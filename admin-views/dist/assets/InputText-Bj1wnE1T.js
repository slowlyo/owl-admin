import{t as Y,bk as xe,Y as de,a4 as se,G as O,H as E,bl as le,l as d,bm as ce,L as K,z as v,ad as M,b5 as he,bn as Oe,M as B,bo as ve,P as Ee,aa as Ne,ab as Te,bp as we,ae as re,bq as Ve,D as L,Q,T as y,ap as Ie,br as oe,bs as Se,am as Pe,ah as N,aM as ke}from"./index-D1HmyPNr.js";var ue=function(f){Y(r,f);function r(t){var e=f.call(this,t)||this,n=t.value;return e.state={isOpen:!1,inputValue:t.multiple||t.creatable===!1?"":e.valueToString(n),isFocused:!1,revealPassword:!1},e.focus=e.focus.bind(e),e.clearValue=e.clearValue.bind(e),e.toggleRevealPassword=e.toggleRevealPassword.bind(e),e.inputRef=e.inputRef.bind(e),e.handleClick=e.handleClick.bind(e),e.handleFocus=e.handleFocus.bind(e),e.handleBlur=e.handleBlur.bind(e),e.handleInputChange=e.handleInputChange.bind(e),e.handleKeyDown=e.handleKeyDown.bind(e),e.handleChange=e.handleChange.bind(e),e.handleStateChange=e.handleStateChange.bind(e),e.loadAutoComplete=xe(e.loadAutoComplete.bind(e),250,{trailing:!0,leading:!1}),e}return r.prototype.componentDidMount=function(){var t=this,e=this.props,n=e.formItem,a=e.autoComplete,i=e.addHook,o=e.formInited,s=e.data,u=e.name;de(a,s)&&n&&(o?n.loadOptions(a,se(s,{term:""})):i&&(this.unHook=i(function(p){return O(t,void 0,void 0,function(){return E(this,function(l){switch(l.label){case 0:return[4,n.loadOptions(a,se(p,{term:""}))];case 1:return l.sent(),n.value&&Se(p,u,n.value),[2]}})})},"init")))},r.prototype.componentDidUpdate=function(t){var e=this.props;t.value!==e.value&&this.setState({inputValue:e.multiple||e.creatable===!1?"":this.valueToString(e.value)}),t.revealPassword!==e.revealPassword&&!e.revealPassword&&this.setState({revealPassword:!1})},r.prototype.componentWillUnmount=function(){this.unHook&&this.unHook()},r.prototype.inputRef=function(t){this.input=t},r.prototype.doAction=function(t,e,n,a){var i=t==null?void 0:t.actionType;i==="reset"?this.resetValue():i==="clear"?this.clearValue():i==="focus"?this.focus():i==="review"?this.setState({revealPassword:!0}):i==="encrypt"&&this.setState({revealPassword:!1})},r.prototype.focus=function(){if(this.input){this.input.focus();var t=this.input.value.length;t&&(this.input.type==="email"?(this.input.type="text",this.input.setSelectionRange(t,t),this.input.type="email"):this.input.setSelectionRange(t,t))}},r.prototype.resetValue=function(){var t,e;return O(this,void 0,void 0,function(){var n,a,i,o,s,u,p,l,c,m=this;return E(this,function(g){switch(g.label){case 0:return n=this.props,a=n.onChange,i=n.dispatchEvent,o=n.resetValue,s=n.formStore,u=n.store,p=n.name,l=(e=Pe((t=s==null?void 0:s.pristine)!==null&&t!==void 0?t:u==null?void 0:u.pristine,p))!==null&&e!==void 0?e:o,[4,i("change",N(this.props,{value:l}))];case 1:return c=g.sent(),c!=null&&c.prevented?[2]:(a(l),this.setState({inputValue:l},function(){m.loadAutoComplete()}),[2])}})})},r.prototype.clearValue=function(){return O(this,void 0,void 0,function(){var t,e,n,a,i,o,s,u=this;return E(this,function(p){switch(p.label){case 0:return t=this.props,e=t.onChange,n=t.dispatchEvent,a=t.clearValueOnEmpty,i=this.props.resetValue,a&&i===""&&(i=void 0),[4,n("clear",N(this.props,{value:i}))];case 1:return o=p.sent(),o!=null&&o.prevented?[2]:[4,n("change",N(this.props,{value:i}))];case 2:return s=p.sent(),s!=null&&s.prevented?[2]:(e(i),this.setState({inputValue:i},function(){u.loadAutoComplete()}),[2])}})})},r.prototype.removeItem=function(t){var e=this.props,n=e.selectedOptions,a=e.onChange,i=n.concat();i.splice(t,1),a(this.normalizeValue(i))},r.prototype.handleClick=function(t){return O(this,void 0,void 0,function(){var e,n,a,i,o;return E(this,function(s){switch(s.label){case 0:return e=this.props,n=e.dispatchEvent,a=e.value,i=e.multiple,[4,n("click",N(this.props,{value:a}))];case 1:return o=s.sent(),o!=null&&o.prevented?[2]:((i||t.target===this.input)&&(this.state.isFocused||this.focus(),this.setState({isOpen:!0})),[2])}})})},r.prototype.handleFocus=function(t){return O(this,void 0,void 0,function(){var e,n,a,i,o;return E(this,function(s){switch(s.label){case 0:return e=this.props,n=e.dispatchEvent,a=e.onFocus,i=e.value,this.setState({isOpen:!0,isFocused:!0}),[4,n("focus",N(this.props,{value:i}))];case 1:return o=s.sent(),o!=null&&o.prevented?[2]:(a==null||a(t),[2])}})})},r.prototype.handleBlur=function(t){return O(this,void 0,void 0,function(){var e,n,a,i,o,s,u,p=this;return E(this,function(l){switch(l.label){case 0:return e=this.props,n=e.onBlur,a=e.trimContents,i=e.value,o=e.onChange,s=e.dispatchEvent,this.setState({isFocused:!1},function(){if(a&&i&&typeof i=="string"){var c=i.trim();p.input&&(p.input.value=c),o(c)}}),[4,s("blur",N(this.props,{value:i}))];case 1:return u=l.sent(),u!=null&&u.prevented?[2]:(n&&n(t),[2])}})})},r.prototype.close=function(){this.setState({isFocused:!1})},r.prototype.handleInputChange=function(t){return O(this,void 0,void 0,function(){var e,n,a,i,o,s,u,p=this;return E(this,function(l){switch(l.label){case 0:return e=this.transformValue(t.currentTarget.value),n=this.props,a=n.creatable,i=n.multiple,o=n.onChange,s=n.dispatchEvent,[4,s("change",N(this.props,{value:e}))];case 1:return u=l.sent(),u!=null&&u.prevented?[2]:(this.setState({inputValue:e},function(){a!==!1&&!i&&(o==null||o(e)),p.loadAutoComplete()}),[2])}})})},r.prototype.handleKeyDown=function(t){var e;return O(this,void 0,void 0,function(){var n,a,i,o,s,u,p,c,l,c,m;return E(this,function(g){switch(g.label){case 0:return n=this.props,a=n.selectedOptions,i=n.onChange,o=n.multiple,s=n.creatable,u=n.dispatchEvent,p=((e=this.props)===null||e===void 0?void 0:e.valueField)||"value",a.length&&!this.state.inputValue&&t.keyCode===8?(t.preventDefault(),c=a.concat(),c.pop(),i(this.normalizeValue(c)),this.setState({inputValue:""},this.loadAutoComplete),[3,4]):[3,1];case 1:return t.key==="Enter"&&this.state.inputValue&&typeof this.highlightedIndex!="number"&&s!==!1?(t.preventDefault(),l=this.state.inputValue,o&&l&&(ke(a,function(P){return P[p]==l})?l=this.normalizeValue(a).concat():(c=a.concat(),c.push({label:l,value:l}),l=this.normalizeValue(c).concat())),[4,u("enter",N(this.props,{value:l}))]):[3,3];case 2:return m=g.sent(),m!=null&&m.prevented?[2]:(i(l),this.setState({inputValue:o?"":l,isOpen:!1},this.loadAutoComplete),[3,4]);case 3:t.key==="Enter"&&this.state.isOpen&&typeof this.highlightedIndex!="number"&&this.setState({isOpen:!1}),g.label=4;case 4:return[2]}})})},r.prototype.handleChange=function(t){var e=this.props,n=e.onChange,a=e.multiple,i=e.options,o=e.selectedOptions,s=e.creatable,u=e.valueField,p=i.find(function(c){return c[u||"value"]===t});if(a){var l=o.concat();p?l.push(p):t&&s!==!1&&l.push({label:t,value:t}),n(this.normalizeValue(l))}else n(p?this.normalizeValue(p):t);(a||s===!1)&&this.setState({inputValue:""},this.loadAutoComplete)},r.prototype.handleStateChange=function(t){var e=this.props.creatable,n=this.props.multiple||this.props.multi;switch(t.type){case le.stateChangeTypes.itemMouseEnter:this.setState({isOpen:!0});break;case le.stateChangeTypes.changeInput:this.setState({isOpen:!0});break;default:var a={};typeof t.isOpen<"u"&&(a.isOpen=t.isOpen),typeof t.highlightedIndex<"u"&&(this.highlightedIndex=t.highlightedIndex),!n&&e===!1&&this.state.isOpen&&t.isOpen===!1&&(a.inputValue=""),this.setState(a);break}},r.prototype.handleNormalInputChange=function(t){return O(this,void 0,void 0,function(){var e,n,a,i,o,s,u;return E(this,function(p){switch(p.label){case 0:return e=this.props,n=e.onChange,a=e.dispatchEvent,i=e.trimContents,o=e.clearValueOnEmpty,s=this.transformValue(t.currentTarget.value),typeof s=="string"&&(i&&(s=s.trim()),o&&s===""&&(s=void 0)),[4,a("change",N(this.props,{value:s}))];case 1:return u=p.sent(),u!=null&&u.prevented?[2]:(n(s),[2])}})})},r.prototype.normalizeValue=function(t){var e=this.props,n=e.multiple,a=e.delimiter,i=e.joinValues,o=e.extractValue,s=e.valueField,u=Array.isArray(t)?t:t?[t]:[];if(i)return u.map(function(l){return l[s||"value"]}).join(a||",");if(o){var p=u.map(function(l){return l[s||"value"]});return n?p:p[0]}else return n?u:u[0]},r.prototype.transformValue=function(t){var e=this.props.transform;return e&&Object.keys(e).forEach(function(n){var a=e[n];switch(n){case"lowerCase":a&&(t=t.toLowerCase());break;case"upperCase":a&&(t=t.toUpperCase());break}}),t},r.prototype.loadAutoComplete=function(){var t=this.props,e=t.formItem,n=t.autoComplete,a=t.data;de(n,a)&&e&&e.loadOptions(n,se(a,{term:this.state.inputValue||""}),{extendsOptions:!0})},r.prototype.reload=function(t,e){var n=this.props.reloadOptions;n&&n(t,e)},r.prototype.valueToString=function(t){return typeof t>"u"||t===null?"":typeof t=="string"?t:t instanceof Date?t.toISOString():JSON.stringify(t)},r.prototype.getTarget=function(){var t;return(t=this.input)===null||t===void 0?void 0:t.parentElement},r.prototype.renderSugestMode=function(){var t=this,e,n=this.props,a=n.className;n.style;var i=n.inputControlClassName,o=n.nativeInputClassName,s=n.inputOnly,u=n.value,p=n.placeholder,l=n.classnames,c=n.disabled,m=n.readOnly,g=n.name,P=n.loading,D=n.clearable,k=n.options,V=n.selectedOptions,F=n.autoComplete,b=n.labelField,h=n.valueField,I=n.multiple,x=n.creatable,_=n.borderMode,j=n.showCounter,X=n.data,T=n.maxLength,Z=n.minLength,$=n.translate,W=n.loadingConfig,q=n.popOverContainer,G=n.themeCss,w=n.css,z=n.id,me=n.nativeAutoComplete,ee=n.testIdBuilder,fe=(e=this.props.type)===null||e===void 0?void 0:e.replace(/^(?:native|input)\-/,"");return d.createElement(le,{isOpen:this.state.isOpen&&!c&&!m,inputValue:this.state.inputValue,onChange:this.handleChange,onStateChange:this.handleStateChange,selectedItem:V.map(function(S){return S[h||"value"]})},function(S){var H,te,ne,Ce=S.getInputProps,ge=S.getItemProps,U=S.isOpen,J=S.inputValue,ae=S.selectedItem,ye=S.highlightedIndex,A=J&&U&&!F?ce(k,J,{keys:[b||"label",h||"value"],threshold:ce.rankings.CONTAINS}):k,be=U?Fe(A,ae):{};A=A.filter(function(C){return!~ae.indexOf(C.value)}),t.state.inputValue&&x!==!1&&I&&!A.some(function(C){return C.value===t.state.inputValue})&&!~ae.indexOf(t.state.inputValue)&&A.push((H={},H[b||"label"]=t.state.inputValue,H[h||"value"]=t.state.inputValue,H.isNew=!0,H));var pe=K(p,X);return d.createElement("div",v({className:l("TextControl-input TextControl-input--withAC",i,M(v(v({},t.props),{name:"inputControlClassName",id:z,themeCss:G||w})),M(v(v({},t.props),{name:"inputControlClassName",id:z,themeCss:G||w,extra:"inner"})),s?a:"",(te={"is-opened":U,"TextControl-input--multiple":I},te["TextControl-input--border".concat(he(_))]=_,te)),onClick:t.handleClick},ee==null?void 0:ee.getTestId()),d.createElement(d.Fragment,null,pe&&!V.length&&!t.state.inputValue&&!t.state.isFocused?d.createElement("div",{className:l("TextControl-placeholder")},pe):null,V.map(function(C,R){return I?d.createElement("div",{className:l("TextControl-value"),key:R},d.createElement(Oe,{className:l("TextControl-valueLabel"),tooltip:"".concat(C[b||"label"])},"".concat(C[b||"label"])),d.createElement(B,{icon:"close",className:l("TextControl-valueIcon","icon"),onClick:t.removeItem.bind(t,R)})):J&&U||x!==!1?null:d.createElement("div",{className:l("TextControl-value"),key:R},C.label)}),d.createElement(ve,v({},Ce({name:g,ref:t.inputRef,disabled:c,readOnly:m,type:fe,onFocus:t.handleFocus,onBlur:t.handleBlur,onChange:t.handleInputChange,onKeyDown:t.handleKeyDown,maxLength:T,minLength:Z}),{autoComplete:me,size:10,className:l(o)}))),D&&!c&&!m&&u?d.createElement("a",{onClick:t.clearValue,className:l("TextControl-clear")},d.createElement(B,{icon:"input-clear",className:"icon",iconContent:"InputText-clear"})):null,j?d.createElement("span",{className:l("TextControl-counter")},"".concat((ne=t.valueToString(u))===null||ne===void 0?void 0:ne.length).concat(typeof T=="number"&&T?"/".concat(T):"")):null,P?d.createElement(Ee,{show:!0,icon:"reload",size:"sm",spinnerClassName:l("TextControl-spinner"),loadingConfig:W}):null,d.createElement(Ne,{container:q||t.getTarget,target:t.getTarget,show:!!(U&&A.length)},d.createElement(Te,{className:l("TextControl-popover"),style:{width:t.input?t.input.parentElement.offsetWidth:"auto"}},d.createElement("div",{className:l("TextControl-sugs")},A.map(function(C){var R=C[b||"label"],ie=C[h||"value"];return d.createElement("div",v({},ge({item:ie,disabled:C.disabled,className:l("TextControl-sugItem",{"is-highlight":ye===be[ie],"is-disabled":C.disabled||C.readOnly})}),{key:ie}),C.isNew?d.createElement("span",null,$("Text.add",{label:R}),d.createElement(B,{icon:"enter",className:"icon"})):d.createElement("span",null,C.disabled?R:we(R,J),C.tip))})))))})},r.prototype.toggleRevealPassword=function(){return O(this,void 0,void 0,function(){var t,e,n,a,i;return E(this,function(o){switch(o.label){case 0:return t=this.props,e=t.dispatchEvent,n=t.value,a=this.state.revealPassword?"encrypt":"review",[4,e(a,N(this.props,{value:n}))];case 1:return i=o.sent(),i!=null&&i.prevented||i!=null&&i.stoped?[2]:(this.setState({revealPassword:!this.state.revealPassword}),[2])}})})},r.prototype.renderNormal=function(){var t,e,n,a=this.props;a.classPrefix;var i=a.classnames,o=a.className;a.style;var s=a.inputControlClassName,u=a.nativeInputClassName,p=a.inputOnly,l=a.value,c=a.placeholder;a.onChange;var m=a.disabled,g=a.readOnly,P=a.max,D=a.min,k=a.step,V=a.clearable,F=a.revealPassword,b=F===void 0?!0:F,h=a.name,I=a.borderMode,x=a.prefix,_=a.suffix,j=a.data,X=a.showCounter,T=a.maxLength,Z=a.minLength,$=a.themeCss,W=a.css,q=a.id,G=a.nativeAutoComplete,w=a.testIdBuilder,z=(e=this.props.type)===null||e===void 0?void 0:e.replace(/^(?:native|input)\-/,"");return d.createElement("div",v({className:i("TextControl-input",(t={},t["TextControl-input--border".concat(he(I))]=I,t),M(v(v({},this.props),{name:"inputControlClassName",id:q,themeCss:$||W})),M(v(v({},this.props),{name:"inputControlClassName",id:q,themeCss:$||W,extra:"inner"})),s,p?o:"")},w==null?void 0:w.getTestId()),x?d.createElement("span",{className:i("TextControl-inputPrefix")},K(x,j)):null,d.createElement(ve,v({name:h,placeholder:K(c,j),ref:this.inputRef,disabled:m,readOnly:g,type:this.state.revealPassword?"text":z,onFocus:this.handleFocus,onBlur:this.handleBlur,max:P,min:D,maxLength:T,minLength:Z,autoComplete:G,size:10,step:k,onChange:this.handleNormalInputChange,value:this.valueToString(l),className:i(u,{"TextControl-input-password":z==="password"&&b})},w==null?void 0:w.getChild("input").getTestId())),V&&!m&&!g&&l?d.createElement("a",{onClick:this.clearValue,className:i("TextControl-clear")},d.createElement(B,{icon:"input-clear",className:"icon",iconContent:"InputText-clear"})):null,z==="password"&&b&&!m?d.createElement("a",{onClick:this.toggleRevealPassword,className:i("TextControl-revealPassword")},this.state.revealPassword?d.createElement(B,{icon:"view",className:i("TextControl-icon-view"),classNameProp:i("TextControl-icon-view"),iconContent:"InputText-view"}):d.createElement(B,{icon:"invisible",className:i("TextControl-icon-invisible"),classNameProp:i("TextControl-icon-invisible"),iconContent:"InputText-invisible"})):null,X?d.createElement("span",{className:i("TextControl-counter")},"".concat((n=this.valueToString(l))===null||n===void 0?void 0:n.length).concat(typeof T=="number"&&T?"/".concat(T):"")):null,_?d.createElement("span",{className:i("TextControl-inputSuffix")},K(_,j)):null)},r.prototype.renderBody=function(t){var e,n,a=this.props,i=a.classnames,o=a.className,s=a.style,u=a.classPrefix,p=a.addOn,l=a.render,c=a.data,m=a.disabled,g=a.readOnly,P=a.inputOnly,D=a.static,k=a.addOnClassName,V=a.themeCss,F=a.css,b=a.id,h=typeof p=="string"?{label:p,type:"plain"}:p,I=d.createElement(B,{cx:i,icon:h==null?void 0:h.icon,className:"Icon"}),x=h&&!D?h.actionType||~["button","submit","reset","action"].indexOf(h.type)?d.createElement("div",{className:i("".concat(u,"TextControl-button"),k,M(v(v({},this.props),{name:"addOnClassName",id:b,themeCss:V||F,extra:"addOn"})))},l("addOn",h,{disabled:m})):d.createElement("div",{className:i("".concat(u,"TextControl-addOn"),k,M(v(v({},this.props),{name:"addOnClassName",id:b,themeCss:V||F,extra:"addOn"})))},I,h.label?K(h.label,c):null):null;if(P)return t;var _=D?i("".concat(u,"TextControl"),(n={},n["".concat(u,"TextControl--withAddOn")]=!!x,n)):i(o,"".concat(u,"TextControl"),(e={},e["".concat(u,"TextControl--withAddOn")]=!!x,e["is-focused"]=this.state.isFocused,e["is-disabled"]=m||g,e));return d.createElement("div",{className:_,style:s},h&&h.position==="left"?x:null,t,h&&h.position!=="left"?x:null)},r.prototype.render=function(){var t=this.props,e=t.options,n=t.source,a=t.autoComplete,i=t.themeCss,o=t.css,s=t.id,u=t.env,p=t.classPrefix,l=a!==!1&&(n||e!=null&&e.length||a)?this.renderSugestMode():this.renderNormal();return d.createElement(d.Fragment,null,this.renderBody(l),d.createElement(re,v({},this.props,{config:{themeCss:i||o,classNames:[{key:"inputControlClassName",weights:{focused:{parent:".".concat(p,"TextControl.is-focused")},disabled:{parent:".".concat(p,"TextControl.is-disabled")}}}],id:s},env:u})),d.createElement(re,v({},this.props,{config:{themeCss:Ve(i||o),classNames:[{key:"inputControlClassName",weights:{default:{inner:"input"},hover:{inner:"input"},focused:{parent:".".concat(p,"TextControl.is-focused"),inner:"input"},disabled:{parent:".".concat(p,"TextControl.is-disabled"),inner:"input"}}}],id:s&&s+"-inner"},env:u})),d.createElement(re,v({},this.props,{config:{themeCss:i||o,classNames:[{key:"addOnClassName"}],id:s&&s+"-addOn"},env:u})))},r.defaultProps={resetValue:"",labelField:"label",valueField:"value",placeholder:"",allowInputText:!0,trimContents:!0,nativeAutoComplete:"off"},L([Q,y("design:type",Function),y("design:paramtypes",[]),y("design:returntype",void 0)],r.prototype,"close",null),L([Q,y("design:type",Function),y("design:paramtypes",[Object]),y("design:returntype",Promise)],r.prototype,"handleNormalInputChange",null),L([Q,y("design:type",Function),y("design:paramtypes",[]),y("design:returntype",void 0)],r.prototype,"getTarget",null),L([Q,Ie(),y("design:type",Function),y("design:paramtypes",[]),y("design:returntype",Object)],r.prototype,"render",null),r}(d.PureComponent);function Fe(f,r,t){return t===void 0&&(t="value"),f.filter(function(e){return r.indexOf(e[t||"value"])===-1}).reduce(function(e,n,a){return e[n[t||"value"]]=a,e},{})}var Ae=function(f){Y(r,f);function r(){return f!==null&&f.apply(this,arguments)||this}return r=L([oe({type:"input-text",alias:["input-password","native-date","native-time","native-number"]})],r),r}(ue),Re=function(f){Y(r,f);function r(){return f!==null&&f.apply(this,arguments)||this}return r=L([oe({type:"input-email",validations:"isEmail"})],r),r}(ue),Be=function(f){Y(r,f);function r(){return f!==null&&f.apply(this,arguments)||this}return r=L([oe({type:"input-url",validations:"isUrl"})],r),r}(ue);export{Re as EmailControlRenderer,Ae as TextControlRenderer,Be as UrlControlRenderer,ue as default,Fe as mapItemIndex};
