import{$o as e,Ao as t,Ci as n,Fo as r,Ko as i,Mo as a,No as o,Oa as s,Po as c,Ur as l,dt as u,fr as d,ii as f,jo as p,kr as m,qo as h}from"./index-zRImlZB6.js";var g=h((e=>{var t=e&&e.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},n=e&&e.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==`function`&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(s){if(r)throw TypeError(`Generator is already executing.`);for(;o&&(o=0,s[0]&&(n=0)),n;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if((a=n.trys,!(a=a.length>0&&a[a.length-1]))&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(e){s=[6,e],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(e,`__esModule`,{value:!0}),e.base64ToBlob=r;function r(e){return t(this,void 0,void 0,function(){var t,r,i;return n(this,function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:return t=n.sent(),[4,t.blob()];case 2:return r=n.sent(),i=a(e),i&&(r=r.slice(0,r.size,i)),[2,r]}})})}var i=/^data:(.+);base64,/;function a(e){return e.match(i)?.slice(1,2).pop()}})),_=h((e=>{var t=e&&e.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},n=e&&e.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==`function`&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(s){if(r)throw TypeError(`Generator is already executing.`);for(;o&&(o=0,s[0]&&(n=0)),n;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if((a=n.trys,!(a=a.length>0&&a[a.length-1]))&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(e){s=[6,e],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(e,`__esModule`,{value:!0}),e.base64ToFile=r;function r(e,r,i){return t(this,void 0,void 0,function(){var t,a;return n(this,function(n){switch(n.label){case 0:return[4,fetch(e)];case 1:return t=n.sent(),[4,t.blob()];case 2:return a=n.sent(),[2,new File([a],r,i)]}})})}})),v=h((e=>{var t=e&&e.__awaiter||function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},n=e&&e.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==`function`&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(s){if(r)throw TypeError(`Generator is already executing.`);for(;o&&(o=0,s[0]&&(n=0)),n;)try{if(r=1,i&&(a=s[0]&2?i.return:s[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[s[0]&2,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return n.label++,{value:s[1],done:!1};case 5:n.label++,i=s[1],s=[0];continue;case 7:s=n.ops.pop(),n.trys.pop();continue;default:if((a=n.trys,!(a=a.length>0&&a[a.length-1]))&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!a||s[1]>a[0]&&s[1]<a[3])){n.label=s[1];break}if(s[0]===6&&n.label<a[1]){n.label=a[1],a=s;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(s);break}a[2]&&n.ops.pop(),n.trys.pop();continue}s=t.call(e,n)}catch(e){s=[6,e],i=0}finally{r=a=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(e,`__esModule`,{value:!0}),e.blobToBase64=r;function r(e){return t(this,void 0,void 0,function(){return n(this,function(t){return[2,typeof FileReader==`function`?a(e):s(e)]})})}var i;(function(e){e.error=`error`,e.loadend=`loadend`})(i||={});function a(e){return t(this,void 0,void 0,function(){return n(this,function(t){return[2,new Promise(function(t,n){try{var r=new FileReader,a=function(){t(r.result),r.removeEventListener(i.loadend,a)};r.addEventListener(i.loadend,a);var o=function(){n(r.error),r.removeEventListener(i.error,o)};r.addEventListener(i.error,o),r.readAsDataURL(e)}catch(e){n(e)}})]})})}var o=`application/octet-stream`;function s(e){return t(this,void 0,void 0,function(){var t,r,i,a;return n(this,function(n){switch(n.label){case 0:return i=(r=Buffer).from,[4,e.text()];case 1:return t=i.apply(r,[n.sent()]),a=e.type||o,[2,`data:${a};base64,${t.toString(`base64`)}`]}})})}})),y=h((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.fileToBase64=void 0;var t=v();Object.defineProperty(e,`fileToBase64`,{enumerable:!0,get:function(){return t.blobToBase64}})})),b=h((e=>{var t=e&&e.__createBinding||(Object.create?(function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||(`get`in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}):(function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]})),n=e&&e.__exportStar||function(e,n){for(var r in e)r!==`default`&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(e,`__esModule`,{value:!0}),n(g(),e),n(_(),e),n(v(),e),n(y(),e)})),x=e(i()),S=e(l()),C=b(),w=function(e){o(i,e);function i(){return e!==null&&e.apply(this,arguments)||this}return i.prototype.uploadFile=function(e,t){return p(this,void 0,void 0,function(){var n,r,i;return c(this,function(a){switch(a.label){case 0:return n=f(t,`post`),n.data?[3,2]:(r=new FormData,[4,(0,C.base64ToBlob)(e)]);case 1:i=a.sent(),r.append(`file`,i,`signature.png`),n.data=r,a.label=2;case 2:return[2,this.props.env.fetcher(n,s(this.props.data,{file:e}))]}})})},i.prototype.handleChange=function(e){var t,n;return p(this,void 0,void 0,function(){var r,i,a,o,s,l,u,d;return c(this,function(c){switch(c.label){case 0:if(r=this.props,i=r.translate,a=r.uploadApi,o=r.embed,s=r.onChange,!o||!a||e===void 0)return s?.(e),[2];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.uploadFile(e,a)];case 2:if(l=c.sent(),!l.ok||l.status&&l.status!==`0`||!l.data)throw Error(l.msg||i(`File.errorRetry`));return u=l.data.value||l.data.url||l.data,s?.(u),[3,4];case 3:return d=c.sent(),s?.(``),(n=(t=this.props.env)?.alert)==null||n.call(t,d.message||i(`File.errorRetry`)),[3,4];case 4:return[2]}})})},i.prototype.render=function(){var e=this.props,n=e.classnames,r=e.className,i=(0,S.default)(this.props,[`value`,`width`,`height`,`mobileUI`,`embed`,`color`,`bgColor`,`clearBtnLabel`,`clearBtnIcon`,`undoBtnLabel`,`undoBtnIcon`,`confirmBtnLabel`,`confirmBtnIcon`,`embedConfirmLabel`,`embedConfirmIcon`,`ebmedCancelLabel`,`ebmedCancelIcon`,`embedBtnIcon`,`embedBtnLabel`,`uploadApi`]);return x.createElement(u,t({classnames:n,className:r,onChange:this.handleChange},i))},a([n,r(`design:type`,Function),r(`design:paramtypes`,[String,String]),r(`design:returntype`,Promise)],i.prototype,`uploadFile`,null),a([n,r(`design:type`,Function),r(`design:paramtypes`,[Object]),r(`design:returntype`,Promise)],i.prototype,`handleChange`,null),i}(x.Component),T=function(e){o(t,e);function t(t,n){var r=e.call(this,t)||this;return n.registerComponent(r),r}return t.prototype.componentWillUnmount=function(){var t;(t=e.prototype.componentWillUnmount)==null||t.call(this),this.context.unRegisterComponent(this)},t.contextType=m,t=a([d({type:`input-signature`,sizeMutable:!1}),r(`design:paramtypes`,[Object,Object])],t),t}(w);export{T as InputSignatureRenderer,w as default};