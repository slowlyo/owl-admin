import{$o as e,Ao as t,Ci as n,Da as r,Fa as i,Fo as a,Hn as o,Ia as s,Ir as c,J as l,Ko as u,Li as d,Lr as f,Mi as p,Mo as m,No as h,Nr as g,Oa as _,Po as v,Ur as y,Ya as b,ba as x,dr as S,ea as C,ga as w,hi as T,ir as E,ji as D,jo as O,ki as k,la as A,ni as j,si as M,so as N,tn as ee}from"./index-Z33w_AY6.js";var P=e(u()),F=e(T()),I=e(y()),L=function(e){switch(typeof e){case`string`:return M(e,`options`,`inputValue`,`option`);case`function`:return e;default:return null}},R=function(e){h(u,e);function u(){return e!==null&&e.apply(this,arguments)||this}return u.prototype.reload=function(e,t){var n=this.props.reloadOptions;n&&n(e,t)},u.prototype.handleChange=function(e,n){return O(this,void 0,void 0,function(){var r,i,a,o,s,l,u,m,h,_,y,b,x,S,C,w,T,E,O,k;return v(this,function(v){switch(v.label){case 0:return r=this.props,i=r.onChange,a=r.joinValues,o=r.delimiter,s=r.valueField,l=r.extractValue,u=r.options,m=r.dispatchEvent,h=r.setOptions,_=r.selectMode,y=r.deferApi,b=r.deferField,x=b===void 0?`defer`:b,S=e,C=u.concat(),w=e,Array.isArray(e)?(S=e.map(function(e){var r=p(u,f(e[s||`value`],s||`value`),{resolve:c(s),value:e[s]||`value`});if(!r)C.push(t(t({},e),{visible:!1}));else if(n){var i=d(C,r);C=A(C,r,1,t(t({},i),e))}return a||l?e[s||`value`]:e}),a&&(S=S.join(o||`,`))):e&&(S=a||l?e[s||`value`]:e,T=p(u,f(e[s||`value`],s||`value`)),T?n&&(E=d(C,T),C=A(C,T,1,t(t({},E),e))):C.push(t(t({},e),{visible:!1}))),O=_===`tree`&&(!!y||!!D(u,function(e){return e.deferApi||e[x]})),(O===!0||C.length>u.length||n)&&h(C,!0),[4,m(`change`,g(this.props,{value:S,options:u,items:u,selectedItems:w}))];case 1:return k=v.sent(),k?.prevented||i(S),[2]}})})},u.prototype.option2value=function(e){return e},u.prototype.getResult=function(e){return e.data.options||e.data.items||e.data},u.prototype.handleSearch=function(e,n,r){return O(this,void 0,void 0,function(){var i,a,o,s,c,l,u,d,p,m,h,g,y,x,S,w,T;return v(this,function(v){switch(v.label){case 0:if(i=this.props,a=i.searchApi,o=i.options,s=i.labelField,c=i.valueField,l=i.env,u=i.data,d=i.translate,p=i.filterOption,!a)return[3,5];v.label=1;case 1:return v.trys.push([1,3,,4]),[4,l.fetcher(a,_(u,t({term:e},r||{})),{cancelExecutor:n})];case 2:if(m=v.sent(),!m.ok)throw Error(d(m.msg||`networkError`));if(h=this.getResult(m),!Array.isArray(h))throw Error(d(`CRUD.invalidArray`));return g={},r&&(g={page:m.data.page,perPage:r.perPage,total:m.data.count}),[2,t({items:C(h,function(e){var n=null,r=e[c||`value`];return Array.isArray(o)&&r!=null&&(n=(0,F.default)(o,f(r,c)),e?.children&&(n=t(t({},n),{children:e.children}))),n||e})},g)];case 3:return y=v.sent(),!l.isCancel(y)&&!a.silent&&l.notify(`error`,y.message),[2,{items:[]}];case 4:return[3,6];case 5:return e?(x=s||`label`,S=c||`value`,w={keys:[x,S]},p?(T=L(p),T?[2,{items:T(o,e,w)}]:(l.notify(`error`,`自定义检索函数不符合要求`),[2,{items:[]}])):[2,{items:k(o,function(t,n,r,i){return!!(Array.isArray(t.children)&&t.children.length||b([t].concat(i),e,{keys:[s||`label`,c||`value`],threshold:b.rankings.CONTAINS}).length)},0,!0)}]):[2,{items:o}];case 6:return[2]}})})},u.prototype.handleResultSearch=function(e,t){var n=this.props,i=n.valueField,a=n.labelField,o=r(e),s=t[a||`label`],c=t[i||`value`];return o.test(s)||o.test(c)},u.prototype.handlePageChange=function(e,n,r){var i=this.props,a=i.source,o=i.data,s=i.formItem,c=i.onChange,l=_(o,t({page:e??1,perPage:n??10},r?{pageDir:r}:{}));!s||!N(s)||(x(a)?s.loadOptionsFromDataScope(a,l,c):j(a,l)&&s.loadOptions(a,l,void 0,!1,c,!1))},u.prototype.optionItemRender=function(e,t){var n=this.props,r=n.menuTpl,i=n.render,a=n.data;return i(`item/${t.index}`,r,{data:_(_(a,t),e)})},u.prototype.resultItemRender=function(e,t){var n=this.props,r=n.valueTpl,i=n.render,a=n.data;return i(`value/${t.index}`,r,{onChange:t.onChange,data:_(_(a,t),e)})},u.prototype.renderCell=function(e,n,r,a){var o=this.props,s=o.render,c=o.data,l=o.classnames,u=o.showInvalidMatch;return s(`cell/${r}/${a}`,t({type:`text`,className:l({"is-invalid":u?n?.__unmatched:!1})},e),{value:i(e.name,n),data:_(c,n)})},u.prototype.getRef=function(e){for(;e&&e.getWrappedInstance;)e=e.getWrappedInstance();this.tranferRef=e},u.prototype.onSelectAll=function(e){var t=this.props,n=t.dispatchEvent,r=t.data;n(`selectAll`,_(r,{items:e}))},u.prototype.doAction=function(e,t,n){var r,i,a=this.props,o=a.resetValue,c=a.onChange,l=a.formStore,u=a.store,d=a.name;switch(e.actionType){case`clear`:c?.(``);break;case`reset`:c?.(s(l?.pristine??u?.pristine,d)??o??``);break;case`selectAll`:(r=this.tranferRef)==null||r.selectAll();break;case`clearSearch`:(i=this.tranferRef)==null||i.clearSearch(t);break}},u.prototype.render=function(){var e=this.props,n=e.className;e.style;var r=e.classnames,i=e.selectedOptions,a=e.showArrow,s=e.sortable,c=e.selectMode,l=e.columns,u=e.loading,d=e.searchable,f=e.searchResultMode,p=e.searchResultColumns,m=e.deferLoad,h=e.leftMode,g=e.rightMode,_=e.disabled,v=e.selectTitle,y=e.resultTitle,b=e.menuTpl,x=e.valueTpl,S=e.searchPlaceholder,C=e.resultListModeFollowSelect,T=C===void 0?!1:C,D=e.resultSearchPlaceholder,O=e.resultSearchable,k=O===void 0?!1:O,A=e.statistics,j=e.labelField,M=e.valueField,N=e.virtualThreshold,F=e.itemHeight,L=e.loadingConfig,R=e.showInvalidMatch,z=e.onlyChildren,B=e.mobileUI,V=e.noResultsText,H=e.pagination,U=e.formItem,W=e.env,G=e.popOverContainer,K=e.data,q=e.autoCheckChildren,J=q===void 0?!0:q,Y=e.initiallyOpen,te=Y===void 0?!0:Y,ne=e.testIdBuilder,X=this.props,Z=X.options,Q=X.leftOptions,$=X.leftDefaultValue;return c===`associated`&&Z&&Z.length&&Z[0].leftOptions&&Array.isArray(Z[0].children)&&(Q=Z[0].leftOptions,$=Z[0].leftDefaultValue??$,Z=Z[0].children),P.createElement(`div`,{className:r(`TransferControl`,n)},P.createElement(ee,{onlyChildren:z,value:i,options:Z,accumulatedOptions:U?.accumulatedOptions??[],disabled:_,onChange:this.handleChange,option2value:this.option2value,sortable:s,showArrow:a,selectMode:c,searchResultMode:f,searchResultColumns:p,columns:l,onSearch:d?this.handleSearch:void 0,onDeferLoad:m,leftOptions:Q,leftMode:h,rightMode:g,cellRender:this.renderCell,selectTitle:v,resultTitle:y,resultListModeFollowSelect:T,onResultSearch:this.handleResultSearch,searchPlaceholder:S,resultSearchable:k,resultSearchPlaceholder:D,statistics:A,labelField:j,valueField:M,optionItemRender:b?this.optionItemRender:void 0,resultItemRender:x?this.resultItemRender:void 0,onSelectAll:this.onSelectAll,onRef:this.getRef,virtualThreshold:N,itemHeight:E(F)>0?E(F):void 0,loadingConfig:L,showInvalidMatch:R,mobileUI:B,noResultsText:V,pagination:t(t({},(0,I.default)(H,[`className`,`layout`,`perPageAvailable`,`popOverContainerSelector`])),{enable:(H&&H.enable!==void 0?!!(typeof H.enable==`string`?w(H.enable,K):H.enable):!!U?.enableSourcePagination)&&(!c||c===`list`||c===`table`)&&Z.length>0,maxButtons:Number.isInteger(H?.maxButtons)?H.maxButtons:5,page:U?.sourcePageNum,perPage:U?.sourcePerPageNum,total:U?.sourceTotalNum,popOverContainer:G??W?.getModalContainer}),onPageChange:this.handlePageChange,initiallyOpen:te,autoCheckChildren:J,testIdBuilder:ne}),P.createElement(o,{overlay:!0,key:`info`,loadingConfig:L,show:u}))},u.defaultProps={multiple:!0},m([n,a(`design:type`,Function),a(`design:paramtypes`,[Object,Boolean]),a(`design:returntype`,Promise)],u.prototype,`handleChange`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Object]),a(`design:returntype`,void 0)],u.prototype,`option2value`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Object]),a(`design:returntype`,void 0)],u.prototype,`getResult`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[String,Function,Object]),a(`design:returntype`,Promise)],u.prototype,`handleSearch`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[String,Object]),a(`design:returntype`,void 0)],u.prototype,`handleResultSearch`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Number,Number,String]),a(`design:returntype`,void 0)],u.prototype,`handlePageChange`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Object,Object]),a(`design:returntype`,void 0)],u.prototype,`optionItemRender`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Object,Object]),a(`design:returntype`,void 0)],u.prototype,`resultItemRender`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Object,Object,Number,Number]),a(`design:returntype`,void 0)],u.prototype,`renderCell`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Object]),a(`design:returntype`,void 0)],u.prototype,`getRef`,null),m([n,a(`design:type`,Function),a(`design:paramtypes`,[Array]),a(`design:returntype`,void 0)],u.prototype,`onSelectAll`,null),m([l(),a(`design:type`,Function),a(`design:paramtypes`,[]),a(`design:returntype`,void 0)],u.prototype,`render`,null),u}(P.Component),z=function(e){h(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(R),B=S({type:`transfer`})(z);export{L as i,B as n,z as r,R as t};