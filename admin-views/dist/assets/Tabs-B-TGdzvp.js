import{$o as e,Ao as t,Ci as n,Do as r,Fo as i,Ia as a,Io as o,Ki as s,Ko as c,La as l,Ma as u,Mo as d,No as f,Nr as p,Oa as m,Po as h,Ro as g,Tn as _,Yi as v,Za as y,Zi as b,gi as x,hi as S,jo as C,kr as w,oi as T,vr as E,wn as D,wr as O,xr as k,ya as A}from"./index-DAdqRbKX.js";var j=e(c()),M=e(S()),N=e(x()),P=e(y()),F=e(r()),I=function(e){f(r,e);function r(t){var n=e.call(this,t)||this;n.newTabDefaultId=3,n.lazySwitchTo=(0,F.default)(n.switchTo.bind(n),250,{leading:!0,trailing:!1});var r=t.location||window.location,i=t.tabs,a=t.source,s=t.data,c=0;if(t.activeKey!==void 0)c=t.activeKey;else if(r&&Array.isArray(i)){var u=r.hash.substring(1),d=(0,M.default)(i,function(e){return e.hash===u});d?c=d.hash:t.defaultKey===void 0?t.defaultActiveKey&&(c=typeof t.defaultActiveKey==`string`?l(t.defaultActiveKey,t.data):t.defaultActiveKey):c=typeof t.defaultKey==`string`?l(t.defaultKey,t.data):t.defaultKey,c=c||i[0]&&i[0].hash||0}var f=o(n.initTabArray(i,a,s),2),p=f[0],m=f[1];return n.state={prevKey:void 0,activeKey:n.activeKey=c,localTabs:p,isFromSource:m},n}return r.prototype.initTabArray=function(e,n,r){if(!e)return[[],!1];var i=l(n,r,`| raw`);if(!Array.isArray(i))return[e,!1];e=Array.isArray(e)?e:[e];var a=[];return i.forEach(function(n){a.push.apply(a,g([],o(e.map(function(e){return t(t({},e),{data:n})})),!1))}),[a,!0]},r.prototype.componentDidMount=function(){this.autoJumpToNeighbour(this.activeKey);var e=this.props,t=e.name,n=e.value,r=e.onChange,i=e.source;e.tabs;var o=e.data,s=this.state.localTabs;if(!(!t||typeof r!=`function`||i))if(n??=a(o,t),n&&Array.isArray(s)){var c=this.resolveKeyByValue(n);c!==void 0&&this.handleSelect(c)}else{var l=this.resolveTabByKey(this.activeKey);l&&n!==(l.value??l.title)&&r(l.value??l.title,t)}},r.prototype.componentDidUpdate=function(e,t){var n=this.props,r=this.state.localTabs,i=l(e.defaultActiveKey,e.data),s=l(n.defaultActiveKey,n.data);if(v({tabs:n.tabs,source:l(n.source,n.data,`| raw`)},{tabs:e.tabs,source:l(e.source,e.data,`| raw`)},!1)){var c=o(this.initTabArray(n.tabs,n.source,n.data),2),u=c[0],d=c[1];this.setState({localTabs:u,isFromSource:d}),r=u}if(n.location&&e.location&&n.location.hash!==e.location.hash){var f=n.location.hash.substring(1);if(!f)return;var p=(0,M.default)(r,function(e){return e.hash===f});p&&p.hash&&p.hash!==this.state.activeKey&&this.setState({activeKey:this.activeKey=p.hash,prevKey:this.state.activeKey})}else if(Array.isArray(r)&&Array.isArray(t.localTabs)&&JSON.stringify(r.map(function(e){return e.hash}))!==JSON.stringify(t.localTabs.map(function(e){return e.hash}))){var m=this.state.activeKey,h=n.location,p=null;if(h&&Array.isArray(r)){var g=h.hash.substring(1);p=(0,M.default)(r,function(e){return e.hash===g})}p?m=p.hash:(!r||!r.some(function(e,t){return e.hash?e.hash===m:t===m}))&&(m=r&&r[0]&&r[0].hash||0),this.setState({prevKey:void 0,activeKey:this.activeKey=m})}else if(i!==s){if(s==null)return;var _=null,p=(0,M.default)(r,function(e){return e.hash===s});p?_=p.hash:typeof s==`number`&&r[s]&&(_=s),_!==null&&this.setState({prevKey:i,activeKey:this.activeKey=_})}this.autoJumpToNeighbour(this.activeKey);var y=this.props,b=y.name,x=y.value,S=y.onChange,C=y.source,w=y.data;if(!(!b||typeof S!=`function`||C)){var T;x??=a(w,b);var E=e.value??a(e.data,e.name);if(x!==E&&(T=this.resolveKeyByValue(x))!==void 0&&T!==this.activeKey)this.handleSelect(T);else if(this.activeKey!==t.activeKey){var p=this.resolveTabByKey(this.activeKey);p&&x!==(p.value??p.title)&&S(p.value??p.title,b)}}},r.prototype.componentWillUnmount=function(){this.lazySwitchTo.cancel()},r.prototype.resolveTabByKey=function(e){var t=this.state.localTabs;if(Array.isArray(t))return(0,M.default)(t,function(t,n){return t.hash?t.hash===e:n===e})},r.prototype.resolveKeyByValue=function(e){var t=this.state.localTabs;if(Array.isArray(t)){var n=(0,M.default)(t,function(t){return(t.value??t.title)===e});return n&&n.hash?n.hash:t.indexOf(n)}},r.prototype.autoJumpToNeighbour=function(e){var t=this.props;t.tabs;var n=t.data,r=this.state.localTabs;if(Array.isArray(r)){var i=(0,N.default)(r,function(t,n){return t.hash?t.hash===e:n===e});if(r[i]&&!b(r[i],this.props.data))for(var a=r.length,o=i,s=i;o-->=0||s++<a;){var c=null;if(o>=0&&b(r[o],n)?c=r[o].hash||o:s<a&&b(r[s],n)&&(c=r[s].hash||s),c!==null){this.setState({activeKey:this.activeKey=c});break}}}},r.prototype.handleAdd=function(){var e=this,t=this.state.localTabs.concat();t.push({title:`tab${this.newTabDefaultId++}`,body:`tab`}),this.setState({localTabs:t},function(){e.switchTo(e.state.localTabs.length-1)})},r.prototype.handleClose=function(e,t){return C(this,void 0,void 0,function(){var n,r,i,a;return h(this,function(o){switch(o.label){case 0:return n=this.state.localTabs.concat(),r=n?.findIndex(function(n,r){return e===(t?n.hash:n.hash??r)}),r===-1?[2]:(n.splice(r,1),i=this.props.dispatchEvent,[4,i(`delete`,p(this.props,{value:e}))]);case 1:return a=o.sent(),a?.prevented||this.setState({localTabs:n}),[2]}})})},r.prototype.handleEdit=function(e,t){var n=this.state.localTabs.concat();n[e].title=t,this.setState({localTabs:n})},r.prototype.handleDragChange=function(e){return C(this,void 0,void 0,function(){var t,n,r=this;return h(this,function(i){return t=this.resolveTabByKey(this.activeKey),n=this.state.localTabs.concat(),n.splice(e.newIndex,0,n.splice(e.oldIndex,1)[0]),this.setState({localTabs:n},function(){if(t){var e=n.indexOf(t);r.switchTo(e)}}),[2]})})},r.prototype.handleSelect=function(e){var t;return C(this,void 0,void 0,function(){var n,r,i,a,o,s,c,l,u;return h(this,function(d){switch(d.label){case 0:return n=this.props,r=n.dispatchEvent,n.data,i=n.env,a=n.onSelect,o=n.id,s=this.state.localTabs,c=s?.find(function(t,n){return e===(t.hash?t.hash:n)}),c?((t=i.tracker)==null||t.call(i,{eventType:`tabChange`,eventData:{id:o,key:e}}),[4,r(`change`,p(this.props,{value:c?.hash?c?.hash:e+1}))]):[2];case 1:return l=d.sent(),l?.prevented?[2]:(typeof e==`string`&&i?i.updateLocation(`#${e}`):typeof this.state.activeKey==`string`&&i&&i.updateLocation(`#`),this.setState({activeKey:this.activeKey=e,prevKey:this.state.activeKey}),typeof a==`string`?(u=T(a,`key`,`props`),u&&u(e,this.props)):typeof a==`function`&&a(e,this.props),[2])}})})},r.prototype.doAction=function(e,t,n,r){n===void 0&&(n=!1);var i=e?.actionType,a=Number(r?.activeKey),o=(0,P.default)(a)?r?.activeKey:a,s=r?.deleteHash;i===`changeActiveKey`?this.handleSelect(typeof o==`number`?o-1:o):i===`deleteTab`&&this.handleClose(s,!0)},r.prototype.switchTo=function(e,t){var n=this.state.localTabs;Array.isArray(n)&&n[e]&&this.setState({activeKey:this.activeKey=n[e].hash||e},t)},r.prototype.currentIndex=function(){var e=this,t=this.state.localTabs;return Array.isArray(t)?(0,N.default)(t,function(t,n){return t.hash?t.hash===e.state.activeKey:n===e.state.activeKey}):-1},r.prototype.dispatchEvent=function(e,t,n,r){return C(this,void 0,void 0,function(){var i;return h(this,function(a){return e===`formItemValidateError`&&(i=n?.props.tabIndex,typeof i==`number`&&this.lazySwitchTo(i)),[2,this.props.dispatchEvent(e,t,n,r)]})})},r.prototype.renderTabTitle=function(e,n,r){var i=this.props.render;return typeof e==`string`||!e?A(e,r):i(`tab-title/${n}`,e,{data:t({index:n,__index:n},r)})},r.prototype.renderToolbar=function(){var e=this.props,n=e.toolbar,r=e.render,i=e.classnames,a=e.toolbarClassName,o=e.id,s=e.themeCss;return n?j.createElement(`div`,{className:i(`Tabs-toolbar`,a,k(t(t({},this.props),{name:`toolbarControlClassName`,id:o,themeCss:s})))},r(`toolbar`,n)):null},r.prototype.renderTabs=function(){var e=this,n=this.props,r=n.classnames,i=n.classPrefix,a=n.contentClassName,o=n.linksClassName,c=n.tabRender,l=n.className,d=n.style,f=n.render,p=n.data,h=n.mode,g=n.tabsMode,v=n.unmountOnExit;n.source;var y=n.formStore,x=n.formMode,S=n.formHorizontal,C=n.subFormMode,w=n.subFormHorizontal,T=n.addable,O=n.closable,M=n.draggable,N=n.showTip,P=n.showTipClassName,F=n.editable,I=n.sidePosition,L=n.translate,R=n.addBtnText,z=n.collapseOnExceed,ee=n.collapseBtnLabel,B=n.disabled,V=n.mobileUI,H=n.swipeable,U=n.testIdBuilder,W=n.id,G=n.wrapperCustomStyle,K=n.themeCss,q=n.env,J=g||h,Y=this.props.mountOnEnter;y&&(Y=!1);var X=this.state,Z=X.localTabs,te=X.isFromSource,Q=[],$=[];return te?(Q=Z.map(function(n,i){var a=m(p,u(n.data)?t({index:i},n.data):{item:n.data,index:i});return b(n,a)?j.createElement(D,t({},n,{title:e.renderTabTitle(n.title,i,a),disabled:B||s(n,a),key:i,eventKey:A(n.hash,a)||i,prevKey:i>0?Z[i-1]?.hash||i-1:0,nextKey:i<Z.length-1?Z[i+1]?.hash||i+1:Z.length-1,swipeable:H,mobileUI:V,mountOnEnter:Y,unmountOnExit:typeof n.reload==`boolean`?n.reload:typeof n.unmountOnExit==`boolean`?n.unmountOnExit:v,onSelect:e.handleSelect,testIdBuilder:U?.getChild(`tab-${typeof n.title==`string`?n.title:i}`),className:r(n.className,k(t(t({},n),{name:`panelControlClassName`,id:n.id,themeCss:n.themeCss})))}),f(`item/${i}`,n?.type?n:n.tab||n.body,{tabIndex:i,dispatchEvent:e.dispatchEvent,disabled:B||s(n,a)||void 0,data:a,formMode:n.mode||C||x,formHorizontal:n.horizontal||w||S})):null}),$=Z.map(function(n,r){return b(n,m(p,u(n.data)?t({index:r},n.data):{item:n.data,index:r}))?j.createElement(E,t({},n,{config:{id:n.id,themeCss:n.themeCss,classNames:[{key:`panelControlClassName`}]},env:e.props.env,key:`customstyle_${r}`})):null})):(Q=Z.map(function(n,i){return b(n,p)?j.createElement(D,t({},n,{title:e.renderTabTitle(n.title,i,p),disabled:B||s(n,p),key:i,eventKey:n.hash||i,prevKey:i>0?Z[i-1]?.hash||i-1:0,nextKey:i<Z.length-1?Z[i+1]?.hash||i+1:Z.length-1,swipeable:H,mobileUI:V,mountOnEnter:Y,unmountOnExit:typeof n.reload==`boolean`?n.reload:typeof n.unmountOnExit==`boolean`?n.unmountOnExit:v,onSelect:e.handleSelect,testIdBuilder:U?.getChild(`tab-${typeof n.title==`string`?n.title:i}`),className:r(n.className,k(t(t({},n),{name:`panelControlClassName`,id:n.id,themeCss:n.themeCss})))}),e.renderTab?e.renderTab(n,e.props,i):c?c(n,e.props,i):f(`tab/${i}`,n?.type?n:n.tab||n.body,{tabIndex:i,dispatchEvent:e.dispatchEvent,disabled:B||s(n,p)||void 0,formMode:n.mode||C||x,formHorizontal:n.horizontal||w||S})):null}),$=Z.map(function(t,n){return b(t,p)?j.createElement(E,{config:{id:t.id,themeCss:t.themeCss,classNames:[{key:`panelControlClassName`}]},env:e.props.env,key:`customstyle_${n}`}):null})),j.createElement(j.default.Fragment,null,j.createElement(_,{addBtnText:L(R||`add`),classPrefix:i,classnames:r,mode:J,closable:O,className:r(l,k(t(t({},this.props),{name:`wrapperCustomStyle`,id:W,themeCss:G}))),style:d,contentClassName:r(a,k(t(t({},this.props),{name:`contentControlClassName`,id:W,themeCss:K}))),linksClassName:o,titleClassName:r(k(t(t({},this.props),{name:`titleControlClassName`,id:W,themeCss:K}))),onSelect:this.handleSelect,activeKey:this.state.activeKey,toolbar:this.renderToolbar(),addable:T,onAdd:this.handleAdd,onClose:this.handleClose,draggable:M,onDragChange:this.handleDragChange,showTip:N,showTipClassName:P,editable:F,onEdit:this.handleEdit,sidePosition:I,collapseOnExceed:z,collapseBtnLabel:ee,mobileUI:V,testIdBuilder:U},Q),$,j.createElement(E,t({},this.props,{config:{wrapperCustomStyle:G,id:W,themeCss:K,classNames:[{key:`titleControlClassName`,weights:{default:{important:!0,inner:`> a`},focused:{important:!0,suf:`.is-active`,inner:`> a`},hover:{important:!0,inner:`> a`},disabled:{important:!0,suf:`.is-disabled`,inner:`> a`}}},{key:`toolbarControlClassName`,weights:{default:{important:!0}}},{key:`contentControlClassName`,weights:{default:{important:!0}}}]},env:q})))},r.prototype.render=function(){return this.renderTabs()},r.defaultProps={className:``,mode:``,mountOnEnter:!0,unmountOnExit:!1},d([n,i(`design:type`,Function),i(`design:paramtypes`,[Array,String,Object]),i(`design:returntype`,Array)],r.prototype,`initTabArray`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[Object]),i(`design:returntype`,void 0)],r.prototype,`autoJumpToNeighbour`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,void 0)],r.prototype,`handleAdd`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[Object,Boolean]),i(`design:returntype`,Promise)],r.prototype,`handleClose`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[Number,String]),i(`design:returntype`,void 0)],r.prototype,`handleEdit`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[Object]),i(`design:returntype`,Promise)],r.prototype,`handleDragChange`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[Object]),i(`design:returntype`,Promise)],r.prototype,`handleSelect`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[Number,Function]),i(`design:returntype`,void 0)],r.prototype,`switchTo`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,Number)],r.prototype,`currentIndex`,null),d([n,i(`design:type`,Function),i(`design:paramtypes`,[Object,Object,j.Component,Object]),i(`design:returntype`,Promise)],r.prototype,`dispatchEvent`,null),r}(j.Component),L=function(e){f(t,e);function t(t,n){var r=e.call(this,t)||this;return n.registerComponent(r),r}return t.prototype.componentWillUnmount=function(){var t;(t=e.prototype.componentWillUnmount)==null||t.call(this),this.context.unRegisterComponent(this)},t.contextType=w,t=d([O({type:`tabs`}),i(`design:paramtypes`,[Object,Object])],t),t}(I);export{L as TabsRenderer,I as default};