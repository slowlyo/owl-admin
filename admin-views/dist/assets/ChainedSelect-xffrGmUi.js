import{$o as e,Ao as t,Fo as n,Hn as r,Ia as i,Io as a,J as o,Ko as s,Lo as c,Mo as l,No as u,Nr as d,Po as f,Ro as p,dr as m,gn as h,hi as g,jo as _,ni as v,ui as y,vr as b,xa as x,xr as S}from"./index-Z33w_AY6.js";var C=e(s()),w=e(y()),T=e(g()),E=e(x()),D=function(e){u(s,e);function s(t){var n=e.call(this,t)||this;return n.state={stack:[]},n.handleChange=n.handleChange.bind(n),n.loadMore=n.loadMore.bind(n),n}return s.prototype.componentDidMount=function(){var e,t;this.props.formInited||!this.props.addHook?this.loadMore():(t=(e=this.props).addHook)==null||t.call(e,this.loadMore,`init`)},s.prototype.componentDidUpdate=function(e){var t=this.props;e.options===t.options?t.formInited&&t.value!==e.value&&this.loadMore():this.setState({stack:[]})},s.prototype.doAction=function(e,t,n){var r=this.props,a=r.resetValue,o=r.onChange,s=r.formStore,c=r.store,l=r.name,u=e?.actionType;u===`clear`?o(``):u===`reset`&&o(i(s?.pristine??c?.pristine,l)??a??``)},s.prototype.array2value=function(e,t){t===void 0&&(t=!1);var n=this.props,r=n.delimiter,i=n.joinValues,a=n.extractValue,o=n.valueField;return t?i?e.join(r||`,`):e:i?e.join(r||`,`):a?e.map(function(e){return e[o||`value`]||e}):e},s.prototype.loadMore=function(){for(var e=this,n=this.props,r=n.value,i=n.delimiter,a=n.onChange,o=n.joinValues,s=n.extractValue,c=n.valueField,l=n.source,u=n.data,p=n.env,m=n.dispatchEvent,h=Array.isArray(r)?r.concat():r&&typeof r==`string`?r.split(i||`,`):[],g=0,y=this.state.stack.length;g<y&&h[g]&&this.state.stack[g].parentId==(o||s?h[g]:h[g][c||`value`]);)g++;if(!(!h[g]||!p||!v(l,u))){var b=o||s?h[g]:h[g][c||`value`],x=this.state.stack.concat();x.splice(g,x.length-g),x.push({parentId:b,loading:!0,options:[]}),this.setState({stack:x},function(){p.fetcher(l,t(t({},u),{value:h,level:g+1,parentId:b,parent:h[g]})).then(function(t){return _(e,void 0,void 0,function(){var e,n,i,o,s;return f(this,function(l){switch(l.label){case 0:return e=this.state.stack.concat(),n=t.data?t.data[c||`value`]:void 0,i=t?.data?.options||t?.data?.items||t?.data?.rows||t.data||[],e.splice(g,e.length-g),n===void 0?[3,2]:(h.splice(g+1,r.length-g-1),h.push(n),o=this.array2value(h,!0),[4,m(`change`,d(this.props,{value:o}))]);case 1:if(s=l.sent(),s?.prevented)return[2];a(o),l.label=2;case 2:return e.push({options:i,parentId:b,loading:!1,visible:Array.isArray(i)&&!(0,E.default)(i)}),this.setState({stack:e},this.loadMore),[2]}})})}).catch(function(e){!l?.silent&&p.notify(`error`,e.message)})})}},s.prototype.handleChange=function(e,t){return _(this,void 0,void 0,function(){var n,r,i,a,o,s,c,l,u,p,m;return f(this,function(f){switch(f.label){case 0:return n=this.props,r=n.value,i=n.delimiter,a=n.onChange,o=n.joinValues,n.extractValue,s=n.dispatchEvent,c=n.valueField,n.data,l=Array.isArray(r)?r.concat():r&&typeof r==`string`?r.split(i||`,`):[],l.splice(e,l.length-e),u=o?t[c||`value`]:t,u!==void 0&&l.push(u),p=this.array2value(l),[4,s(`change`,d(this.props,{value:p}))];case 1:return m=f.sent(),m?.prevented||a(p),[2]}})})},s.prototype.reload=function(e,t){var n=this.props.reloadOptions;n&&n(e,t)},s.prototype.renderStatic=function(e){e===void 0&&(e=`-`);var t=this.props,n=t.options,r=n===void 0?[]:n,i=t.labelField,o=t.valueField,s=t.classPrefix,c=t.classnames,l=t.className,u=t.value,d=t.delimiter,f=p([{options:r,visible:!0}],a(this.state.stack||[]),!1),m=Array.isArray(u)?u.concat():u&&typeof u==`string`?u.split(d||`,`):[];return m?.length>0&&(e=m.map(function(e,t){var n=f[t]||{},r=n.options;return n.visible===!1?null:!r||!r.length?e:((0,T.default)(r,function(t){return e===t[o||`value`]})||{})[i||`label`]??e}).filter(function(e){return e!=null}).join(` > `)),C.createElement(`div`,{className:c(`${s}SelectStaticControl`,l)},e)},s.prototype.render=function(){var e=this,n=this.props,i=n.options,a=n.classPrefix,o=n.className,s=n.style;n.inline;var l=n.loading,u=n.value,d=n.delimiter;n.joinValues,n.extractValue,n.multiple;var f=n.mobileUI,p=n.env,m=n.testIdBuilder,g=n.popoverClassName,_=n.placeholder,v=c(n,[`options`,`classPrefix`,`className`,`style`,`inline`,`loading`,`value`,`delimiter`,`joinValues`,`extractValue`,`multiple`,`mobileUI`,`env`,`testIdBuilder`,`popoverClassName`,`placeholder`]),y=Array.isArray(u)?u.concat():u&&typeof u==`string`?u.split(d||`,`):[],x=this.props,T=x.themeCss,E=x.id,D=this.state.stack.find(function(e){return e.loading});return C.createElement(`div`,{className:(0,w.default)(`${a}ChainedSelectControl`,o)},C.createElement(h,t({},v,{placeholder:_,mobileUI:f,popOverContainer:f?p?.getModalContainer:v.popOverContainer||p?.getModalContainer,className:(0,w.default)(S(t(t({},this.props),{name:`chainedSelectControlClassName`,id:E,themeCss:T}))),popoverClassName:(0,w.default)(g,S(t(t({},this.props),{name:`chainedSelectPopoverClassName`,id:E,themeCss:T}))),controlStyle:s,classPrefix:a,key:`base`,testIdBuilder:m?.getChild(`base`),options:Array.isArray(i)?i:[],value:y[0],onChange:this.handleChange.bind(this,0),loading:l,inline:!0})),this.state.stack.map(function(n,r){var i=n.options,o=n.loading;return n.visible===!1||o?null:C.createElement(h,t({},v,{mobileUI:f,popOverContainer:f?p.getModalContainer:v.popOverContainer||p?.getModalContainer,classPrefix:a,key:`x-${r+1}`,testIdBuilder:m?.getChild(`x-${r+1}`),options:Array.isArray(i)?i:[],value:y[r+1],onChange:e.handleChange.bind(e,r+1),inline:!0,controlStyle:s,className:(0,w.default)(S(t(t({},e.props),{name:`chainedSelectControlClassName`,id:E,themeCss:T}))),popoverClassName:(0,w.default)(g,S(t(t({},e.props),{name:`chainedSelectPopoverClassName`,id:E,themeCss:T})))}))}),D&&C.createElement(r,{size:`sm`,className:(0,w.default)(`${a}ChainedSelectControl-spinner`)}),C.createElement(b,t({},this.props,{config:{themeCss:T,classNames:[{key:`chainedSelectControlClassName`,weights:{focused:{suf:`.is-opened:not(.is-mobile)`},disabled:{suf:`.is-disabled`}}},{key:`chainedSelectPopoverClassName`,weights:{default:{suf:` .${a}Select-option`},hover:{suf:` .${a}Select-option.is-highlight`},focused:{inner:`.${a}Select-option.is-active`}}}],id:E},env:p})))},s.defaultProps={clearable:!1,searchable:!1,multiple:!0},l([o(),n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,void 0)],s.prototype,`render`,null),s}(C.Component),O=function(e){u(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t=l([m({type:`chained-select`,sizeMutable:!1})],t),t}(D);export{O as ChainedSelectControlRenderer,D as default};