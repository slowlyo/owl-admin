import{t as J,z as m,G as A,H as O,l as C,e6 as ke,M as U,ax as be,e7 as Fe,bs as pe,a4 as N,e8 as he,D as S,E as ge,e9 as Ae,ea as Oe,eb as Ne,be as se,aq as fe,x as le,aL as L,a$ as z,aK as W,ec as Te,al as $,w as ve,aX as Be,au as me,aw as Q,v as G,L as V,ad as X,Y as de,aD as ye,aS as De,b3 as Y,ed as Ie,ee as _e,ae as Ke,U as je,Q as R,T as p,ef as qe,d4 as Me,cs as Le,cv as Pe}from"./index-BnZOs00e.js";import"./ColumnToggler-C3uFhljD.js";var He=function(F){J(l,F);function l(e){var t=F.call(this,e)||this;return t.formItems=[],t.handleSubmit=t.handleSubmit.bind(t),t.handleAction=t.handleAction.bind(t),t}return l.prototype.buildSchema=function(){var e,t,n,r,a,i,s=this.props,o=s.searchable,c=s.sortable,d=s.name,v=s.label,b=s.translate,f=s.testIdBuilder,u;if(o===!0?u={title:"",controls:[{type:"text",name:d,placeholder:v,clearable:!0,testid:(e=f==null?void 0:f.getChild(d))===null||e===void 0?void 0:e.getTestIdValue()}]}:o&&(o.controls||o.tabs||o.fieldSet?u=m(m({title:""},o),{controls:Array.isArray(o.controls)?o.controls.concat():void 0}):(o==null?void 0:o.type)==="form"?u=o:u={title:"",className:o.formClassName,controls:[m({type:o.type||"text",name:o.name||d,testid:(t=f==null?void 0:f.getChild(o.name||d))===null||t===void 0?void 0:t.getTestIdValue(),placeholder:v},o)]}),u&&u.controls&&c&&u.controls.unshift({type:"hidden",name:"orderBy",value:d},{type:"button-group",name:"order",label:b("sort"),options:[{label:b("asc"),value:"asc"},{label:b("desc"),value:"desc"}]}),u){var y=[];(u.controls||u.body||[]).forEach(function(g){return g.name&&g.name!=="orderBy"&&g.name!=="order"&&y.push(g.name)}),this.formItems=y,u=m(m({},u),{type:"form",wrapperComponent:"div",wrapWithPanel:!0,title:!1,testid:(n=f==null?void 0:f.getChild("form"))===null||n===void 0?void 0:n.getTestIdValue(),actions:[{type:"button",label:b("reset"),actionType:"clear-and-submit",testid:(r=f==null?void 0:f.getChild("btn-reset"))===null||r===void 0?void 0:r.getTestIdValue()},{type:"button",label:b("cancel"),actionType:"cancel",testid:(a=f==null?void 0:f.getChild("btn-cancel"))===null||a===void 0?void 0:a.getTestIdValue()},{label:b("search"),type:"submit",primary:!0,testid:(i=f==null?void 0:f.getChild("btn-search"))===null||i===void 0?void 0:i.getTestIdValue()}]})}return u||"error"},l.prototype.handleAction=function(e,t,n,r){return A(this,void 0,void 0,function(){var a,i,s,o,c,d,v;return O(this,function(b){switch(b.label){case 0:return a=this.props,i=a.onAction,s=a.data,o=a.dispatchEvent,c=a.name,t.actionType==="cancel"||t.actionType==="close"?(r(),[2]):t.actionType==="reset"?(r(),this.handleReset(),[2]):(d=m({},s),this.formItems.forEach(function(f){return pe(d,f,void 0)}),[4,o("columnSearch",N(s,{searchName:c,searchValue:d}))]);case 1:return v=b.sent(),v!=null&&v.prevented?[2]:(i&&i(e,t,n),[2])}})})},l.prototype.handleReset=function(){return A(this,void 0,void 0,function(){var e,t,n,r,a,i;return O(this,function(s){switch(s.label){case 0:return e=this.props,t=e.onSearch,n=e.data,r=e.name,a=m({},n),this.formItems.forEach(function(o){return pe(a,o,void 0)}),a.orderBy===r&&(a.orderBy="",a.order="asc"),i=t,i?[4,t(r,a)]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return t&&t(a),[2]}})})},l.prototype.handleSubmit=function(e,t){return A(this,void 0,void 0,function(){var n,r,a,i;return O(this,function(s){switch(s.label){case 0:return n=this.props,r=n.onSearch,a=n.name,e.order&&(e=m(m({},e),{orderBy:a})),i=r,i?[4,r(a,e)]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return t(),[2]}})})},l.prototype.isActive=function(){var e=this.props,t=e.data,n=e.name,r=e.orderBy;return r&&r===n||this.formItems.some(function(a){return t==null?void 0:t[a]})},l.prototype.render=function(){var e=this,t=this.props,n=t.render,r=t.name,a=t.data,i=t.searchable,s=t.order,o=t.orderBy,c=t.popOverContainer,d=t.classPrefix,v=t.classnames,b=t.testIdBuilder,f=this.buildSchema(),u=this.isActive();return C.createElement(ke,{className:"".concat(d,"TableCell-searchBtn"),layerClassName:v("".concat(d,"TableCell-searchPopOver"),i.className),active:u,filterIcon:C.createElement(U,{icon:"search",className:"icon",iconContent:"table-search-icon",testIdBuilder:b==null?void 0:b.getChild("search-icon")}),popOverContainer:c||function(){return be.findDOMNode(e)},filterDropdown:function(y){y.setSelectedKeys,y.selectedKeys;var g=y.confirm;return y.clearFilters,n("quick-search-form",f,{data:m(m({},a),{orderBy:o,order:o&&o===r?s:""}),onSubmit:function(h){return e.handleSubmit(h,g)},onAction:function(h,E,w){e.handleAction(h,E,w,g)}})},testIdBuilder:b})},l}(C.Component),Qe=Fe(function(F){var l=F.store;return C.createElement(He,m({},F,{data:l.query,orderBy:l.orderBy,order:l.order}))});(function(F){J(l,F);function l(){var e=F!==null&&F.apply(this,arguments)||this;return e.propsNeedRemove=["title"],e}return l.defaultProps=m(m({},he.defaultProps),{wrapperComponent:"div"}),l=S([ge({type:"cell-field",name:"cell-field"}),Ae(),Oe(),Ne()],l),l})(he);var Ve=function(F){J(l,F);function l(e,t){var n=F.call(this,e)||this;n.renderedToolbars=[],n.subForms={},n.columns=[],n.reactions=[];var r=t;r.registerComponent(n);var a=e.store,i=e.columnsTogglable,s=e.columns,o=e.rowSelection,c=e.keyField,d=e.primaryField,v=e.canAccessSuperData,b=e.persistKey;return a.update({columnsTogglable:i,columns:s,canAccessSuperData:v,rowSelectionKeyField:d||(o==null?void 0:o.keyField)||c,persistKey:b}),l.syncRows(a,e,void 0)&&n.syncSelected(),n.columns=n.buildColumns(a.filteredColumns,[],[]),n.rowSelection=n.buildRowSelection(),n.expandable=n.buildExpandable(),n.reactions.push(se(function(){return a.currentSelectedRowKeys.join(",")},function(){n.rowSelection=n.buildRowSelection(),n.forceUpdate()})),n.reactions.push(se(function(){return a.currentExpandedKeys.join(",")},function(){n.expandable=n.buildExpandable(),n.forceUpdate()})),n.reactions.push(se(function(){return a.filteredColumns},function(){n.columns=n.buildColumns(a.filteredColumns,[],[]),n.forceUpdate()})),n}return l.prototype.componentWillUnmount=function(){var e=this.context;e.unRegisterComponent(this),this.reactions&&this.reactions.forEach(function(t){return t()})},l.prototype.syncSelected=function(){var e=this.props,t=e.store,n=e.onSelect;n&&n(t.selectedRows.map(function(r){return r.data}),t.unSelectedRows.map(function(r){return r.data}))},l.syncRows=function(e,t,n){var r,a=t.source,i=fe(t,function(y){return y.items}),s=[],o=!1;if(Array.isArray(i))(!n||fe(n,function(y){return y.items})!==i)&&(o=!0,s=i);else if(typeof a=="string"){var c=le(a,t.data,"| raw"),d=n?le(a,n.data,"| raw"):null;d&&d===c?o=!1:Array.isArray(c)&&(o=!0,s=c)}o&&e.initRows(s,t.getEntryId,t.reUseRow,t.childrenColumnName);var v=[],b=e.keyField;Array.isArray(t.selected)?v=t.selected.map(function(y){return y[b]})||[]:t.rowSelection&&t.rowSelection.selectedRowKeysExpr?s.forEach(function(y,g){var h,E=L(((h=t.rowSelection)===null||h===void 0?void 0:h.selectedRowKeysExpr)||"",{record:y,rowIndex:g});E&&v.push(y[b])}):t.rowSelection&&t.rowSelection.selectedRowKeys&&(v=z([],W(t.rowSelection.selectedRowKeys),!1)),o&&v.length>0&&e.updateSelected(v);var f=[],u=t.primaryField||((r=t.expandable)===null||r===void 0?void 0:r.keyField)||t.keyField;return t.expandable&&t.expandable.expandedRowKeysExpr?s.forEach(function(y,g){var h,E=L(((h=t.expandable)===null||h===void 0?void 0:h.expandedRowKeysExpr)||"",{record:y,rowIndex:g});E&&f.push(y[u])}):t.expandable&&t.expandable.expandedRowKeys&&(f=z([],W(t.expandable.expandedRowKeys),!1)),o&&f.length>0&&e.updateExpanded(f,u),o},l.prototype.componentDidUpdate=function(e){var t,n,r,a=this.props,i=a.store;if(Te(["orderBy","columnsTogglable","canAccessSuperData","persistKey"],e,a,function(d){d.orderBy&&!a.onQuery&&delete d.orderBy,i.update(d,{resolveDefinitions:a.resolveDefinitions})}),$(["source","value","items"],e,a)||!a.value&&!a.items&&(a.data!==e.data||typeof a.source=="string"&&ve(a.source)))l.syncRows(i,a,e)&&this.syncSelected();else if(Be(e.selected,a.selected)){var s=i.keyField,o=i.selectedRows.map(function(d){return d[s]}).join(",");i.updateSelected(a.selected.map(function(d){return d[s]})||[]);var c=i.selectedRows.map(function(d){return d[s]}).join(",");o!==c&&this.syncSelected()}$(["columns"],e,a)&&i.update({columns:a.columns}),$(["rowSelection","selectable","multiple","maxKeepItemSelectionLength"],e,a)&&(this.rowSelection=this.buildRowSelection()),$(["query","pageField","perPageField"],e,a)&&i.updateQuery(a.query,void 0,a.pageField,a.perPageField,!0),(!me((t=e==null?void 0:e.rowSelection)===null||t===void 0?void 0:t.keyField,(n=a.rowSelection)===null||n===void 0?void 0:n.keyField)||!me(e.keyField,a.keyField))&&i.update({rowSelectionKeyField:a.primaryField||((r=a.rowSelection)===null||r===void 0?void 0:r.keyField)||a.keyField})},l.prototype.getPopOverContainer=function(){return be.findDOMNode(this)},l.prototype.subFormRef=function(e,t,n){var r=this.props.quickEditFormRef;r&&r(e,t,n),this.subForms["".concat(t,"-").concat(n)]=e,e&&this.props.store.addForm(e.props.store,n)},l.prototype.reset=function(){var e=this,t=this.props.store;t.reset();var n=[];Object.keys(this.subForms).forEach(function(r){return e.subForms[r]&&n.push(e.subForms[r])}),n.forEach(function(r){return r.clearErrors()})},l.prototype.renderCellSchema=function(e,t){var n=this.props,r=n.render;if(n.store,e&&Q(e)){e.width,e.children;var a=e.wrapperComponent,i=e.title,s=G(e,["width","children","wrapperComponent","title"]);return r("cell-field",m(m({},s),{wrapperComponent:a||void 0,title:i||s.label,type:"cell-field",column:s,data:t.data,name:e.name}),t)}return e},l.prototype.renderSchema=function(e,t,n){var r=this.props.render;if(t&&Q(t))return r(e||"field",m(m({},t),{data:n==null?void 0:n.data}),n);if(Array.isArray(t)){var a=[];return t.forEach(function(i,s){return a.push(r(e||"field",m(m({},i),{data:n==null?void 0:n.data}),m(m({},n),{key:s})))}),a}return typeof t=="string"?V(t,n==null?void 0:n.data):t},l.prototype.buildColumns=function(e,t,n){var r=this,a=this.props,i=a.render,s=a.store,o=a.popOverContainer,c=a.canAccessSuperData,d=a.showBadge,v=a.itemBadge,b=a.data,f=a.classnames,u=a.env,y=a.testIdBuilder,g=[];return t=t,n=n,Array.isArray(e)&&e.forEach(function(h,E){return A(r,void 0,void 0,function(){var w,k,x,T,_,j,P,ce,Z,ee,ue,M=this,te,ne;return O(this,function(re){switch(re.label){case 0:return w=m({},h),k=null,x=w.title||w.label,T=m(m({},b),{popOverContainer:o||this.getPopOverContainer}),Q(h.title)?k=Le(h.title):typeof x=="string"&&(k={type:"plain",tpl:x}),(h.headerAlign||h.align)&&(k.align=h.headerAlign||h.align,k.className="flex-1"),_=function(K){var q,B=M.renderCellSchema(k,T),D=null;return h.remark&&(D=i("remark",{type:"remark",tooltip:h.remark,container:M.getPopOverContainer})),C.createElement("div",{key:E,className:f("Table-head-cell-wrapper",(q={},q["".concat(h.className)]=!!h.className,q["".concat(h.titleClassName)]=!!h.titleClassName,q)),style:{justifyContent:{right:"flex-end",center:"center"}[h.align]||"flex-start"}},B,D,K)},Object.assign(w,{title:_}),j=!!(!((te=h.children)===null||te===void 0)&&te.length),ne=h.canAccessSuperData,h.type&&Object.assign(w,{render:function(K,q,B,D,we){var Se={},ae=s.getRowByIndex(B,z([],W(we||[]),!1))||{},Ce=y==null?void 0:y.getChild("row-".concat(B,"-cell-").concat(D)),H={children:M.renderCellSchema(h,{data:ae.locals,btnDisabled:s.dragging,popOverContainer:o||M.getPopOverContainer,quickEditFormRef:M.subFormRef,onQuickChange:function(I,xe,Re,Ee){M.handleQuickChange(ae,I,xe,Re,Ee)},row:ae,showBadge:d&&E===0,itemBadge:v,testIdBuilder:Ce}),props:Se};if(!j&&h.rowSpanExpr){var ie=+V(h.rowSpanExpr,{record:q,rowIndex:B,colIndex:D});ie&&(H.props.rowSpan=ie,t.push({colIndex:D,rowIndex:B,rowSpan:ie}))}if(!j&&h.colSpanExpr){var oe=+V(h.colSpanExpr,{record:q,rowIndex:B,colIndex:D});oe&&(H.props.colSpan=oe,n.push({colIndex:D,rowIndex:B,colSpan:oe}))}return t.forEach(function(I){D===I.colIndex&&B>I.rowIndex&&B<I.rowIndex+(I.rowSpan||0)&&(H.props.rowSpan=0)}),n.forEach(function(I){B===I.rowIndex&&D>I.colIndex&&D<I.colIndex+(I.colSpan||0)&&(H.props.colSpan=0)}),H}}),h.searchable&&(w.filterDropdown=C.createElement(Qe,m({},this.props,{popOverContainer:this.getPopOverContainer,name:h.name,searchable:h.searchable,onSearch:this.handleSearch,key:"th-search-"+E,testIdBuilder:y==null?void 0:y.getChild("head-search-".concat(E))}))),h.sortable&&(w.sorter=!0),h.filterable?h.filterable.options?(w.filters=h.filterable.options.map(function(K){return typeof K=="string"?{text:K,value:K}:{text:K.label,value:K.value}}),[3,4]):[3,1]:[3,4];case 1:return h.filterable.source?(P=h.filterable.source,ve(P)?(ce=le(P,b,"| raw"),w.filters=ce,[3,4]):[3,2]):[3,4];case 2:return de(P,b)?(Z=Me(P),Z.cache=3e3,[4,u.fetcher(Z,b)]):[3,4];case 3:ee=re.sent(),ue=ee.data&&ee.data.options||[],w.filters=ue,re.label=4;case 4:return j&&(w.children=this.buildColumns(h.children,t,n)),g.push(w),[2]}})})}),g},l.prototype.buildSummary=function(e,t){var n=this,r=[];return Array.isArray(t)&&t.forEach(function(a,i){Q(a)?r.push({colSpan:a.colSpan,fixed:a.fixed,cellClassName:a.cellClassName,render:function(s){return n.renderSchema(e,a,{data:s})}}):Array.isArray(a)&&(r[i]||r.push([]),a.forEach(function(s){r[i].push({colSpan:s.colSpan,fixed:s.fixed,cellClassName:s.cellClassName,render:function(o){return n.renderSchema(e,s,{data:o})}})}))}),r.length?r:null},l.prototype.rowClassName=function(e,t){var n=this.props,r=n.rowClassNameExpr,a=n.store,i=n.themeCss,s=n.id,o=n.rowClassName,c=[];o&&c.push(o),r&&c.push(V(r,m(m({},e),{rowIndex:t})));var d=a.getRowByIndex(t);return d!=null&&d.modified&&c.push("is-modified"),d!=null&&d.moved&&c.push("is-moved"),c.push(X(m(m({},this.props),{name:"tableRowClassname",id:s,themeCss:i}))),c.join(" ")},l.prototype.buildRowSelection=function(){var e=this,t=this.props,n=t.selectable,r=t.multiple,a=t.maxKeepItemSelectionLength,i=t.rowSelection,s=t.store,o=null;if(n)o={type:r===!1?"radio":"",selectedRowKeys:s.currentSelectedRowKeys,maxSelectedLength:a};else if(i){i.selectedRowKeys;var c=i.selections,d=G(i,["selectedRowKeys","selections"]);o=m({selectedRowKeys:s.currentSelectedRowKeys,maxSelectedLength:a},d),o.getCheckboxProps=function(v,b){var f=e.props,u=f.rowSelection,y=f.maxKeepItemSelectionLength,g=f.store,h=u==null?void 0:u.disableOn;return{disabled:(h?L(h,{record:v,rowIndex:b}):!1)||y&&g.currentSelectedRowKeys.length>=y&&!g.currentSelectedRowKeys.includes(v[g.keyField])}},i.disableOn&&delete o.disableOn,c&&Array.isArray(c)&&(o.selections=[],c.forEach(function(v){o.selections.push({key:v.key,text:v.text,onSelect:function(b){var f=[];f=b.filter(function(u,y){return v.key==="all"?!0:v.key==="none"?!1:v.key==="invert"?!s.currentSelectedRowKeys.includes(u):v.key==="odd"?y%2===0:v.key==="even"?y%2!==0:!0}),s.updateSelected(f)}})}))}return o},l.prototype.expandedRowClassName=function(e,t){var n=this.props.expandable;return V(n==null?void 0:n.expandedRowClassNameExpr,{record:e,rowIndex:t})},l.prototype.expandedRowRender=function(e,t){var n=this.props.expandable;return this.renderSchema("expandableBody",m({},n),{data:m(m(m({},this.props.data),e),{rowIndex:t})})},l.prototype.rowExpandable=function(e,t,n){var r=this.props.expandable;return r!=null&&r.expandableOn?L(r.expandableOn,{record:e,rowIndex:t}):!1},l.prototype.buildExpandable=function(){var e=this.props,t=e.expandable,n=e.store,r=null;if(t){t.expandedRowKeys;var a=G(t,["expandedRowKeys"]);r=m({expandedRowKeys:n.currentExpandedKeys},a),t.expandableOn&&(r.rowExpandable=this.rowExpandable,delete r.expandableOn),t&&t.type&&(r.expandedRowRender=this.expandedRowRender),t.expandedRowClassNameExpr&&(r.expandedRowClassName=this.expandedRowClassName,delete r.expandedRowClassNameExpr)}return r},l.prototype.reloadTarget=function(e,t){var n=this.context;n.reload(e,t)},l.prototype.handleSave=function(){return A(this,void 0,void 0,function(){var e,t,n,r,a,i,s,o,c,d,v,b=this;return O(this,function(f){switch(f.label){case 0:return e=this.props,t=e.store,n=e.onSave,r=e.primaryField,a=e.keyField,t.modifiedRows.length?(i=[],Object.keys(this.subForms).forEach(function(u){return b.subForms[u]&&i.push(b.subForms[u])}),i.length?[4,Promise.all(i.map(function(u){return u.validate()}))]:[3,2]):[2];case 1:if(s=f.sent(),~s.indexOf(!1))return[2];f.label=2;case 2:return o=t.modifiedRows.map(function(u){return u.data}),c=t.modifiedRows.map(function(u){return u.path}),d=t.modifiedRows.map(function(u){return Y(u.data,u.pristine,[a,r])}),v=t.rows.filter(function(u){return!u.modified}).map(function(u){return u.data}),n?(n(o,d,c,v,t.modifiedRows.map(function(u){return u.pristine})),[2]):(this.handleQuickSave(o,d,c,v,t.modifiedRows.map(function(u){return u.pristine})),[2])}})})},l.prototype.handleQuickSave=function(e,t,n,r,a,i){var s=this,o=this.props,c=o.store,d=o.quickSaveApi,v=o.quickSaveItemApi,b=o.primaryField,f=o.keyField,u=o.env,y=o.messages,g=o.reload,h=o.dispatchEvent;if(Array.isArray(e)){if(!de(d)){u&&u.alert("Table2 quickSaveApi is required");return}var E=b||f,w=N(c.data,{rows:e,rowsDiff:t,indexes:n,rowsOrigin:a});e.length&&e[0].hasOwnProperty(E)&&(w.ids=e.map(function(T){return T[E]}).join(",")),r&&(w.unModifiedItems=r),c.saveRemote(d,w,{successMessage:y&&y.saveFailed,errorMessage:y&&y.saveSuccess}).then(function(){h("quickSaveSubmitted",w),g&&s.reloadTarget(ye(g,w),w)}).catch(function(){})}else{if(!de(v)){u&&u.alert("Table2 quickSaveItemApi is required!");return}var k=N(c.data,{item:e,modified:t,origin:a}),x=N(k,e);c.saveRemote(v,x).then(function(){h("quickSaveSubmitted",x),g&&s.reloadTarget(ye(g,k),k)}).catch(function(){i!=null&&i.resetOnFailed&&s.reset()})}},l.prototype.handleQuickChange=function(e,t,n,r,a){if(De(e)){var i=this.props,s=i.onSave,o=i.onPristineChange,c=i.saveImmediately,d=i.primaryField,v=i.keyField,b=i.quickSaveItemApi;if(e.change(t,r),e.modified&&this.syncSelected(),r){o==null||o(e.data,e.path);return}if(!(!n&&!c)){if(n&&n.api){this.props.onAction&&this.props.onAction(null,{actionType:"ajax",api:n.api,reload:a==null?void 0:a.reload},e.locals);return}if(!s){this.handleQuickSave(b?e.data:[e.data],Y(e.data,e.pristine,[v,d]),[e.path],void 0,e.pristine,a);return}s(e.data,Y(e.data,e.pristine,[v,d]),e.path,void 0,e.pristine,a)}}},l.prototype.handleAction=function(e,t,n){var r=this.props.onAction;return r==null?void 0:r(e,t,n)},l.prototype.renderActions=function(e){var t=this,n=this.props,r=n.actions,a=n.render,i=n.store,s=n.classnames,o=n.data,c=n.columnsTogglable,d=n.dispatchEvent;r=Array.isArray(r)?r.concat():[];var v=Q(c)?c:{align:"left"};return i.toggable&&e==="header"&&!~this.renderedToolbars.indexOf("columns-toggler")&&r.push({type:"button",children:a("column-toggler",m(m({},v),{type:"column-toggler"}),{cols:i.columnsData,toggleAllColumns:function(){i.toggleAllColumns(),d("columnToggled",N(o,{columns:i.columnsData.filter(function(b){return b.toggled})}))},toggleToggle:function(b){var f=i.columnsData[b];f.toggleToggle(),d("columnToggled",N(o,{columns:i.columnsData.filter(function(u){return u.toggled})}))}})}),Array.isArray(r)&&r.length?C.createElement("div",{className:s("Table-toolbar")},r.map(function(b,f){return a("action/".concat(f),m({type:"button"},b),{onAction:t.handleAction,key:f,btnDisabled:i.dragging,data:i.getData(o)})})):null},l.prototype.handleSelected=function(e,t,n){return A(this,void 0,void 0,function(){var r,a,i,s;return O(this,function(o){switch(o.label){case 0:return r=this.props,a=r.dispatchEvent,i=r.data,s=r.store,s.updateSelected(t),this.syncSelected(),[4,a("selectedChange",N(i,{selectedItems:e,unSelectedItems:n}))];case 1:return o.sent(),[2]}})})},l.prototype.handleSort=function(e){return A(this,void 0,void 0,function(){var t,n,r,a,i;return O(this,function(s){switch(s.label){case 0:return t=this.props,n=t.dispatchEvent,r=t.data,a=t.onSort,[4,n("columnSort",N(r,{orderBy:e.orderBy,orderDir:e.orderDir}))];case 1:return i=s.sent(),i!=null&&i.prevented?[2,i==null?void 0:i.prevented]:(a&&a(e),[2])}})})},l.prototype.handleFilter=function(e){return A(this,void 0,void 0,function(){var t,n,r,a,i;return O(this,function(s){switch(s.label){case 0:return t=this.props,n=t.dispatchEvent,r=t.data,a=t.onSearch,[4,n("columnFilter",N(r,e))];case 1:return i=s.sent(),i!=null&&i.prevented?[2,i==null?void 0:i.prevented]:(a&&a(e),[2])}})})},l.prototype.handleSearch=function(e,t){return A(this,void 0,void 0,function(){var n,r,a,i,s,o,c;return O(this,function(d){switch(d.label){case 0:return n=this.props,r=n.data,a=n.dispatchEvent,i=n.store,s=n.onSearch,[4,a("columnSearch",N(r,{searchName:e,searchValue:t}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2]:(i.updateQuery(t),s&&s((c={},c[e]=t[e],c)),[2])}})})},l.prototype.handleRowClick=function(e,t,n){return A(this,void 0,void 0,function(){var r,a,i,s,o;return O(this,function(c){switch(c.label){case 0:return r=this.props,a=r.dispatchEvent,i=r.data,s=r.onRow,[4,a("rowClick",N(i,{item:t,index:n}))];case 1:return o=c.sent(),o!=null&&o.prevented?[2]:(t&&s&&s.onRowClick&&s.onRowClick(e,t,n),[2])}})})},l.prototype.handleRowDbClick=function(e,t,n){return A(this,void 0,void 0,function(){var r,a,i,s,o;return O(this,function(c){switch(c.label){case 0:return r=this.props,a=r.dispatchEvent,i=r.data,s=r.onRow,[4,a("rowDbClick",N(i,{item:t,index:n}))];case 1:return o=c.sent(),o!=null&&o.prevented?[2,!1]:(t&&s&&s.onRowDbClick&&s.onRowDbClick(e,t,n),[2,!0])}})})},l.prototype.handleRowMouseEnter=function(e,t,n){var r;return A(this,void 0,void 0,function(){var a,i,s,o,c;return O(this,function(d){switch(d.label){case 0:return(r=e==null?void 0:e.persist)===null||r===void 0||r.call(e),a=this.props,i=a.dispatchEvent,s=a.data,o=a.onRow,[4,i("rowMouseEnter",N(s,{item:t,index:n}))];case 1:return c=d.sent(),c!=null&&c.prevented?[2]:(t&&o&&o.onRowMouseEnter&&o.onRowMouseEnter(e,t,n),[2])}})})},l.prototype.handleRowMouseLeave=function(e,t,n){var r;return A(this,void 0,void 0,function(){var a,i,s,o,c;return O(this,function(d){switch(d.label){case 0:return(r=e==null?void 0:e.persist)===null||r===void 0||r.call(e),a=this.props,i=a.dispatchEvent,s=a.data,o=a.onRow,[4,i("rowMouseLeave",N(s,{item:t,index:n}))];case 1:return c=d.sent(),c!=null&&c.prevented?[2]:(t&&o&&o.onRowMouseLeave&&o.onRowMouseLeave(e,t,n),[2])}})})},l.prototype.handleOrderChange=function(e,t,n){return A(this,void 0,void 0,function(){var r,a;return O(this,function(i){return r=this.props.store,a=r.getRowByIndex(e,n),r.exchange(e,t,a),[2]})})},l.prototype.handleSaveOrder=function(){return A(this,void 0,void 0,function(){var e,t,n,r,a,i,s,o;return O(this,function(c){switch(c.label){case 0:return e=this.props,t=e.store,n=e.onSaveOrder,r=e.data,a=e.dispatchEvent,i=t.movedRows.map(function(d){return d.data}),s=t.rows.map(function(d){return d.getDataWithModifiedChilden()}),[4,a("orderChange",N(r,{movedItems:i}))];case 1:return o=c.sent(),o!=null&&o.prevented?[2]:!n||!t.movedRows.length?[2]:(n(i,s),[2])}})})},l.prototype.doAction=function(e,t,n,r){var a=this,i=this.props,s=i.store,o=i.data,c=i.keyField,d=i.expandable,v=i.primaryField,b=e==null?void 0:e.actionType,f=s.keyField,u=s.getData(o).items||[];switch(b){case"selectAll":s.updateSelectedAll();break;case"clearAll":s.updateSelected([]);break;case"select":var y=[];u.forEach(function(x,T){var _=L((r==null?void 0:r.selected)||(r==null?void 0:r.selectedRowKeysExpr),{record:x,rowIndex:T});_&&y.push(x[f])}),s.updateSelected(y);break;case"expand":var g=v||(d==null?void 0:d.keyField)||c,h=[],E=[];if(r!=null&&r.value){var w=u.findIndex(function(x){return x[g]===r.value}),k=u[w];this.tableRef&&this.tableRef.isExpandableRow(k,w)&&(this.tableRef.isExpanded(k)?E.push(k):h.push(k))}else r!=null&&r.expandedRowsExpr&&u.forEach(function(x,T){var _=L(r==null?void 0:r.expandedRowsExpr,{record:x,rowIndex:T});_&&a.tableRef&&a.tableRef.isExpandableRow(x,T)&&(a.tableRef.isExpanded(x)?E.push(x):h.push(x))});h.length>0&&this.tableRef&&this.tableRef.onExpandRows(h),E.length>0&&this.tableRef&&this.tableRef.onCollapseRows(E);break;default:this.handleAction(void 0,e,o);break}},l.prototype.getRef=function(e){this.tableRef=e},l.prototype.renderTable=function(){var e=this.props,t=e.render,n=e.title,r=e.footer;e.rowSelection,e.selectable,e.multiple,e.columns,e.expandable;var a=e.footSummary,i=e.headSummary,s=e.loading,o=e.classnames,c=e.placeholder;e.rowClassNameExpr;var d=e.itemActions,v=e.keyField,b=e.primaryField;e.maxKeepItemSelectionLength;var f=e.onRow,u=e.store,y=e.id,g=e.themeCss,h=G(e,["render","title","footer","rowSelection","selectable","multiple","columns","expandable","footSummary","headSummary","loading","classnames","placeholder","rowClassNameExpr","itemActions","keyField","primaryField","maxKeepItemSelectionLength","onRow","store","id","themeCss"]),E=void 0;if(d){var w=Array.isArray(d)?d.filter(function(x){return!x.hiddenOnHover}):[];if(!w.length)return null;E=function(x,T){return C.createElement("div",{className:o("Table-itemActions")},w.map(function(_,j){return t("itemAction/".concat(j),m(m({},_),{isMenuItem:!0}),{key:j,item:x,data:x,rowIndex:T})}))}}var k={data:this.props.data};return C.createElement(Ie,m({},h,{headerClassName:X(m(m({},this.props),{name:"tableHeadClassname",id:y,themeCss:g})),bodyClassname:X(m(m({},this.props),{name:"tableBodyClassname",id:y,themeCss:g})),onRef:this.getRef,title:this.renderSchema("title",n,k),footer:this.renderSchema("footer",r,k),columns:this.columns,dataSource:u.dataSource,rowSelection:this.rowSelection,rowClassName:this.rowClassName,expandable:this.expandable,footSummary:this.buildSummary("footSummary",a),headSummary:this.buildSummary("headSummary",i),loading:this.renderSchema("loading",s,k),placeholder:this.renderSchema("placeholder",c,k),onSelect:this.handleSelected,onSelectAll:this.handleSelected,onSort:this.handleSort,onFilter:this.handleFilter,onDrag:this.handleOrderChange,itemActions:E,keyField:b||v,onRow:m(m({},f),{onRowClick:this.handleRowClick,onRowDbClick:this.handleRowDbClick,onRowMouseEnter:this.handleRowMouseEnter,onRowMouseLeave:this.handleRowMouseLeave})}))},l.prototype.renderHeading=function(){var e=this.props,t=e.store,n=e.hideQuickSaveBtn,r=e.classnames,a=e.headingClassName,i=e.saveImmediately,s=e.quickSaveApi,o=e.translate,c=e.columns,d=!1;if(t.modifiedRows.length===1){var v=(c==null?void 0:c.map(function(u){var y;return!((y=u==null?void 0:u.quickEdit)===null||y===void 0)&&y.saveImmediately?u==null?void 0:u.name:""}).filter(function(u){return u}))||[],b=t.modifiedRows[0],f=Y(b.data,b.pristine);_e(v,Object.keys(f)).length&&(d=!0)}return s&&!i&&!d&&t.modified&&!n||t.moved?C.createElement("div",{className:r("Table-heading",a),key:"heading"},!i&&t.modified&&!n&&!d?C.createElement("span",null,o("Table.modified",{modified:t.modified}),C.createElement("button",{type:"button",className:r("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSave},C.createElement(U,{icon:"check",className:"icon m-r-xs"}),o("Form.submit")),C.createElement("button",{type:"button",className:r("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},C.createElement(U,{icon:"close",className:"icon m-r-xs"}),o("Table.discard"))):t.moved?C.createElement("span",null,o("Table.moved",{moved:t.moved}),C.createElement("button",{type:"button",className:r("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSaveOrder},C.createElement(U,{icon:"check",className:"icon m-r-xs"}),o("Form.submit")),C.createElement("button",{type:"button",className:r("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},C.createElement(U,{icon:"close",className:"icon m-r-xs"}),o("Table.discard"))):""):null},l.prototype.render=function(){var e=this.props,t=e.classnames,n=e.style,r=e.store,a=e.themeCss,i=e.wrapperCustomStyle,s=e.id,o=e.env;this.renderedToolbars=[];var c=this.renderHeading();return C.createElement("div",{className:t("Table-render-wrapper",X(m(m({},this.props),{name:"wrapperCustomStyle",id:s,themeCss:i})),{"Table--unsaved":!!r.modified||!!r.moved}),style:n},this.renderActions("header"),c,this.renderTable(),C.createElement(Ke,m({},this.props,{config:{themeCss:a,classNames:[{key:"tableHeadClassname",weights:{default:{inner:".".concat(t("Table-table")," > thead > tr > th"),important:!0}}},{key:"tableHeadClassname",weights:{default:{inner:"> tr > th",important:!0}}},{key:"tableBodyClassname",weights:{default:{inner:"> tbody.".concat(t("Table-tbody")," > tr  td")},hover:{suf:"> tbody > tr",inner:"td",important:!0}}},{key:"tableRowClassname",weights:{default:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))},hover:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))}}}],wrapperCustomStyle:i,id:s},env:o})))},l.contextType=je,l.propsList=["source","columnsTogglable","columns","items","rowSelection","expandable","sticky","itemBadge","popOverContainer","keyField","childrenColumnName","rowClassNameExpr","lineHeight","bordered","footer","maxKeepItemSelectionLength","keepItemSelectionOnPageChange","itemActions","headingClassName","footSummary","headSummary","saveImmediately","selectable","multiple","primaryField","hideQuickSaveBtn","selected","placeholder","autoFillHeight"],l.defaultProps={keyField:"id",canAccessSuperData:!1,lazyRenderAfter:100},S([R,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",void 0)],l.prototype,"getPopOverContainer",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Number,Number]),p("design:returntype",void 0)],l.prototype,"subFormRef",null),S([R,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",void 0)],l.prototype,"reset",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Number]),p("design:returntype",void 0)],l.prototype,"rowClassName",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Number]),p("design:returntype",void 0)],l.prototype,"expandedRowClassName",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Number]),p("design:returntype",void 0)],l.prototype,"expandedRowRender",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Number,Array]),p("design:returntype",void 0)],l.prototype,"rowExpandable",null),S([R,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",Promise)],l.prototype,"handleSave",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Object,Array,Array,Object,Object]),p("design:returntype",void 0)],l.prototype,"handleQuickSave",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Object,Object,Boolean,Object]),p("design:returntype",void 0)],l.prototype,"handleQuickChange",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Object,Object]),p("design:returntype",void 0)],l.prototype,"handleAction",null),S([R,p("design:type",Function),p("design:paramtypes",[Array,Array,Array]),p("design:returntype",Promise)],l.prototype,"handleSelected",null),S([R,p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],l.prototype,"handleSort",null),S([R,p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],l.prototype,"handleFilter",null),S([R,p("design:type",Function),p("design:paramtypes",[String,Object]),p("design:returntype",Promise)],l.prototype,"handleSearch",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowClick",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowDbClick",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowMouseEnter",null),S([R,p("design:type",Function),p("design:paramtypes",[Object,Object,Number]),p("design:returntype",Promise)],l.prototype,"handleRowMouseLeave",null),S([R,p("design:type",Function),p("design:paramtypes",[Number,Number,Array]),p("design:returntype",Promise)],l.prototype,"handleOrderChange",null),S([R,p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",Promise)],l.prototype,"handleSaveOrder",null),S([R,p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",void 0)],l.prototype,"getRef",null),l}(C.Component),We=function(F){J(l,F);function l(){return F!==null&&F.apply(this,arguments)||this}return l.prototype.receive=function(e,t){var n,r,a,i=this.context;if(!((n=this.props)===null||n===void 0)&&n.host)return(a=(r=this.props.host).receive)===null||a===void 0?void 0:a.call(r,e,t);if(t)return i.send(t,e)},l.prototype.reload=function(e,t,n){var r,a,i,s,o=this.context;if((r=o==null?void 0:o.parent)===null||r===void 0||r.getComponents(),!((a=this.props)===null||a===void 0)&&a.host)return(s=(i=this.props.host).reload)===null||s===void 0?void 0:s.call(i,e,t,n);if(e)return o.reload(e,n)},l.prototype.setData=function(e,t,n,r){var a;return A(this,void 0,void 0,function(){var i,s,o,c,d,v,b,f,u;return O(this,function(y){switch(y.label){case 0:return i=this.props.store,s=i.data.rows.length,n===void 0?[3,1]:(o=z([],W(i.data.rows),!1),c=String(n).split(","),c.forEach(function(g){var h=Number(g);o.splice(h,1,e)}),[2,i.updateData({rows:o},void 0,t)]);case 1:if(r===void 0)return[3,6];d=z([],W(i.data.rows),!1),v=0,y.label=2;case 2:return v<s?(b=d[v],[4,Pe(r,b)]):[3,5];case 3:f=y.sent(),f&&d.splice(v,1,e),y.label=4;case 4:return v++,[3,2];case 5:return[2,i.updateData({rows:d},void 0,t)];case 6:return u=m(m({},e),{rows:(a=e.rows)!==null&&a!==void 0?a:e.items}),[2,i.updateData(u,void 0,t)]}})})},l.prototype.getData=function(){var e=this.props,t=e.store,n=e.data;return t.getData(n)},l=S([ge({type:"table2",storeType:qe.name,name:"table2",isolateScope:!0})],l),l}(Ve);export{We as TableRenderer,Ve as default};
