import{s as W,y as b,E as A,G as O,f as S,dX as ke,L as V,ap as ge,dY as Fe,bl as pe,a3 as N,dZ as he,z as x,D as de,d_ as Ae,d$ as Oe,e0 as Ne,t as z,a5 as Te,e1 as Be,b2 as fe,b8 as oe,ai as ve,w as le,aM as P,aG as U,aH as $,e2 as De,al as G,v as me,aN as Ie,am as ye,ao as H,K as Q,ad as X,X as se,av as be,aK as _e,aZ as Z,e3 as je,e4 as Ke,ae as Me,T as qe,P as R,Q as h,e5 as Pe,dc as Le,ck as He,cn as Qe}from"./index-DT8qTvyx.js";var Ve=function(k){W(s,k);function s(e){var t=k.call(this,e)||this;return t.formItems=[],t.handleSubmit=t.handleSubmit.bind(t),t.handleAction=t.handleAction.bind(t),t}return s.prototype.buildSchema=function(){var e,t,n,r,a,i,l=this.props,o=l.searchable,d=l.sortable,c=l.name,v=l.label,y=l.translate,f=l.testIdBuilder,u;if(o===!0?u={title:"",controls:[{type:"text",name:c,placeholder:v,clearable:!0,testid:(e=f==null?void 0:f.getChild(c))===null||e===void 0?void 0:e.getTestIdValue()}]}:o&&(o.controls||o.tabs||o.fieldSet?u=b(b({title:""},o),{controls:Array.isArray(o.controls)?o.controls.concat():void 0}):(o==null?void 0:o.type)==="form"?u=o:u={title:"",className:o.formClassName,controls:[b({type:o.type||"text",name:o.name||c,testid:(t=f==null?void 0:f.getChild(o.name||c))===null||t===void 0?void 0:t.getTestIdValue(),placeholder:v},o)]}),u&&u.controls&&d&&u.controls.unshift({type:"hidden",name:"orderBy",value:c},{type:"button-group",name:"order",label:y("sort"),options:[{label:y("asc"),value:"asc"},{label:y("desc"),value:"desc"}]}),u){var m=[];(u.controls||u.body||[]).forEach(function(g){return g.name&&g.name!=="orderBy"&&g.name!=="order"&&m.push(g.name)}),this.formItems=m,u=b(b({},u),{type:"form",wrapperComponent:"div",wrapWithPanel:!0,title:!1,testid:(n=f==null?void 0:f.getChild("form"))===null||n===void 0?void 0:n.getTestIdValue(),actions:[{type:"button",label:y("reset"),actionType:"clear-and-submit",testid:(r=f==null?void 0:f.getChild("btn-reset"))===null||r===void 0?void 0:r.getTestIdValue()},{type:"button",label:y("cancel"),actionType:"cancel",testid:(a=f==null?void 0:f.getChild("btn-cancel"))===null||a===void 0?void 0:a.getTestIdValue()},{label:y("search"),type:"submit",primary:!0,testid:(i=f==null?void 0:f.getChild("btn-search"))===null||i===void 0?void 0:i.getTestIdValue()}]})}return u||"error"},s.prototype.handleAction=function(e,t,n,r){return A(this,void 0,void 0,function(){var a,i,l,o,d,c,v;return O(this,function(y){switch(y.label){case 0:return a=this.props,i=a.onAction,l=a.data,o=a.dispatchEvent,d=a.name,t.actionType==="cancel"||t.actionType==="close"?(r(),[2]):t.actionType==="reset"?(r(),this.handleReset(),[2]):(c=b({},l),this.formItems.forEach(function(f){return pe(c,f,void 0)}),[4,o("columnSearch",N(l,{searchName:d,searchValue:c}))]);case 1:return v=y.sent(),v!=null&&v.prevented?[2]:(i&&i(e,t,n),[2])}})})},s.prototype.handleReset=function(){return A(this,void 0,void 0,function(){var e,t,n,r,a,i;return O(this,function(l){switch(l.label){case 0:return e=this.props,t=e.onSearch,n=e.data,r=e.name,a=b({},n),this.formItems.forEach(function(o){return pe(a,o,void 0)}),a.orderBy===r&&(a.orderBy="",a.order="asc"),i=t,i?[4,t(r,a)]:[3,2];case 1:i=l.sent(),l.label=2;case 2:return t&&t(a),[2]}})})},s.prototype.handleSubmit=function(e,t){return A(this,void 0,void 0,function(){var n,r,a,i;return O(this,function(l){switch(l.label){case 0:return n=this.props,r=n.onSearch,a=n.name,e.order&&(e=b(b({},e),{orderBy:a})),i=r,i?[4,r(a,e)]:[3,2];case 1:i=l.sent(),l.label=2;case 2:return t(),[2]}})})},s.prototype.isActive=function(){var e=this.props,t=e.data,n=e.name,r=e.orderBy;return r&&r===n||this.formItems.some(function(a){return t==null?void 0:t[a]})},s.prototype.render=function(){var e=this,t=this.props,n=t.render,r=t.name,a=t.data,i=t.searchable,l=t.order,o=t.orderBy,d=t.popOverContainer,c=t.classPrefix,v=t.classnames,y=t.testIdBuilder,f=this.buildSchema(),u=this.isActive();return S.createElement(ke,{className:"".concat(c,"TableCell-searchBtn"),layerClassName:v("".concat(c,"TableCell-searchPopOver"),i.className),active:u,filterIcon:S.createElement(V,{icon:"search",className:"icon",iconContent:"table-search-icon",testIdBuilder:y==null?void 0:y.getChild("search-icon")}),popOverContainer:d||function(){return ge.findDOMNode(e)},filterDropdown:function(m){m.setSelectedKeys,m.selectedKeys;var g=m.confirm;return m.clearFilters,n("quick-search-form",f,{data:b(b({},a),{orderBy:o,order:o&&o===r?l:""}),onSubmit:function(p){return e.handleSubmit(p,g)},onAction:function(p,w,C){e.handleAction(p,w,C,g)}})},testIdBuilder:y})},s}(S.Component),ze=Fe(function(k){var s=k.store;return S.createElement(Ve,b({},k,{data:s.query,orderBy:s.orderBy,order:s.order}))});(function(k){W(s,k);function s(){var e=k!==null&&k.apply(this,arguments)||this;return e.propsNeedRemove=["title"],e}return s.defaultProps=b(b({},he.defaultProps),{wrapperComponent:"div"}),s=x([de({type:"cell-field",name:"cell-field"}),Ae(),Oe(),Ne()],s),s})(he);(function(k){W(s,k);function s(){return k!==null&&k.apply(this,arguments)||this}return s.prototype.render=function(){var e=this.props;e.className,e.store;var t=e.render,n=e.classPrefix,r=e.classnames,a=e.tooltip,i=e.align,l=e.cols,o=e.toggleAllColumns,d=e.toggleToggle,c=e.data,v=e.size,y=e.popOverContainer,f=z(e,["className","store","render","classPrefix","classnames","tooltip","align","cols","toggleAllColumns","toggleToggle","data","size","popOverContainer"]),u=f.translate,m=f.env;if(!l)return null;var g=l.filter(function(w){return Te(w.pristine||w,c)&&w.toggable!==!1}),p=g.filter(function(w){return w.toggled!==!1});return S.createElement(Be,b({},f,{render:t,tooltip:a||u("Table.columnsVisibility"),tooltipContainer:y||m.getModalContainer,isActived:l.findIndex(function(w){return!w.toggled})!==-1,align:i??"right",size:v||"sm",classnames:r,classPrefix:n,key:"columns-toggable",columns:l,activeToggaleColumns:p,data:c}),g!=null&&g.length?S.createElement("li",{className:r("ColumnToggler-menuItem"),key:"selectAll",onClick:function(){o&&o((p==null?void 0:p.length)<=0)}},S.createElement(fe,{size:"sm",classPrefix:n,key:"checkall",checked:!!(p!=null&&p.length),partial:!!(p!=null&&p.length&&(p==null?void 0:p.length)!==(g==null?void 0:g.length))},u("Checkboxes.selectAll"))):null,g==null?void 0:g.map(function(w,C){return S.createElement("li",{className:r("ColumnToggler-menuItem"),key:"item"+(w.index||C),onClick:function(){d&&d(C)}},S.createElement(fe,{size:"sm",classPrefix:n,checked:w.toggled!==!1},w.title?t("tpl",w.title):w.label||null))}))},s=x([de({type:"column-toggler",name:"column-toggler"})],s),s})(S.Component);var Ue=function(k){W(s,k);function s(e,t){var n=k.call(this,e)||this;n.renderedToolbars=[],n.subForms={},n.columns=[],n.reactions=[];var r=t;r.registerComponent(n);var a=e.store,i=e.columnsTogglable,l=e.columns,o=e.rowSelection,d=e.keyField,c=e.primaryField,v=e.canAccessSuperData;return a.update({columnsTogglable:i,columns:l,canAccessSuperData:v,rowSelectionKeyField:c||(o==null?void 0:o.keyField)||d}),s.syncRows(a,e,void 0)&&n.syncSelected(),n.columns=n.buildColumns(a.filteredColumns,[],[]),n.rowSelection=n.buildRowSelection(),n.expandable=n.buildExpandable(),n.reactions.push(oe(function(){return a.currentSelectedRowKeys.join(",")},function(){n.rowSelection=n.buildRowSelection(),n.forceUpdate()})),n.reactions.push(oe(function(){return a.currentExpandedKeys.join(",")},function(){n.expandable=n.buildExpandable(),n.forceUpdate()})),n.reactions.push(oe(function(){return a.filteredColumns},function(){n.columns=n.buildColumns(a.filteredColumns,[],[]),n.forceUpdate()})),n}return s.prototype.componentWillUnmount=function(){var e=this.context;e.unRegisterComponent(this),this.reactions&&this.reactions.forEach(function(t){return t()})},s.prototype.syncSelected=function(){var e=this.props,t=e.store,n=e.onSelect;n&&n(t.selectedRows.map(function(r){return r.data}),t.unSelectedRows.map(function(r){return r.data}))},s.syncRows=function(e,t,n){var r,a=t.source,i=ve(t,function(m){return m.items}),l=[],o=!1;if(Array.isArray(i)&&(!n||ve(n,function(m){return m.items})!==i))o=!0,l=i;else if(typeof a=="string"){var d=le(a,t.data,"| raw"),c=n?le(a,n.data,"| raw"):null;c&&c===d?o=!1:Array.isArray(d)&&(o=!0,l=d)}o&&e.initRows(l,t.getEntryId,t.reUseRow,t.childrenColumnName);var v=[],y=e.keyField;Array.isArray(t.selected)?v=t.selected.map(function(m){return m[y]})||[]:t.rowSelection&&t.rowSelection.selectedRowKeysExpr?l.forEach(function(m,g){var p,w=P(((p=t.rowSelection)===null||p===void 0?void 0:p.selectedRowKeysExpr)||"",{record:m,rowIndex:g});w&&v.push(m[y])}):t.rowSelection&&t.rowSelection.selectedRowKeys&&(v=U([],$(t.rowSelection.selectedRowKeys),!1)),o&&v.length>0&&e.updateSelected(v);var f=[],u=t.primaryField||((r=t.expandable)===null||r===void 0?void 0:r.keyField)||t.keyField;return t.expandable&&t.expandable.expandedRowKeysExpr?l.forEach(function(m,g){var p,w=P(((p=t.expandable)===null||p===void 0?void 0:p.expandedRowKeysExpr)||"",{record:m,rowIndex:g});w&&f.push(m[u])}):t.expandable&&t.expandable.expandedRowKeys&&(f=U([],$(t.expandable.expandedRowKeys),!1)),o&&f.length>0&&e.updateExpanded(f,u),o},s.prototype.componentDidUpdate=function(e){var t,n,r,a=this.props,i=a.store;if(De(["orderBy","columnsTogglable","canAccessSuperData"],e,a,function(c){c.orderBy&&!a.onQuery&&delete c.orderBy,i.update(c,{resolveDefinitions:a.resolveDefinitions})}),G(["source","value","items"],e,a)||!a.value&&!a.items&&(a.data!==e.data||typeof a.source=="string"&&me(a.source)))s.syncRows(i,a,e)&&this.syncSelected();else if(Ie(e.selected,a.selected)){var l=i.keyField,o=i.selectedRows.map(function(c){return c[l]}).join(",");i.updateSelected(a.selected.map(function(c){return c[l]})||[]);var d=i.selectedRows.map(function(c){return c[l]}).join(",");o!==d&&this.syncSelected()}G(["columns"],e,a)&&i.update({columns:a.columns}),G(["rowSelection","selectable","multiple","maxKeepItemSelectionLength"],e,a)&&(this.rowSelection=this.buildRowSelection()),G(["query","pageField","perPageField"],e,a)&&i.updateQuery(a.query,void 0,a.pageField,a.perPageField,!0),(!ye((t=e==null?void 0:e.rowSelection)===null||t===void 0?void 0:t.keyField,(n=a.rowSelection)===null||n===void 0?void 0:n.keyField)||!ye(e.keyField,a.keyField))&&i.update({rowSelectionKeyField:a.primaryField||((r=a.rowSelection)===null||r===void 0?void 0:r.keyField)||a.keyField})},s.prototype.getPopOverContainer=function(){return ge.findDOMNode(this)},s.prototype.subFormRef=function(e,t,n){var r=this.props.quickEditFormRef;r&&r(e,t,n),this.subForms["".concat(t,"-").concat(n)]=e,e&&this.props.store.addForm(e.props.store,n)},s.prototype.reset=function(){var e=this,t=this.props.store;t.reset();var n=[];Object.keys(this.subForms).forEach(function(r){return e.subForms[r]&&n.push(e.subForms[r])}),n.forEach(function(r){return r.clearErrors()})},s.prototype.renderCellSchema=function(e,t){var n=this.props,r=n.render;if(n.store,e&&H(e)){e.width,e.children;var a=e.title,i=z(e,["width","children","title"]);return r("cell-field",b(b({},i),{title:a||i.label,type:"cell-field",column:i,data:t.data,name:e.name}),t)}return e},s.prototype.renderSchema=function(e,t,n){var r=this.props.render;if(t&&H(t))return r(e||"field",b(b({},t),{data:n==null?void 0:n.data}),n);if(Array.isArray(t)){var a=[];return t.forEach(function(i,l){return a.push(r(e||"field",b(b({},i),{data:n==null?void 0:n.data}),b(b({},n),{key:l})))}),a}return typeof t=="string"?Q(t,n==null?void 0:n.data):t},s.prototype.buildColumns=function(e,t,n){var r=this,a=this.props,i=a.render,l=a.store,o=a.popOverContainer,d=a.canAccessSuperData,c=a.showBadge,v=a.itemBadge,y=a.data,f=a.classnames,u=a.env,m=a.testIdBuilder,g=[];return t=t,n=n,Array.isArray(e)&&e.forEach(function(p,w){return A(r,void 0,void 0,function(){var C,F,E,T,_,j,ce,Y,J,ue,q=this,ee,te;return O(this,function(ne){switch(ne.label){case 0:return C=b({},p),F=null,E={popOverContainer:o||this.getPopOverContainer,value:p.title||p.label},H(p.title)?F=He(p.title):(typeof p.title=="string"||typeof p.label=="string")&&(F={type:"plain"}),p.align&&(F.align=p.align,F.className="flex-1"),T=function(K){var M,B=q.renderCellSchema(F,E),D=null;return p.remark&&(D=i("remark",{type:"remark",tooltip:p.remark,container:q.getPopOverContainer})),S.createElement("div",{key:w,className:f("Table-head-cell-wrapper",(M={},M["".concat(p.className)]=!!p.className,M["".concat(p.titleClassName)]=!!p.titleClassName,M)),style:{justifyContent:{right:"flex-end",center:"center"}[p.align]||"flex-start"}},B,D,K)},Object.assign(C,{title:T}),_=!!(!((ee=p.children)===null||ee===void 0)&&ee.length),te=p.canAccessSuperData,p.type&&Object.assign(C,{render:function(K,M,B,D,we){var Se={},re=l.getRowByIndex(B,U([],$(we||[]),!1))||{},Ce=m==null?void 0:m.getChild("row-".concat(B,"-cell-").concat(D)),L={children:q.renderCellSchema(p,{data:re.locals,btnDisabled:l.dragging,popOverContainer:o||q.getPopOverContainer,quickEditFormRef:q.subFormRef,onQuickChange:function(I,xe,Re,Ee){q.handleQuickChange(re,I,xe,Re,Ee)},row:re,showBadge:c&&w===0,itemBadge:v,testIdBuilder:Ce}),props:Se};if(!_&&p.rowSpanExpr){var ae=+Q(p.rowSpanExpr,{record:M,rowIndex:B,colIndex:D});ae&&(L.props.rowSpan=ae,t.push({colIndex:D,rowIndex:B,rowSpan:ae}))}if(!_&&p.colSpanExpr){var ie=+Q(p.colSpanExpr,{record:M,rowIndex:B,colIndex:D});ie&&(L.props.colSpan=ie,n.push({colIndex:D,rowIndex:B,colSpan:ie}))}return t.forEach(function(I){D===I.colIndex&&B>I.rowIndex&&B<I.rowIndex+(I.rowSpan||0)&&(L.props.rowSpan=0)}),n.forEach(function(I){B===I.rowIndex&&D>I.colIndex&&D<I.colIndex+(I.colSpan||0)&&(L.props.colSpan=0)}),L}}),p.searchable&&(C.filterDropdown=S.createElement(ze,b({},this.props,{popOverContainer:this.getPopOverContainer,name:p.name,searchable:p.searchable,onSearch:this.handleSearch,key:"th-search-"+w,testIdBuilder:m==null?void 0:m.getChild("head-search-".concat(w))}))),p.sortable&&(C.sorter=!0),p.filterable?p.filterable.options?(C.filters=p.filterable.options.map(function(K){return typeof K=="string"?{text:K,value:K}:{text:K.label,value:K.value}}),[3,4]):[3,1]:[3,4];case 1:return p.filterable.source?(j=p.filterable.source,me(j)?(ce=le(j,y,"| raw"),C.filters=ce,[3,4]):[3,2]):[3,4];case 2:return se(j,y)?(Y=Le(j),Y.cache=3e3,[4,u.fetcher(Y,y)]):[3,4];case 3:J=ne.sent(),ue=J.data&&J.data.options||[],C.filters=ue,ne.label=4;case 4:return _&&(C.children=this.buildColumns(p.children,t,n)),g.push(C),[2]}})})}),g},s.prototype.buildSummary=function(e,t){var n=this,r=[];return Array.isArray(t)&&t.forEach(function(a,i){H(a)?r.push({colSpan:a.colSpan,fixed:a.fixed,cellClassName:a.cellClassName,render:function(l){return n.renderSchema(e,a,{data:l})}}):Array.isArray(a)&&(r[i]||r.push([]),a.forEach(function(l){r[i].push({colSpan:l.colSpan,fixed:l.fixed,cellClassName:l.cellClassName,render:function(o){return n.renderSchema(e,l,{data:o})}})}))}),r.length?r:null},s.prototype.rowClassName=function(e,t){var n=this.props,r=n.rowClassNameExpr,a=n.store,i=n.themeCss,l=n.id,o=n.rowClassName,d=[];o&&d.push(o),r&&d.push(Q(r,{record:e,rowIndex:t}));var c=a.getRowByIndex(t);return c!=null&&c.modified&&d.push("is-modified"),c!=null&&c.moved&&d.push("is-moved"),d.push(X(b(b({},this.props),{name:"tableRowClassname",id:l,themeCss:i}))),d.join(" ")},s.prototype.buildRowSelection=function(){var e=this,t=this.props,n=t.selectable,r=t.multiple,a=t.maxKeepItemSelectionLength,i=t.rowSelection,l=t.store,o=null;if(n)o={type:r===!1?"radio":"",selectedRowKeys:l.currentSelectedRowKeys,maxSelectedLength:a};else if(i){i.selectedRowKeys;var d=i.selections,c=z(i,["selectedRowKeys","selections"]);o=b({selectedRowKeys:l.currentSelectedRowKeys,maxSelectedLength:a},c),o.getCheckboxProps=function(v,y){var f=e.props,u=f.rowSelection,m=f.maxKeepItemSelectionLength,g=f.store,p=u==null?void 0:u.disableOn;return{disabled:(p?P(p,{record:v,rowIndex:y}):!1)||m&&g.currentSelectedRowKeys.length>=m&&!g.currentSelectedRowKeys.includes(v[g.keyField])}},i.disableOn&&delete o.disableOn,d&&Array.isArray(d)&&(o.selections=[],d.forEach(function(v){o.selections.push({key:v.key,text:v.text,onSelect:function(y){var f=[];f=y.filter(function(u,m){return v.key==="all"?!0:v.key==="none"?!1:v.key==="invert"?!l.currentSelectedRowKeys.includes(u):v.key==="odd"?m%2===0:v.key==="even"?m%2!==0:!0}),l.updateSelected(f)}})}))}return o},s.prototype.expandedRowClassName=function(e,t){var n=this.props.expandable;return Q(n==null?void 0:n.expandedRowClassNameExpr,{record:e,rowIndex:t})},s.prototype.expandedRowRender=function(e,t){var n=this.props.expandable;return this.renderSchema("expandableBody",b({},n),{data:b(b({},this.props.data),{record:e,rowIndex:t})})},s.prototype.rowExpandable=function(e,t,n){var r=this.props.expandable;return r!=null&&r.expandableOn?P(r.expandableOn,{record:e,rowIndex:t}):!1},s.prototype.buildExpandable=function(){var e=this.props,t=e.expandable,n=e.store,r=null;if(t){t.expandedRowKeys;var a=z(t,["expandedRowKeys"]);r=b({expandedRowKeys:n.currentExpandedKeys},a),t.expandableOn&&(r.rowExpandable=this.rowExpandable,delete r.expandableOn),t&&t.type&&(r.expandedRowRender=this.expandedRowRender),t.expandedRowClassNameExpr&&(r.expandedRowClassName=this.expandedRowClassName,delete r.expandedRowClassNameExpr)}return r},s.prototype.reloadTarget=function(e,t){var n=this.context;n.reload(e,t)},s.prototype.handleSave=function(){return A(this,void 0,void 0,function(){var e,t,n,r,a,i,l,o,d,c,v,y=this;return O(this,function(f){switch(f.label){case 0:return e=this.props,t=e.store,n=e.onSave,r=e.primaryField,a=e.keyField,t.modifiedRows.length?(i=[],Object.keys(this.subForms).forEach(function(u){return y.subForms[u]&&i.push(y.subForms[u])}),i.length?[4,Promise.all(i.map(function(u){return u.validate()}))]:[3,2]):[2];case 1:if(l=f.sent(),~l.indexOf(!1))return[2];f.label=2;case 2:return o=t.modifiedRows.map(function(u){return u.data}),d=t.modifiedRows.map(function(u){return u.path}),c=t.modifiedRows.map(function(u){return Z(u.data,u.pristine,[a,r])}),v=t.rows.filter(function(u){return!u.modified}).map(function(u){return u.data}),n?(n(o,c,d,v,t.modifiedRows.map(function(u){return u.pristine})),[2]):(this.handleQuickSave(o,c,d,v,t.modifiedRows.map(function(u){return u.pristine})),[2])}})})},s.prototype.handleQuickSave=function(e,t,n,r,a,i){var l=this,o=this.props,d=o.store,c=o.quickSaveApi,v=o.quickSaveItemApi,y=o.primaryField,f=o.keyField,u=o.env,m=o.messages,g=o.reload,p=o.dispatchEvent;if(Array.isArray(e)){if(!se(c)){u&&u.alert("Table2 quickSaveApi is required");return}var w=y||f,C=N(d.data,{rows:e,rowsDiff:t,indexes:n,rowsOrigin:a});e.length&&e[0].hasOwnProperty(w)&&(C.ids=e.map(function(T){return T[w]}).join(",")),r&&(C.unModifiedItems=r),d.saveRemote(c,C,{successMessage:m&&m.saveFailed,errorMessage:m&&m.saveSuccess}).then(function(){p("quickSaveSubmitted",C),g&&l.reloadTarget(be(g,C),C)}).catch(function(){})}else{if(!se(v)){u&&u.alert("Table2 quickSaveItemApi is required!");return}var F=N(d.data,{item:e,modified:t,origin:a}),E=N(F,e);d.saveRemote(v,E).then(function(){p("quickSaveSubmitted",E),g&&l.reloadTarget(be(g,F),F)}).catch(function(){i!=null&&i.resetOnFailed&&l.reset()})}},s.prototype.handleQuickChange=function(e,t,n,r,a){if(_e(e)){var i=this.props,l=i.onSave,o=i.onPristineChange,d=i.saveImmediately,c=i.primaryField,v=i.keyField,y=i.quickSaveItemApi;if(e.change(t,r),e.modified&&this.syncSelected(),r){o==null||o(e.data,e.path);return}if(!(!n&&!d)){if(n&&n.api){this.props.onAction&&this.props.onAction(null,{actionType:"ajax",api:n.api,reload:a==null?void 0:a.reload},e.locals);return}if(!l){this.handleQuickSave(y?e.data:[e.data],Z(e.data,e.pristine,[v,c]),[e.path],void 0,e.pristine,a);return}l(e.data,Z(e.data,e.pristine,[v,c]),e.path,void 0,e.pristine,a)}}},s.prototype.handleAction=function(e,t,n){var r=this.props.onAction;r&&r(e,t,n)},s.prototype.renderActions=function(e){var t=this,n=this.props,r=n.actions,a=n.render,i=n.store,l=n.classnames,o=n.data,d=n.columnsTogglable,c=n.dispatchEvent;r=Array.isArray(r)?r.concat():[];var v=H(d)?d:{};return i.toggable&&e==="header"&&!~this.renderedToolbars.indexOf("columns-toggler")&&r.push({type:"button",children:a("column-toggler",b(b({},v),{type:"column-toggler"}),{cols:i.columnsData,toggleAllColumns:function(){i.toggleAllColumns(),c("columnToggled",N(o,{columns:i.columnsData.filter(function(y){return y.toggled})}))},toggleToggle:function(y){var f=i.columnsData[y];f.toggleToggle(),c("columnToggled",N(o,{columns:i.columnsData.filter(function(u){return u.toggled})}))}})}),Array.isArray(r)&&r.length?S.createElement("div",{className:l("Table-toolbar")},r.map(function(y,f){return a("action/".concat(f),b({type:"button"},y),{onAction:t.handleAction,key:f,btnDisabled:i.dragging,data:i.getData(o)})})):null},s.prototype.handleSelected=function(e,t,n){return A(this,void 0,void 0,function(){var r,a,i,l,o;return O(this,function(d){switch(d.label){case 0:return r=this.props,a=r.dispatchEvent,i=r.data,l=r.store,[4,a("selectedChange",N(i,{selectedItems:e,unSelectedItems:n}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2,o==null?void 0:o.prevented]:(l.updateSelected(t),this.syncSelected(),[2])}})})},s.prototype.handleSort=function(e){return A(this,void 0,void 0,function(){var t,n,r,a,i;return O(this,function(l){switch(l.label){case 0:return t=this.props,n=t.dispatchEvent,r=t.data,a=t.onSort,[4,n("columnSort",N(r,{orderBy:e.orderBy,orderDir:e.orderDir}))];case 1:return i=l.sent(),i!=null&&i.prevented?[2,i==null?void 0:i.prevented]:(a&&a(e),[2])}})})},s.prototype.handleFilter=function(e){return A(this,void 0,void 0,function(){var t,n,r,a,i;return O(this,function(l){switch(l.label){case 0:return t=this.props,n=t.dispatchEvent,r=t.data,a=t.onSearch,[4,n("columnFilter",N(r,e))];case 1:return i=l.sent(),i!=null&&i.prevented?[2,i==null?void 0:i.prevented]:(a&&a(e),[2])}})})},s.prototype.handleSearch=function(e,t){return A(this,void 0,void 0,function(){var n,r,a,i,l,o,d;return O(this,function(c){switch(c.label){case 0:return n=this.props,r=n.data,a=n.dispatchEvent,i=n.store,l=n.onSearch,[4,a("columnSearch",N(r,{searchName:e,searchValue:t}))];case 1:return o=c.sent(),o!=null&&o.prevented?[2]:(i.updateQuery(t),l&&l((d={},d[e]=t[e],d)),[2])}})})},s.prototype.handleRowClick=function(e,t,n){return A(this,void 0,void 0,function(){var r,a,i,l,o;return O(this,function(d){switch(d.label){case 0:return r=this.props,a=r.dispatchEvent,i=r.data,l=r.onRow,[4,a("rowClick",N(i,{item:t,index:n}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2]:(t&&l&&l.onRowClick&&l.onRowClick(e,t,n),[2])}})})},s.prototype.handleRowDbClick=function(e,t,n){return A(this,void 0,void 0,function(){var r,a,i,l,o;return O(this,function(d){switch(d.label){case 0:return r=this.props,a=r.dispatchEvent,i=r.data,l=r.onRow,[4,a("rowDbClick",N(i,{item:t,index:n}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2,!1]:(t&&l&&l.onRowDbClick&&l.onRowDbClick(e,t,n),[2,!0])}})})},s.prototype.handleRowMouseEnter=function(e,t,n){var r;return A(this,void 0,void 0,function(){var a,i,l,o,d;return O(this,function(c){switch(c.label){case 0:return(r=e==null?void 0:e.persist)===null||r===void 0||r.call(e),a=this.props,i=a.dispatchEvent,l=a.data,o=a.onRow,[4,i("rowMouseEnter",N(l,{item:t,index:n}))];case 1:return d=c.sent(),d!=null&&d.prevented?[2]:(t&&o&&o.onRowMouseEnter&&o.onRowMouseEnter(e,t,n),[2])}})})},s.prototype.handleRowMouseLeave=function(e,t,n){var r;return A(this,void 0,void 0,function(){var a,i,l,o,d;return O(this,function(c){switch(c.label){case 0:return(r=e==null?void 0:e.persist)===null||r===void 0||r.call(e),a=this.props,i=a.dispatchEvent,l=a.data,o=a.onRow,[4,i("rowMouseLeave",N(l,{item:t,index:n}))];case 1:return d=c.sent(),d!=null&&d.prevented?[2]:(t&&o&&o.onRowMouseLeave&&o.onRowMouseLeave(e,t,n),[2])}})})},s.prototype.handleOrderChange=function(e,t,n){return A(this,void 0,void 0,function(){var r,a;return O(this,function(i){return r=this.props.store,a=r.getRowByIndex(e,n),r.exchange(e,t,a),[2]})})},s.prototype.handleSaveOrder=function(){return A(this,void 0,void 0,function(){var e,t,n,r,a,i,l,o;return O(this,function(d){switch(d.label){case 0:return e=this.props,t=e.store,n=e.onSaveOrder,r=e.data,a=e.dispatchEvent,i=t.movedRows.map(function(c){return c.data}),l=t.rows.map(function(c){return c.getDataWithModifiedChilden()}),[4,a("orderChange",N(r,{movedItems:i}))];case 1:return o=d.sent(),o!=null&&o.prevented?[2]:!n||!t.movedRows.length?[2]:(n(i,l),[2])}})})},s.prototype.doAction=function(e,t,n,r){var a=this,i=this.props,l=i.store,o=i.data,d=i.keyField,c=i.expandable,v=i.primaryField,y=e==null?void 0:e.actionType,f=l.keyField,u=l.getData(o).items||[];switch(y){case"selectAll":l.updateSelectedAll();break;case"clearAll":l.updateSelected([]);break;case"select":var m=[];u.forEach(function(E,T){var _=P((r==null?void 0:r.selected)||(r==null?void 0:r.selectedRowKeysExpr),{record:E,rowIndex:T});_&&m.push(E[f])}),l.updateSelected(m);break;case"expand":var g=v||(c==null?void 0:c.keyField)||d,p=[],w=[];if(r!=null&&r.value){var C=u.findIndex(function(E){return E[g]===r.value}),F=u[C];this.tableRef&&this.tableRef.isExpandableRow(F,C)&&(this.tableRef.isExpanded(F)?w.push(F):p.push(F))}else r!=null&&r.expandedRowsExpr&&u.forEach(function(E,T){var _=P(r==null?void 0:r.expandedRowsExpr,{record:E,rowIndex:T});_&&a.tableRef&&a.tableRef.isExpandableRow(E,T)&&(a.tableRef.isExpanded(E)?w.push(E):p.push(E))});p.length>0&&this.tableRef&&this.tableRef.onExpandRows(p),w.length>0&&this.tableRef&&this.tableRef.onCollapseRows(w);break;default:this.handleAction(void 0,e,o);break}},s.prototype.getRef=function(e){this.tableRef=e},s.prototype.renderTable=function(){var e=this.props,t=e.render,n=e.title,r=e.footer;e.rowSelection,e.selectable,e.multiple,e.columns,e.expandable;var a=e.footSummary,i=e.headSummary,l=e.loading,o=e.classnames,d=e.placeholder;e.rowClassNameExpr;var c=e.itemActions,v=e.keyField,y=e.primaryField;e.maxKeepItemSelectionLength;var f=e.onRow,u=e.store,m=e.id,g=e.themeCss,p=z(e,["render","title","footer","rowSelection","selectable","multiple","columns","expandable","footSummary","headSummary","loading","classnames","placeholder","rowClassNameExpr","itemActions","keyField","primaryField","maxKeepItemSelectionLength","onRow","store","id","themeCss"]),w=void 0;if(c){var C=Array.isArray(c)?c.filter(function(E){return!E.hiddenOnHover}):[];if(!C.length)return null;w=function(E,T){return S.createElement("div",{className:o("Table-itemActions")},C.map(function(_,j){return t("itemAction/".concat(j),b(b({},_),{isMenuItem:!0}),{key:j,item:E,data:E,rowIndex:T})}))}}var F={data:this.props.data};return S.createElement(je,b({},p,{headerClassName:X(b(b({},this.props),{name:"tableHeadClassname",id:m,themeCss:g})),bodyClassname:X(b(b({},this.props),{name:"tableBodyClassname",id:m,themeCss:g})),onRef:this.getRef,title:this.renderSchema("title",n,F),footer:this.renderSchema("footer",r,F),columns:this.columns,dataSource:u.dataSource,rowSelection:this.rowSelection,rowClassName:this.rowClassName,expandable:this.expandable,footSummary:this.buildSummary("footSummary",a),headSummary:this.buildSummary("headSummary",i),loading:this.renderSchema("loading",l,F),placeholder:this.renderSchema("placeholder",d,F),onSelect:this.handleSelected,onSelectAll:this.handleSelected,onSort:this.handleSort,onFilter:this.handleFilter,onDrag:this.handleOrderChange,itemActions:w,keyField:y||v,onRow:b(b({},f),{onRowClick:this.handleRowClick,onRowDbClick:this.handleRowDbClick,onRowMouseEnter:this.handleRowMouseEnter,onRowMouseLeave:this.handleRowMouseLeave})}))},s.prototype.renderHeading=function(){var e=this.props,t=e.store,n=e.hideQuickSaveBtn,r=e.classnames,a=e.headingClassName,i=e.saveImmediately,l=e.quickSaveApi,o=e.translate,d=e.columns,c=!1;if(t.modifiedRows.length===1){var v=(d==null?void 0:d.map(function(u){var m;return!((m=u==null?void 0:u.quickEdit)===null||m===void 0)&&m.saveImmediately?u==null?void 0:u.name:""}).filter(function(u){return u}))||[],y=t.modifiedRows[0],f=Z(y.data,y.pristine);Ke(v,Object.keys(f)).length&&(c=!0)}return l&&!i&&!c&&t.modified&&!n||t.moved?S.createElement("div",{className:r("Table-heading",a),key:"heading"},!i&&t.modified&&!n&&!c?S.createElement("span",null,o("Table.modified",{modified:t.modified}),S.createElement("button",{type:"button",className:r("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSave},S.createElement(V,{icon:"check",className:"icon m-r-xs"}),o("Form.submit")),S.createElement("button",{type:"button",className:r("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},S.createElement(V,{icon:"close",className:"icon m-r-xs"}),o("Table.discard"))):t.moved?S.createElement("span",null,o("Table.moved",{moved:t.moved}),S.createElement("button",{type:"button",className:r("Button Button--size-xs Button--success m-l-sm"),onClick:this.handleSaveOrder},S.createElement(V,{icon:"check",className:"icon m-r-xs"}),o("Form.submit")),S.createElement("button",{type:"button",className:r("Button Button--size-xs Button--danger m-l-sm"),onClick:this.reset},S.createElement(V,{icon:"close",className:"icon m-r-xs"}),o("Table.discard"))):""):null},s.prototype.render=function(){var e=this.props,t=e.classnames,n=e.style,r=e.store,a=e.themeCss,i=e.wrapperCustomStyle,l=e.id,o=e.env;this.renderedToolbars=[];var d=this.renderHeading();return S.createElement("div",{className:t("Table-render-wrapper",X(b(b({},this.props),{name:"wrapperCustomStyle",id:l,themeCss:i})),{"Table--unsaved":!!r.modified||!!r.moved}),style:n},this.renderActions("header"),d,this.renderTable(),S.createElement(Me,b({},this.props,{config:{themeCss:a,classNames:[{key:"tableHeadClassname",weights:{default:{inner:".".concat(t("Table-table")," > thead > tr > th"),important:!0}}},{key:"tableHeadClassname",weights:{default:{inner:"> tr > th",important:!0}}},{key:"tableBodyClassname",weights:{default:{inner:"> tbody.".concat(t("Table-tbody")," > tr  td")},hover:{suf:"> tbody > tr",inner:"td",important:!0}}},{key:"tableRowClassname",weights:{default:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))},hover:{parent:".".concat(t("Table-table")," > tbody.").concat(t("Table-tbody")),inner:"td.".concat(t("Table-cell"))}}}],wrapperCustomStyle:i,id:l},env:o})))},s.contextType=qe,s.propsList=["source","columnsTogglable","columns","items","rowSelection","expandable","sticky","itemBadge","popOverContainer","keyField","childrenColumnName","rowClassNameExpr","lineHeight","bordered","footer","maxKeepItemSelectionLength","keepItemSelectionOnPageChange","itemActions","headingClassName","footSummary","headSummary","saveImmediately","selectable","multiple","primaryField","hideQuickSaveBtn","selected","placeholder","autoFillHeight"],s.defaultProps={keyField:"id",canAccessSuperData:!1,lazyRenderAfter:100},x([R,h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",void 0)],s.prototype,"getPopOverContainer",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Number,Number]),h("design:returntype",void 0)],s.prototype,"subFormRef",null),x([R,h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",void 0)],s.prototype,"reset",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Number]),h("design:returntype",void 0)],s.prototype,"rowClassName",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Number]),h("design:returntype",void 0)],s.prototype,"expandedRowClassName",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Number]),h("design:returntype",void 0)],s.prototype,"expandedRowRender",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Number,Array]),h("design:returntype",void 0)],s.prototype,"rowExpandable",null),x([R,h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",Promise)],s.prototype,"handleSave",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Object,Array,Array,Object,Object]),h("design:returntype",void 0)],s.prototype,"handleQuickSave",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Object,Object,Boolean,Object]),h("design:returntype",void 0)],s.prototype,"handleQuickChange",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Object,Object]),h("design:returntype",void 0)],s.prototype,"handleAction",null),x([R,h("design:type",Function),h("design:paramtypes",[Array,Array,Array]),h("design:returntype",Promise)],s.prototype,"handleSelected",null),x([R,h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",Promise)],s.prototype,"handleSort",null),x([R,h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",Promise)],s.prototype,"handleFilter",null),x([R,h("design:type",Function),h("design:paramtypes",[String,Object]),h("design:returntype",Promise)],s.prototype,"handleSearch",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Object,Number]),h("design:returntype",Promise)],s.prototype,"handleRowClick",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Object,Number]),h("design:returntype",Promise)],s.prototype,"handleRowDbClick",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Object,Number]),h("design:returntype",Promise)],s.prototype,"handleRowMouseEnter",null),x([R,h("design:type",Function),h("design:paramtypes",[Object,Object,Number]),h("design:returntype",Promise)],s.prototype,"handleRowMouseLeave",null),x([R,h("design:type",Function),h("design:paramtypes",[Number,Number,Array]),h("design:returntype",Promise)],s.prototype,"handleOrderChange",null),x([R,h("design:type",Function),h("design:paramtypes",[]),h("design:returntype",Promise)],s.prototype,"handleSaveOrder",null),x([R,h("design:type",Function),h("design:paramtypes",[Object]),h("design:returntype",void 0)],s.prototype,"getRef",null),s}(S.Component),We=function(k){W(s,k);function s(){return k!==null&&k.apply(this,arguments)||this}return s.prototype.receive=function(e,t){var n,r,a,i=this.context;if(!((n=this.props)===null||n===void 0)&&n.host)return(a=(r=this.props.host).receive)===null||a===void 0?void 0:a.call(r,e,t);if(t)return i.send(t,e)},s.prototype.reload=function(e,t,n){var r,a,i,l,o=this.context;if((r=o==null?void 0:o.parent)===null||r===void 0||r.getComponents(),!((a=this.props)===null||a===void 0)&&a.host)return(l=(i=this.props.host).reload)===null||l===void 0?void 0:l.call(i,e,t,n);if(e)return o.reload(e,n)},s.prototype.setData=function(e,t,n,r){var a;return A(this,void 0,void 0,function(){var i,l,o,d,c,v,y,f,u;return O(this,function(m){switch(m.label){case 0:return i=this.props.store,l=i.data.rows.length,n===void 0?[3,1]:(o=U([],$(i.data.rows),!1),d=String(n).split(","),d.forEach(function(g){var p=Number(g);o.splice(p,1,e)}),[2,i.updateData({rows:o},void 0,t)]);case 1:if(r===void 0)return[3,6];c=U([],$(i.data.rows),!1),v=0,m.label=2;case 2:return v<l?(y=c[v],[4,Qe(r,y)]):[3,5];case 3:f=m.sent(),f&&c.splice(v,1,e),m.label=4;case 4:return v++,[3,2];case 5:return[2,i.updateData({rows:c},void 0,t)];case 6:return u=b(b({},e),{rows:(a=e.rows)!==null&&a!==void 0?a:e.items}),[2,i.updateData(u,void 0,t)]}})})},s.prototype.getData=function(){var e=this.props,t=e.store,n=e.data;return t.getData(n)},s=x([de({type:"table2",storeType:Pe.name,name:"table2",isolateScope:!0})],s),s}(Ue);export{We as TableRenderer,Ue as default};
