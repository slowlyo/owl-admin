import{t as P,G as C,H as A,l as y,ag as x,d1 as U,d2 as N,D as b,Q as E,T as p,ap as T,br as R,z as D,Y as w,a4 as k,aM as H,ah as M}from"./index-BnZOs00e.js";var $=function(m){P(o,m);function o(t){return m.call(this,t)||this}return o.prototype.componentWillUnmount=function(){this.unHook&&this.unHook()},o.prototype.onSearch=function(t,e,a){return C(this,void 0,void 0,function(){var n,l,i,s,c,d,u,r,f,h;return A(this,function(v){switch(v.label){case 0:if(n=this.props,l=n.searchApi,i=n.setLoading,s=n.env,l=(a==null?void 0:a.searchApi)||l,c=(a==null?void 0:a.searchTerm)||this.props.searchTerm||"term",d=(a==null?void 0:a.searchParam)||this.props.searchParam||{},u=D((h={},h[c]=t,h),d),!w(l,u))return[2,Promise.resolve([])];i(!0),v.label=1;case 1:return v.trys.push([1,,3,4]),[4,s.fetcher(l,u,{cancelExecutor:e,autoAppend:!0})];case 2:return r=v.sent(),f=r.data&&r.data.options||r.data||[],[2,f];case 3:return i(!1),[7];case 4:return[2]}})})},o.prototype.deferLoad=function(t,e,a){return C(this,void 0,void 0,function(){var n,l,i,s,c,d,u;return A(this,function(r){switch(r.label){case 0:if(n=this.props,l=n.env,i=n.deferApi,s=n.setLoading,n.formInited,n.addHook,i=(a==null?void 0:a.deferApi)||i,!l||!l.fetcher)throw new Error("fetcher is required");if(c=k(t,{}),!w(i,c))return[2,Promise.resolve([])];r.label=1;case 1:return r.trys.push([1,,3,4]),[4,l.fetcher(i,c)];case 2:return d=r.sent(),u=d.data&&d.data.options||d.data||[],e&&u.forEach(function(f){f.isRef=!0}),[2,u];case 3:return s(!1),[7];case 4:return[2]}})})},o.prototype.changeValue=function(t){return C(this,void 0,void 0,function(){var e,a,n,l,i,s,c,d,u,r,f,h;return A(this,function(v){switch(v.label){case 0:return e=this.props,a=e.joinValues,n=e.extractValue,l=e.delimiter,i=e.multiple,s=e.valueField,c=e.onChange,d=e.options,e.setOptions,e.data,u=e.dispatchEvent,r=t,f=[],(Array.isArray(t)?t:t?[t]:[]).forEach(function(g){var S=H(d,function(F){return F[s||"value"]==g[s||"value"]});S||f.push(g)}),a?i?r=Array.isArray(t)?t.map(function(g){return g[s||"value"]}).join(l):t?t[s||"value"]:"":r=r?r[s||"value"]:"":n&&(i?r=Array.isArray(t)?t.map(function(g){return g[s||"value"]}):t?[t[s||"value"]]:[]:r=r?r[s||"value"]:""),[4,u("change",M(this.props,{value:r,options:d,items:d}))];case 1:return h=v.sent(),h!=null&&h.prevented?[2]:(c(r),[2])}})})},o.prototype.renderStatic=function(){var t=this.props,e=t.selectedOptions,a=t.labelField,n=a===void 0?"label":a,l=t.classnames;return n==="avatar"?e.map(function(i,s){return y.createElement("img",{key:s,className:l("UserSelect-avatar-img"),src:i[n],alt:""})}):e.map(function(i){return i[n]}).join(",")},o.prototype.render=function(){var t=this,e=this.props,a=e.showNav,n=e.navTitle,l=e.searchable,i=e.options,s=e.className;e.style;var c=e.selectedOptions,d=e.tabOptions,u=e.multi,r=e.multiple,f=e.isDep,h=e.isRef,v=e.placeholder,g=e.searchPlaceholder,S=e.tabMode,F=e.data,L=e.displayFields,j=e.labelField,V=e.loadingConfig,_=e.disabled;return d==null||d.forEach(function(O){O.deferLoad=t.deferLoad,O.onChange=t.changeValue,O.onSearch=t.onSearch}),y.createElement("div",{className:x("UserSelectControl",s)},S?y.createElement(U,{selection:c,tabOptions:d,multiple:r,displayFields:L,onChange:this.changeValue,onSearch:this.onSearch,deferLoad:this.deferLoad,data:F,disabled:_}):y.createElement(N,{loadingConfig:V,showNav:a,navTitle:n,selection:c,options:i,multi:u,multiple:r,searchable:l,placeholder:v,searchPlaceholder:g,deferLoad:this.deferLoad,onChange:this.changeValue,onSearch:this.onSearch,displayFields:L,labelField:j,isDep:f,isRef:h,disabled:_}))},o.defaultProps={showNav:!0},b([E,p("design:type",Function),p("design:paramtypes",[String,Function,Object]),p("design:returntype",Promise)],o.prototype,"onSearch",null),b([E,p("design:type",Function),p("design:paramtypes",[Object,Boolean,Object]),p("design:returntype",Promise)],o.prototype,"deferLoad",null),b([E,p("design:type",Function),p("design:paramtypes",[Object]),p("design:returntype",Promise)],o.prototype,"changeValue",null),b([T(),p("design:type",Function),p("design:paramtypes",[]),p("design:returntype",void 0)],o.prototype,"render",null),o}(y.Component),z=function(m){P(o,m);function o(){return m!==null&&m.apply(this,arguments)||this}return o=b([R({type:"users-select"})],o),o}($);export{z as UserSelectControlRenderer,$ as default};
