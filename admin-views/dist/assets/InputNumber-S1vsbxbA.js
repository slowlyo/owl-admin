import{$o as e,Ao as t,Ci as n,Fo as r,Ia as i,J as a,Ko as o,Mo as s,No as c,Nr as l,Po as u,Qt as d,Rr as f,fo as p,fr as m,gn as h,jo as g,nr as _,rr as v,ui as y,vr as b,xr as x,ya as S,yr as C,zo as w}from"./index-C4Pf1uQ-.js";var T=e(o()),E=e(y()),D=function(e){c(o,e);function o(t){var n=e.call(this,t)||this;n.handleChange=n.handleChange.bind(n),n.handleChangeUnit=n.handleChangeUnit.bind(n);var r=n.getUnit(),i=f(t.unitOptions),a=t.formItem,o=t.value;return a&&n.formatNumber(o,!0),n.state={unit:r,unitOptions:i},n}return o.prototype.doAction=function(e,t,n,r){n===void 0&&(n=!1);var a=e?.actionType,o=this.props,s=o.min,c=o.max,l=o.precision,u=o.step,f=o.resetValue,p=o.big,m=o.onChange,h=o.clearValueOnEmpty,g=o.formStore,_=o.store,v=o.name;if(a===`clear`)m?.(h?void 0:``);else if(a===`reset`){var y=d.normalizePrecision(this.filterNum(l),this.filterNum(u)),b=i(g?.pristine??_?.pristine,v)??f,x=d.normalizeValue(b??``,this.filterNum(s,p),this.filterNum(c,p),y,b??``,h,p);m?.(h&&x===``?void 0:x)}},o.prototype.formatNumber=function(e,t){t===void 0&&(t=!1);var n=this.props,r=n.showAsPercent,i=n.suffix,a=n.step,o=n.big,s=n.setPrinstineValue,c=this.props.precision;r&&i===`%`&&(c=(c||0)+2);var l=this.getUnit(),u=f(this.props.unitOptions),m=d.normalizePrecision(this.filterNum(c),this.filterNum(a));if(e!=null&&m!=null&&(!l||u.length===0)&&o!==!0){var h=parseFloat(p(e.toString(),`.`,m));!isNaN(h)&&h!==e&&(e=h,t&&s(h))}return e},o.prototype.getUnit=function(){var e,t,n=this.props;if(n.unitOptions&&n.unitOptions.length){var r=f(n.unitOptions).map(function(e){return e.value});if(n.value&&typeof n.value==`string`){var i=r[0];r.sort(function(e,t){return t.length-e.length});try{for(var a=w(r),o=a.next();!o.done;o=a.next()){var s=o.value;if(n.value.endsWith(s)){i=s;break}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return i}else return r[0]}},o.prototype.getValue=function(e){var t=this.props,n=t.resetValue,r=t.unitOptions;if(!(e&&typeof e!=`number`&&typeof e!=`string`))return e!==null&&r&&this.state.unit&&(e+=String(this.state.unit)),e===null?n??null:e},o.prototype.dispatchEvent=function(e){return g(this,void 0,void 0,function(){var t,n,r;return u(this,function(i){return t=this.props,n=t.dispatchEvent,r=t.value,n(e,l(this.props,{value:r})),[2]})})},o.prototype.handleChange=function(e){return g(this,void 0,void 0,function(){var t,n,r,i,a,o,s;return u(this,function(c){switch(c.label){case 0:return t=this.props,n=t.onChange,r=t.dispatchEvent,i=t.clearValueOnEmpty,a=this.getValue(e),o=i&&a===``?void 0:a,o=this.formatNumber(o),[4,r(`change`,l(this.props,{value:o}))];case 1:return s=c.sent(),s?.prevented||n(o),[2]}})})},o.prototype.changeCursorPos=function(e){var t,n;if(!isNaN(e)){var r=this.props,i=r.kilobitSeparator,a=r.prefix,o=e>0?Math.floor(e):Math.ceil(e),s=`${e}`.length;if(a&&(s+=a.length),i){var c=Math.floor((`${Math.abs(o)}`.length-1)/3);c>0&&(s+=c)}this.input&&(i||a)&&((n=(t=this.input).setSelectionRange)==null||n.call(t,s,s))}},o.prototype.filterNum=function(e,t){if(t===void 0&&(t=!1),e!==void 0)return typeof e!=`number`&&(e=S(e,this.props.data),e=/^[-]?\d+/.test(e)?t?e:+e:void 0),e},o.prototype.handleChangeUnit=function(e){var t=this,n=this.props.value,r=this.state.unit;this.setState({unit:e.value},function(){n&&(n=n.toString().replace(r,``),t.props.onChange(n+t.state.unit))})},o.prototype.componentDidUpdate=function(e){var t=this.getUnit(),n=this.props,r=n.value,i=n.formInited,a=n.onChange,o=n.setPrinstineValue;if(r!=null&&(typeof r==`string`||typeof r==`number`)&&t&&!String(r).endsWith(t)){var s=this.getValue(r);i===!1?o?.(s):a?.(s)}this.props.value!==e.value&&/^([-+]?(([1-9]\d*\.?\d*)|(0\.\d*[1-9]))[^\d\.]*)$/.test(this.props.value)&&this.setState({unit:t}),this.props.unitOptions!==e.unitOptions&&this.setState({unitOptions:f(this.props.unitOptions)})},o.prototype.inputRef=function(e){this.input=e},o.prototype.focus=function(){this.input&&this.input.focus()},o.prototype.render=function(){var e,n=this,r=this.props,i=r.className,a=r.style,o=r.classPrefix,s=r.value,c=r.step,l=r.precision,u=r.max,f=r.min,p=r.disabled,m=r.placeholder,g=r.showSteps,y=r.borderMode,S=r.suffix,w=r.prefix,D=r.kilobitSeparator,O=r.unitOptions,k=r.readOnly,A=r.keyboard,j=r.displayMode,M=r.big,N=r.resetValue,P=r.clearValueOnEmpty,F=r.css,I=r.themeCss,L=r.inputControlClassName,R=r.id,z=r.env,B=r.name,V=r.showAsPercent,H=r.testIdBuilder,U=r.popOverContainer,W=this.state.unit,G=this.filterNum(l),K=D||w||S?function(e,t){var r=t.userTyping,i=t.input;if(D&&e)if((r||n.input===document.activeElement)&&v(e)===v(n.input?.value)){var a=e.toString().split(`.`);a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,`,`),e=a.join(`.`)}else e=_(e,G);return S&&r&&n.input?.selectionStart===i.length?`${w||``}${e}`:`${w||``}${e}${S||``}`}:void 0,q=function(e){return e&&(w&&(e=e.replace(w,``)),S&&(e=e.replace(S,``)),D&&(e=e.replace(/,/g,``))),e},J=W&&s&&typeof s==`string`?s.replace(W,``):isNaN(s)?void 0:s;return T.createElement(`div`,{className:(0,E.default)(`${o}NumberControl`,(e={},e[`${o}NumberControl--withUnit`]=O,e),i),style:a},T.createElement(d,{name:B,inputControlClassName:(0,E.default)(L,x(t(t({},this.props),{name:`inputControlClassName`,id:R,themeCss:I||F})),x(t(t({},this.props),{name:`inputControlClassName`,id:R,themeCss:I||F,extra:`inner`}))),inputRef:this.inputRef,value:J,resetValue:N,step:c,max:this.filterNum(u,M),min:this.filterNum(f,M),formatter:K,parser:q,onChange:this.handleChange,disabled:p,placeholder:m,precision:G,showSteps:g,borderMode:y,readOnly:k,suffix:S,showAsPercent:V,onFocus:function(){return n.dispatchEvent(`focus`)},onBlur:function(){return n.dispatchEvent(`blur`)},keyboard:A,displayMode:j,big:M,clearValueOnEmpty:P,testIdBuilder:H}),Array.isArray(O)&&O.length!==0?O.length>1?T.createElement(h,{value:W,clearable:!1,options:this.state.unitOptions||[],onChange:this.handleChangeUnit,className:`${o}NumberControl-unit`,disabled:p,popOverContainer:U}):T.createElement(`div`,{className:(0,E.default)(`${o}NumberControl-unit`,`${o}NumberControl-single-unit`,`${o}Select`,`${k?`${o}NumberControl-readonly`:``}`)},typeof O[0]==`string`?O[0]:O[0].label):null,T.createElement(b,t({},this.props,{config:{themeCss:I||F,classNames:[{key:`inputControlClassName`,weights:{focused:{pre:`${o}Number-${j?j+`-`:``}focused.`},disabled:{pre:`${o}Number-${j?j+`-`:``}disabled.`}}}],id:R},env:z})),T.createElement(b,t({},this.props,{config:{themeCss:C(I||F),classNames:[{key:`inputControlClassName`,weights:{default:{inner:`input`},hover:{inner:`input`},focused:{pre:`${o}Number-${j?j+`-`:``}focused.`,inner:`input`},disabled:{pre:`${o}Number-${j?j+`-`:``}disabled.`,inner:`input`}}}],id:R&&R+`-inner`},env:z})))},o.defaultProps={step:1,resetValue:``,clearValueOnEmpty:!1},s([n,r(`design:type`,Function),r(`design:paramtypes`,[String]),r(`design:returntype`,Promise)],o.prototype,`dispatchEvent`,null),s([n,r(`design:type`,Function),r(`design:paramtypes`,[Number]),r(`design:returntype`,void 0)],o.prototype,`changeCursorPos`,null),s([n,r(`design:type`,Function),r(`design:paramtypes`,[Object]),r(`design:returntype`,void 0)],o.prototype,`inputRef`,null),s([a(),r(`design:type`,Function),r(`design:paramtypes`,[]),r(`design:returntype`,void 0)],o.prototype,`render`,null),o}(T.Component),O=function(e){c(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.defaultProps=t({validations:`isNumeric`},D.defaultProps),n=s([m({type:`input-number`,detectProps:[`unitOptions`,`precision`,`suffix`]})],n),n}(D);export{O as NumberControlRenderer,D as default};