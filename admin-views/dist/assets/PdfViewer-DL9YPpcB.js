const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PdfViewer-CW4lN0kg.js","assets/index-DAdqRbKX.js","assets/index-C-Yoix6T.css"])))=>i.map(i=>d[i]);
import{$o as e,Ci as t,Fo as n,Ia as r,Ko as i,La as a,Mo as o,No as s,Po as c,Tr as l,jo as u,kr as d,ti as f,wr as p,za as m}from"./index-DAdqRbKX.js";var h=e(i()),g=h.lazy(function(){return m(()=>import(`./PdfViewer-CW4lN0kg.js`),__vite__mapDeps([0,1,2]))}),_=function(e){s(i,e);function i(t){var n=e.call(this,t)||this;return n.wrapper=h.createRef(),n.state={inited:!1,loading:!1,error:!1},n}return i.prototype.componentDidMount=function(){this.wrapper.current&&this.setState({width:this.wrapper.current.clientWidth-100}),this.renderPdf()},i.prototype.componentDidUpdate=function(e){var t=this,n=this.props;(f(e.src,n.src,e.data,n.data)||a(n.src,n.data,`| raw`)!==a(e.src,e.data,`| raw`))&&(this.abortLoad(),setTimeout(function(){t.fetchPdf()},0)),r(n.data,n.name)&&r(e.data,e.name)!==r(n.data,n.name)&&(this.abortLoad(),this.renderPdf())},i.prototype.componentWillUnmount=function(){this.abortLoad()},i.prototype.abortLoad=function(){this.fetchCancel&&=(this.fetchCancel(`load canceled`),void 0),this.reader&&=(this.reader.abort(),void 0)},i.prototype.renderPdf=function(){return u(this,void 0,void 0,function(){var e,t,n,i;return c(this,function(a){switch(a.label){case 0:return e=this.props,t=e.src,n=e.name,i=e.data,this.setState({error:!1}),t?this.file?[3,2]:[4,this.fetchPdf()]:[3,3];case 1:a.sent(),a.label=2;case 2:return[3,5];case 3:return r(i,n)?[4,this.renderFormFile()]:[3,5];case 4:a.sent(),a.label=5;case 5:return[2]}})})},i.prototype.fetchPdf=function(){return u(this,void 0,void 0,function(){var e,t,n,r,i,o,s,l,u=this;return c(this,function(c){switch(c.label){case 0:if(e=this.props,t=e.env,n=e.src,r=e.data,e.translate,n&&(o=a(n,r,`| raw`),typeof o==`string`?i=o:typeof o==`object`&&typeof o.value==`string`&&(i=o.value)),!i)return console.warn(`file src is empty`),[2];this.setState({inited:!0,loading:!0,error:!1}),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,t.fetcher(i,r,{responseType:`arraybuffer`,cancelExecutor:function(e){return u.fetchCancel=e}})];case 2:return s=c.sent(),this.file=s.data,this.forceUpdate(),[3,5];case 3:return l=c.sent(),this.setState({error:!0}),console.error(l),[3,5];case 4:return this.setState({loading:!1}),[7];case 5:return[2]}})})},i.prototype.renderFormFile=function(){return u(this,void 0,void 0,function(){var e,t,n,i,a,o=this;return c(this,function(s){return e=this.props,t=e.name,n=e.data,i=r(n,t),this.setState({inited:!0,loading:!0}),i instanceof File&&(a=new FileReader,a.onload=function(e){o.file=a.result,o.setState({loading:!1}),o.forceUpdate()},a.onerror=function(e){o.setState({error:!0})},a.readAsArrayBuffer(i),this.reader=a),[2]})})},i.prototype.renderEmpty=function(){var e=this.props,t=e.src,n=e.name;return!t&&!n?h.createElement(`svg`,{width:`100%`,height:`100`,xmlns:`http://www.w3.org/2000/svg`},h.createElement(`rect`,{x:`0`,y:`0`,width:`100%`,height:`100`,style:{fill:`#F7F7F9`}}),h.createElement(`text`,{x:`50%`,y:`50%`,fontSize:`18`,textAnchor:`middle`,alignmentBaseline:`middle`,fontFamily:`monospace, sans-serif`,fill:`#555555`},`PDF viewer`)):null},i.prototype.renderError=function(){var e=this.props,t=e.src,n=e.translate;return this.state.error&&t?h.createElement(`div`,null,n(`loadingFailed`)+` url:`+t):null},i.prototype.renderTip=function(){return h.createElement(`div`,null,h.createElement(`p`,null,"[PdfViewer]: pdfjsWorkerSrc is required, Please set the `pdfjsWorkerSrc` in setGlobalOptions function."))},i.prototype.render=function(){var e=this.props,t=e.className,n=e.classnames;e.translate;var r=e.height,i=e.background,a=l().pdfjsWorkerSrc,o=this.state,s=o.loading,c=o.inited,u=o.error,d=Math.max(this.props.width||this.state.width,300);return h.createElement(`div`,{ref:this.wrapper},this.renderEmpty(),a?h.createElement(h.Suspense,{fallback:h.createElement(`div`,null,`...`)},c&&!u?h.createElement(g,{file:this.file,loading:s,className:t,classnames:n,width:d,height:r,background:i}):null):this.renderTip(),this.renderError())},o([t,n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,void 0)],i.prototype,`abortLoad`,null),o([t,n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,Promise)],i.prototype,`renderPdf`,null),o([t,n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,Promise)],i.prototype,`fetchPdf`,null),o([t,n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,Promise)],i.prototype,`renderFormFile`,null),o([t,n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,void 0)],i.prototype,`renderEmpty`,null),o([t,n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,void 0)],i.prototype,`renderError`,null),o([t,n(`design:type`,Function),n(`design:paramtypes`,[]),n(`design:returntype`,void 0)],i.prototype,`renderTip`,null),i}(h.Component),v=function(e){s(t,e);function t(t,n){var r=e.call(this,t)||this;return n.registerComponent(r),r}return t.prototype.componentWillUnmount=function(){var t;(t=e.prototype.componentWillUnmount)==null||t.call(this),this.context.unRegisterComponent(this)},t.contextType=d,t=o([p({type:`pdf-viewer`}),n(`design:paramtypes`,[Object,Object])],t),t}(_);export{g as PdfView,v as PdfViewerRenderer,_ as default};