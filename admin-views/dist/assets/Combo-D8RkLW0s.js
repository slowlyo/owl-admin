import{t as W,bd as L,as as ae,a4 as K,z as V,aI as ne,aS as U,al as ce,w as Y,x as R,am as z,G as O,H as w,cn as re,bE as q,aE as fe,au as he,av as ie,ax as pe,b4 as be,ah as H,aM as le,aL as J,co as se,l as h,cp as ve,M as _,cq as ge,L as oe,aP as $,y as G,aw as Q,cr as ye,p as Ce,D as j,Q as de,T as M,a2 as X,cm as Z,bi as Ie,cs as ue,Y as Ve,ct as Ae,cu as Ee,cv as Ne,a$ as Se,aK as xe}from"./index-mmejWJJO.js";function me(P,c){return c.reduce(function(t,e){return t[e]=Ie(e,P),t},{})}var ee=function(P){W(c,P);function c(t){var e=P.call(this,t)||this;e.subFormDefaultValues=[],e.keys=[],e.toDispose=[],e.id=L(),e.refsMap={},e.makeFormRef=ae(function(l){return function(o){return e.formRef(o,l)}}),e.memoizedFormatValue=ae(function(l,o,i,d,m){return K(ne(m,V({index:d,__index:d},m)),V(V({},i),Array.isArray(o)?me(m,o):null))},function(l,o,i,d,m){return Array.isArray(o)?JSON.stringify([i,d,m,me(m,o)]):JSON.stringify(l?[i,d]:[i,d,m])}),e.handleChange=e.handleChange.bind(e),e.handleRadioChange=e.handleRadioChange.bind(e),e.handleSingleFormChange=e.handleSingleFormChange.bind(e),e.handleSingleFormInit=e.handleSingleFormInit.bind(e),e.handleFormInit=e.handleFormInit.bind(e),e.handleAction=e.handleAction.bind(e),e.addItem=e.addItem.bind(e),e.deleteItem=e.deleteItem.bind(e),e.dragTipRef=e.dragTipRef.bind(e),e.flush=e.flush.bind(e),e.handleComboTypeChange=e.handleComboTypeChange.bind(e),e.handleSubFormValid=e.handleSubFormValid.bind(e),e.defaultValue=V({},t.scaffold);var n=t.store;t.value;var r=t.multiple,a=t.formItem,s=t.addHook;return n.config({multiple:r,minLength:e.resolveVariableProps(t,"minLength"),maxLength:e.resolveVariableProps(t,"maxLength"),length:e.getValueAsArray(t).length}),typeof t.perPage=="number"&&t.perPage>0&&n.changePage(1,t.perPage),a&&U(a)&&a.setSubStore(n),s&&e.toDispose.push(s(e.flush,"flush")),e}return c.prototype.componentDidUpdate=function(t){var e=this.props;if(ce(["minLength","maxLength","value"],t,e)||this.resolveVariableProps(t,"minLength")!==this.resolveVariableProps(e,"minLength")||this.resolveVariableProps(t,"maxLength")!==this.resolveVariableProps(e,"maxLength")){var n=e.store,r=e.multiple,a=this.getValueAsArray(e);n.config({multiple:r,minLength:this.resolveVariableProps(e,"minLength"),maxLength:this.resolveVariableProps(e,"maxLength"),length:a.length}),n.activeKey>=a.length&&n.setActiveKey(Math.max(0,a.length-1)),e.value!==t.value&&!t.formInited&&this.subFormDefaultValues.length&&(this.subFormDefaultValues=this.subFormDefaultValues.map(function(s,l){return V(V({},s),{values:a[l]})}))}t.perPage!==e.perPage&&e.store.changePage(1,typeof e.perPage=="number"?e.perPage:0)},c.prototype.componentWillUnmount=function(){var t,e,n,r,a=this.props.formItem;a&&U(a)&&a.setSubStore(null),this.toDispose.forEach(function(s){return s()}),this.toDispose=[],(e=(t=this.memoizedFormatValue.cache).clear)===null||e===void 0||e.call(t),(r=(n=this.makeFormRef.cache).clear)===null||r===void 0||r.call(n)},c.prototype.resolveVariableProps=function(t,e){var n={minLength:0,maxLength:1/0},r=t[e];if(!r)return n[e];if(typeof r=="string")if(Y(r)){var a=R(r,t.data,"| raw");r=typeof a=="number"&&a>=0?a:n[e]}else{var s=parseInt(r,10);r=isNaN(s)?n[e]:s}return r},c.prototype.doAction=function(t,e,n,r){var a,s,l,o,i=t==null?void 0:t.actionType,d=this.props,m=d.onChange,b=d.resetValue,u=d.formStore,p=d.store,v=d.name;if(i==="addItem")this.addItemValue((a=r==null?void 0:r.item)!==null&&a!==void 0?a:{});else if(i==="clear")m("");else if(i==="reset"){var C=(o=z((s=u==null?void 0:u.pristine)!==null&&s!==void 0?s:(l=p==null?void 0:p.parentStore)===null||l===void 0?void 0:l.pristine,v))!==null&&o!==void 0?o:b;m(C??"")}},c.prototype.addItemValue=function(t){var e=this.props,n=e.flat,r=e.joinValues,a=e.addattop,s=e.delimiter,l=e.disabled,o=e.submitOnChange;if(!l){var i=this.getValueAsArray();a===!0?(this.keys.unshift(L()),i.unshift(t)):(i.push(t),this.keys.push(L())),n&&r&&(i=i.join(s||",")),this.props.onChange(i,o,!0)}},c.prototype.getValueAsArray=function(t){t===void 0&&(t=this.props);var e=t.flat,n=t.joinValues,r=t.delimiter;t.type,t.formItem;var a=t.getValue();return n&&e&&typeof a=="string"?a=a.split(r||","):Array.isArray(a)?a=a.concat():a=[],a},c.prototype.addItemWith=function(t){var e,n,r=this.props,a=r.flat,s=r.joinValues,l=r.addattop,o=r.delimiter,i=r.scaffold,d=r.disabled,m=r.submitOnChange,b=r.store;if(!d){var u=this.getValueAsArray();u.push(a?(n=(e=t.scaffold)!==null&&e!==void 0?e:i)!==null&&n!==void 0?n:"":V({},t.scaffold||i)),this.keys.push(L()),a&&s&&(u=u.join(o||",")),l===!0?(this.keys.unshift(this.keys.pop()),u.unshift(u.pop()),b.changePage(1)):b.perPage&&b.changePage(Math.ceil(u.length/b.perPage)),this.props.onChange(u,m,!0)}},c.prototype.addItem=function(){return O(this,void 0,void 0,function(){var t,e,n,r,a,s,l,o,i,d,m,b,u;return w(this,function(p){switch(p.label){case 0:return t=this.props,e=t.flat,n=t.joinValues,r=t.addattop,a=t.delimiter,s=t.scaffold,l=t.disabled,o=t.submitOnChange,i=t.dispatchEvent,d=t.store,l?[2]:(m=this.getValueAsArray(),[4,i("add",H(this.props,{value:e&&n?m.join(a||","):ue(m)}))]);case 1:return b=p.sent(),b!=null&&b.prevented?[2]:(m.push(e?s??"":V({},s)),this.keys.push(L()),e&&n&&(m=m.join(a||",")),u=this.keys.length-1,r===!0?(this.keys.unshift(this.keys.pop()),m.unshift(m.pop()),u=0,d.changePage(1)):d.perPage&&d.changePage(Math.ceil(m.length/d.perPage)),d.setActiveKey(u),this.props.onChange(m,o,!0),[2])}})})},c.prototype.deleteItem=function(t){var e,n;return O(this,void 0,void 0,function(){var r,a,s,l,o,i,d,m,b,u,p,v,C,f,A,I,g,E,N;return w(this,function(y){switch(y.label){case 0:return r=this.props,a=r.flat,s=r.joinValues,l=r.delimiter,o=r.disabled,i=r.deleteApi,d=r.deleteConfirmText,m=r.data,b=r.env,u=r.translate,p=r.dispatchEvent,v=r.submitOnChange,C=r.store,o?[2]:(f=this.getValueAsArray(),A=K(m,f[t]),[4,p("delete",H(this.props,{key:t,value:a&&s?f.join(l||","):ue(f),item:f[t]}))]);case 1:return I=y.sent(),I!=null&&I.prevented?[2]:Ve(i,A)?[4,b.confirm(d?oe(d,A):u("deleteConfirm"))]:[3,4];case 2:return g=y.sent(),g?[4,b.fetcher(i,A)]:[2];case 3:if(E=y.sent(),!E.ok)return!(i!=null&&i.silent)&&b.notify("error",(n=(e=i==null?void 0:i.messages)===null||e===void 0?void 0:e.failed)!==null&&n!==void 0?n:u("deleteFailed")),[2];y.label=4;case 4:return this.keys.splice(t,1),f.splice(t,1),N=C.perPage?1:Math.ceil(f.length/C.perPage),C.page>N&&C.changePage(N),a&&s&&(f=f.join(l||",")),this.props.onChange(f,v,!0),[2]}})})},c.prototype.handleChange=function(t,e,n){var r,a,s,l,o=n.index,i=this.props,d=i.flat,m=i.store,b=i.joinValues,u=i.delimiter,p=i.disabled,v=i.submitOnChange,C=i.type,f=i.syncFields,A=i.name;if(!p){Array.isArray(f)&&f.forEach(function(F){A!=null&&A.startsWith(F)&&(t=V({},t),re(t,A))});var I=this.getValueAsArray();if(I[o]=d?t.flat:V({},t),d&&b&&(I=I.join(u||",")),C==="input-kv"){var g=!1,E={};try{for(var N=q(I),y=N.next();!y.done;y=N.next()){var x=y.value;x.key!=null&&E[x.key]?g=!0:E[x.key]=!0}}catch(F){r={error:F}}finally{try{y&&!y.done&&(a=N.return)&&a.call(N)}finally{if(r)throw r.error}}g||this.props.onChange(I,v,!0)}else if(C==="input-kvs"){var g=!1,E={};try{for(var S=q(I),k=S.next();!k.done;k=S.next()){var x=k.value;"_key"in x&&(E[x._key]?g=!0:E[x._key]=!0)}}catch(T){s={error:T}}finally{try{k&&!k.done&&(l=S.return)&&l.call(S)}finally{if(s)throw s.error}}g||this.props.onChange(I,v,!0)}else this.props.onChange(I,v,!0);m.forms.forEach(function(F){return U(F)&&F.items.forEach(function(B){return B.unique&&B.syncOptions(void 0,F.data)})})}},c.prototype.handleRadioChange=function(t,e){var n=e.index,r=e.name,a=e.trueValue,s=a===void 0?!0:a,l=e.falseValue,o=l===void 0?!1:l,i=this.props,d=i.onChange,m=i.submitOnChange,b=i.multiple,u=i.disabled;if(!(!b||u||!r)){var p=this.getValueAsArray();if(!(!Array.isArray(p)||p.length<2||!fe(p[0])))return p=p.map(function(v,C){var f;return V(V({},v),(f={},f[r]=C===n?s:o,f))}),d(p,m,!0),!1}},c.prototype.handleSingleFormChange=function(t){this.props.value===null&&he(this.defaultValue,t)||this.props.onChange(V({},t),this.props.submitOnChange,!0)},c.prototype.handleSubFormValid=function(t,e){var n=e.index,r=this.props.store;r.setMemberValid(t,n)},c.prototype.handleFormInit=function(t,e){var n,r=e.index,a=this.props,s=a.syncDefaultValue,l=a.flat,o=a.joinValues,i=a.delimiter,d=a.formInited,m=a.onChange,b=a.submitOnChange,u=a.setPrinstineValue,p=a.formItem,v=a.name,C=a.syncFields;if(Array.isArray(C)&&C.forEach(function(I){v!=null&&v.startsWith(I)&&(t=V({},t),re(t,v))}),p!=null&&p.validated&&((n=this.subForms[r])===null||n===void 0||n.validate(!0,!1,!1)),this.subFormDefaultValues.push({index:r,values:t,setted:!1}),!(s===!1||this.subFormDefaultValues.length!==this.subForms.filter(function(I){return I!==void 0}).length)){var f=this.getValueAsArray(),A=!1;this.subFormDefaultValues=this.subFormDefaultValues.map(function(I){var g=I.index,E=I.values,N=I.setted,y=l?E.flat:V({},E);return!N&&ie(f[g],y)&&(f[g]=l?E.flat:V({},E),A=!0),{index:g,values:E,setted:!0}}),A&&(l&&o&&(f=f.join(i||",")),d?m(f,b,!0):u(f))}},c.prototype.handleSingleFormInit=function(t){var e=this.props,n=e.syncDefaultValue,r=e.setPrinstineValue,a=e.value,s=e.nullable;n!==!1&&!s&&ie(a,t)&&r(V({},t))},c.prototype.handleAction=function(t,e){var n=this.props.onAction;if(e.actionType==="delete"){e.index!==void 0&&this.deleteItem(e.index);return}n&&n.apply(null,arguments)},c.prototype.validate=function(){var t=this,e=this.props,n=e.messages,r=e.nullable,a=e.value,s=e.translate,l=e.store,o=e.flat,i=this.getValueAsArray(),d=this.resolveVariableProps(this.props,"minLength"),m=this.resolveVariableProps(this.props,"maxLength");if(d&&(!Array.isArray(i)||i.length<d))return s(n&&n.minLengthValidateFailed||"Combo.minLength",{minLength:d});if(m&&Array.isArray(i)&&i.length>m)return s(n&&n.maxLengthValidateFailed||"Combo.maxLength",{maxLength:m});if(r&&!a)return;if(i.length){var b=this.subForms;return Promise.all(i.map(function(u,p){return O(t,void 0,void 0,function(){var v,C,f,A,I,g,E,N,y,x,S,k;return w(this,function(F){switch(F.label){case 0:return v=this.refsMap[p],v?[2,v.validate(!0,!1,!1)]:[3,1];case 1:if(C=b[Object.keys(b)[0]],!C)return[3,10];f=C.props.store,A=!1,F.label=2;case 2:F.trys.push([2,7,8,9]),I=q(f.items),g=I.next(),F.label=3;case 3:return g.done?[3,6]:(E=g.value,N=Ee(E),y=o?u:z(u,E.name,!1),E.extraName&&!o&&(y=[z(u,E.name,!1),z(u,E.extraName,!1)]),N.changeTmpValue(y,"dataChanged"),[4,N.validate(u)]);case 4:if(A=F.sent(),Ae(N),A===!1)return[3,6];F.label=5;case 5:return g=I.next(),[3,3];case 6:return[3,9];case 7:return x=F.sent(),S={error:x},[3,9];case 8:try{g&&!g.done&&(k=I.return)&&k.call(I)}finally{if(S)throw S.error}return[7];case 9:return l.setMemberValid(A,p),[2,A];case 10:return[2]}})})})).then(function(u){var p=u.indexOf(!1);if(~p)return l.perPage&&l.changePage(Math.ceil(p/l.perPage)),s(n&&n.validateFailed||"validateFailed")})}else if(this.subForms.length)return Promise.all(this.subForms.map(function(u){return u.validate(!0,!1,!1)})).then(function(u){if(~u.indexOf(!1))return s(n&&n.validateFailed||"validateFailed")})},c.prototype.flush=function(){return O(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Promise.all(this.subForms.map(function(e){return e.flush()}))];case 1:return t.sent(),[2]}})})},c.prototype.dragTipRef=function(t){!this.dragTip&&t?this.initDragging():this.dragTip&&!t&&this.destroyDragging(),this.dragTip=t},c.prototype.initDragging=function(){var t=this,e=this.props.classPrefix,n=this.props.submitOnChange,r=pe.findDOMNode(this);this.sortable=new be(r.querySelector(".".concat(e,"Combo-items")),{group:"combo-".concat(this.id),animation:150,handle:".".concat(e,"Combo-itemDrager"),ghostClass:"".concat(e,"Combo-item--dragging"),onEnd:function(a){if(a.newIndex!==a.oldIndex){var s=a.to;a.oldIndex<s.childNodes.length-1?s.insertBefore(a.item,s.childNodes[a.oldIndex>a.newIndex?a.oldIndex+1:a.oldIndex]):s.appendChild(a.item);var l=t.props.value;if(Array.isArray(l)){var o=l.concat();o.splice(a.newIndex,0,o.splice(a.oldIndex,1)[0]),t.keys.splice(a.newIndex,0,t.keys.splice(a.oldIndex,1)[0]),t.props.onChange(o,n,!0),t.props.dispatchEvent("dragEnd",H(t.props,{item:o[a.newIndex],value:o,index:a.newIndex,oldValue:l,oldIndex:a.oldIndex}))}}}})},c.prototype.destroyDragging=function(){this.sortable&&this.sortable.destroy()},Object.defineProperty(c.prototype,"subForms",{get:function(){var t=this;return Object.keys(this.refsMap).map(function(e){return parseInt(e,10)}).sort().map(function(e){return t.refsMap[e]})},enumerable:!1,configurable:!0}),c.prototype.formRef=function(t,e){if(e===void 0&&(e=0),t){for(;t&&t.getWrappedInstance;)t=t.getWrappedInstance();this.refsMap[e]=t}else this.refsMap[e],this.subFormDefaultValues=this.subFormDefaultValues.filter(function(n){var r=n.index;return r!==e}),delete this.refsMap[e]},c.prototype.formatValue=function(t,e){e===void 0&&(e=-1);var n=this.props,r=n.flat,a=n.data,s=n.strictMode,l=n.syncFields;return r&&(t={flat:t}),t=t||this.defaultValue,this.memoizedFormatValue(s!==!1,l,t,e,a)},c.prototype.pickCondition=function(t){var e=this.props.conditions;return le(e,function(n){return n.test&&J(n.test,t)})},c.prototype.handleComboTypeChange=function(t,e){var n=this.props,r=n.multiple,a=n.onChange,s=n.value;n.flat;var l=n.submitOnChange,o=this.props.conditions,i=le(o,function(m){return m.label===e.label});if(i)if(r){var d=this.getValueAsArray();d.splice(t,1,V({},se(i.scaffold||{},d[t]))),a(d,l,!0)}else a(V({},se(i.scaffold||{},s)),l,!0)},c.prototype.handleTabSelect=function(t){return O(this,void 0,void 0,function(){var e,n,r,a,s,l,o,i,d;return w(this,function(m){switch(m.label){case 0:return e=this.props,n=e.store,r=e.data,a=e.name,s=e.value,l=e.dispatchEvent,o={key:t,item:s[t]},[4,l("tabsChange",K(r,a?V(V({},o),(d={},d[a]=s,d)):o))];case 1:return i=m.sent(),i!=null&&i.prevented?[2]:(n.setActiveKey(t),[2])}})})},c.prototype.setNull=function(t){t.preventDefault();var e=this.props.onChange;e(null),this.subForms.forEach(function(n){n.clearErrors()})},c.prototype.renderPlaceholder=function(){var t=this.props,e=t.placeholder,n=t.translate;return h.createElement("span",{className:"text-muted"},n(e||"placeholder.noData"))},c.prototype.renderTabsMode=function(){var t=this,e=this.props;e.classPrefix;var n=e.classnames,r=e.tabsStyle;e.formClassName,e.render;var a=e.disabled,s=e.store,l=e.flat;e.subFormMode,e.addButtonText;var o=e.addable,i=e.removable,d=e.typeSwitchable,m=e.itemRemovableOn,b=e.delimiter;e.canAccessSuperData,e.addIcon;var u=e.deleteIcon,p=e.tabsLabelTpl,v=e.conditions;e.changeImmediately;var C=e.addBtnText;e.static;var f=e.translate,A=e.testIdBuilder,I=this.props.items,g=this.props.value;l&&typeof g=="string"&&(g=g.split(b||","));var E=s.removable!==!1&&!a&&i!==!1;return Array.isArray(g)||(g=[]),h.createElement(ve,{addBtnText:f(C||"add"),className:"ComboTabs",mode:r,activeKey:s.activeKey,onSelect:this.handleTabSelect,testIdBuilder:A,additionBtns:!a&&o!==!1&&s.addable?h.createElement("li",{className:n("Tabs-link ComboTabs-addLink")},this.renderAddBtn()):null},g.map(function(N,y){var x=t.formatValue(N,y),S=A==null?void 0:A.getChild("tab-".concat(y)),k=null,F=void 0;E&&(!m||J(m,N)!==!1)&&(F=h.createElement("div",V({onClick:t.deleteItem.bind(t,y),key:"delete",className:n("Combo-tab-delBtn ".concat(s.removable?"":"is-disabled")),"data-tooltip":f("delete"),"data-position":"bottom"},S==null?void 0:S.getChild("delBtn").getTestId()),u?h.createElement("i",{className:u}):h.createElement(_,{icon:"status-close",className:"icon"}))),Array.isArray(v)&&v.length&&(k=t.pickCondition(x),I=k?k.items:void 0);var B=l&&I?[V(V({},I&&I[0]),{name:"flat"})]:I,T=Array.isArray(B)&&B.some(function(D){return D.unique});return t.keys[y]||t.keys.splice(y,0,L()),h.createElement(ge,{title:oe(p||f("{{index}}",{index:x.index+1}),x),key:t.keys[y],toolbar:F,eventKey:y,mountOnEnter:!T,unmountOnExit:!1,className:s.memberValidMap[y]===!1?"has-error":"",tabClassName:s.memberValidMap[y]===!1?"has-error":"",testIdBuilder:S},k&&d!==!1?h.createElement("div",{className:n("Combo-itemTag")},h.createElement("label",null,f("Combo.type")),h.createElement($,{onChange:t.handleComboTypeChange.bind(t,y),options:v.map(function(D){return{label:D.label,value:D.label}}),value:k.label,clearable:!1})):null,h.createElement("div",{className:n("Combo-itemInner")},B?t.renderItems(B,x,y,N):h.createElement(G,{level:"warning",className:"m-b-none"},f("Combo.invalidData"))))}))},c.prototype.renderDelBtn=function(t,e){var n=this;if(this.props.static)return null;var r=this.props;r.classPrefix;var a=r.classnames,s=r.render,l=r.store,o=r.deleteIcon,i=r.translate,d=r.itemRemovableOn,m=r.disabled,b=r.removable,u=r.deleteBtn,p=r.mobileUI,v=r.data,C=r.testIdBuilder,f=C==null?void 0:C.getChild("delete-btn-".concat(e)),A=l.removable!==!1&&!m&&b!==!1;return A&&(!d||J(d,t)!==!1)?Q(u)?s("delete-btn",V(V({},u),{type:"button",className:a("Combo-delController",u?u.className:""),testIdBuilder:f,onClick:function(I){if(!u.onClick){n.deleteItem(e);return}var g=u.onClick;typeof g=="string"&&(g=ye(u.onClick,"e","index","props"));var E=g(I,e,n.props);E&&E.then?E.then(function(){n.deleteItem(e)}):n.deleteItem(e)}}),{data:ne(v,{index:e})}):typeof u=="string"?s("delete-btn",{type:"button",className:a("Combo-delController"),label:u,onClick:this.deleteItem.bind(this,e),testIdBuilder:f}):h.createElement("a",V({onClick:this.deleteItem.bind(this,e),key:"delete",className:a("Combo-delBtn ".concat(l.removable?"":"is-disabled")),"data-tooltip":p?null:i("delete"),"data-position":"bottom"},f==null?void 0:f.getTestId()),o?h.createElement("i",{className:o}):h.createElement(_,{icon:"status-close",className:"icon"})):null},c.prototype.renderAddBtn=function(){var t=this;if(this.props.static)return null;var e=this.props;e.classPrefix;var n=e.classnames,r=e.render,a=e.addButtonClassName,s=e.store,l=e.addButtonText,o=e.addBtn,i=e.addable,d=e.addIcon,m=e.conditions,b=e.translate,u=e.tabsMode,p=e.testIdBuilder,v=Array.isArray(m)&&m.length,C=p==null?void 0:p.getChild("add-button");return h.createElement(h.Fragment,null,s.addable&&i!==!1&&(v?r("add-button",{type:"dropdown-button",icon:d?h.createElement(_,{icon:"plus-fine",className:"icon"}):"",label:b(l||"add"),level:"info",size:"sm",closeOnClick:!0,btnClassName:a,testIdBuilder:C},{buttons:m==null?void 0:m.map(function(f){return{label:f.label,onClick:function(A){return t.addItemWith(f),!1}}})}):u?h.createElement("a",{onClick:this.addItem},d?h.createElement(_,{icon:"plus-fine",className:"icon"}):null,h.createElement("span",null,b(l||"add"))):Q(o)?r("add-button",V(V({},o),{type:"button",testIdBuilder:C,onClick:function(){return t.addItem()}})):h.createElement(Ce,{className:n("Combo-addBtn",a),onClick:this.addItem,testIdBuilder:C},d?h.createElement(_,{icon:"plus-fine",className:"icon"}):null,h.createElement("span",null,b(l||"add")))))},c.prototype.renderMultipe=function(){var t=this;if(this.props.tabsMode)return this.renderTabsMode();var e=this.props;e.classPrefix;var n=e.classnames,r=e.multiLine,a=e.disabled,s=e.flat,l=e.draggable,o=e.draggableTip,i=e.typeSwitchable,d=e.delimiter,m=e.dragIcon,b=e.noBorder,u=e.conditions,p=e.placeholder,v=e.translate,C=e.itemClassName,f=e.itemsWrapperClassName,A=e.static,I=e.mobileUI,g=e.store,E=e.render,N=this.props.items,y=this.props.value;return s&&typeof y=="string"&&(y=y.split(d||",")),h.createElement("div",{className:n("Combo Combo--multi",{"is-mobile":I},r?"Combo--ver":"Combo--hor",b?"Combo--noBorder":"",a?"is-disabled":"",!A&&!a&&l&&Array.isArray(y)&&y.length>1?"is-draggable":"")},h.createElement("div",{className:n("Combo-items",f)},Array.isArray(y)&&y.length?g.getRangeByPage(y).map(function(x,S,k){S+=g.offset;var F=t.renderDelBtn(x,S),B=t.formatValue(x,S),T=null;Array.isArray(u)&&u.length&&(T=t.pickCondition(B),N=T?T.items:void 0);var D=s&&N?[V(V({},N&&N[0]),{name:"flat"})]:N;return t.keys[S]||t.keys.splice(S,1,L()),h.createElement("div",{className:n("Combo-item",C,g.memberValidMap[S]===!1?"has-error":""),key:t.keys[S]},!A&&!a&&l&&k.length>1?h.createElement("div",{className:n("Combo-itemDrager")},h.createElement("a",{key:"drag","data-tooltip":v("Combo.dragDropSort"),"data-position":"bottom"},m?h.createElement("i",{className:m}):h.createElement(_,{icon:"drag-bar",className:"icon"}))):null,T&&i!==!1?h.createElement("div",{className:n("Combo-itemTag")},h.createElement("label",null,v("Combo.type")),h.createElement($,{onChange:t.handleComboTypeChange.bind(t,S),options:u.map(function(te){return{label:te.label,value:te.label}}),value:T.label,clearable:!1})):null,h.createElement("div",{className:n("Combo-itemInner")},D?t.renderItems(D,B,S,x):h.createElement(G,{level:"warning",className:"m-b-none"},v("Combo.invalidData"))),F)}):p?h.createElement("div",{className:n("Combo-placeholder")},v(p)):null),h.createElement("div",{className:n("Combo-toolbar")},!A&&!a?this.renderAddBtn():null,!A&&!a&&l?h.createElement("span",{className:n("Combo-dragableTip"),ref:this.dragTipRef},Array.isArray(y)&&y.length>1?v(o):""):null,g.multiplePage&&Array.isArray(y)&&y.length>g.perPage?E("pager",{type:"pagination"},{activePage:g.page,perPage:g.perPage,total:Array.isArray(y)?y.length:0,onPageChange:g.changePage,className:"Combo-pager",disabled:a}):null))},c.prototype.renderSingle=function(){var t=this.props,e=t.conditions,n=t.classnames,r=t.value,a=t.multiLine,s=t.noBorder,l=t.disabled,o=t.typeSwitchable,i=t.nullable,d=t.translate,m=t.itemClassName,b=t.mobileUI,u=t.store,p=this.props.items,v=Q(r)?this.formatValue(r):this.formatValue(this.defaultValue),C=null;return Array.isArray(e)&&e.length&&(C=this.pickCondition(v),p=C?C.items:void 0),h.createElement("div",{className:n("Combo Combo--single",{"is-mobile":b},a?"Combo--ver":"Combo--hor",s?"Combo--noBorder":"",l?"is-disabled":"")},h.createElement("div",{className:n("Combo-item",m,u.memberValidMap[0]===!1?"has-error":"")},C&&o!==!1?h.createElement("div",{className:n("Combo-itemTag")},h.createElement("label",null,d("Combo.type")),h.createElement($,{onChange:this.handleComboTypeChange.bind(this,0),options:e.map(function(f){return{label:f.label,value:f.label}}),value:C.label,clearable:!1})):null,h.createElement("div",{className:n("Combo-itemInner")},p?this.renderItems(p,v):h.createElement(G,{level:"warning",className:"m-b-none"},d("Combo.invalidData")))),r&&i?h.createElement("a",{className:n("Combo-setNullBtn"),href:"#",onClick:this.setNull},d("clear")):null)},c.prototype.renderItems=function(t,e,n,r){var a=this.props,s=a.classnames,l=a.formClassName,o=a.render,i=a.multiLine,d=a.disabled,m=a.canAccessSuperData,b=a.multiple,u=a.tabsMode,p=a.subFormMode,v=a.subFormHorizontal,C=a.changeImmediately,f=a.lazyLoad;a.translate;var A=a.static,I=a.testIdBuilder,g=a.updatePristineAfterStoreDataReInit,E=Array.isArray(t)?t.map(function(N,y){var x=n!==void 0&&n>=0?"-".concat(n):"",S="item-".concat(N.testid||N.id||y)+x;return V(V({},N),{testIdBuilder:I==null?void 0:I.getChild(S)})}):t;if(b){if(b&&n!==void 0&&n>=0)return o("multiple/".concat(n),{type:"form",body:E,wrapperComponent:"div",wrapWithPanel:!1,mode:u||i?p:"row",horizontal:v,className:s("Combo-form",l)},V(V({index:n,disabled:d,static:A,data:e,originData:r,onChange:this.handleChange,onInit:this.handleFormInit,onAction:this.handleAction,onRadioChange:this.handleRadioChange,ref:this.makeFormRef(n),onValidChange:this.handleSubFormValid,canAccessSuperData:m,lazyChange:!C,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0},u?{}:{lazyLoad:f}),{updatePristineAfterStoreDataReInit:g??!1}))}else return o("single",{type:"form",body:E,wrapperComponent:"div",wrapWithPanel:!1,mode:i?p||"normal":"row",horizontal:v,className:s("Combo-form",l)},{index:0,disabled:d,static:A,data:e,originData:r,onChange:this.handleSingleFormChange,ref:this.makeFormRef(0),onValidChange:this.handleSubFormValid,onInit:this.handleSingleFormInit,canAccessSuperData:m,lazyChange:!C,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0,updatePristineAfterStoreDataReInit:g??!1});return h.createElement(h.Fragment,null)},c.prototype.renderStatic=function(t){return this.props.render("static-input-kv",{type:"json"},this.props)},c.prototype.render=function(){var t=this.props,e=t.type,n=t.formInited,r=t.multiple,a=t.className;t.style,t.classPrefix;var s=t.classnames,l=t.static,o=t.staticSchema;return l&&(o||["input-kv","input-kvs"].includes(e))?this.renderStatic():n||typeof n>"u"?h.createElement("div",{className:s("ComboControl",a)},r?this.renderMultipe():this.renderSingle()):null},c.defaultProps={minLength:0,maxLength:1/0,multiple:!1,multiLine:!1,addButtonClassName:"",formClassName:"",subFormMode:"normal",draggableTip:"",addButtonText:"add",canAccessSuperData:!1,addIcon:!0,dragIcon:"",deleteIcon:"",tabsMode:!1,tabsStyle:"",placeholder:"placeholder.empty",itemClassName:"",itemsWrapperClassName:""},c.propsList=["minLength","maxLength","multiple","multiLine","addButtonClassName","subFormMode","draggableTip","addButtonText","draggable","scaffold","canAccessSuperData","addIcon","dragIcon","deleteIcon","noBorder","conditions","tabsMode","tabsStyle","lazyLoad","changeImmediately","strictMode","items","conditions","messages","formStore","itemClassName","itemsWrapperClassName"],j([de,M("design:type",Function),M("design:paramtypes",[Number]),M("design:returntype",Promise)],c.prototype,"handleTabSelect",null),j([de,M("design:type",Function),M("design:paramtypes",[Object]),M("design:returntype",void 0)],c.prototype,"setNull",null),c}(h.Component),Pe=function(P){W(c,P);function c(){return P!==null&&P.apply(this,arguments)||this}return c.prototype.setData=function(t,e,n,r){return O(this,void 0,void 0,function(){var a,s,l,o,i,d,m,b,u,p;return w(this,function(v){switch(v.label){case 0:return a=this.props,s=a.multiple,l=a.onChange,o=a.submitOnChange,s?(i=Se([],xe(this.getValueAsArray()),!1),d=i.length,n===void 0?[3,1]:(m=String(n).split(","),m.forEach(function(C){var f=Number(C);i.splice(f,1,V(V({},i[f]),t))}),l==null||l(i,o,!0),[3,7])):[3,8];case 1:if(r===void 0)return[3,6];b=0,v.label=2;case 2:return b<d?(u=i[b],[4,Ne(r,u)]):[3,5];case 3:p=v.sent(),p&&i.splice(b,1,V(V({},i[b]),t)),v.label=4;case 4:return b++,[3,2];case 5:return l==null||l(i,o,!0),[3,7];case 6:l==null||l(t,o,!0),v.label=7;case 7:return[3,9];case 8:l==null||l(t,o,!0),v.label=9;case 9:return[2]}})})},c=j([X({type:"combo",storeType:Z.name,extendsData:!1,shouldComponentUpdate:function(t,e){return Y(t.maxLength)&&R(e.maxLength,e.data)!==R(t.maxLength,t.data)||Y(t.minLength)&&R(e.minLength,e.data)!==R(t.minLength,t.data)}})],c),c}(ee),ke=function(P){W(c,P);function c(){return P!==null&&P.apply(this,arguments)||this}return c=j([X({type:"input-kv",storeType:Z.name,extendsData:!1})],c),c}(ee),Be=function(P){W(c,P);function c(){return P!==null&&P.apply(this,arguments)||this}return c=j([X({type:"input-kvs",storeType:Z.name,extendsData:!1})],c),c}(ee);export{Pe as ComboControlRenderer,ke as KVControlRenderer,Be as KVSControlRenderer,ee as default};
