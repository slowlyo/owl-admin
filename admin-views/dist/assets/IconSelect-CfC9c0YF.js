import{$o as e,Ao as t,Ci as n,Do as r,Fo as i,Gn as a,Hn as o,Kn as s,Ko as c,Mo as l,No as u,Po as d,Vn as f,Ya as p,Zt as m,fr as h,g,h as _,jo as v,m as y,ui as b}from"./index-C4Pf1uQ-.js";var x=e(c()),S=e(b()),C=e(r()),w=function(e){u(r,e);function r(t){var n=e.call(this,t)||this;return n.state={activeTypeIndex:0,showModal:!1,tmpCheckIconId:null,searchValue:``,isRefreshLoading:!1},n.handleSearchValueChange=(0,C.default)(n.handleSearchValueChange.bind(n),300),n}return r.prototype.getSvgName=function(e){return typeof e==`string`?/data-name="(.*?)"/.exec(e)?.[1]||``:e?.name||e?.id||``},r.prototype.getSvgId=function(e){return typeof e==`string`?/data-id="(.*?)"/.exec(e)?.[1]||``:e?.id||``},r.prototype.getValueBySvg=function(e){return e?typeof e==`string`?{name:this.getSvgName(e),id:this.getSvgId(e),svg:e.replace(/'/g,``)}:t(t({},e),{svg:e.svg?.replace(/'/g,``)}):null},r.prototype.handleClick=function(){this.props.disabled||this.toggleModel(!0)},r.prototype.handleClear=function(e){e.preventDefault(),e.stopPropagation(),this.props.onChange&&this.props.onChange(``)},r.prototype.renderInputArea=function(){var e=this.props,t=e.classPrefix,n=e.disabled,r=e.value,i=e.placeholder,a=e.clearable,o=this.getValueBySvg(r);return x.createElement(`div`,{className:(0,S.default)(`${t}IconSelectControl-input-area`)},x.createElement(`div`,{className:(0,S.default)(`${t}IconSelectControl-input-icon-show`)},x.createElement(s,{icon:o?.svg,className:`icon`})),x.createElement(`span`,{className:(0,S.default)(`${t}IconSelectControl-input-icon-id`)},o?.name),a&&!n&&o?x.createElement(`a`,{onClick:this.handleClear,className:(0,S.default)(`${t}IconSelectControl-clear`)},x.createElement(s,{icon:`input-clear`,className:`icon`})):null,!o&&i&&x.createElement(`span`,{className:(0,S.default)(`${t}IconSelectControl-input-icon-placeholder`)},i)||null)},r.prototype.handleIconTypeClick=function(e,t){this.setState({activeTypeIndex:t})},r.prototype.renderIconTypes=function(){var e=this,t=this.props.classPrefix,n=g.map(function(e){return{id:e.groupId,label:e.name}});return x.createElement(`ul`,{className:(0,S.default)(`${t}IconSelectControl-type-list`)},n.map(function(t,n){return x.createElement(`li`,{key:t.id,onClick:function(){return e.handleIconTypeClick(t,n)},className:(0,S.default)({active:n===e.state.activeTypeIndex})},t.label)}))},r.prototype.handleConfirm=function(){var e=this.state.tmpCheckIconId;if(this.props.returnSvg){var n=e&&e.svg||``;n=n.replace(/<svg/,`<svg data-name="${e?.name}" data-id="${e?.id}"`),this.props.noSize&&(n=n.replace(/width=".*?"/,``).replace(/height=".*?"/,``)),this.props.onChange&&this.props.onChange(n)}else this.props.onChange&&this.props.onChange(e&&e.id?t(t({},e),{id:`svg-`+e.id}):``);this.toggleModel(!1)},r.prototype.handleLocalUpload=function(e){return v(this,void 0,void 0,function(){return d(this,function(t){return this.props.onChange&&this.props.onChange(e),this.toggleModel(!1),[2]})})},r.prototype.handleClickIconInModal=function(e){this.setState({tmpCheckIconId:e?.id===this.state.tmpCheckIconId?.id?null:e})},r.prototype.renderIconList=function(e){var t=this,n=this.props,r=n.classPrefix,i=n.noDataTip,a=n.translate;return!e||!e.length?x.createElement(`p`,{className:(0,S.default)(`${r}IconSelectControl-icon-list-empty`)},a(i)):x.createElement(`ul`,{className:(0,S.default)(`${r}IconSelectControl-icon-list`)},e.map(function(e,n){return x.createElement(`li`,{key:e.id},x.createElement(`div`,{className:(0,S.default)(`${r}IconSelectControl-icon-list-item`,{active:t.state.tmpCheckIconId?.id===e.id}),onClick:function(){return t.handleClickIconInModal(e)}},x.createElement(`svg`,null,x.createElement(`use`,{xlinkHref:`#${e.id}`})),x.createElement(`div`,{className:(0,S.default)(`${r}IconSelectControl-icon-list-item-info`)},x.createElement(`p`,{className:(0,S.default)(`${r}IconSelectControl-icon-list-item-info-name`)},e.name))))}))},r.prototype.handleSearchValueChange=function(e){this.setState({searchValue:e})},r.prototype.handleRefreshIconList=function(){return v(this,void 0,void 0,function(){var e,t;return d(this,function(n){switch(n.label){case 0:if(e=_,!(e&&typeof e==`function`))return[3,5];n.label=1;case 1:return n.trys.push([1,3,4,5]),this.setState({isRefreshLoading:!0}),[4,Promise.resolve(e())];case 2:return n.sent(),[3,5];case 3:return t=n.sent(),console.error(t),[3,5];case 4:return this.setState({isRefreshLoading:!1}),[7];case 5:return[2]}})})},r.prototype.renderModalContent=function(){var e=this.props,t=e.render,n=e.classPrefix,r=e.loadingConfig;e.funcSchema;var i=e.funcCom,a=this.getIconsByType(),s=this.state.searchValue,c=s?p(a,s,{keys:[`name`],threshold:p.rankings.CONTAINS}):a;return x.createElement(x.default.Fragment,null,x.createElement(m,{className:(0,S.default)(`${n}IconSelectControl-Modal-search`),mini:!1,clearable:!0,onChange:this.handleSearchValueChange}),_&&t(`refresh-btn`,{type:`button`,icon:`fa fa-refresh`},{className:(0,S.default)(`${n}IconSelectControl-Modal-refresh`),onClick:this.handleRefreshIconList})||null,i?x.createElement(`div`,{className:(0,S.default)(`${n}IconSelectControl-Modal-func`)},x.createElement(i,{onUpload:this.handleLocalUpload})):null,x.createElement(`div`,{className:(0,S.default)(`${n}IconSelectControl-Modal-content`)},x.createElement(o,{size:`lg`,loadingConfig:r,overlay:!0,key:`info`,show:this.state.isRefreshLoading}),x.createElement(`div`,{className:(0,S.default)(`${n}IconSelectControl-Modal-content-aside`)},this.renderIconTypes()),x.createElement(`div`,{className:(0,S.default)(`${n}IconSelectControl-Modal-content-main`)},this.renderIconList(c))))},r.prototype.getIconsByType=function(){return(y==null?void 0:g.length)&&g[this.state.activeTypeIndex].children||[]},r.prototype.toggleModel=function(e){var n=this.props.value,r=typeof n==`string`?this.getValueBySvg(n):n;if(e===void 0){this.setState({showModal:!this.state.showModal,searchValue:``});return}this.setState({showModal:e,tmpCheckIconId:e&&r?.id?t(t({},r),{id:String(r.id).replace(/^svg-/,``)}):null,searchValue:``})},r.prototype.render=function(){var e=this,t=this.props,n=t.className;t.style;var r=t.classPrefix,i=t.disabled,o=t.translate;return x.createElement(`div`,{className:(0,S.default)(n,`${r}IconSelectControl`,{"is-focused":this.state.showModal,"is-disabled":i})},x.createElement(`div`,{className:(0,S.default)(`${r}IconSelectControl-input`),onClick:this.handleClick},this.renderInputArea()),x.createElement(a,{show:this.state.showModal,closeOnOutside:!0,closeOnEsc:!0,size:`lg`,overlay:!0,onHide:function(){return e.toggleModel(!1)}},x.createElement(a.Header,{onClose:function(){return e.toggleModel(!1)}},o(`IconSelect.choice`)),x.createElement(a.Body,null,this.renderModalContent()),x.createElement(a.Footer,null,x.createElement(f,{type:`button`,className:`m-l`,onClick:function(){return e.toggleModel(!1)}},o(`cancel`)),x.createElement(f,{type:`button`,level:`primary`,onClick:this.handleConfirm},o(`confirm`)))))},r.defaultProps={noDataTip:`placeholder.noData`,clearable:!0},l([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,void 0)],r.prototype,`handleClick`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[Object]),i(`design:returntype`,void 0)],r.prototype,`handleClear`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,void 0)],r.prototype,`renderInputArea`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[Object,Number]),i(`design:returntype`,void 0)],r.prototype,`handleIconTypeClick`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,void 0)],r.prototype,`renderIconTypes`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,void 0)],r.prototype,`handleConfirm`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[String]),i(`design:returntype`,Promise)],r.prototype,`handleLocalUpload`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[Array]),i(`design:returntype`,void 0)],r.prototype,`renderIconList`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,Promise)],r.prototype,`handleRefreshIconList`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[]),i(`design:returntype`,void 0)],r.prototype,`renderModalContent`,null),l([n,i(`design:type`,Function),i(`design:paramtypes`,[Boolean]),i(`design:returntype`,void 0)],r.prototype,`toggleModel`,null),r}(x.PureComponent),T=function(e){u(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t=l([h({type:`icon-select`})],t),t}(w);export{T as IconSelectControlRenderer,w as default};