const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cssMode-ywvSMuKZ.js","assets/editor.api-Ck4Uxo0P.js","assets/editor-D_Zs4rIG.css","assets/monaco-editor-core-CSIW_mLf.js","assets/jsonMode-DJkof3Lb.js","assets/monaco-editor-core-Cf4ZaCSP.js","assets/htmlMode-BuGjBUG_.js","assets/monaco-editor-core-B8ls8UxL.js","assets/handlebars-CAnowPJU.js","assets/monaco-editor-core-m9NPrqmz.js","assets/html-stttqmSW.js","assets/javascript-DqYIbBEB.js","assets/typescript-Q_nWbpR3.js","assets/liquid-B_hOSIM_.js","assets/python-Dh7v9Q93.js","assets/razor-C2nw8Fm3.js","assets/xml-CjcLdctF.js"])))=>i.map(i=>d[i]);
import{za as e}from"./index-DAdqRbKX.js";import{$ as t,$a as n,$i as r,$n as i,$o as a,$r as o,$s as s,$t as c,A as l,Aa as u,Ac as d,Ai as f,An as p,Ao as m,Ar as h,As as ee,At as g,B as te,Ba as ne,Bc as re,Bi as ie,Bn as ae,Bo as oe,Br as se,Bs as ce,Bt as le,C as ue,Ca as de,Cc as _,Ci as fe,Cn as pe,Co as me,Cr as v,Cs as he,Ct as ge,D as _e,Da as ve,Dc as y,Di as ye,Dn as be,Do as xe,Dr as Se,Ds as Ce,Dt as b,E as we,Ea as x,Ec as S,Ei as Te,En as Ee,Eo as De,Er as Oe,Es as ke,Et as Ae,F as je,Fa as Me,Fc as C,Fi as w,Fn as Ne,Fo as Pe,Fr as Fe,Fs as Ie,Ft as Le,G as Re,Ga as ze,Gc as Be,Gi as Ve,Gn as He,Go as Ue,Gr as We,Gs as T,Gt as Ge,H as Ke,Ha as qe,Hc as Je,Hi as Ye,Hn as Xe,Ho as Ze,Hr as Qe,Hs as $e,Ht as et,I as E,Ia as tt,Ic as nt,Ii as D,In as rt,Io as it,Ir as O,Is as at,It as ot,J as st,Ja as ct,Ji as lt,Jn as ut,Jo as dt,Jr as ft,Js as pt,Jt as mt,K as ht,Ka as gt,Kc as _t,Ki as vt,Kn as yt,Ko as bt,Kr as xt,Ks as St,Kt as Ct,L as wt,La as Tt,Lc as Et,Li as k,Ln as Dt,Lo as Ot,Lr as kt,Ls as At,Lt as jt,M as Mt,Ma as Nt,Mc as Pt,Mi as Ft,Mn as It,Mo as Lt,Mr as Rt,Ms as zt,Mt as Bt,N as Vt,Na as Ht,Nc as Ut,Ni as Wt,Nn as Gt,No as Kt,Nr as qt,Ns as Jt,Nt as Yt,O as Xt,Oa as Zt,Oc as Qt,Oi as $t,On as en,Oo as tn,Or as nn,Os as rn,Ot as an,P as on,Pa as sn,Pc as cn,Pi as ln,Pn as un,Po as dn,Pr as fn,Ps as pn,Pt as mn,Q as hn,Qa as gn,Qi as _n,Qn as vn,Qo as yn,Qr as bn,Qs as xn,Qt as Sn,R as Cn,Ra as wn,Rc as Tn,Ri as En,Rn as Dn,Ro as On,Rr as kn,Rs as An,Rt as jn,S as Mn,Sa as Nn,Sc as Pn,Si as Fn,Sn as In,So as Ln,Sr as Rn,Ss as zn,St as Bn,T as Vn,Ta as Hn,Tc as Un,Ti as Wn,Tn as Gn,To as Kn,Tr as qn,Ts as Jn,Tt as Yn,U as Xn,Ua as Zn,Uc as Qn,Ui as $n,Un as er,Uo as tr,Ur as nr,Us as rr,Ut as ir,V as ar,Va as or,Vc as sr,Vi as cr,Vn as lr,Vo as ur,Vr as dr,Vs as fr,Vt as A,W as pr,Wa as mr,Wc as hr,Wi as gr,Wn as _r,Wo as vr,Wr as yr,Ws as br,Wt as xr,X as Sr,Xa as Cr,Xi as wr,Xn as Tr,Xo as Er,Xr as Dr,Xs as Or,Xt as kr,Y as Ar,Ya as jr,Yi as Mr,Yn as Nr,Yo as Pr,Yr as Fr,Ys as Ir,Yt as Lr,Z as Rr,Za as zr,Zi as Br,Zn as Vr,Zo as Hr,Zr as Ur,Zs as Wr,Zt as Gr,_ as Kr,_a as qr,_c as j,_i as Jr,_n as Yr,_o as Xr,_r as Zr,_s as Qr,_t as $r,a as ei,aa as ti,ac as ni,ai as ri,an as ii,ao as M,ar as ai,as as oi,at as si,b as ci,ba as li,bc as ui,bi as di,bn as fi,bo as pi,br as mi,bs as hi,bt as gi,c as _i,ca as vi,cc as yi,ci as N,cn as bi,co as xi,cr as Si,cs as Ci,ct as wi,d as Ti,da as Ei,dc as P,di as Di,dn as Oi,do as ki,dr as Ai,ds as ji,dt as Mi,ea as Ni,ec as Pi,ei as F,en as I,eo as Fi,er as Ii,es as Li,et as Ri,f as zi,fa as Bi,fc as L,fi as Vi,fn as Hi,fo as Ui,fr as Wi,fs as Gi,ft as Ki,g as qi,ga as Ji,gc as Yi,gi as Xi,gn as Zi,go as Qi,gr as $i,gs as ea,gt as ta,h as na,ha as ra,hc as ia,hi as aa,hn as oa,ho as sa,hr as ca,hs as la,ht as ua,i as da,ia as fa,ic as pa,ii as ma,in as ha,io as ga,ir as _a,is as va,it as ya,j as ba,ja as xa,jc as Sa,ji as Ca,jn as wa,jo as Ta,jr as Ea,js as Da,jt as Oa,k as ka,ka as Aa,kc as ja,ki as Ma,kn as Na,ko as Pa,kr as Fa,ks as Ia,kt as La,l as Ra,la as za,lc as R,li as Ba,ln as Va,lo as Ha,lr as Ua,ls as Wa,lt as Ga,m as Ka,ma as qa,mc as Ja,mi as Ya,mn as Xa,mo as Za,mr as Qa,ms as $a,mt as eo,n as to,na as no,nc as ro,ni as io,nn as ao,no as oo,nr as so,ns as co,nt as lo,o as uo,oa as fo,oc as po,oi as mo,on as ho,oo as go,or as _o,os as vo,ot as yo,p as bo,pa as xo,pc as So,pi as Co,pn as wo,po as To,pr as Eo,ps as Do,pt as Oo,q as ko,qa as Ao,qc as z,qi as jo,qn as B,qo as Mo,qr as V,qs as No,qt as Po,r as Fo,ra as Io,rc as Lo,ri as Ro,rn as zo,ro as Bo,rr as Vo,rs as Ho,rt as Uo,s as Wo,sa as Go,sc as H,si as Ko,sn as qo,so as Jo,sr as Yo,ss as Xo,st as Zo,t as Qo,ta as $o,tc as es,ti as U,tn as ts,to as ns,tr as rs,ts as is,tt as as,u as os,ua as ss,uc as W,ui as cs,un as ls,uo as us,ur as ds,us as G,ut as fs,v as ps,va as ms,vc as hs,vi as gs,vn as _s,vo as vs,vr as ys,vs as bs,vt as xs,w as Ss,wa as Cs,wc as K,wi as ws,wn as Ts,wo as Es,wr as Ds,ws as Os,wt as ks,x as As,xa as js,xc as Ms,xi as Ns,xn as Ps,xo as Fs,xr as Is,xs as q,xt as Ls,y as Rs,ya as zs,yc as J,yi as Bs,yn as Vs,yo as Hs,yr as Us,ys as Ws,yt as Gs,z as Ks,za as qs,zc as Js,zi as Ys,zn as Xs,zo as Zs,zr as Qs,zs as $s,zt as ec}from"./editor.api-Ck4Uxo0P.js";import"./monaco-editor-core-m9NPrqmz.js";import"./monaco.contribution-DpboB52g.js";import"./monaco-editor-core-CSIW_mLf.js";import"./monaco-editor-core-Cf4ZaCSP.js";import"./monaco-editor-core-B8ls8UxL.js";var tc=function(){function e(e,t,n){this._onDidChange=new to,this._languageId=e,this.setOptions(t),this.setModeConfiguration(n)}return Object.defineProperty(e.prototype,`onDidChange`,{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`languageId`,{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`modeConfiguration`,{get:function(){return this._modeConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`diagnosticsOptions`,{get:function(){return this.options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`options`,{get:function(){return this._options},enumerable:!1,configurable:!0}),e.prototype.setOptions=function(e){this._options=e||Object.create(null),this._onDidChange.fire(this)},e.prototype.setDiagnosticsOptions=function(e){this.setOptions(e)},e.prototype.setModeConfiguration=function(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)},e}(),nc={validate:!0,lint:{compatibleVendorPrefixes:`ignore`,vendorPrefix:`warning`,duplicateProperties:`warning`,emptyRules:`warning`,importStatement:`ignore`,boxModel:`ignore`,universalSelector:`ignore`,zeroUnits:`ignore`,fontFaceProperties:`warning`,hexColorLength:`error`,argumentsInColorFunction:`error`,unknownProperties:`warning`,ieHack:`ignore`,unknownVendorSpecificProperties:`ignore`,propertyIgnoredDueToDisplay:`warning`,important:`ignore`,float:`ignore`,idSelector:`ignore`},data:{useDefaultDataProvider:!0}},rc={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},ic=new tc(`css`,nc,rc),ac=new tc(`scss`,nc,rc),oc=new tc(`less`,nc,rc);Ka.css={cssDefaults:ic,lessDefaults:oc,scssDefaults:ac};function sc(){return e(()=>import(`./cssMode-ywvSMuKZ.js`),__vite__mapDeps([0,1,2,3]))}Ka.onLanguage(`less`,function(){sc().then(function(e){return e.setupMode(oc)})}),Ka.onLanguage(`scss`,function(){sc().then(function(e){return e.setupMode(ac)})}),Ka.onLanguage(`css`,function(){sc().then(function(e){return e.setupMode(ic)})});var cc=new(function(){function e(e,t,n){this._onDidChange=new to,this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(n)}return Object.defineProperty(e.prototype,`onDidChange`,{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`languageId`,{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`modeConfiguration`,{get:function(){return this._modeConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`diagnosticsOptions`,{get:function(){return this._diagnosticsOptions},enumerable:!1,configurable:!0}),e.prototype.setDiagnosticsOptions=function(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)},e.prototype.setModeConfiguration=function(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)},e}())(`json`,{validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:`warning`,schemaValidation:`warning`,comments:`error`,trailingCommas:`error`},{documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0});Ka.json={jsonDefaults:cc};function lc(){return e(()=>import(`./jsonMode-DJkof3Lb.js`),__vite__mapDeps([4,1,2,5]))}Ka.register({id:`json`,extensions:[`.json`,`.bowerrc`,`.jshintrc`,`.jscsrc`,`.eslintrc`,`.babelrc`,`.har`],aliases:[`JSON`,`json`],mimetypes:[`application/json`]}),Ka.onLanguage(`json`,function(){lc().then(function(e){return e.setupMode(cc)})});var uc=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},dc=function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol==`function`&&(o[Symbol.iterator]=function(){return this}),o;function s(e){return function(t){return c([e,t])}}function c(o){if(r)throw TypeError(`Generator is already executing.`);for(;n;)try{if(r=1,i&&(a=o[0]&2?i.return:o[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,o[1])).done)return a;switch(i=0,a&&(o=[o[0]&2,a.value]),o[0]){case 0:case 1:a=o;break;case 4:return n.label++,{value:o[1],done:!1};case 5:n.label++,i=o[1],o=[0];continue;case 7:o=n.ops.pop(),n.trys.pop();continue;default:if((a=n.trys,!(a=a.length>0&&a[a.length-1]))&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!a||o[1]>a[0]&&o[1]<a[3])){n.label=o[1];break}if(o[0]===6&&n.label<a[1]){n.label=a[1],a=o;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(o);break}a[2]&&n.ops.pop(),n.trys.pop();continue}o=t.call(e,n)}catch(e){o=[6,e],i=0}finally{r=a=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},fc=function(){function e(e,t,n){this._onDidChange=new to,this._languageId=e,this.setOptions(t),this.setModeConfiguration(n)}return Object.defineProperty(e.prototype,`onDidChange`,{get:function(){return this._onDidChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`languageId`,{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`options`,{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`modeConfiguration`,{get:function(){return this._modeConfiguration},enumerable:!1,configurable:!0}),e.prototype.setOptions=function(e){this._options=e||Object.create(null),this._onDidChange.fire(this)},e.prototype.setModeConfiguration=function(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)},e}(),pc={format:{tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:`default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var`,contentUnformatted:`pre`,indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:null,indentHandlebars:!1,endWithNewline:!1,extraLiners:`head, body, /html`,wrapAttributes:`auto`},suggest:{},data:{useDefaultDataProvider:!0}};function mc(e){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:e===hc,documentFormattingEdits:e===hc,documentRangeFormattingEdits:e===hc}}var hc=`html`,gc=`handlebars`,_c=`razor`,vc=wc(hc,pc,mc(hc)),yc=vc.defaults,bc=wc(gc,pc,mc(gc)),xc=bc.defaults,Sc=wc(_c,pc,mc(_c));Ka.html={htmlDefaults:yc,razorDefaults:Sc.defaults,handlebarDefaults:xc,htmlLanguageService:vc,handlebarLanguageService:bc,razorLanguageService:Sc,registerHTMLLanguageService:wc};function Cc(){return e(()=>import(`./htmlMode-BuGjBUG_.js`),__vite__mapDeps([6,1,2,7]))}function wc(e,t,n){var r=this;t===void 0&&(t=pc),n===void 0&&(n=mc(e));var i=new fc(e,t,n),a,o=Ka.onLanguage(e,function(){return uc(r,void 0,void 0,function(){return dc(this,function(e){switch(e.label){case 0:return[4,Cc()];case 1:return a=e.sent().setupMode(i),[2]}})})});return{defaults:i,dispose:function(){o.dispose(),a?.dispose(),a=void 0}}}var Tc={},Ec={},Dc=function(){function e(e){var t=this;this._languageId=e,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise(function(e,n){t._lazyLoadPromiseResolve=e,t._lazyLoadPromiseReject=n})}return e.getOrCreate=function(t){return Ec[t]||(Ec[t]=new e(t)),Ec[t]},e.prototype.whenLoaded=function(){return this._lazyLoadPromise},e.prototype.load=function(){var e=this;return this._loadingTriggered||(this._loadingTriggered=!0,Tc[this._languageId].loader().then(function(t){return e._lazyLoadPromiseResolve(t)},function(t){return e._lazyLoadPromiseReject(t)})),this._lazyLoadPromise},e}();function Y(e){var t=e.id;Tc[t]=e,Ka.register(e);var n=Dc.getOrCreate(t);Ka.setMonarchTokensProvider(t,n.whenLoaded().then(function(e){return e.language})),Ka.onLanguage(t,function(){n.load().then(function(e){Ka.setLanguageConfiguration(t,e.conf)})})}Y({id:`abap`,extensions:[`.abap`],aliases:[`abap`,`ABAP`],loader:function(){return e(()=>import(`./abap-d-5-CaTf.js`),[])}}),Y({id:`apex`,extensions:[`.cls`],aliases:[`Apex`,`apex`],mimetypes:[`text/x-apex-source`,`text/x-apex`],loader:function(){return e(()=>import(`./apex-CNfYhFEe.js`),[])}}),Y({id:`azcli`,extensions:[`.azcli`],aliases:[`Azure CLI`,`azcli`],loader:function(){return e(()=>import(`./azcli-BCFf0EGO.js`),[])}}),Y({id:`bat`,extensions:[`.bat`,`.cmd`],aliases:[`Batch`,`bat`],loader:function(){return e(()=>import(`./bat-CRux9raL.js`),[])}}),Y({id:`bicep`,extensions:[`.bicep`],aliases:[`Bicep`],loader:function(){return e(()=>import(`./bicep-SsTf7WWw.js`),[])}}),Y({id:`cameligo`,extensions:[`.mligo`],aliases:[`Cameligo`],loader:function(){return e(()=>import(`./cameligo-C-u9BJBJ.js`),[])}}),Y({id:`clojure`,extensions:[`.clj`,`.cljs`,`.cljc`,`.edn`],aliases:[`clojure`,`Clojure`],loader:function(){return e(()=>import(`./clojure-BHfAQXry.js`),[])}}),Y({id:`coffeescript`,extensions:[`.coffee`],aliases:[`CoffeeScript`,`coffeescript`,`coffee`],mimetypes:[`text/x-coffeescript`,`text/coffeescript`],loader:function(){return e(()=>import(`./coffee-qXi6eZqN.js`),[])}}),Y({id:`c`,extensions:[`.c`,`.h`],aliases:[`C`,`c`],loader:function(){return e(()=>import(`./cpp-C9aF6XYM.js`),[])}}),Y({id:`cpp`,extensions:[`.cpp`,`.cc`,`.cxx`,`.hpp`,`.hh`,`.hxx`],aliases:[`C++`,`Cpp`,`cpp`],loader:function(){return e(()=>import(`./cpp-C9aF6XYM.js`),[])}}),Y({id:`csharp`,extensions:[`.cs`,`.csx`,`.cake`],aliases:[`C#`,`csharp`],loader:function(){return e(()=>import(`./csharp-Dfj5E0oL.js`),[])}}),Y({id:`csp`,extensions:[],aliases:[`CSP`,`csp`],loader:function(){return e(()=>import(`./csp-w6VMpa6u.js`),[])}}),Y({id:`css`,extensions:[`.css`],aliases:[`CSS`,`css`],mimetypes:[`text/css`],loader:function(){return e(()=>import(`./css-DPMn0c_u.js`),[])}}),Y({id:`dart`,extensions:[`.dart`],aliases:[`Dart`,`dart`],mimetypes:[`text/x-dart-source`,`text/x-dart`],loader:function(){return e(()=>import(`./dart-C3zQqB6Z.js`),[])}}),Y({id:`dockerfile`,extensions:[`.dockerfile`],filenames:[`Dockerfile`],aliases:[`Dockerfile`],loader:function(){return e(()=>import(`./dockerfile-LP0C7luA.js`),[])}}),Y({id:`ecl`,extensions:[`.ecl`],aliases:[`ECL`,`Ecl`,`ecl`],loader:function(){return e(()=>import(`./ecl-B7_L65bV.js`),[])}}),Y({id:`elixir`,extensions:[`.ex`,`.exs`],aliases:[`Elixir`,`elixir`,`ex`],loader:function(){return e(()=>import(`./elixir-DSaffgXL.js`),[])}}),Y({id:`flow9`,extensions:[`.flow`],aliases:[`Flow9`,`Flow`,`flow9`,`flow`],loader:function(){return e(()=>import(`./flow9-BpNzw0sy.js`),[])}}),Y({id:`fsharp`,extensions:[`.fs`,`.fsi`,`.ml`,`.mli`,`.fsx`,`.fsscript`],aliases:[`F#`,`FSharp`,`fsharp`],loader:function(){return e(()=>import(`./fsharp-BVKlRGzE.js`),[])}}),Y({id:`go`,extensions:[`.go`],aliases:[`Go`],loader:function(){return e(()=>import(`./go-Crjgc_a9.js`),[])}}),Y({id:`graphql`,extensions:[`.graphql`,`.gql`],aliases:[`GraphQL`,`graphql`,`gql`],mimetypes:[`application/graphql`],loader:function(){return e(()=>import(`./graphql-DbiyocpL.js`),[])}}),Y({id:`handlebars`,extensions:[`.handlebars`,`.hbs`],aliases:[`Handlebars`,`handlebars`,`hbs`],mimetypes:[`text/x-handlebars-template`],loader:function(){return e(()=>import(`./handlebars-CAnowPJU.js`),__vite__mapDeps([8,1,2,9]))}}),Y({id:`hcl`,extensions:[`.tf`,`.tfvars`,`.hcl`],aliases:[`Terraform`,`tf`,`HCL`,`hcl`],loader:function(){return e(()=>import(`./hcl-CJmncxQa.js`),[])}}),Y({id:`html`,extensions:[`.html`,`.htm`,`.shtml`,`.xhtml`,`.mdoc`,`.jsp`,`.asp`,`.aspx`,`.jshtm`],aliases:[`HTML`,`htm`,`html`,`xhtml`],mimetypes:[`text/html`,`text/x-jshtm`,`text/template`,`text/ng-template`],loader:function(){return e(()=>import(`./html-stttqmSW.js`),__vite__mapDeps([10,1,2,9]))}}),Y({id:`ini`,extensions:[`.ini`,`.properties`,`.gitconfig`],filenames:[`config`,`.gitattributes`,`.gitconfig`,`.editorconfig`],aliases:[`Ini`,`ini`],loader:function(){return e(()=>import(`./ini-BSpyHxWk.js`),[])}}),Y({id:`java`,extensions:[`.java`,`.jav`],aliases:[`Java`,`java`],mimetypes:[`text/x-java-source`,`text/x-java`],loader:function(){return e(()=>import(`./java-9mAu1PaT.js`),[])}}),Y({id:`javascript`,extensions:[`.js`,`.es6`,`.jsx`,`.mjs`],firstLine:`^#!.*\\bnode`,filenames:[`jakefile`],aliases:[`JavaScript`,`javascript`,`js`],mimetypes:[`text/javascript`],loader:function(){return e(()=>import(`./javascript-DqYIbBEB.js`),__vite__mapDeps([11,1,2,9,12]))}}),Y({id:`julia`,extensions:[`.jl`],aliases:[`julia`,`Julia`],loader:function(){return e(()=>import(`./julia-D0THIaPo.js`),[])}}),Y({id:`kotlin`,extensions:[`.kt`],aliases:[`Kotlin`,`kotlin`],mimetypes:[`text/x-kotlin-source`,`text/x-kotlin`],loader:function(){return e(()=>import(`./kotlin-B_CExMf7.js`),[])}}),Y({id:`less`,extensions:[`.less`],aliases:[`Less`,`less`],mimetypes:[`text/x-less`,`text/less`],loader:function(){return e(()=>import(`./less-BDXXuLJY.js`),[])}}),Y({id:`lexon`,extensions:[`.lex`],aliases:[`Lexon`],loader:function(){return e(()=>import(`./lexon-f-GPUyWh.js`),[])}}),Y({id:`lua`,extensions:[`.lua`],aliases:[`Lua`,`lua`],loader:function(){return e(()=>import(`./lua-SnJ8M_Ml.js`),[])}}),Y({id:`liquid`,extensions:[`.liquid`,`.html.liquid`],aliases:[`Liquid`,`liquid`],mimetypes:[`application/liquid`],loader:function(){return e(()=>import(`./liquid-B_hOSIM_.js`),__vite__mapDeps([13,1,2,9]))}}),Y({id:`m3`,extensions:[`.m3`,`.i3`,`.mg`,`.ig`],aliases:[`Modula-3`,`Modula3`,`modula3`,`m3`],loader:function(){return e(()=>import(`./m3-Ce0qFvB0.js`),[])}}),Y({id:`markdown`,extensions:[`.md`,`.markdown`,`.mdown`,`.mkdn`,`.mkd`,`.mdwn`,`.mdtxt`,`.mdtext`],aliases:[`Markdown`,`markdown`],loader:function(){return e(()=>import(`./markdown-BFAY-cE4.js`),[])}}),Y({id:`mips`,extensions:[`.s`],aliases:[`MIPS`,`MIPS-V`],mimetypes:[`text/x-mips`,`text/mips`,`text/plaintext`],loader:function(){return e(()=>import(`./mips-LoYixuW4.js`),[])}}),Y({id:`msdax`,extensions:[`.dax`,`.msdax`],aliases:[`DAX`,`MSDAX`],loader:function(){return e(()=>import(`./msdax-D3QKHskY.js`),[])}}),Y({id:`mysql`,extensions:[],aliases:[`MySQL`,`mysql`],loader:function(){return e(()=>import(`./mysql-NDnJve4v.js`),[])}}),Y({id:`objective-c`,extensions:[`.m`],aliases:[`Objective-C`],loader:function(){return e(()=>import(`./objective-c-DXTUuchZ.js`),[])}}),Y({id:`pascal`,extensions:[`.pas`,`.p`,`.pp`],aliases:[`Pascal`,`pas`],mimetypes:[`text/x-pascal-source`,`text/x-pascal`],loader:function(){return e(()=>import(`./pascal-CuTdS-UR.js`),[])}}),Y({id:`pascaligo`,extensions:[`.ligo`],aliases:[`Pascaligo`,`ligo`],loader:function(){return e(()=>import(`./pascaligo-D3Keise3.js`),[])}}),Y({id:`perl`,extensions:[`.pl`],aliases:[`Perl`,`pl`],loader:function(){return e(()=>import(`./perl-BMy4GQ1d.js`),[])}}),Y({id:`pgsql`,extensions:[],aliases:[`PostgreSQL`,`postgres`,`pg`,`postgre`],loader:function(){return e(()=>import(`./pgsql-DQzER1o3.js`),[])}}),Y({id:`php`,extensions:[`.php`,`.php4`,`.php5`,`.phtml`,`.ctp`],aliases:[`PHP`,`php`],mimetypes:[`application/x-php`],loader:function(){return e(()=>import(`./php-wRc_a_11.js`),[])}}),Y({id:`pla`,extensions:[`.pla`],loader:function(){return e(()=>import(`./pla-B7hW9STH.js`),[])}}),Y({id:`postiats`,extensions:[`.dats`,`.sats`,`.hats`],aliases:[`ATS`,`ATS/Postiats`],loader:function(){return e(()=>import(`./postiats-CfxEELsL.js`),[])}}),Y({id:`powerquery`,extensions:[`.pq`,`.pqm`],aliases:[`PQ`,`M`,`Power Query`,`Power Query M`],loader:function(){return e(()=>import(`./powerquery-H7QMxtRC.js`),[])}}),Y({id:`powershell`,extensions:[`.ps1`,`.psm1`,`.psd1`],aliases:[`PowerShell`,`powershell`,`ps`,`ps1`],loader:function(){return e(()=>import(`./powershell-C5SVerkI.js`),[])}}),Y({id:`proto`,extensions:[`.proto`],aliases:[`protobuf`,`Protocol Buffers`],loader:function(){return e(()=>import(`./protobuf-q-rG3KuI.js`),[])}}),Y({id:`pug`,extensions:[`.jade`,`.pug`],aliases:[`Pug`,`Jade`,`jade`],loader:function(){return e(()=>import(`./pug-frCMXrdq.js`),[])}}),Y({id:`python`,extensions:[`.py`,`.rpy`,`.pyw`,`.cpy`,`.gyp`,`.gypi`],aliases:[`Python`,`py`],firstLine:`^#!/.*\\bpython[0-9.-]*\\b`,loader:function(){return e(()=>import(`./python-Dh7v9Q93.js`),__vite__mapDeps([14,1,2,9]))}}),Y({id:`qsharp`,extensions:[`.qs`],aliases:[`Q#`,`qsharp`],loader:function(){return e(()=>import(`./qsharp-BSXpnIwf.js`),[])}}),Y({id:`r`,extensions:[`.r`,`.rhistory`,`.rmd`,`.rprofile`,`.rt`],aliases:[`R`,`r`],loader:function(){return e(()=>import(`./r-CwnYPsp1.js`),[])}}),Y({id:`razor`,extensions:[`.cshtml`],aliases:[`Razor`,`razor`],mimetypes:[`text/x-cshtml`],loader:function(){return e(()=>import(`./razor-C2nw8Fm3.js`),__vite__mapDeps([15,1,2,9]))}}),Y({id:`redis`,extensions:[`.redis`],aliases:[`redis`],loader:function(){return e(()=>import(`./redis-CRD8HwaO.js`),[])}}),Y({id:`redshift`,extensions:[],aliases:[`Redshift`,`redshift`],loader:function(){return e(()=>import(`./redshift-Cu6Xksl_.js`),[])}}),Y({id:`restructuredtext`,extensions:[`.rst`],aliases:[`reStructuredText`,`restructuredtext`],loader:function(){return e(()=>import(`./restructuredtext-A8UDNanE.js`),[])}}),Y({id:`ruby`,extensions:[`.rb`,`.rbx`,`.rjs`,`.gemspec`,`.pp`],filenames:[`rakefile`,`Gemfile`],aliases:[`Ruby`,`rb`],loader:function(){return e(()=>import(`./ruby-Dk7B5KJG.js`),[])}}),Y({id:`rust`,extensions:[`.rs`,`.rlib`],aliases:[`Rust`,`rust`],loader:function(){return e(()=>import(`./rust-BQTjgCtf.js`),[])}}),Y({id:`sb`,extensions:[`.sb`],aliases:[`Small Basic`,`sb`],loader:function(){return e(()=>import(`./sb-C_C-PSk8.js`),[])}}),Y({id:`scala`,extensions:[`.scala`,`.sc`,`.sbt`],aliases:[`Scala`,`scala`,`SBT`,`Sbt`,`sbt`,`Dotty`,`dotty`],mimetypes:[`text/x-scala-source`,`text/x-scala`,`text/x-sbt`,`text/x-dotty`],loader:function(){return e(()=>import(`./scala-DVCwPwmk.js`),[])}}),Y({id:`scheme`,extensions:[`.scm`,`.ss`,`.sch`,`.rkt`],aliases:[`scheme`,`Scheme`],loader:function(){return e(()=>import(`./scheme-ClsMsReY.js`),[])}}),Y({id:`scss`,extensions:[`.scss`],aliases:[`Sass`,`sass`,`scss`],mimetypes:[`text/x-scss`,`text/scss`],loader:function(){return e(()=>import(`./scss-VClU-TMY.js`),[])}}),Y({id:`shell`,extensions:[`.sh`,`.bash`],aliases:[`Shell`,`sh`],loader:function(){return e(()=>import(`./shell-lSrvS5A5.js`),[])}}),Y({id:`sol`,extensions:[`.sol`],aliases:[`sol`,`solidity`,`Solidity`],loader:function(){return e(()=>import(`./solidity-BslTQNbK.js`),[])}}),Y({id:`aes`,extensions:[`.aes`],aliases:[`aes`,`sophia`,`Sophia`],loader:function(){return e(()=>import(`./sophia-BHCXn0O-.js`),[])}}),Y({id:`sparql`,extensions:[`.rq`],aliases:[`sparql`,`SPARQL`],loader:function(){return e(()=>import(`./sparql-prIoLvZR.js`),[])}}),Y({id:`sql`,extensions:[`.sql`],aliases:[`SQL`],loader:function(){return e(()=>import(`./sql-ZwNV8VXJ.js`),[])}}),Y({id:`st`,extensions:[`.st`,`.iecst`,`.iecplc`,`.lc3lib`],aliases:[`StructuredText`,`scl`,`stl`],loader:function(){return e(()=>import(`./st-oxann5it.js`),[])}}),Y({id:`swift`,aliases:[`Swift`,`swift`],extensions:[`.swift`],mimetypes:[`text/swift`],loader:function(){return e(()=>import(`./swift-Dp65RBlp.js`),[])}}),Y({id:`systemverilog`,extensions:[`.sv`,`.svh`],aliases:[`SV`,`sv`,`SystemVerilog`,`systemverilog`],loader:function(){return e(()=>import(`./systemverilog-C8oBpjnH.js`),[])}}),Y({id:`verilog`,extensions:[`.v`,`.vh`],aliases:[`V`,`v`,`Verilog`,`verilog`],loader:function(){return e(()=>import(`./systemverilog-C8oBpjnH.js`),[])}}),Y({id:`tcl`,extensions:[`.tcl`],aliases:[`tcl`,`Tcl`,`tcltk`,`TclTk`,`tcl/tk`,`Tcl/Tk`],loader:function(){return e(()=>import(`./tcl-DCkgR36f.js`),[])}}),Y({id:`twig`,extensions:[`.twig`],aliases:[`Twig`,`twig`],mimetypes:[`text/x-twig`],loader:function(){return e(()=>import(`./twig-oYqkZgk7.js`),[])}}),Y({id:`typescript`,extensions:[`.ts`,`.tsx`],aliases:[`TypeScript`,`ts`,`typescript`],mimetypes:[`text/typescript`],loader:function(){return e(()=>import(`./typescript-Q_nWbpR3.js`),__vite__mapDeps([12,1,2,9]))}}),Y({id:`vb`,extensions:[`.vb`],aliases:[`Visual Basic`,`vb`],loader:function(){return e(()=>import(`./vb-BChOqYS9.js`),[])}}),Y({id:`xml`,extensions:[`.xml`,`.dtd`,`.ascx`,`.csproj`,`.config`,`.wxi`,`.wxl`,`.wxs`,`.xaml`,`.svg`,`.svgz`,`.opf`,`.xsl`],firstLine:`(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)`,aliases:[`XML`,`xml`],mimetypes:[`text/xml`,`application/xml`,`application/xaml+xml`,`application/xml-dtd`],loader:function(){return e(()=>import(`./xml-CjcLdctF.js`),__vite__mapDeps([16,1,2,9]))}}),Y({id:`yaml`,extensions:[`.yaml`,`.yml`],aliases:[`YAML`,`yaml`,`YML`,`yml`],mimetypes:[`application/x-yaml`,`text/x-yaml`],loader:function(){return e(()=>import(`./yaml-DPjh__Fr.js`),[])}});var Oc=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},kc=function(e,t){return function(n,r){t(n,r,e)}},Ac=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};const jc=new k(`selectionAnchorSet`,!1);var Mc=class e{constructor(e,t){this.editor=e,this.selectionAnchorSetContextKey=jc.bindTo(t),this.modelChangeListener=e.onDidChangeModel(()=>this.selectionAnchorSetContextKey.reset())}static get(t){return t.getContribution(e.ID)}setSelectionAnchor(){if(this.editor.hasModel()){let e=this.editor.getPosition(),t=this.decorationId?[this.decorationId]:[];this.decorationId=this.editor.deltaDecorations(t,[{range:R.fromPositions(e,e),options:{description:`selection-anchor`,stickiness:1,hoverMessage:new ue().appendText(z(`selectionAnchor`,`Selection Anchor`)),className:`selection-anchor`}}])[0],this.selectionAnchorSetContextKey.set(!!this.decorationId),Fn(z(`anchorSet`,`Anchor set at {0}:{1}`,e.lineNumber,e.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){let e=this.editor.getModel().getDecorationRange(this.decorationId);e&&this.editor.setPosition(e.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){let e=this.editor.getModel().getDecorationRange(this.decorationId);if(e){let t=this.editor.getPosition();this.editor.setSelection(R.fromPositions(e.getStartPosition(),t)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){this.decorationId&&(this.editor.deltaDecorations([this.decorationId],[]),this.decorationId=void 0,this.selectionAnchorSetContextKey.set(!1))}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}};Mc.ID=`editor.contrib.selectionAnchorController`,Mc=Oc([kc(1,D)],Mc);var Nc=class extends V{constructor(){super({id:`editor.action.setSelectionAnchor`,label:z(`setSelectionAnchor`,`Set Selection Anchor`),alias:`Set Selection Anchor`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2080),weight:100}})}run(e,t){return Ac(this,void 0,void 0,function*(){Mc.get(t).setSelectionAnchor()})}},Pc=class extends V{constructor(){super({id:`editor.action.goToSelectionAnchor`,label:z(`goToSelectionAnchor`,`Go to Selection Anchor`),alias:`Go to Selection Anchor`,precondition:jc})}run(e,t){return Ac(this,void 0,void 0,function*(){Mc.get(t).goToSelectionAnchor()})}},Fc=class extends V{constructor(){super({id:`editor.action.selectFromAnchorToCursor`,label:z(`selectFromAnchorToCursor`,`Select from Anchor to Cursor`),alias:`Select from Anchor to Cursor`,precondition:jc,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2089),weight:100}})}run(e,t){return Ac(this,void 0,void 0,function*(){Mc.get(t).selectFromAnchorToCursor()})}},Ic=class extends V{constructor(){super({id:`editor.action.cancelSelectionAnchor`,label:z(`cancelSelectionAnchor`,`Cancel Selection Anchor`),alias:`Cancel Selection Anchor`,precondition:jc,kbOpts:{kbExpr:A.editorTextFocus,primary:9,weight:100}})}run(e,t){return Ac(this,void 0,void 0,function*(){Mc.get(t).cancelSelectionAnchor()})}};U(Mc.ID,Mc),o(Nc),o(Pc),o(Fc),o(Ic);var Lc=v(`editorOverviewRuler.bracketMatchForeground`,{dark:`#A0A0A0`,light:`#A0A0A0`,hc:`#A0A0A0`},z(`overviewRulerBracketMatchForeground`,`Overview ruler marker color for matching brackets.`)),Rc=class extends V{constructor(){super({id:`editor.action.jumpToBracket`,label:z(`smartSelect.jumpBracket`,`Go to Bracket`),alias:`Go to Bracket`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:3160,weight:100}})}run(e,t){let n=Vc.get(t);n&&n.jumpToBracket()}},zc=class extends V{constructor(){super({id:`editor.action.selectToBracket`,label:z(`smartSelect.selectToBracket`,`Select to Bracket`),alias:`Select to Bracket`,precondition:void 0,description:{description:`Select to Bracket`,args:[{name:`args`,schema:{type:`object`,properties:{selectBrackets:{type:`boolean`,default:!0}}}}]}})}run(e,t,n){let r=Vc.get(t);if(!r)return;let i=!0;n&&n.selectBrackets===!1&&(i=!1),r.selectToBracket(i)}},Bc=class{constructor(e,t,n){this.position=e,this.brackets=t,this.options=n}},Vc=class e extends _{constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=[],this._updateBracketsSoon=this._register(new T(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(63),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(e=>{this._matchBrackets!==`never`&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(e=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(e=>{this._lastBracketsData=[],this._decorations=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(e=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(e=>{e.hasChanged(63)&&(this._matchBrackets=this._editor.getOption(63),this._decorations=this._editor.deltaDecorations(this._decorations,[]),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}static get(t){return t.getContribution(e.ID)}jumpToBracket(){if(!this._editor.hasModel())return;let e=this._editor.getModel(),t=this._editor.getSelections().map(t=>{let n=t.getStartPosition(),r=e.matchBracket(n),i=null;if(r)r[0].containsPosition(n)?i=r[1].getStartPosition():r[1].containsPosition(n)&&(i=r[0].getStartPosition());else{let t=e.findEnclosingBrackets(n);if(t)i=t[0].getStartPosition();else{let t=e.findNextBracket(n);t&&t.range&&(i=t.range.getStartPosition())}}return i?new R(i.lineNumber,i.column,i.lineNumber,i.column):new R(n.lineNumber,n.column,n.lineNumber,n.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;let t=this._editor.getModel(),n=[];this._editor.getSelections().forEach(r=>{let i=r.getStartPosition(),a=t.matchBracket(i);if(!a&&(a=t.findEnclosingBrackets(i),!a)){let e=t.findNextBracket(i);e&&e.range&&(a=t.matchBracket(e.range.getStartPosition()))}let o=null,s=null;if(a){a.sort(W.compareRangesUsingStarts);let[t,n]=a;if(o=e?t.getStartPosition():t.getEndPosition(),s=e?n.getEndPosition():n.getStartPosition(),n.containsPosition(i)){let e=o;o=s,s=e}}o&&s&&n.push(new R(o.lineNumber,o.column,s.lineNumber,s.column))}),n.length>0&&(this._editor.setSelections(n),this._editor.revealRange(n[0]))}_updateBrackets(){if(this._matchBrackets===`never`)return;this._recomputeBrackets();let e=[],t=0;for(let n of this._lastBracketsData){let r=n.brackets;r&&(e[t++]={range:r[0],options:n.options},e[t++]={range:r[1],options:n.options})}this._decorations=this._editor.deltaDecorations(this._decorations,e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}let t=this._editor.getSelections();if(t.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}let n=this._editor.getModel(),r=n.getVersionId(),i=[];this._lastVersionId===r&&(i=this._lastBracketsData);let a=[],o=0;for(let e=0,n=t.length;e<n;e++){let n=t[e];n.isEmpty()&&(a[o++]=n.getStartPosition())}a.length>1&&a.sort(P.compare);let s=[],c=0,l=0,u=i.length;for(let t=0,r=a.length;t<r;t++){let r=a[t];for(;l<u&&i[l].position.isBefore(r);)l++;if(l<u&&i[l].position.equals(r))s[c++]=i[l];else{let t=n.matchBracket(r),i=e._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!t&&this._matchBrackets===`always`&&(t=n.findEnclosingBrackets(r,20),i=e._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),s[c++]=new Bc(r,t,i)}}this._lastBracketsData=s,this._lastVersionId=r}};Vc.ID=`editor.contrib.bracketMatchingController`,Vc._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=I.register({description:`bracket-match-overview`,stickiness:1,className:`bracket-match`,overviewRuler:{color:aa(Lc),position:ki.Center}}),Vc._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=I.register({description:`bracket-match-no-overview`,stickiness:1,className:`bracket-match`}),U(Vc.ID,Vc),o(zc),o(Rc),Ya((e,t)=>{let n=e.getColor(ao);n&&t.addRule(`.monaco-editor .bracket-match { background-color: ${n}; }`);let r=e.getColor(zo);r&&t.addRule(`.monaco-editor .bracket-match { border: 1px solid ${r}; }`)}),cs.appendMenuItem(N.MenubarGoMenu,{group:`5_infile_nav`,command:{id:`editor.action.jumpToBracket`,title:z({key:`miGoToBracket`,comment:[`&& denotes a mnemonic`]},`Go to &&Bracket`)},order:2});var Hc=class{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,t){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;let n=this._selection.startLineNumber,r=this._selection.startColumn,i=this._selection.endColumn;if(!(this._isMovingLeft&&r===1)&&!(!this._isMovingLeft&&i===e.getLineMaxColumn(n)))if(this._isMovingLeft){let a=new W(n,r-1,n,r),o=e.getValueInRange(a);t.addEditOperation(a,null),t.addEditOperation(new W(n,i,n,i),o)}else{let a=new W(n,i,n,i+1),o=e.getValueInRange(a);t.addEditOperation(a,null),t.addEditOperation(new W(n,r,n,r),o)}}computeCursorState(e,t){return this._isMovingLeft?new R(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new R(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}},Uc=class extends V{constructor(e,t){super(t),this.left=e}run(e,t){if(!t.hasModel())return;let n=[],r=t.getSelections();for(let e of r)n.push(new Hc(e,this.left));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}},Wc=class extends Uc{constructor(){super(!0,{id:`editor.action.moveCarretLeftAction`,label:z(`caret.moveLeft`,`Move Selected Text Left`),alias:`Move Selected Text Left`,precondition:A.writable})}},Gc=class extends Uc{constructor(){super(!1,{id:`editor.action.moveCarretRightAction`,label:z(`caret.moveRight`,`Move Selected Text Right`),alias:`Move Selected Text Right`,precondition:A.writable})}};o(Wc),o(Gc),o(class extends V{constructor(){super({id:`editor.action.transposeLetters`,label:z(`transposeLetters.label`,`Transpose Letters`),alias:`Transpose Letters`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(e,t){if(!t.hasModel())return;let n=t.getModel(),r=[],i=t.getSelections();for(let e of i){if(!e.isEmpty())continue;let t=e.startLineNumber,i=e.startColumn,a=n.getLineMaxColumn(t);if(t===1&&(i===1||i===2&&a===2))continue;let o=i===a?e.getPosition():Po.rightPosition(n,e.getPosition().lineNumber,e.getPosition().column),s=Po.leftPosition(n,o),c=Po.leftPosition(n,s),l=n.getValueInRange(W.fromPositions(c,s)),u=n.getValueInRange(W.fromPositions(s,o)),d=W.fromPositions(c,o);r.push(new mt(d,u+l))}r.length>0&&(t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop())}});var Kc=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},qc=`9_cutcopypaste`,Jc=hr||document.queryCommandSupported(`cut`),Yc=hr||document.queryCommandSupported(`copy`),Xc=navigator.clipboard===void 0||ro?document.queryCommandSupported(`paste`):!0;function Zc(e){return e.register(),e}const Qc=Jc?Zc(new Fr({id:`editor.action.clipboardCutAction`,precondition:void 0,kbOpts:hr?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:N.MenubarEditMenu,group:`2_ccp`,title:z({key:`miCut`,comment:[`&& denotes a mnemonic`]},`Cu&&t`),order:1},{menuId:N.EditorContext,group:qc,title:z(`actions.clipboard.cutLabel`,`Cut`),when:A.writable,order:1},{menuId:N.CommandPalette,group:``,title:z(`actions.clipboard.cutLabel`,`Cut`),order:1},{menuId:N.SimpleEditorContext,group:qc,title:z(`actions.clipboard.cutLabel`,`Cut`),when:A.writable,order:1}]})):void 0,$c=Yc?Zc(new Fr({id:`editor.action.clipboardCopyAction`,precondition:void 0,kbOpts:hr?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:N.MenubarEditMenu,group:`2_ccp`,title:z({key:`miCopy`,comment:[`&& denotes a mnemonic`]},`&&Copy`),order:2},{menuId:N.EditorContext,group:qc,title:z(`actions.clipboard.copyLabel`,`Copy`),order:2},{menuId:N.CommandPalette,group:``,title:z(`actions.clipboard.copyLabel`,`Copy`),order:1},{menuId:N.SimpleEditorContext,group:qc,title:z(`actions.clipboard.copyLabel`,`Copy`),order:2}]})):void 0;cs.appendMenuItem(N.MenubarEditMenu,{submenu:N.MenubarCopy,title:{value:z(`copy as`,`Copy As`),original:`Copy As`},group:`2_ccp`,order:3}),cs.appendMenuItem(N.EditorContext,{submenu:N.EditorContextCopy,title:{value:z(`copy as`,`Copy As`),original:`Copy As`},group:qc,order:3});const el=Xc?Zc(new Fr({id:`editor.action.clipboardPasteAction`,precondition:void 0,kbOpts:hr?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:N.MenubarEditMenu,group:`2_ccp`,title:z({key:`miPaste`,comment:[`&& denotes a mnemonic`]},`&&Paste`),order:4},{menuId:N.EditorContext,group:qc,title:z(`actions.clipboard.pasteLabel`,`Paste`),when:A.writable,order:4},{menuId:N.CommandPalette,group:``,title:z(`actions.clipboard.pasteLabel`,`Paste`),order:1},{menuId:N.SimpleEditorContext,group:qc,title:z(`actions.clipboard.pasteLabel`,`Paste`),when:A.writable,order:4}]})):void 0;var tl=class extends V{constructor(){super({id:`editor.action.clipboardCopyWithSyntaxHighlightingAction`,label:z(`actions.clipboard.copyWithSyntaxHighlightingLabel`,`Copy With Syntax Highlighting`),alias:`Copy With Syntax Highlighting`,precondition:void 0,kbOpts:{kbExpr:A.textInputFocus,primary:0,weight:100}})}run(e,t){t.hasModel()&&(!t.getOption(32)&&t.getSelection().isEmpty()||(Gr.forceCopyWithSyntaxHighlighting=!0,t.focus(),document.execCommand(`copy`),Gr.forceCopyWithSyntaxHighlighting=!1))}};function nl(e,t){e&&(e.addImplementation(1e4,`code-editor`,(e,n)=>{let r=e.get(po).getFocusedCodeEditor();if(r&&r.hasTextFocus()){let e=r.getOption(32),n=r.getSelection();return n&&n.isEmpty()&&!e||document.execCommand(t),!0}return!1}),e.addImplementation(0,`generic-dom`,(e,n)=>(document.execCommand(t),!0)))}nl(Qc,`cut`),nl($c,`copy`),el&&(el.addImplementation(1e4,`code-editor`,(e,t)=>{let n=e.get(po),r=e.get($r),i=n.getFocusedCodeEditor();return i&&i.hasTextFocus()?!document.execCommand(`paste`)&&Be?(()=>Kc(void 0,void 0,void 0,function*(){let e=yield r.readText();if(e!==``){let t=Sn.INSTANCE.get(e),n=!1,r=null,a=null;t&&(n=i.getOption(32)&&!!t.isFromEmptySelection,r=t.multicursorText===void 0?null:t.multicursorText,a=t.mode),i.trigger(`keyboard`,`paste`,{text:e,pasteOnNewLine:n,multicursorText:r,mode:a})}}))():!0:!1}),el.addImplementation(0,`generic-dom`,(e,t)=>(document.execCommand(`paste`),!0))),Yc&&o(tl);var rl=class{constructor(e){this.executor=e,this._didRun=!1}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}},X=class e{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(t){return this.equals(t)||this.value===``||t.value.startsWith(this.value+e.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(t){return new e(this.value+e.sep+t)}};X.sep=`.`,X.None=new X(`@@none@@`),X.Empty=new X(``),X.QuickFix=new X(`quickfix`),X.Refactor=new X(`refactor`),X.Source=new X(`source`),X.SourceOrganizeImports=X.Source.append(`organizeImports`),X.SourceFixAll=X.Source.append(`fixAll`);function il(e,t){return!(e.include&&!e.include.intersects(t)||e.excludes&&e.excludes.some(n=>ol(t,n,e.include))||!e.includeSourceActions&&X.Source.contains(t))}function al(e,t){let n=t.kind?new X(t.kind):void 0;return!(e.include&&(!n||!e.include.contains(n))||e.excludes&&n&&e.excludes.some(t=>ol(n,t,e.include))||!e.includeSourceActions&&n&&X.Source.contains(n)||e.onlyIncludePreferredActions&&!t.isPreferred)}function ol(e,t,n){return!(!t.contains(e)||n&&t.contains(n))}var sl=class e{constructor(e,t,n){this.kind=e,this.apply=t,this.preferred=n}static fromUser(t,n){return!t||typeof t!=`object`?new e(n.kind,n.apply,!1):new e(e.getKindFromUser(t,n.kind),e.getApplyFromUser(t,n.apply),e.getPreferredUser(t))}static getApplyFromUser(e,t){switch(typeof e.apply==`string`?e.apply.toLowerCase():``){case`first`:return`first`;case`never`:return`never`;case`ifsingle`:return`ifSingle`;default:return t}}static getKindFromUser(e,t){return typeof e.kind==`string`?new X(e.kind):t}static getPreferredUser(e){return typeof e.preferred==`boolean`?e.preferred:!1}},cl=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};const ll=`editor.action.codeAction`,ul=`editor.action.refactor`,dl=`editor.action.sourceAction`,fl=`editor.action.organizeImports`,pl=`editor.action.fixAll`;var ml=class{constructor(e,t){this.action=e,this.provider=t}resolve(e){return cl(this,void 0,void 0,function*(){if(this.provider?.resolveCodeAction&&!this.action.edit){let t;try{t=yield this.provider.resolveCodeAction(this.action,e)}catch(e){nt(e)}t&&(this.action.edit=t.edit)}return this})}},hl=class e extends _{constructor(t,n,r){super(),this.documentation=n,this._register(r),this.allActions=[...t].sort(e.codeActionsComparator),this.validActions=this.allActions.filter(({action:e})=>!e.disabled)}static codeActionsComparator({action:e},{action:t}){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:ti(e.diagnostics)?ti(t.diagnostics)?e.diagnostics[0].message.localeCompare(t.diagnostics[0].message):-1:ti(t.diagnostics)?1:0}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&X.QuickFix.contains(new X(e.kind))&&!!e.isPreferred)}},gl={actions:[],documentation:void 0};function _l(e,t,n,i,a){let o=n.filter||{},s={only:o.include?.value,trigger:n.type},c=new an(e,a),l=vl(e,o),u=new K,d=l.map(n=>cl(this,void 0,void 0,function*(){try{i.report(n);let r=yield n.provideCodeActions(e,t,s,c.token);if(r&&u.add(r),c.token.isCancellationRequested)return gl;let a=(r?.actions||[]).filter(e=>e&&al(o,e)),l=yl(n,a,o.include);return{actions:a.map(e=>new ml(e,n)),documentation:l}}catch(e){if(cn(e))throw e;return nt(e),gl}})),f=Cs.onDidChange(()=>{Ni(Cs.all(e),l)||c.cancel()});return Promise.all(d).then(e=>new hl(no(e.map(e=>e.actions)),r(e.map(e=>e.documentation)),u)).finally(()=>{f.dispose(),c.dispose()})}function vl(e,t){return Cs.all(e).filter(e=>e.providedCodeActionKinds?e.providedCodeActionKinds.some(e=>il(t,new X(e))):!0)}function yl(e,t,n){if(!e.documentation)return;let r=e.documentation.map(e=>({kind:new X(e.kind),command:e.command}));if(n){let e;for(let t of r)t.kind.contains(n)&&(e?e.kind.contains(t.kind)&&(e=t):e=t);if(e)return e?.command}for(let e of t)if(e.kind){for(let t of r)if(t.kind.contains(new X(e.kind)))return t.command}}vs.registerCommand(`_executeCodeActionProvider`,function(e,t,n,r,i){return cl(this,void 0,void 0,function*(){if(!(t instanceof L))throw Ut();let a=e.get(Jo).getModel(t);if(!a)throw Ut();let o=R.isISelection(n)?R.liftSelection(n):W.isIRange(n)?a.validateRange(n):void 0;if(!o)throw Ut();let s=yield _l(a,o,{type:1,filter:{includeSourceActions:!0,include:typeof r==`string`?new X(r):void 0}},ta.None,j.None),c=[],l=Math.min(s.validActions.length,typeof i==`number`?i:0);for(let e=0;e<l;e++)c.push(s.validActions[e].resolve(j.None));try{return yield Promise.all(c),s.validActions.map(e=>e.action)}finally{setTimeout(()=>s.dispose(),100)}})});var bl=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},xl=function(e,t){return function(n,r){t(n,r,e)}},Sl=class e{constructor(t,n){this._messageWidget=new Un,this._messageListeners=new K,this._editor=t,this._visible=e.MESSAGE_VISIBLE.bindTo(n),this._editorListener=this._editor.onDidAttemptReadOnlyEdit(()=>this._onDidAttemptReadOnlyEdit())}static get(t){return t.getContribution(e.ID)}dispose(){this._editorListener.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){Fn(e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._messageWidget.value=new Cl(this._editor,t,e),this._messageListeners.add(this._editor.onDidBlurEditorText(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(new St(()=>this.closeMessage(),3e3));let n;this._messageListeners.add(this._editor.onMouseMove(e=>{e.target.position&&(n?n.containsPosition(e.target.position)||this.closeMessage():n=new W(t.lineNumber-3,1,e.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(Cl.fadeOut(this._messageWidget.value))}_onDidAttemptReadOnlyEdit(){this._editor.hasModel()&&this.showMessage(z(`editor.readonly`,`Cannot edit in read-only editor`),this._editor.getPosition())}};Sl.ID=`editor.contrib.messageController`,Sl.MESSAGE_VISIBLE=new k(`messageVisible`,!1,z(`messageVisible`,`Whether the editor is currently showing an inline message`)),Sl=bl([xl(1,D)],Sl),F(new(ft.bindToContribution(Sl.get))({id:`leaveEditorMessage`,precondition:Sl.MESSAGE_VISIBLE,handler:e=>e.closeMessage(),kbOpts:{weight:130,primary:9}}));var Cl=class{constructor(e,{lineNumber:t,column:n},r){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:n-1},this._domNode=document.createElement(`div`),this._domNode.classList.add(`monaco-editor-overlaymessage`);let i=document.createElement(`div`);i.classList.add(`anchor`,`top`),this._domNode.appendChild(i);let a=document.createElement(`div`);a.classList.add(`message`),a.textContent=r,this._domNode.appendChild(a);let o=document.createElement(`div`);o.classList.add(`anchor`,`below`),this._domNode.appendChild(o),this._editor.addContentWidget(this),this._domNode.classList.add(`fadeIn`)}static fadeOut(e){let t,n=()=>{e.dispose(),clearTimeout(t),e.getDomNode().removeEventListener(`animationend`,n)};return t=setTimeout(n,110),e.getDomNode().addEventListener(`animationend`,n),e.getDomNode().classList.add(`fadeOut`),{dispose:n}}dispose(){this._editor.removeContentWidget(this)}getId(){return`messageoverlay`}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2]}}afterRender(e){this._domNode.classList.toggle(`below`,e===2)}};U(Sl.ID,Sl),Ya((e,t)=>{let n=e.getColor(ai);if(n){let r=e.type===Xi.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.below { border-top-color: ${n}; }`),t.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.top { border-bottom-color: ${n}; }`),t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { border: ${r}px solid ${n}; }`)}let r=e.getColor(_a);r&&t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { background-color: ${r}; }`);let i=e.getColor(_o);i&&t.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { color: ${i}; }`)});var wl=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Tl=function(e,t){return function(n,r){t(n,r,e)}},El=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Dl=class extends Jr{constructor(e,t){super(e.command?e.command.id:e.title,Ol(e.title),void 0,!e.disabled,t),this.action=e}};function Ol(e){return e.replace(/\r\n|\r|\n/g,` `)}var kl=class extends _{constructor(e,t,n,r){super(),this._editor=e,this._delegate=t,this._contextMenuService=n,this._visible=!1,this._showingActions=this._register(new Un),this._keybindingResolver=new Al({getKeybindings:()=>r.getKeybindings()})}get isVisible(){return this._visible}show(e,t,n,r){return El(this,void 0,void 0,function*(){let i=r.includeDisabledActions?t.allActions:t.validActions;if(!i.length){this._visible=!1;return}if(!this._editor.getDomNode())throw this._visible=!1,Pt();this._visible=!0,this._showingActions.value=t;let a=this.getMenuActions(e,i,t.documentation),o=P.isIPosition(n)?this._toCoords(n):n||{x:0,y:0},s=this._keybindingResolver.getResolver(),c=this._editor.getOption(113);this._contextMenuService.showContextMenu({domForShadowRoot:c?this._editor.getDomNode():void 0,getAnchor:()=>o,getActions:()=>a,onHide:()=>{this._visible=!1,this._editor.focus()},autoSelectFirstItem:!0,getKeyBinding:e=>e instanceof Dl?s(e.action):void 0})})}getMenuActions(e,t,n){let r=e=>new Dl(e.action,()=>this._delegate.onSelectCodeAction(e)),i=t.map(r),a=[...n],o=this._editor.getModel();if(o&&i.length)for(let n of Cs.all(o))n._getAdditionalMenuItems&&a.push(...n._getAdditionalMenuItems({trigger:e.type,only:e.filter?.include?.value},t.map(e=>e.action)));return a.length&&i.push(new Bs,...a.map(e=>r(new ml({title:e.title,command:e},void 0)))),i}_toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();let t=this._editor.getScrolledVisiblePosition(e),n=rn(this._editor.getDomNode());return{x:n.left+t.left,y:n.top+t.top+t.height}}};kl=wl([Tl(2,xs),Tl(3,Oo)],kl);var Al=class e{constructor(e){this._keybindingProvider=e}getResolver(){let t=new rl(()=>this._keybindingProvider.getKeybindings().filter(t=>e.codeActionCommands.indexOf(t.command)>=0).filter(e=>e.resolvedKeybinding).map(e=>{let t=e.commandArgs;return e.command===`editor.action.organizeImports`?t={kind:X.SourceOrganizeImports.value}:e.command===`editor.action.fixAll`&&(t={kind:X.SourceFixAll.value}),Object.assign({resolvedKeybinding:e.resolvedKeybinding},sl.fromUser(t,{kind:X.None,apply:`never`}))}));return e=>{if(e.kind)return this.bestKeybindingForCodeAction(e,t.getValue())?.resolvedKeybinding}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;let n=new X(e.kind);return t.filter(e=>e.kind.contains(n)).filter(t=>t.preferred?e.isPreferred:!0).reduceRight((e,t)=>e?e.kind.contains(t.kind)?t:e:t,void 0)}};Al.codeActionCommands=[ul,ll,dl,fl,pl];var jl=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ml=function(e,t){return function(n,r){t(n,r,e)}},Nl;(function(e){e.Hidden={type:0};class t{constructor(e,t,n,r){this.actions=e,this.trigger=t,this.editorPosition=n,this.widgetPosition=r,this.type=1}}e.Showing=t})(Nl||={});var Pl=class e extends _{constructor(e,t,n,r){super(),this._editor=e,this._quickFixActionId=t,this._preferredFixActionId=n,this._keybindingService=r,this._onClick=this._register(new J),this.onClick=this._onClick.event,this._state=Nl.Hidden,this._domNode=document.createElement(`div`),this._domNode.className=M.lightBulb.classNames,this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(e=>{let t=this._editor.getModel();(this.state.type!==1||!t||this.state.editorPosition.lineNumber>=t.getLineCount())&&this.hide()})),yr.ignoreTarget(this._domNode),this._register(Ws(this._domNode,e=>{if(this.state.type!==1)return;this._editor.focus(),e.preventDefault();let{top:t,height:n}=rn(this._domNode),r=this._editor.getOption(58),i=Math.floor(r/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(i+=r),this._onClick.fire({x:e.posx,y:t+n+i,actions:this.state.actions,trigger:this.state.trigger})})),this._register(Qr(this._domNode,`mouseenter`,e=>{if((e.buttons&1)!=1)return;this.hide();let t=new dr;t.startMonitoring(e.target,e.buttons,Qe,()=>{},()=>{t.dispose()})})),this._register(this._editor.onDidChangeConfiguration(e=>{e.hasChanged(56)&&!this._editor.getOption(56).enabled&&this.hide()})),this._updateLightBulbTitleAndIcon(),this._register(this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitleAndIcon,this))}dispose(){super.dispose(),this._editor.removeContentWidget(this)}getId(){return`LightBulbWidget`}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(t,n,r){if(t.validActions.length<=0)return this.hide();let i=this._editor.getOptions();if(!i.get(56).enabled)return this.hide();let a=this._editor.getModel();if(!a)return this.hide();let{lineNumber:o,column:s}=a.validatePosition(r),c=a.getOptions().tabSize,l=i.get(43),u=a.getLineContent(o),d=ts.computeIndentLevel(u,c),f=l.spaceWidth*d>22,p=e=>e>2&&this._editor.getTopForLineNumber(e)===this._editor.getTopForLineNumber(e-1),m=o;if(!f){if(o>1&&!p(o-1))--m;else if(!p(o+1))m+=1;else if(s*l.spaceWidth<22)return this.hide()}this.state=new Nl.Showing(t,n,r,{position:{lineNumber:m,column:1},preference:e._posPref}),this._editor.layoutContentWidget(this)}hide(){this.state=Nl.Hidden,this._editor.layoutContentWidget(this)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this.state.type===1&&this.state.actions.hasAutoFix){this._domNode.classList.remove(...M.lightBulb.classNamesArray),this._domNode.classList.add(...M.lightbulbAutofix.classNamesArray);let e=this._keybindingService.lookupKeybinding(this._preferredFixActionId);if(e){this.title=z(`preferredcodeActionWithKb`,`Show Code Actions. Preferred Quick Fix Available ({0})`,e.getLabel());return}}this._domNode.classList.remove(...M.lightbulbAutofix.classNamesArray),this._domNode.classList.add(...M.lightBulb.classNamesArray);let e=this._keybindingService.lookupKeybinding(this._quickFixActionId);e?this.title=z(`codeActionWithKb`,`Show Code Actions ({0})`,e.getLabel()):this.title=z(`codeAction`,`Show Code Actions`)}set title(e){this._domNode.title=e}};Pl._posPref=[0],Pl=jl([Ml(3,Oo)],Pl),Ya((e,t)=>{let n=e.getColor(Oi)?.transparent(.7),r=e.getColor(Ne);r&&t.addRule(`
		.monaco-editor .contentWidgets ${M.lightBulb.cssSelector} {
			color: ${r};
			background-color: ${n};
		}`);let i=e.getColor(un);i&&t.addRule(`
		.monaco-editor .contentWidgets ${M.lightbulbAutofix.cssSelector} {
			color: ${i};
			background-color: ${n};
		}`)});var Fl=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Il=function(e,t){return function(n,r){t(n,r,e)}},Ll=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Rl=function(e,t,n,r,i){if(r===`m`)throw TypeError(`Private method is not writable`);if(r===`a`&&!i)throw TypeError(`Private accessor was defined without a setter`);if(typeof t==`function`?e!==t||!i:!t.has(e))throw TypeError(`Cannot write private member to an object whose class did not declare it`);return r===`a`?i.call(e,n):i?i.value=n:t.set(e,n),n},zl=function(e,t,n,r){if(n===`a`&&!r)throw TypeError(`Private accessor was defined without a getter`);if(typeof t==`function`?e!==t||!r:!t.has(e))throw TypeError(`Cannot read private member from an object whose class did not declare it`);return n===`m`?r:n===`a`?r.call(e):r?r.value:t.get(e)},Bl,Vl=class extends _{constructor(e,t,n,r,i){super(),this._editor=e,this.delegate=r,this._activeCodeActions=this._register(new Un),Bl.set(this,!1),this._codeActionWidget=new rl(()=>this._register(i.createInstance(kl,this._editor,{onSelectCodeAction:e=>Ll(this,void 0,void 0,function*(){this.delegate.applyCodeAction(e,!0)})}))),this._lightBulbWidget=new rl(()=>{let e=this._register(i.createInstance(Pl,this._editor,t,n));return this._register(e.onClick(e=>this.showCodeActionList(e.trigger,e.actions,e,{includeDisabledActions:!1}))),e})}dispose(){Rl(this,Bl,!0,`f`),super.dispose()}update(e){var t;return Ll(this,void 0,void 0,function*(){if(e.type!==1){(t=this._lightBulbWidget.rawValue)==null||t.hide();return}let n;try{n=yield e.actions}catch(e){C(e);return}if(!zl(this,Bl,`f`))if(this._lightBulbWidget.getValue().update(n,e.trigger,e.position),e.trigger.type===1){if(e.trigger.filter?.include){let t=this.tryGetValidActionToApply(e.trigger,n);if(t){try{this._lightBulbWidget.getValue().hide(),yield this.delegate.applyCodeAction(t,!1)}finally{n.dispose()}return}if(e.trigger.context){let t=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,n);if(t&&t.action.disabled){Sl.get(this._editor).showMessage(t.action.disabled,e.trigger.context.position),n.dispose();return}}}let t=!!e.trigger.filter?.include;if(e.trigger.context&&(!n.allActions.length||!t&&!n.validActions.length)){Sl.get(this._editor).showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=n,n.dispose();return}this._activeCodeActions.value=n,this._codeActionWidget.getValue().show(e.trigger,n,e.position,{includeDisabledActions:t})}else this._codeActionWidget.getValue().isVisible?n.dispose():this._activeCodeActions.value=n})}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply===`first`&&t.validActions.length===0||e.autoApply===`ifSingle`&&t.allActions.length===1))return t.allActions.find(({action:e})=>e.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply===`first`&&t.validActions.length>0||e.autoApply===`ifSingle`&&t.validActions.length===1))return t.validActions[0]}showCodeActionList(e,t,n,r){return Ll(this,void 0,void 0,function*(){this._codeActionWidget.getValue().show(e,t,n,r)})}};Bl=new WeakMap,Vl=Fl([Il(4,H)],Vl);var Hl=function(e,t,n,r){if(n===`a`&&!r)throw TypeError(`Private accessor was defined without a getter`);if(typeof t==`function`?e!==t||!r:!t.has(e))throw TypeError(`Cannot read private member from an object whose class did not declare it`);return n===`m`?r:n===`a`?r.call(e):r?r.value:t.get(e)},Ul=function(e,t,n,r,i){if(r===`m`)throw TypeError(`Private method is not writable`);if(r===`a`&&!i)throw TypeError(`Private accessor was defined without a setter`);if(typeof t==`function`?e!==t||!i:!t.has(e))throw TypeError(`Cannot write private member to an object whose class did not declare it`);return r===`a`?i.call(e,n):i?i.value=n:t.set(e,n),n},Wl;const Gl=new k(`supportedCodeAction`,``);var Kl=class extends _{constructor(e,t,n,r=250){super(),this._editor=e,this._markerService=t,this._signalChange=n,this._delay=r,this._autoTriggerTimer=this._register(new St),this._register(this._markerService.onMarkerChanged(e=>this._onMarkerChanges(e))),this._register(this._editor.onDidChangeCursorPosition(()=>this._onCursorChange()))}trigger(e){let t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);return this._createEventAndSignalChange(e,t)}_onMarkerChanges(e){let t=this._editor.getModel();t&&e.some(e=>Kt(e,t.uri))&&this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2})},this._delay)}_onCursorChange(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2})},this._delay)}_getRangeOfMarker(e){let t=this._editor.getModel();if(t)for(let n of this._markerService.read({resource:t.uri})){let r=t.validateRange(n);if(W.intersectRanges(r,e))return W.lift(r)}}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;let t=this._editor.getModel(),n=this._editor.getSelection();if(n.isEmpty()&&e.type===2){let{lineNumber:e,column:r}=n.getPosition(),i=t.getLineContent(e);if(i.length===0)return;if(r===1){if(/\s/.test(i[0]))return}else if(r===t.getLineMaxColumn(e)){if(/\s/.test(i[i.length-1]))return}else if(/\s/.test(i[r-2])&&/\s/.test(i[r-1]))return}return n}_createEventAndSignalChange(e,t){let n=this._editor.getModel();if(!t||!n){this._signalChange(void 0);return}let r=this._getRangeOfMarker(t),i={trigger:e,selection:t,position:r?r.getStartPosition():t.getStartPosition()};return this._signalChange(i),i}},ql;(function(e){e.Empty={type:0};class t{constructor(e,t,n,r){this.trigger=e,this.rangeOrSelection=t,this.position=n,this._cancellablePromise=r,this.type=1,this.actions=r.catch(e=>{if(cn(e))return Jl;throw e})}cancel(){this._cancellablePromise.cancel()}}e.Triggered=t})(ql||={});var Jl={allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1},Yl=class extends _{constructor(e,t,n,r){super(),this._editor=e,this._markerService=t,this._progressService=r,this._codeActionOracle=this._register(new Un),this._state=ql.Empty,this._onDidChangeState=this._register(new J),this.onDidChangeState=this._onDidChangeState.event,Wl.set(this,!1),this._supportedCodeActions=Gl.bindTo(n),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(Cs.onDidChange(()=>this._update())),this._update()}dispose(){Hl(this,Wl,`f`)||(Ul(this,Wl,!0,`f`),super.dispose(),this.setState(ql.Empty,!0))}_update(){if(Hl(this,Wl,`f`))return;this._codeActionOracle.value=void 0,this.setState(ql.Empty);let e=this._editor.getModel();if(e&&Cs.has(e)&&!this._editor.getOption(80)){let t=[];for(let n of Cs.all(e))Array.isArray(n.providedCodeActionKinds)&&t.push(...n.providedCodeActionKinds);this._supportedCodeActions.set(t.join(` `)),this._codeActionOracle.value=new Kl(this._editor,this._markerService,t=>{var n;if(!t){this.setState(ql.Empty);return}let r=No(n=>_l(e,t.selection,t.trigger,ta.None,n));t.trigger.type===1&&((n=this._progressService)==null||n.showWhile(r,250)),this.setState(new ql.Triggered(t.trigger,t.selection,t.position,r))},void 0),this._codeActionOracle.value.trigger({type:2})}else this._supportedCodeActions.reset()}trigger(e){this._codeActionOracle.value&&this._codeActionOracle.value.trigger(e)}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!Hl(this,Wl,`f`)&&this._onDidChangeState.fire(e))}};Wl=new WeakMap;var Xl=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Zl=function(e,t){return function(n,r){t(n,r,e)}},Ql=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};function $l(e){return w.regex(Gl.keys()[0],RegExp(`(\\s|^)`+Er(e.value)+`\\b`))}var eu={type:`object`,defaultSnippets:[{body:{kind:``}}],properties:{kind:{type:`string`,description:z(`args.schema.kind`,`Kind of the code action to run.`)},apply:{type:`string`,description:z(`args.schema.apply`,`Controls when the returned actions are applied.`),default:`ifSingle`,enum:[`first`,`ifSingle`,`never`],enumDescriptions:[z(`args.schema.apply.first`,`Always apply the first returned code action.`),z(`args.schema.apply.ifSingle`,`Apply the first returned code action if it is the only one.`),z(`args.schema.apply.never`,`Do not apply the returned code actions.`)]},preferred:{type:`boolean`,default:!1,description:z(`args.schema.preferred`,`Controls if only preferred code actions should be returned.`)}}},tu=class e extends _{constructor(e,t,n,r,i){super(),this._instantiationService=i,this._editor=e,this._model=this._register(new Yl(this._editor,t,n,r)),this._register(this._model.onDidChangeState(e=>this.update(e))),this._ui=new rl(()=>this._register(new Vl(e,au.Id,du.Id,{applyCodeAction:(e,t)=>Ql(this,void 0,void 0,function*(){try{yield this._applyCodeAction(e)}finally{t&&this._trigger({type:2,filter:{}})}})},this._instantiationService)))}static get(t){return t.getContribution(e.ID)}update(e){this._ui.getValue().update(e)}showCodeActions(e,t,n){return this._ui.getValue().showCodeActionList(e,t,n,{includeDisabledActions:!1})}manualTriggerAtCurrentPosition(e,t,n){if(!this._editor.hasModel())return;Sl.get(this._editor).closeMessage();let r=this._editor.getPosition();this._trigger({type:1,filter:t,autoApply:n,context:{notAvailableMessage:e,position:r}})}_trigger(e){return this._model.trigger(e)}_applyCodeAction(e){return this._instantiationService.invokeFunction(nu,e,this._editor)}};tu.ID=`editor.contrib.quickFixController`,tu=Xl([Zl(1,Cn),Zl(2,D),Zl(3,ua),Zl(4,H)],tu);function nu(e,t,n){return Ql(this,void 0,void 0,function*(){let r=e.get(ie),i=e.get(Hs),a=e.get(mo),o=e.get(Ft);if(a.publicLog2(`codeAction.applyCodeAction`,{codeActionTitle:t.action.title,codeActionKind:t.action.kind,codeActionIsPreferred:!!t.action.isPreferred}),yield t.resolve(j.None),t.action.edit&&(yield r.apply(cr.convert(t.action.edit),{editor:n,label:t.action.title})),t.action.command)try{yield i.executeCommand(t.action.command.id,...t.action.command.arguments||[])}catch(e){let t=ru(e);o.error(typeof t==`string`?t:z(`applyCodeActionFailed`,`An unknown error occurred while applying the code action`))}})}function ru(e){if(typeof e==`string`)return e;if(e instanceof Error&&typeof e.message==`string`)return e.message}function iu(e,t,n,r){if(e.hasModel()){let i=tu.get(e);i&&i.manualTriggerAtCurrentPosition(t,n,r)}}var au=class e extends V{constructor(){super({id:e.Id,label:z(`quickfix.trigger.label`,`Quick Fix...`),alias:`Quick Fix...`,precondition:w.and(A.writable,A.hasCodeActionsProvider),kbOpts:{kbExpr:A.editorTextFocus,primary:2132,weight:100}})}run(e,t){return iu(t,z(`editor.action.quickFix.noneMessage`,`No code actions available`),void 0,void 0)}};au.Id=`editor.action.quickFix`;var ou=class extends ft{constructor(){super({id:ll,precondition:w.and(A.writable,A.hasCodeActionsProvider),description:{description:`Trigger a code action`,args:[{name:`args`,schema:eu}]}})}runEditorCommand(e,t,n){let r=sl.fromUser(n,{kind:X.Empty,apply:`ifSingle`});return iu(t,typeof n?.kind==`string`?r.preferred?z(`editor.action.codeAction.noneMessage.preferred.kind`,`No preferred code actions for '{0}' available`,n.kind):z(`editor.action.codeAction.noneMessage.kind`,`No code actions for '{0}' available`,n.kind):r.preferred?z(`editor.action.codeAction.noneMessage.preferred`,`No preferred code actions available`):z(`editor.action.codeAction.noneMessage`,`No code actions available`),{include:r.kind,includeSourceActions:!0,onlyIncludePreferredActions:r.preferred},r.apply)}},su=class extends V{constructor(){super({id:ul,label:z(`refactor.label`,`Refactor...`),alias:`Refactor...`,precondition:w.and(A.writable,A.hasCodeActionsProvider),kbOpts:{kbExpr:A.editorTextFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:`1_modification`,order:2,when:w.and(A.writable,$l(X.Refactor))},description:{description:`Refactor...`,args:[{name:`args`,schema:eu}]}})}run(e,t,n){let r=sl.fromUser(n,{kind:X.Refactor,apply:`never`});return iu(t,typeof n?.kind==`string`?r.preferred?z(`editor.action.refactor.noneMessage.preferred.kind`,`No preferred refactorings for '{0}' available`,n.kind):z(`editor.action.refactor.noneMessage.kind`,`No refactorings for '{0}' available`,n.kind):r.preferred?z(`editor.action.refactor.noneMessage.preferred`,`No preferred refactorings available`):z(`editor.action.refactor.noneMessage`,`No refactorings available`),{include:X.Refactor.contains(r.kind)?r.kind:X.None,onlyIncludePreferredActions:r.preferred},r.apply)}},cu=class extends V{constructor(){super({id:dl,label:z(`source.label`,`Source Action...`),alias:`Source Action...`,precondition:w.and(A.writable,A.hasCodeActionsProvider),contextMenuOpts:{group:`1_modification`,order:2.1,when:w.and(A.writable,$l(X.Source))},description:{description:`Source Action...`,args:[{name:`args`,schema:eu}]}})}run(e,t,n){let r=sl.fromUser(n,{kind:X.Source,apply:`never`});return iu(t,typeof n?.kind==`string`?r.preferred?z(`editor.action.source.noneMessage.preferred.kind`,`No preferred source actions for '{0}' available`,n.kind):z(`editor.action.source.noneMessage.kind`,`No source actions for '{0}' available`,n.kind):r.preferred?z(`editor.action.source.noneMessage.preferred`,`No preferred source actions available`):z(`editor.action.source.noneMessage`,`No source actions available`),{include:X.Source.contains(r.kind)?r.kind:X.None,includeSourceActions:!0,onlyIncludePreferredActions:r.preferred},r.apply)}},lu=class extends V{constructor(){super({id:fl,label:z(`organizeImports.label`,`Organize Imports`),alias:`Organize Imports`,precondition:w.and(A.writable,$l(X.SourceOrganizeImports)),kbOpts:{kbExpr:A.editorTextFocus,primary:1581,weight:100}})}run(e,t){return iu(t,z(`editor.action.organize.noneMessage`,`No organize imports action available`),{include:X.SourceOrganizeImports,includeSourceActions:!0},`ifSingle`)}},uu=class extends V{constructor(){super({id:pl,label:z(`fixAll.label`,`Fix All`),alias:`Fix All`,precondition:w.and(A.writable,$l(X.SourceFixAll))})}run(e,t){return iu(t,z(`fixAll.noneMessage`,`No fix all action available`),{include:X.SourceFixAll,includeSourceActions:!0},`ifSingle`)}},du=class e extends V{constructor(){super({id:e.Id,label:z(`autoFix.label`,`Auto Fix...`),alias:`Auto Fix...`,precondition:w.and(A.writable,$l(X.QuickFix)),kbOpts:{kbExpr:A.editorTextFocus,primary:1620,mac:{primary:2644},weight:100}})}run(e,t){return iu(t,z(`editor.action.autoFix.noneMessage`,`No auto fixes available`),{include:X.QuickFix,onlyIncludePreferredActions:!0},`ifSingle`)}};du.Id=`editor.action.autoFix`,U(tu.ID,tu),o(au),o(su),o(cu),o(lu),o(du),o(uu),F(new ou);var fu=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},pu=class{constructor(){this.lenses=[],this._disposables=new K}dispose(){this._disposables.dispose()}add(e,t){this._disposables.add(e);for(let n of e.lenses)this.lenses.push({symbol:n,provider:t})}};function mu(e,t){return fu(this,void 0,void 0,function*(){let n=Hn.ordered(e),r=new Map,i=new pu,a=n.map((n,a)=>fu(this,void 0,void 0,function*(){r.set(n,a);try{let r=yield Promise.resolve(n.provideCodeLenses(e,t));r&&i.add(r,n)}catch(e){nt(e)}}));return yield Promise.all(a),i.lenses=i.lenses.sort((e,t)=>e.symbol.range.startLineNumber<t.symbol.range.startLineNumber?-1:e.symbol.range.startLineNumber>t.symbol.range.startLineNumber?1:r.get(e.provider)<r.get(t.provider)?-1:r.get(e.provider)>r.get(t.provider)?1:e.symbol.range.startColumn<t.symbol.range.startColumn?-1:e.symbol.range.startColumn>t.symbol.range.startColumn?1:0),i})}vs.registerCommand(`_executeCodeLensProvider`,function(e,...t){let[n,r]=t;Fs(L.isUri(n)),Fs(typeof r==`number`||!r);let i=e.get(Jo).getModel(n);if(!i)throw Ut();let a=[],o=new K;return mu(i,j.None).then(e=>{o.add(e);let t=[];for(let n of e.lenses)r==null||n.symbol.command?a.push(n.symbol):r-- >0&&n.provider.resolveCodeLens&&t.push(Promise.resolve(n.provider.resolveCodeLens(i,n.symbol,j.None)).then(e=>a.push(e||n.symbol)));return Promise.all(t)}).then(()=>a).finally(()=>{setTimeout(()=>o.dispose(),100)})});var hu=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},gu=function(e,t){return function(n,r){t(n,r,e)}};const _u=yi(`ICodeLensCache`);var vu=class{constructor(e,t){this.lineCount=e,this.data=t}},yu=class{constructor(e){this._fakeProvider=new class{provideCodeLenses(){throw Error(`not supported`)}},this._cache=new oe(20,.75),Wr(()=>e.remove(`codelens/cache`,1));let t=`codelens/cache2`,n=e.get(t,1,`{}`);this._deserialize(n),Sa(e.onWillSaveState)(n=>{n.reason===E.SHUTDOWN&&e.store(t,this._serialize(),1,1)})}put(e,t){let n=t.lenses.map(e=>({range:e.symbol.range,command:e.symbol.command&&{id:``,title:e.symbol.command?.title}})),r=new pu;r.add({lenses:n,dispose:()=>{}},this._fakeProvider);let i=new vu(e.getLineCount(),r);this._cache.set(e.uri.toString(),i)}get(e){let t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){let e=Object.create(null);for(let[t,n]of this._cache){let r=new Set;for(let e of n.data.lenses)r.add(e.symbol.range.startLineNumber);e[t]={lineCount:n.lineCount,lines:[...r.values()]}}return JSON.stringify(e)}_deserialize(e){try{let t=JSON.parse(e);for(let e in t){let n=t[e],r=[];for(let e of n.lines)r.push({range:new W(e,1,e,11)});let i=new pu;i.add({lenses:r,dispose(){}},this._fakeProvider),this._cache.set(e,new vu(n.lineCount,i))}}catch{}}};yu=hu([gu(0,je)],yu),Bi(_u,yu);var bu=class{constructor(e,t,n){this.afterLineNumber=e,this.heightInPx=t,this._onHeight=n,this.suppressMouseDown=!0,this.domNode=document.createElement(`div`)}onComputedHeight(e){this._lastHeight===void 0?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute(`monaco-visible-view-zone`)}},xu=class e{constructor(t,n,r){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=t,this._id=`codelens.widget-${e._idPool++}`,this.updatePosition(r),this._domNode=document.createElement(`span`),this._domNode.className=`codelens-decoration ${n}`}withCommands(e,t){this._commands.clear();let n=[],r=!1;for(let t=0;t<e.length;t++){let i=e[t];if(i&&(r=!0,i.command)){let r=on(i.command.title.trim());i.command.id?(n.push(G(`a`,{id:String(t),title:i.command.tooltip},...r)),this._commands.set(String(t),i.command)):n.push(G(`span`,{title:i.command.tooltip},...r)),t+1<e.length&&n.push(G(`span`,void 0,`\xA0|\xA0`))}}r?(At(this._domNode,...n),this._isEmpty&&t&&this._domNode.classList.add(`fadein`),this._isEmpty=!1):At(this._domNode,G(`span`,void 0,`no commands`))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){this._widgetPosition={position:{lineNumber:e,column:this._editor.getModel().getLineFirstNonWhitespaceColumn(e)},preference:[1]}}getPosition(){return this._widgetPosition||null}};xu._idPool=0;var Su=class{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){let t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let e=0,n=t.length;e<n;e++)this._addDecorationsCallbacks[e](t[e])}},Cu=class{constructor(e,t,n,r,i,a,o){this._isDisposed=!1,this._editor=t,this._className=n,this._data=e,this._decorationIds=[];let s,c=[];this._data.forEach((e,t)=>{e.symbol.command&&c.push(e.symbol),r.addDecoration({range:e.symbol.range,options:I.EMPTY},e=>this._decorationIds[t]=e),s=s?W.plusRange(s,e.symbol.range):W.lift(e.symbol.range)}),this._viewZone=new bu(s.startLineNumber-1,a,o),this._viewZoneId=i.addZone(this._viewZone),c.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(c,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new xu(this._editor,this._className,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t&&t.removeZone(this._viewZoneId),this._contentWidget&&=(this._editor.removeContentWidget(this._contentWidget),void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some((e,t)=>{let n=this._editor.getModel().getDecorationRange(e),r=this._data[t].symbol;return!!(n&&W.isEmpty(r.range)===n.isEmpty())})}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach((e,n)=>{t.addDecoration({range:e.symbol.range,options:I.EMPTY},e=>this._decorationIds[n]=e)})}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.isVisible())return null;for(let t=0;t<this._decorationIds.length;t++){let n=e.getDecorationRange(this._decorationIds[t]);n&&(this._data[t].symbol.range=n)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){let n=e[t];if(n){let{symbol:e}=this._data[t];e.command=n.command||e.command}}}getCommand(e){return this._contentWidget?.getCommand(e)}getLineNumber(){let e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){let t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}getItems(){return this._data}};Ya((e,t)=>{let n=e.getColor(ha);n&&(t.addRule(`.monaco-editor .codelens-decoration { color: ${n}; }`),t.addRule(`.monaco-editor .codelens-decoration .codicon { color: ${n}; }`));let r=e.getColor(ls);r&&(t.addRule(`.monaco-editor .codelens-decoration > a:hover { color: ${r} !important; }`),t.addRule(`.monaco-editor .codelens-decoration > a:hover .codicon { color: ${r} !important; }`))});var wu=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Tu=function(e,t){return function(n,r){t(n,r,e)}},Eu=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Du=class{constructor(e,t,n,r){this._editor=e,this._commandService=t,this._notificationService=n,this._codeLensCache=r,this._disposables=new K,this._localToDispose=new K,this._lenses=[],this._getCodeLensModelDelays=new go(Hn,250,2500),this._oldCodeLensModels=new K,this._resolveCodeLensesDelays=new go(Hn,250,2500),this._resolveCodeLensesScheduler=new T(()=>this._resolveCodeLensesInViewport(),this._resolveCodeLensesDelays.min),this._disposables.add(this._editor.onDidChangeModel(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeConfiguration(e=>{(e.hasChanged(43)||e.hasChanged(16)||e.hasChanged(15))&&this._updateLensStyle(),e.hasChanged(14)&&this._onModelChange()})),this._disposables.add(Hn.onDidChange(this._onModelChange,this)),this._onModelChange(),this._styleClassName=`_`+Ha(this._editor.getId()).toString(16),this._styleElement=Jn(pn(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0),this._updateLensStyle()}dispose(){var e;this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),(e=this._currentCodeLensModel)==null||e.dispose(),this._styleElement.remove()}_getLayoutInfo(){let e=this._editor.getOption(16),t;return!e||e<5?(e=this._editor.getOption(45)*.9|0,t=this._editor.getOption(58)):t=e*Math.max(1.3,this._editor.getOption(58)/this._editor.getOption(45))|0,{codeLensHeight:t,fontSize:e}}_updateLensStyle(){let{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),n=this._editor.getOption(15),r=this._editor.getOption(43),i=`--codelens-font-family${this._styleClassName}`,a=`--codelens-font-features${this._styleClassName}`,o=`
		.monaco-editor .codelens-decoration.${this._styleClassName} { line-height: ${e}px; font-size: ${t}px; padding-right: ${Math.round(t*.5)}px; font-feature-settings: var(${a}) }
		.monaco-editor .codelens-decoration.${this._styleClassName} span.codicon { line-height: ${e}px; font-size: ${t}px; }
		`;n&&(o+=`.monaco-editor .codelens-decoration.${this._styleClassName} { font-family: var(${i}), ${Et.fontFamily}}`),this._styleElement.textContent=o,this._editor.getContainerDomNode().style.setProperty(i,n??`inherit`),this._editor.getContainerDomNode().style.setProperty(a,r.fontFeatureSettings),this._editor.changeViewZones(t=>{for(let n of this._lenses)n.updateHeight(e,t)})}_localDispose(){var e,t,n;(e=this._getCodeLensModelPromise)==null||e.cancel(),this._getCodeLensModelPromise=void 0,(t=this._resolveCodeLensesPromise)==null||t.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),(n=this._currentCodeLensModel)==null||n.dispose()}_onModelChange(){this._localDispose();let e=this._editor.getModel();if(!e||!this._editor.getOption(14))return;let t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!Hn.has(e)){t&&this._localToDispose.add(pt(()=>{t===this._codeLensCache.get(e)&&(this._codeLensCache.delete(e),this._onModelChange())},30*1e3));return}for(let t of Hn.all(e))if(typeof t.onDidChange==`function`){let e=t.onDidChange(()=>n.schedule());this._localToDispose.add(e)}let n=new T(()=>{var t;let r=Date.now();(t=this._getCodeLensModelPromise)==null||t.cancel(),this._getCodeLensModelPromise=No(t=>mu(e,t)),this._getCodeLensModelPromise.then(t=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=t,this._codeLensCache.put(e,t),n.delay=this._getCodeLensModelDelays.update(e,Date.now()-r),this._renderCodeLensSymbols(t),this._resolveCodeLensesInViewportSoon()},C)},this._getCodeLensModelDelays.get(e));this._localToDispose.add(n),this._localToDispose.add(ja(()=>this._resolveCodeLensesScheduler.cancel())),this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._editor.changeDecorations(e=>{this._editor.changeViewZones(t=>{let n=[],r=-1;this._lenses.forEach(e=>{!e.isValid()||r===e.getLineNumber()?n.push(e):(e.update(t),r=e.getLineNumber())});let i=new Su;n.forEach(e=>{e.dispose(i,t),this._lenses.splice(this._lenses.indexOf(e),1)}),i.commit(e)})}),n.schedule()})),this._localToDispose.add(this._editor.onDidFocusEditorWidget(()=>{n.schedule()})),this._localToDispose.add(this._editor.onDidScrollChange(e=>{e.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(this._editor.onDidLayoutChange(()=>{this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(ja(()=>{if(this._editor.getModel()){let e=b.capture(this._editor);this._editor.changeDecorations(e=>{this._editor.changeViewZones(t=>{this._disposeAllLenses(e,t)})}),e.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)})),this._localToDispose.add(this._editor.onMouseDown(e=>{if(e.target.type!==9)return;let t=e.target.element;if(t?.tagName===`SPAN`&&(t=t.parentElement),t?.tagName===`A`)for(let e of this._lenses){let n=e.getCommand(t);if(n){this._commandService.executeCommand(n.id,...n.arguments||[]).catch(e=>this._notificationService.error(e));break}}})),n.schedule()}_disposeAllLenses(e,t){let n=new Su;for(let e of this._lenses)e.dispose(n,t);e&&n.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;let t=this._editor.getModel().getLineCount(),n=[],r;for(let i of e.lenses){let e=i.symbol.range.startLineNumber;e<1||e>t||(r&&r[r.length-1].symbol.range.startLineNumber===e?r.push(i):(r=[i],n.push(r)))}let i=b.capture(this._editor),a=this._getLayoutInfo();this._editor.changeDecorations(e=>{this._editor.changeViewZones(t=>{let r=new Su,i=0,o=0;for(;o<n.length&&i<this._lenses.length;){let e=n[o][0].symbol.range.startLineNumber,s=this._lenses[i].getLineNumber();s<e?(this._lenses[i].dispose(r,t),this._lenses.splice(i,1)):s===e?(this._lenses[i].updateCodeLensSymbols(n[o],r),o++,i++):(this._lenses.splice(i,0,new Cu(n[o],this._editor,this._styleClassName,r,t,a.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),i++,o++)}for(;i<this._lenses.length;)this._lenses[i].dispose(r,t),this._lenses.splice(i,1);for(;o<n.length;)this._lenses.push(new Cu(n[o],this._editor,this._styleClassName,r,t,a.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),o++;r.commit(e)})}),i.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){var e;(e=this._resolveCodeLensesPromise)==null||e.cancel(),this._resolveCodeLensesPromise=void 0;let t=this._editor.getModel();if(!t)return;let n=[],r=[];if(this._lenses.forEach(e=>{let i=e.computeIfNecessary(t);i&&(n.push(i),r.push(e))}),n.length===0)return;let i=Date.now(),a=No(e=>{let i=n.map((n,i)=>{let a=Array(n.length),o=n.map((n,r)=>!n.symbol.command&&typeof n.provider.resolveCodeLens==`function`?Promise.resolve(n.provider.resolveCodeLens(t,n.symbol,e)).then(e=>{a[r]=e},nt):(a[r]=n.symbol,Promise.resolve(void 0)));return Promise.all(o).then(()=>{!e.isCancellationRequested&&!r[i].isDisposed()&&r[i].updateCommands(a)})});return Promise.all(i)});this._resolveCodeLensesPromise=a,this._resolveCodeLensesPromise.then(()=>{let e=this._resolveCodeLensesDelays.update(t,Date.now()-i);this._resolveCodeLensesScheduler.delay=e,this._currentCodeLensModel&&this._codeLensCache.put(t,this._currentCodeLensModel),this._oldCodeLensModels.clear(),a===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)},e=>{C(e),a===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)})}getLenses(){return this._lenses}};Du.ID=`css.editor.codeLens`,Du=wu([Tu(1,Hs),Tu(2,Ft),Tu(3,_u)],Du),U(Du.ID,Du),o(class extends V{constructor(){super({id:`codelens.showLensesInCurrentLine`,precondition:A.hasCodeLensProvider,label:z(`showLensOnLine`,`Show CodeLens Commands For Current Line`),alias:`Show CodeLens Commands For Current Line`})}run(e,t){return Eu(this,void 0,void 0,function*(){if(!t.hasModel())return;let n=e.get(ci),r=e.get(Hs),i=e.get(Ft),a=t.getSelection().positionLineNumber,o=t.getContribution(Du.ID),s=[];for(let e of o.getLenses())if(e.getLineNumber()===a)for(let t of e.getItems()){let{command:e}=t.symbol;e&&s.push({label:e.title,command:e})}if(s.length===0)return;let c=yield n.pick(s,{canPickMany:!1});if(c)try{yield r.executeCommand(c.command.id,...c.command.arguments||[])}catch(e){i.error(e)}})}});function Ou(e,t){let n=[],r=x.ordered(e).reverse().map(r=>Promise.resolve(r.provideDocumentColors(e,t)).then(e=>{if(Array.isArray(e))for(let t of e)n.push({colorInfo:t,provider:r})}));return Promise.all(r).then(()=>n)}function ku(e,t,n,r){return Promise.resolve(n.provideColorPresentations(e,t,r))}vs.registerCommand(`_executeDocumentColorProvider`,function(e,...t){let[n]=t;if(!(n instanceof L))throw Ut();let r=e.get(Jo).getModel(n);if(!r)throw Ut();let i=[],a=x.ordered(r).reverse().map(e=>Promise.resolve(e.provideDocumentColors(r,j.None)).then(e=>{if(Array.isArray(e))for(let t of e)i.push({range:t.range,color:[t.color.red,t.color.green,t.color.blue,t.color.alpha]})}));return Promise.all(a).then(()=>i)}),vs.registerCommand(`_executeColorPresentationProvider`,function(e,...t){let[n,r]=t,{uri:i,range:a}=r;if(!(i instanceof L)||!Array.isArray(n)||n.length!==4||!W.isIRange(a))throw Ut();let[o,s,c,l]=n,u=e.get(Jo).getModel(i);if(!u)throw Ut();let d={range:a,color:{red:o,green:s,blue:c,alpha:l}},f=[],p=x.ordered(u).reverse().map(e=>Promise.resolve(e.provideColorPresentations(u,d,j.None)).then(e=>{Array.isArray(e)&&f.push(...e)}));return Promise.all(p).then(()=>f)});var Au=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ju=function(e,t){return function(n,r){t(n,r,e)}},Mu=500,Nu=class e extends _{constructor(e,t,n){super(),this._editor=e,this._codeEditorService=t,this._configurationService=n,this._localToDispose=this._register(new K),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=[],this._decorationsTypes=new Set,this._register(e.onDidChangeModel(()=>{this._isEnabled=this.isEnabled(),this.onModelChanged()})),this._register(e.onDidChangeModelLanguage(()=>this.onModelChanged())),this._register(x.onDidChange(()=>this.onModelChanged())),this._register(e.onDidChangeConfiguration(()=>{let e=this._isEnabled;this._isEnabled=this.isEnabled(),e!==this._isEnabled&&(this._isEnabled?this.onModelChanged():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isEnabled=this.isEnabled(),this.onModelChanged()}isEnabled(){let e=this._editor.getModel();if(!e)return!1;let t=e.getLanguageId(),n=this._configurationService.getValue(t);if(n&&typeof n==`object`){let e=n.colorDecorators;if(e&&e.enable!==void 0&&!e.enable)return e.enable}return this._editor.getOption(17)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}onModelChanged(){if(this.stop(),!this._isEnabled)return;let t=this._editor.getModel();!t||!x.has(t)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new St,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},e.RECOMPUTE_TIME))})),this.beginCompute())}beginCompute(){this._computePromise=No(e=>{let t=this._editor.getModel();return t?Ou(t,e):Promise.resolve([])}),this._computePromise.then(e=>{this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null},C)}stop(){this._timeoutTimer&&=(this._timeoutTimer.cancel(),null),this._computePromise&&=(this._computePromise.cancel(),null),this._localToDispose.clear()}updateDecorations(e){let t=e.map(e=>({range:{startLineNumber:e.colorInfo.range.startLineNumber,startColumn:e.colorInfo.range.startColumn,endLineNumber:e.colorInfo.range.endLineNumber,endColumn:e.colorInfo.range.endColumn},options:I.EMPTY}));this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach((t,n)=>this._colorDatas.set(t,e[n]))}updateColorDecorators(e){let t=[],n={};for(let r=0;r<e.length&&t.length<Mu;r++){let{red:i,green:a,blue:o,alpha:s}=e[r].colorInfo.color,c=new kn(Math.round(i*255),Math.round(a*255),Math.round(o*255),s),l=Ha(`rgba(${c.r},${c.g},${c.b},${c.a})`).toString(16),u=`rgba(${c.r}, ${c.g}, ${c.b}, ${c.a})`,d=`colorBox-`+l;!this._decorationsTypes.has(d)&&!n[d]&&this._codeEditorService.registerDecorationType(`color-detector-color`,d,{before:{contentText:` `,border:`solid 0.1em #000`,margin:`0.1em 0.2em 0 0.2em`,width:`0.8em`,height:`0.8em`,backgroundColor:u},dark:{before:{border:`solid 0.1em #eee`}}},void 0,this._editor),n[d]=!0,t.push({range:{startLineNumber:e[r].colorInfo.range.startLineNumber,startColumn:e[r].colorInfo.range.startColumn,endLineNumber:e[r].colorInfo.range.endLineNumber,endColumn:e[r].colorInfo.range.endColumn},options:this._codeEditorService.resolveDecorationOptions(d,!0)})}this._decorationsTypes.forEach(e=>{n[e]||this._codeEditorService.removeDecorationType(e)}),this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,t)}removeAllDecorations(){this._decorationsIds=this._editor.deltaDecorations(this._decorationsIds,[]),this._colorDecoratorIds=this._editor.deltaDecorations(this._colorDecoratorIds,[]),this._decorationsTypes.forEach(e=>{this._codeEditorService.removeDecorationType(e)})}getColorData(e){let t=this._editor.getModel();if(!t)return null;let n=t.getDecorationsInRange(W.fromPositions(e,e)).filter(e=>this._colorDatas.has(e.id));return n.length===0?null:this._colorDatas.get(n[0].id)}};Nu.ID=`editor.contrib.colorDetector`,Nu.RECOMPUTE_TIME=1e3,Nu=Au([ju(1,po),ju(2,xo)],Nu),U(Nu.ID,Nu);function Pu(e,t){return!!e[t]}var Fu=class{constructor(e,t){this.target=e.target,this.hasTriggerModifier=Pu(e.event,t.triggerModifier),this.hasSideBySideModifier=Pu(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}},Iu=class{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=Pu(e,t.triggerModifier)}},Lu=class{constructor(e,t,n,r){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=n,this.triggerSideBySideModifier=r}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}};function Ru(e){return e===`altKey`?Qn?new Lu(57,`metaKey`,6,`altKey`):new Lu(5,`ctrlKey`,6,`altKey`):Qn?new Lu(6,`altKey`,57,`metaKey`):new Lu(6,`altKey`,5,`ctrlKey`)}var zu=class extends _{constructor(e){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new J),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new J),this.onExecute=this._onExecute.event,this._onCancel=this._register(new J),this.onCancel=this._onCancel.event,this._editor=e,this._opts=Ru(this._editor.getOption(69)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(e=>{if(e.hasChanged(69)){let e=Ru(this._editor.getOption(69));if(this._opts.equals(e))return;this._opts=e,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(e=>this._onEditorMouseMove(new Fu(e,this._opts)))),this._register(this._editor.onMouseDown(e=>this._onEditorMouseDown(new Fu(e,this._opts)))),this._register(this._editor.onMouseUp(e=>this._onEditorMouseUp(new Fu(e,this._opts)))),this._register(this._editor.onKeyDown(e=>this._onEditorKeyDown(new Iu(e,this._opts)))),this._register(this._editor.onKeyUp(e=>this._onEditorKeyUp(new Iu(e,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(e=>this._onDidChangeCursorSelection(e))),this._register(this._editor.onDidChangeModel(e=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(e=>{(e.scrollTopChanged||e.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=e.target.position?e.target.position.lineNumber:0}_onEditorMouseUp(e){let t=e.target.position?e.target.position.lineNumber:0;this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}},Bu=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Vu=function(e,t){return function(n,r){t(n,r,e)}},Hu=class extends Bt{constructor(e,t,n,r,i,a,o,s,c,l){super(e,Object.assign(Object.assign({},n.getRawOptions()),{overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()}),{},r,i,a,o,s,c,l),this._parentEditor=n,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration(e=>this._onParentConfigurationChanged(e)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){sa(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};Hu=Bu([Vu(3,H),Vu(4,po),Vu(5,Hs),Vu(6,D),Vu(7,Vi),Vu(8,Ft),Vu(9,mn)],Hu);var Uu=new O(new kn(0,122,204)),Wu={showArrow:!0,showFrame:!0,className:``,frameColor:Uu,arrowColor:Uu,keepEditorSelection:!1},Gu=`vs.editor.contrib.zoneWidget`,Ku=class{constructor(e,t,n,r,i,a){this.id=``,this.domNode=e,this.afterLineNumber=t,this.afterColumn=n,this.heightInLines=r,this._onDomNodeTop=i,this._onComputedHeight=a}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}},qu=class{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}},Ju=class e{constructor(t){this._editor=t,this._ruleName=e._IdGenerator.nextId(),this._decorations=[],this._color=null,this._height=-1}dispose(){this.hide(),at(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){at(this._ruleName),Os(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `)}show(e){this._decorations=this._editor.deltaDecorations(this._decorations,[{range:W.fromPositions(e),options:{description:`zone-widget-arrow`,className:this._ruleName,stickiness:1}}])}hide(){this._editor.deltaDecorations(this._decorations,[])}};Ju._IdGenerator=new ba(`.arrow-decoration-`);var Yu=class{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._positionMarkerId=[],this._viewZone=null,this._disposables=new K,this.container=null,this._isShowing=!1,this.editor=e,this.options=Za(t),sa(this.options,Wu,!1),this.domNode=document.createElement(`div`),this.options.isAccessible||(this.domNode.setAttribute(`aria-hidden`,`true`),this.domNode.setAttribute(`role`,`presentation`)),this._disposables.add(this.editor.onDidLayoutChange(e=>{let t=this._getWidth(e);this.domNode.style.width=t+`px`,this.domNode.style.left=this._getLeft(e)+`px`,this._onWidth(t)}))}dispose(){this._overlayWidget&&=(this.editor.removeOverlayWidget(this._overlayWidget),null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this.editor.deltaDecorations(this._positionMarkerId,[]),this._positionMarkerId=[],this._disposables.dispose()}create(){this.domNode.classList.add(`zone-widget`),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement(`div`),this.container.classList.add(`zone-widget-container`),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new Ju(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){let e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){let e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+`px`}_onViewZoneHeight(e){if(this.domNode.style.height=`${e}px`,this.container){let t=e-this._decoratingElementsHeight();this.container.style.height=`${t}px`;let n=this.editor.getLayoutInfo();this._doLayout(t,this._getWidth(n))}this._resizeSash&&this._resizeSash.layout()}get position(){let[e]=this._positionMarkerId;if(!e)return;let t=this.editor.getModel();if(!t)return;let n=t.getDecorationRange(e);if(n)return n.getStartPosition()}show(e,t){let n=W.isIRange(e)?W.lift(e):W.fromPositions(e);this._isShowing=!0,this._showImpl(n,t),this._isShowing=!1,this._positionMarkerId=this.editor.deltaDecorations(this._positionMarkerId,[{range:n,options:I.EMPTY}])}hide(){this._viewZone&&=(this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id)}),null),this._overlayWidget&&=(this.editor.removeOverlayWidget(this._overlayWidget),null),this._arrow&&this._arrow.hide()}_decoratingElementsHeight(){let e=this.editor.getOption(58),t=0;if(this.options.showArrow){let n=Math.round(e/3);t+=2*n}if(this.options.showFrame){let n=Math.round(e/9);t+=2*n}return t}_showImpl(e,t){let n=e.getStartPosition(),r=this.editor.getLayoutInfo(),i=this._getWidth(r);this.domNode.style.width=`${i}px`,this.domNode.style.left=this._getLeft(r)+`px`;let a=document.createElement(`div`);a.style.overflow=`hidden`;let o=this.editor.getOption(58),s=Math.max(12,this.editor.getLayoutInfo().height/o*.8);t=Math.min(t,s);let c=0,l=0;if(this._arrow&&this.options.showArrow&&(c=Math.round(o/3),this._arrow.height=c,this._arrow.show(n)),this.options.showFrame&&(l=Math.round(o/9)),this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._overlayWidget&&=(this.editor.removeOverlayWidget(this._overlayWidget),null),this.domNode.style.top=`-1000px`,this._viewZone=new Ku(a,n.lineNumber,n.column,t,e=>this._onViewZoneTop(e),e=>this._onViewZoneHeight(e)),this._viewZone.id=e.addZone(this._viewZone),this._overlayWidget=new qu(Gu+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){let e=this.options.frameWidth?this.options.frameWidth:l;this.container.style.borderTopWidth=e+`px`,this.container.style.borderBottomWidth=e+`px`}let u=t*o-this._decoratingElementsHeight();this.container&&(this.container.style.top=c+`px`,this.container.style.height=u+`px`,this.container.style.overflow=`hidden`),this._doLayout(u,i),this.options.keepEditorSelection||this.editor.setSelection(e);let d=this.editor.getModel();if(d){let t=e.endLineNumber+1;t<=d.getLineCount()?this.revealLine(t,!1):this.revealLine(d.getLineCount(),!0)}}revealLine(e,t){t?this.editor.revealLineInCenter(e,0):this.editor.revealLine(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new g(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.hide(),this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){let n=(t.currentY-e.startY)/this.editor.getOption(58),r=n<0?Math.ceil(n):Math.floor(n),i=e.heightInLines+r;i>5&&i<35&&this._relayout(i)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){let e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}},Xu=class extends gs{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new J),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=q(e,G(`.monaco-dropdown`)),this._label=q(this._element,G(`.dropdown-label`));let n=t.labelRenderer;n||=e=>(e.textContent=t.label||``,null);for(let e of[Do.CLICK,Do.MOUSE_DOWN,nr.Tap])this._register(Qr(this.element,e,e=>Gi.stop(e,!0)));for(let e of[Do.MOUSE_DOWN,nr.Tap])this._register(Qr(this._label,e,e=>{e instanceof MouseEvent&&e.detail>1||(this.visible?this.hide():this.show())}));this._register(Qr(this._label,Do.KEY_UP,e=>{let t=new Pi(e);(t.equals(3)||t.equals(10))&&(Gi.stop(e,!0),this.visible?this.hide():this.show())}));let r=n(this._label);r&&this._register(r),this._register(yr.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&=(this.boxContainer.remove(),void 0),this.contents&&=(this.contents.remove(),void 0),this._label&&=(this._label.remove(),void 0)}},Zu=class extends Xu{constructor(e,t){super(e,t),this._actions=[],this._contextMenuProvider=t.contextMenuProvider,this.actions=t.actions||[],this.actionProvider=t.actionProvider,this.menuClassName=t.menuClassName||``,this.menuAsChild=!!t.menuAsChild}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this.actionProvider?this.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add(`active`),this._contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:e=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this.menuClassName,onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this.menuAsChild?this.element:void 0})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove(`active`)}},Qu=class extends ks{constructor(e,t,n,r=Object.create(null)){super(null,e,r),this.actionItem=null,this._onDidChangeVisibility=this._register(new J),this.menuActionsOrProvider=t,this.contextMenuProvider=n,this.options=r,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;let t=e=>{this.element=q(e,G(`a.action-label`));let t=[];return typeof this.options.classNames==`string`?t=this.options.classNames.split(/\s+/g).filter(e=>!!e):this.options.classNames&&(t=this.options.classNames),t.find(e=>e===`icon`)||t.push(`codicon`),this.element.classList.add(...t),this.element.setAttribute(`role`,`button`),this.element.setAttribute(`aria-haspopup`,`true`),this.element.setAttribute(`aria-expanded`,`false`),this.element.title=this._action.label||``,null},n=Array.isArray(this.menuActionsOrProvider),r={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:n?this.menuActionsOrProvider:void 0,actionProvider:n?void 0:this.menuActionsOrProvider};if(this.dropdownMenu=this._register(new Zu(e,r)),this._register(this.dropdownMenu.onDidChangeVisibility(e=>{var t;(t=this.element)==null||t.setAttribute(`aria-expanded`,`${e}`),this._onDidChangeVisibility.fire(e)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){let e=this;this.dropdownMenu.menuOptions=Object.assign(Object.assign({},this.dropdownMenu.menuOptions),{get anchorAlignment(){return e.options.anchorAlignmentProvider()}})}this.updateEnabled()}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}updateEnabled(){var e,t;let n=!this.getAction().enabled;(e=this.actionItem)==null||e.classList.toggle(`disabled`,n),(t=this.element)==null||t.classList.toggle(`disabled`,n)}},$u=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ed=function(e,t){return function(n,r){t(n,r,e)}},td=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};function nd(e,t,n,r,i,a,o){let s=e.getActions(t);return id(s,n,!1,typeof r==`string`?e=>e===r:r,i,a,o),rd(s)}function rd(e){let t=new K;for(let[,n]of e)for(let e of n)t.add(e);return t}function id(e,t,n,r=e=>e===`navigation`,i=2**53-1,a=()=>!1,o=!1){let s,c;Array.isArray(t)?(s=t,c=t):(s=t.primary,c=t.secondary);let l=new Set;for(let[t,i]of e){let e;r(t)?(e=s,e.length>0&&o&&e.push(new Bs)):(e=c,e.length>0&&e.push(new Bs));for(let r of i){n&&(r=r instanceof Ba&&r.alt?r.alt:r);let i=e.push(r);r instanceof di&&l.add({group:t,action:r,index:i-1})}}for(let{group:e,action:t,index:n}of l){let o=r(e)?s:c,l=t.actions;(l.length<=1||o.length+l.length-2<=i)&&a(t,e,o.length)&&o.splice(n,1,...l)}if(s!==c&&s.length>i){let e=s.splice(i,s.length-i);c.unshift(...e,new Bs)}}var ad=class extends ge{constructor(e,t,n,r,i){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t?.draggable}),this._keybindingService=n,this._notificationService=r,this._contextKeyService=i,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new Un),this._altKey=$a.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}onClick(e){return td(this,void 0,void 0,function*(){e.preventDefault(),e.stopPropagation();try{yield this.actionRunner.run(this._commandAction,this._context)}catch(e){this._notificationService.error(e)}})}render(e){super.render(e),e.classList.add(`menu-entry`),this._updateItemClass(this._menuItemAction.item);let t=!1,n=this._altKey.keyStatus.altKey||(_t||Je)&&this._altKey.keyStatus.shiftKey,r=()=>{let e=t&&n;e!==this._wantsAltCommand&&(this._wantsAltCommand=e,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._menuItemAction.alt&&this._register(this._altKey.event(e=>{n=e.altKey||(_t||Je)&&e.shiftKey,r()})),this._register(Qr(e,`mouseleave`,e=>{t=!1,r()})),this._register(Qr(e,`mouseenter`,e=>{t=!0,r()}))}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}updateTooltip(){if(this.label){let e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),n=this._commandAction.tooltip||this._commandAction.label,r=t?z(`titleAndKb`,`{0} ({1})`,n,t):n;if(!this._wantsAltCommand&&this._menuItemAction.alt){let e=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,t=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),n=t&&t.getLabel(),i=n?z(`titleAndKb`,`{0} ({1})`,e,n):e;r+=`\n[${Wt.modifierLabels[re].altKey}] ${i}`}this.label.title=r}}updateClass(){this.options.icon&&(this._commandAction===this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.item):this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;let{element:t,label:n}=this;if(!t||!n)return;let r=this._commandAction.checked&&e.toggled?.icon?e.toggled.icon:e.icon;if(r)if(Co.isThemeIcon(r)){let e=Co.asClassNameArray(r);n.classList.add(...e),this._itemClassDispose.value=ja(()=>{n.classList.remove(...e)})}else r.light&&n.style.setProperty(`--menu-entry-icon-light`,zn(r.light)),r.dark&&n.style.setProperty(`--menu-entry-icon-dark`,zn(r.dark)),n.classList.add(`icon`),this._itemClassDispose.value=ja(()=>{n.classList.remove(`icon`),n.style.removeProperty(`--menu-entry-icon-light`),n.style.removeProperty(`--menu-entry-icon-dark`)})}};ad=$u([ed(2,Oo),ed(3,Ft),ed(4,D)],ad);var od=class extends Qu{constructor(e,t,n){let r=Object.assign({},t??Object.create(null),{menuAsChild:t?.menuAsChild??!1,classNames:t?.classNames??(Co.isThemeIcon(e.item.icon)?Co.asClassName(e.item.icon):void 0)});super(e,{getActions:()=>e.actions},n,r)}render(e){if(super.render(e),this.element){e.classList.add(`menu-entry`);let{icon:t}=this._action.item;t&&!Co.isThemeIcon(t)&&(this.element.classList.add(`icon`),t.light&&this.element.style.setProperty(`--menu-entry-icon-light`,zn(t.light)),t.dark&&this.element.style.setProperty(`--menu-entry-icon-dark`,zn(t.dark)))}}};od=$u([ed(2,xs)],od);var sd=class extends ks{constructor(e,t,n,r,i,a,o,s){super(null,e),this._keybindingService=n,this._notificationService=r,this._contextMenuService=i,this._menuService=a,this._instaService=o,this._storageService=s,this._container=null,this._storageKey=`${e.item.submenu._debugName}_lastActionId`;let c,l=s.get(this._storageKey,1);l&&(c=e.actions.find(e=>l===e.id)),c||=e.actions[0],this._defaultAction=this._instaService.createInstance(ad,c,void 0);let u=Object.assign({},t??Object.create(null),{menuAsChild:t?.menuAsChild??!0,classNames:t?.classNames??[`codicon`,`codicon-chevron-down`],actionRunner:t?.actionRunner??new gs});this._dropdown=new Qu(e,e.actions,this._contextMenuService,u),this._dropdown.actionRunner.onDidRun(e=>{e.action instanceof Ba&&this.update(e.action)})}update(e){this._storageService.store(this._storageKey,e.id,1,0),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(ad,e,void 0),this._defaultAction.actionRunner=new class extends gs{runAction(e,t){return td(this,void 0,void 0,function*(){yield e.run(void 0)})}},this._container&&this._defaultAction.render(Ie(this._container,G(`.action-container`)))}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add(`monaco-dropdown-with-default`);let t=G(`.action-container`);this._defaultAction.render(q(this._container,t)),this._register(Qr(t,Do.KEY_DOWN,e=>{let t=new Pi(e);t.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),t.stopPropagation())}));let n=G(`.dropdown-action-container`);this._dropdown.render(q(this._container,n)),this._register(Qr(n,Do.KEY_DOWN,e=>{var t;let n=new Pi(e);n.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),(t=this._defaultAction.element)==null||t.focus(),n.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};sd=$u([ed(2,Oo),ed(3,Ft),ed(4,xs),ed(5,Ko),ed(6,H),ed(7,je)],sd);function cd(e,t,n){if(t instanceof Ba)return e.createInstance(ad,t,void 0);if(t instanceof Di)return t.item.rememberDefaultAction?e.createInstance(sd,t,n):e.createInstance(od,t,n)}var ld=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ud=function(e,t){return function(n,r){t(n,r,e)}};const dd=yi(`IPeekViewService`);Bi(dd,class{constructor(){this._widgets=new Map}addExclusiveWidget(e,t){let n=this._widgets.get(e);n&&(n.listener.dispose(),n.widget.dispose()),this._widgets.set(e,{widget:t,listener:t.onDidClose(()=>{let n=this._widgets.get(e);n&&n.widget===t&&(n.listener.dispose(),this._widgets.delete(e))})})}});var fd;(function(e){e.inPeekEditor=new k(`inReferenceSearchEditor`,!0,z(`inReferenceSearchEditor`,`Whether the current code editor is embedded inside peek`)),e.notInPeekEditor=e.inPeekEditor.toNegated()})(fd||={});var pd=class{constructor(e,t){e instanceof Hu&&fd.inPeekEditor.bindTo(t)}dispose(){}};pd.ID=`editor.contrib.referenceController`,pd=ld([ud(1,D)],pd),U(pd.ID,pd);function md(e){let t=e.get(po).getFocusedCodeEditor();return t instanceof Hu?t.getParentEditor():t}var hd={headerBackgroundColor:O.white,primaryHeadingColor:O.fromHex(`#333333`),secondaryHeadingColor:O.fromHex(`#6c6c6cb3`)},gd=class extends Yu{constructor(e,t,n){super(e,t),this.instantiationService=n,this._onDidClose=new J,this.onDidClose=this._onDidClose.event,sa(this.options,hd,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){let t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();let e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass(`peekview-widget`),this._headElement=G(`.head`),this._bodyElement=G(`.body`),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){let n=G(`.peekview-title`);this.options.supportOnTitleClick&&(n.classList.add(`clickable`),hi(n,`click`,e=>this._onTitleClick(e))),q(this._headElement,n),this._fillTitleIcon(n),this._primaryHeading=G(`span.filename`),this._secondaryHeading=G(`span.dirname`),this._metaHeading=G(`span.meta`),q(n,this._primaryHeading,this._secondaryHeading,this._metaHeading);let r=G(`.peekview-actions`);q(this._headElement,r),this._actionbarWidget=new Bn(r,this._getActionBarOptions()),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new Jr(`peekview.close`,z(`label.close`,`Close`),M.close.classNames,!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:cd.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute(`title`,e),t?this._secondaryHeading.innerText=t:he(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,An(this._metaHeading)):zt(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}let n=Math.ceil(this.editor.getOption(58)*1.2),r=Math.round(e-(n+2));this._doLayoutHead(n,t),this._doLayoutBody(r,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};gd=ld([ud(2,H)],gd);const _d=v(`peekViewTitle.background`,{dark:Rt(be,.1),light:Rt(be,.1),hc:null},z(`peekViewTitleBackground`,`Background color of the peek view title area.`)),vd=v(`peekViewTitleLabel.foreground`,{dark:O.white,light:O.black,hc:O.white},z(`peekViewTitleForeground`,`Color of the peek view title.`)),yd=v(`peekViewTitleDescription.foreground`,{dark:`#ccccccb3`,light:`#616161`,hc:`#FFFFFF99`},z(`peekViewTitleInfoForeground`,`Color of the peek view title info.`)),bd=v(`peekView.border`,{dark:be,light:be,hc:Va},z(`peekViewBorder`,`Color of the peek view borders and arrow.`)),xd=v(`peekViewResult.background`,{dark:`#252526`,light:`#F3F3F3`,hc:O.black},z(`peekViewResultsBackground`,`Background color of the peek view result list.`)),Sd=v(`peekViewResult.lineForeground`,{dark:`#bbbbbb`,light:`#646465`,hc:O.white},z(`peekViewResultsMatchForeground`,`Foreground color for line nodes in the peek view result list.`)),Cd=v(`peekViewResult.fileForeground`,{dark:O.white,light:`#1E1E1E`,hc:O.white},z(`peekViewResultsFileForeground`,`Foreground color for file nodes in the peek view result list.`)),wd=v(`peekViewResult.selectionBackground`,{dark:`#3399ff33`,light:`#3399ff33`,hc:null},z(`peekViewResultsSelectionBackground`,`Background color of the selected entry in the peek view result list.`)),Td=v(`peekViewResult.selectionForeground`,{dark:O.white,light:`#6C6C6C`,hc:O.white},z(`peekViewResultsSelectionForeground`,`Foreground color of the selected entry in the peek view result list.`)),Ed=v(`peekViewEditor.background`,{dark:`#001F33`,light:`#F2F8FC`,hc:O.black},z(`peekViewEditorBackground`,`Background color of the peek view editor.`)),Dd=v(`peekViewEditorGutter.background`,{dark:Ed,light:Ed,hc:Ed},z(`peekViewEditorGutterBackground`,`Background color of the gutter in the peek view editor.`)),Od=v(`peekViewResult.matchHighlightBackground`,{dark:`#ea5c004d`,light:`#ea5c004d`,hc:null},z(`peekViewResultsMatchHighlight`,`Match highlight color in the peek view result list.`)),kd=v(`peekViewEditor.matchHighlightBackground`,{dark:`#ff8f0099`,light:`#f5d802de`,hc:null},z(`peekViewEditorMatchHighlight`,`Match highlight color in the peek view editor.`)),Ad=v(`peekViewEditor.matchHighlightBorder`,{dark:null,light:null,hc:bi},z(`peekViewEditorMatchHighlightBorder`,`Match highlight border in the peek view editor.`));var jd=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Md=class{constructor(e,t,n,r){this.isProviderFirst=e,this.parent=t,this.link=n,this._rangeCallback=r,this.id=Mt.nextId()}get uri(){return this.link.uri}get range(){return this._range??this.link.targetSelectionRange??this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){let e=this.parent.getPreview(this)?.preview(this.range);return e?z({key:`aria.oneReference.preview`,comment:[`Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code`]},`symbol in {0} on line {1} at column {2}, {3}`,Pa(this.uri),this.range.startLineNumber,this.range.startColumn,e.value):z(`aria.oneReference`,`symbol in {0} on line {1} at column {2}`,Pa(this.uri),this.range.startLineNumber,this.range.startColumn)}},Nd=class{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){let n=this._modelReference.object.textEditorModel;if(!n)return;let{startLineNumber:r,startColumn:i,endLineNumber:a,endColumn:o}=e,s=new W(r,n.getWordUntilPosition({lineNumber:r,column:i-t}).startColumn,r,i),c=new W(a,o,a,1073741824),l=n.getValueInRange(s).replace(/^\s+/,``),u=n.getValueInRange(e),d=n.getValueInRange(c).replace(/\s+$/,``);return{value:l+u+d,highlight:{start:l.length,end:l.length+u.length}}}},Pd=class{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new ur}dispose(){y(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){let e=this.children.length;return e===1?z(`aria.fileReferences.1`,`1 symbol in {0}, full path {1}`,Pa(this.uri),this.uri.fsPath):z(`aria.fileReferences.N`,`{0} symbols in {1}, full path {2}`,e,Pa(this.uri),this.uri.fsPath)}resolve(e){return jd(this,void 0,void 0,function*(){if(this._previews.size!==0)return this;for(let t of this.children)if(!this._previews.has(t.uri))try{let n=yield e.createModelReference(t.uri);this._previews.set(t.uri,new Nd(n))}catch(e){C(e)}return this})}},Fd=class e{constructor(t,n){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new J,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=t,this._title=n;let[r]=t;t.sort(e._compareReferences);let i;for(let n of t)if((!i||!Lt.isEqual(i.uri,n.uri,!0))&&(i=new Pd(this,n.uri),this.groups.push(i)),i.children.length===0||e._compareReferences(n,i.children[i.children.length-1])!==0){let e=new Md(r===n,i,n,e=>this._onDidChangeReferenceRange.fire(e));this.references.push(e),i.children.push(e)}}dispose(){y(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new e(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?z(`aria.result.0`,`No results found`):this.references.length===1?z(`aria.result.1`,`Found 1 symbol in {0}`,this.references[0].uri.fsPath):this.groups.length===1?z(`aria.result.n1`,`Found {0} symbols in {1}`,this.references.length,this.groups[0].uri.fsPath):z(`aria.result.nm`,`Found {0} symbols in {1} files`,this.references.length,this.groups.length)}nextOrPreviousReference(e,t){let{parent:n}=e,r=n.children.indexOf(e),i=n.children.length,a=n.parent.groups.length;return a===1||t&&r+1<i||!t&&r>0?(r=t?(r+1)%i:(r+i-1)%i,n.children[r]):(r=n.parent.groups.indexOf(n),t?(r=(r+1)%a,n.parent.groups[r].children[0]):(r=(r+a-1)%a,n.parent.groups[r].children[n.parent.groups[r].children.length-1]))}nearestReference(e,t){let n=this.references.map((n,r)=>({idx:r,prefixLen:tr(n.uri.toString(),e.toString()),offsetDist:Math.abs(n.range.startLineNumber-t.lineNumber)*100+Math.abs(n.range.startColumn-t.column)})).sort((e,t)=>e.prefixLen>t.prefixLen?-1:e.prefixLen<t.prefixLen?1:e.offsetDist<t.offsetDist?-1:e.offsetDist>t.offsetDist?1:0)[0];if(n)return this.references[n.idx]}referenceAt(e,t){for(let n of this.references)if(n.uri.toString()===e.toString()&&W.containsPosition(n.range,t))return n}firstReference(){for(let e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return Lt.compare(e.uri,t.uri)||W.compareRangesUsingStarts(e.range,t.range)}};function Id(e){if(!e)return;typeof e==`string`&&(e=L.file(e));let t=Pa(e)||(e.scheme===$e.file?e.fsPath:e.path);return _t&&On(t)?Ld(t):t}function Ld(e){return Ot(e)?e.charAt(0).toUpperCase()+e.slice(1):e}var Rd=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},zd=function(e,t){return function(n,r){t(n,r,e)}},Bd=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof Fd||e instanceof Pd}getChildren(e){if(e instanceof Fd)return e.groups;if(e instanceof Pd)return e.resolve(this._resolverService).then(e=>e.children);throw Error(`bad tree`)}};Bd=Rd([zd(0,ms)],Bd);var Vd=class{getHeight(){return 23}getTemplateId(e){return e instanceof Pd?Gd.id:qd.id}},Hd=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){if(e instanceof Md){let t=e.parent.getPreview(e)?.preview(e.range);if(t)return t.value}return Pa(e.uri)}};Hd=Rd([zd(0,Oo)],Hd);var Ud=class{getId(e){return e instanceof Md?e.id:e.uri}},Wd=class extends _{constructor(e,t,n){super(),this._uriLabel=t;let r=document.createElement(`div`);r.classList.add(`reference-file`),this.file=this._register(new Mn(r,{supportHighlights:!0})),this.badge=new Vt(q(r,G(`.count`))),this._register(Ar(this.badge,n)),e.appendChild(r)}set(e,t){let n=Ta(e.uri);this.file.setLabel(Id(e.uri),this._uriLabel.getUriLabel(n,{relative:!0}),{title:this._uriLabel.getUriLabel(e.uri),matches:t});let r=e.children.length;this.badge.setCount(r),r>1?this.badge.setTitleFormat(z(`referencesCount`,`{0} references`,r)):this.badge.setTitleFormat(z(`referenceCount`,`{0} reference`,r))}};Wd=Rd([zd(1,ko),zd(2,Vi)],Wd);var Gd=class e{constructor(t){this._instantiationService=t,this.templateId=e.id}renderTemplate(e){return this._instantiationService.createInstance(Wd,e)}renderElement(e,t,n){n.set(e.element,as(e.filterData))}disposeTemplate(e){e.dispose()}};Gd.id=`FileReferencesRenderer`,Gd=Rd([zd(0,H)],Gd);var Kd=class{constructor(e){this.label=new _e(e,!1)}set(e,n){let r=e.parent.getPreview(e)?.preview(e.range);if(!r||!r.value)this.label.set(`${Pa(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{let{value:e,highlight:i}=r;n&&!t.isDefault(n)?(this.label.element.classList.toggle(`referenceMatch`,!1),this.label.set(e,as(n))):(this.label.element.classList.toggle(`referenceMatch`,!0),this.label.set(e,[i]))}}},qd=class e{constructor(){this.templateId=e.id}renderTemplate(e){return new Kd(e)}renderElement(e,t,n){n.set(e.element,e.filterData)}disposeTemplate(){}};qd.id=`OneReferenceRenderer`;var Jd=class{getWidgetAriaLabel(){return z(`treeAriaLabel`,`References`)}getAriaLabel(e){return e.ariaMessage}},Yd=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Xd=function(e,t){return function(n,r){t(n,r,e)}},Zd=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Qd=class e{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new K,this._callOnModelChange=new K,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();let e=this._editor.getModel();if(e){for(let t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(t){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));let n=[],r=[];for(let i=0,a=t.children.length;i<a;i++){let a=t.children[i];this._decorationIgnoreSet.has(a.id)||a.uri.toString()===this._editor.getModel().uri.toString()&&(n.push({range:a.range,options:e.DecorationOptions}),r.push(i))}let i=this._editor.deltaDecorations([],n);for(let e=0;e<i.length;e++)this._decorations.set(i[e],t.children[r[e]])}_onDecorationChanged(){let e=[],t=this._editor.getModel();if(t){for(let[n,r]of this._decorations){let i=t.getDecorationRange(n);if(!i)continue;let a=!1;W.equalsRange(i,r.range)||((W.spansMultipleLines(i)||r.range.endColumn-r.range.startColumn!==i.endColumn-i.startColumn)&&(a=!0),a?(this._decorationIgnoreSet.add(r.id),e.push(n)):r.range=i)}for(let t=0,n=e.length;t<n;t++)this._decorations.delete(e[t]);this._editor.deltaDecorations(e,[])}}removeDecorations(){this._editor.deltaDecorations([...this._decorations.keys()],[]),this._decorations.clear()}};Qd.DecorationOptions=I.register({description:`reference-decoration`,stickiness:1,className:`reference-decoration`});var $d=class{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,n;try{let r=JSON.parse(e);t=r.ratio,n=r.heightInLines}catch{}return{ratio:t||.7,heightInLines:n||18}}},ef=class extends ar{},tf=class extends gd{constructor(e,t,n,r,i,a,o,s,c,l,u,d){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},a),this._defaultTreeKeyboardSupport=t,this.layoutData=n,this._textModelResolverService=i,this._instantiationService=a,this._peekViewService=o,this._uriLabel=s,this._undoRedoService=c,this._keybindingService=l,this._modeService=u,this._languageConfigurationService=d,this._disposeOnNewModel=new K,this._callOnDispose=new K,this._onDidSelectReference=new J,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new ji(0,0),this._applyTheme(r.getColorTheme()),this._callOnDispose.add(r.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}dispose(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),y(this._preview),y(this._previewNotAvailableMessage),y(this._tree),y(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){let t=e.getColor(bd)||O.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(_d)||O.transparent,primaryHeadingColor:e.getColor(vd),secondaryHeadingColor:e.getColor(yd)})}show(e){this.editor.revealRangeInCenterIfOutsideViewport(e,0),super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?`side`:`open`,source:`title`})}_fillBody(e){this.setCssClass(`reference-zone-widget`),this._messageContainer=q(e,G(`div.messages`)),zt(this._messageContainer),this._splitView=new Re(e,{orientation:1}),this._previewContainer=q(e,G(`div.preview.inline`)),this._preview=this._instantiationService.createInstance(Hu,this._previewContainer,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:`auto`,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},this.editor),zt(this._previewContainer),this._previewNotAvailableMessage=new ts(z(`missingPreviewMessage`,`no preview available`),ts.DEFAULT_CREATION_OPTIONS,null,null,this._undoRedoService,this._modeService,this._languageConfigurationService),this._treeContainer=q(e,G(`div.ref-tree.inline`));let t={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new Jd,keyboardNavigationLabelProvider:this._instantiationService.createInstance(Hd),identityProvider:new Ud,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:xd}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(hi(this._treeContainer,`keydown`,e=>{e.equals(9)&&(this._keybindingService.dispatchEvent(e,e.target),e.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(ef,`ReferencesWidget`,this._treeContainer,new Vd,[this._instantiationService.createInstance(Gd),this._instantiationService.createInstance(qd)],this._instantiationService.createInstance(Bd),t),this._splitView.addView({onDidChange:ui.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:e=>{this._preview.layout({height:this._dim.height,width:e})}},pr.Distribute),this._splitView.addView({onDidChange:ui.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:e=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${e}px`,this._tree.layout(this._dim.height,e)}},pr.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));let n=(e,t)=>{e instanceof Md&&(t===`show`&&this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:t,source:`tree`}))};this._tree.onDidOpen(e=>{e.sideBySide?n(e.element,`side`):e.editorOptions.pinned?n(e.element,`goto`):n(e.element,`show`)}),zt(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new ji(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(``),this._messageContainer.innerText=z(`noResults`,`No results`),An(this._messageContainer),Promise.resolve(void 0)):(zt(this._messageContainer),this._decorationsManager=new Qd(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{let{event:t,target:n}=e;if(t.detail!==2)return;let r=this._getFocusedReference();r&&this._onDidSelectReference.fire({element:{uri:r.uri,range:n.range},kind:t.ctrlKey||t.metaKey||t.altKey?`side`:`open`,source:`editor`})})),this.container.classList.add(`results-loaded`),An(this._treeContainer),An(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){let[e]=this._tree.getFocus();if(e instanceof Md)return e;if(e instanceof Pd&&e.children.length>0)return e.children[0]}revealReference(e){return Zd(this,void 0,void 0,function*(){yield this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:`goto`,source:`tree`})})}_revealReference(e,t){return Zd(this,void 0,void 0,function*(){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme===$e.inMemory?this.setTitle(z(`peekView.alternateTitle`,`References`)):this.setTitle(m(e.uri),this._uriLabel.getUriLabel(Ta(e.uri)));let n=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),yield this._tree.expand(e.parent),this._tree.reveal(e));let r=yield n;if(!this._model){r.dispose();return}y(this._previewModelReference);let i=r.object;if(i){let t=this._preview.getModel()===i.textEditorModel?0:1,n=W.lift(e.range).collapseToStart();this._previewModelReference=r,this._preview.setModel(i.textEditorModel),this._preview.setSelection(n),this._preview.revealRangeInCenter(n,t)}else this._preview.setModel(this._previewNotAvailableMessage),r.dispose()})}};tf=Yd([Xd(3,Vi),Xd(4,ms),Xd(5,H),Xd(6,dd),Xd(7,ko),Xd(8,Fe),Xd(9,Oo),Xd(10,zs),Xd(11,ss)],tf),Ya((e,t)=>{let n=e.getColor(Od);n&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: ${n}; }`);let r=e.getColor(kd);r&&t.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${r}; }`);let i=e.getColor(Ad);i&&t.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${i}; box-sizing: border-box; }`);let a=e.getColor(bi);a&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted ${a}; box-sizing: border-box; }`);let o=e.getColor(xd);o&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${o}; }`);let s=e.getColor(Sd);s&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${s}; }`);let c=e.getColor(Cd);c&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${c}; }`);let l=e.getColor(wd);l&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: ${l}; }`);let u=e.getColor(Td);u&&t.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: ${u} !important; }`);let d=e.getColor(Ed);d&&t.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {	background-color: ${d};}`);let f=e.getColor(Dd);f&&t.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .margin {	background-color: ${f};}`)});var nf=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},rf=function(e,t){return function(n,r){t(n,r,e)}},af=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};const of=new k(`referenceSearchVisible`,!1,z(`referenceSearchVisible`,`Whether reference peek is visible, like 'Peek References' or 'Peek Definition'`));var sf=class e{constructor(e,t,n,r,i,a,o,s){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=r,this._notificationService=i,this._instantiationService=a,this._storageService=o,this._configurationService=s,this._disposables=new K,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=of.bindTo(n)}static get(t){return t.getContribution(e.ID)}dispose(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),(e=this._widget)==null||e.dispose(),(t=this._model)==null||t.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,n){let r;if(this._widget&&(r=this._widget.position),this.closeWidget(),r&&e.containsPosition(r))return;this._peekMode=n,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));let i=`peekViewLayout`,a=$d.fromJSON(this._storageService.get(i,0,`{}`));this._widget=this._instantiationService.createInstance(tf,this._editor,this._defaultTreeKeyboardSupport,a),this._widget.setTitle(z(`labelLoading`,`Loading...`)),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget&&=(this._storageService.store(i,JSON.stringify(this._widget.layoutData),0,1),void 0),this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(e=>{let{element:t,kind:r}=e;if(t)switch(r){case`open`:(e.source!==`editor`||!this._configurationService.getValue(`editor.stablePeek`))&&this.openReference(t,!1,!1);break;case`side`:this.openReference(t,!0,!1);break;case`goto`:n?this._gotoReference(t):this.openReference(t,!1,!0);break}}));let o=++this._requestIdPool;t.then(t=>{var n;if(o!==this._requestIdPool||!this._widget){t.dispose();return}return(n=this._model)==null||n.dispose(),this._model=t,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(``):this._widget.setMetaTitle(z(`metaTitle.N`,`{0} ({1})`,this._model.title,this._model.references.length));let t=this._editor.getModel().uri,n=new P(e.startLineNumber,e.startColumn),r=this._model.nearestReference(t,n);if(r)return this._widget.setSelection(r).then(()=>{this._widget&&this._editor.getOption(76)===`editor`&&this._widget.focusOnPreviewEditor()})}})},e=>{this._notificationService.error(e)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}goToNextOrPreviousReference(e){return af(this,void 0,void 0,function*(){if(!this._editor.hasModel()||!this._model||!this._widget)return;let t=this._widget.position;if(!t)return;let n=this._model.nearestReference(this._editor.getModel().uri,t);if(!n)return;let r=this._model.nextOrPreviousReference(n,e),i=this._editor.hasTextFocus(),a=this._widget.isPreviewEditorFocused();yield this._widget.setSelection(r),yield this._gotoReference(r),i?this._editor.focus():this._widget&&a&&this._widget.focusOnPreviewEditor()})}revealReference(e){return af(this,void 0,void 0,function*(){!this._editor.hasModel()||!this._model||!this._widget||(yield this._widget.revealReference(e))})}closeWidget(e=!0){var t,n;(t=this._widget)==null||t.dispose(),(n=this._model)==null||n.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(t){this._widget&&this._widget.hide(),this._ignoreModelChangeEvent=!0;let n=W.lift(t.range).collapseToStart();return this._editorService.openCodeEditor({resource:t.uri,options:{selection:n}},this._editor).then(t=>{if(this._ignoreModelChangeEvent=!1,!t||!this._widget){this.closeWidget();return}if(this._editor===t)this._widget.show(n),this._widget.focusOnReferenceTree();else{let r=e.get(t),i=this._model.clone();this.closeWidget(),t.focus(),r.toggleWidget(n,No(e=>Promise.resolve(i)),this._peekMode??!1)}},e=>{this._ignoreModelChangeEvent=!1,C(e)})}openReference(e,t,n){t||this.closeWidget();let{uri:r,range:i}=e;this._editorService.openCodeEditor({resource:r,options:{selection:i,pinned:n}},this._editor,t)}};sf.ID=`editor.contrib.referencesController`,sf=nf([rf(2,D),rf(3,po),rf(4,Ft),rf(5,H),rf(6,je),rf(7,xo)],sf);function cf(e,t){let n=md(e);if(!n)return;let r=sf.get(n);r&&t(r)}ln.registerCommandAndKeybindingRule({id:`togglePeekWidgetFocus`,weight:100,primary:Yi(2089,60),when:w.or(of,fd.inPeekEditor),handler(e){cf(e,e=>{e.changeFocusBetweenPreviewAndReferences()})}}),ln.registerCommandAndKeybindingRule({id:`goToNextReference`,weight:90,primary:62,secondary:[70],when:w.or(of,fd.inPeekEditor),handler(e){cf(e,e=>{e.goToNextOrPreviousReference(!0)})}}),ln.registerCommandAndKeybindingRule({id:`goToPreviousReference`,weight:90,primary:1086,secondary:[1094],when:w.or(of,fd.inPeekEditor),handler(e){cf(e,e=>{e.goToNextOrPreviousReference(!1)})}}),vs.registerCommandAlias(`goToNextReferenceFromEmbeddedEditor`,`goToNextReference`),vs.registerCommandAlias(`goToPreviousReferenceFromEmbeddedEditor`,`goToPreviousReference`),vs.registerCommandAlias(`closeReferenceSearchEditor`,`closeReferenceSearch`),vs.registerCommand(`closeReferenceSearch`,e=>cf(e,e=>e.closeWidget())),ln.registerKeybindingRule({id:`closeReferenceSearch`,weight:-1,primary:9,secondary:[1033],when:w.and(fd.inPeekEditor,w.not(`config.editor.stablePeek`))}),ln.registerKeybindingRule({id:`closeReferenceSearch`,weight:250,primary:9,secondary:[1033],when:w.and(of,w.not(`config.editor.stablePeek`))}),ln.registerCommandAndKeybindingRule({id:`revealReference`,weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:w.and(of,Ke),handler(e){let t=e.get(te).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof Md&&cf(e,e=>e.revealReference(t[0]))}}),ln.registerCommandAndKeybindingRule({id:`openReferenceToSide`,weight:100,primary:2051,mac:{primary:259},when:w.and(of,Ke),handler(e){let t=e.get(te).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof Md&&cf(e,e=>e.openReference(t[0],!0,!0))}}),vs.registerCommand(`openReference`,e=>{let t=e.get(te).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof Md&&cf(e,e=>e.openReference(t[0],!1,!0))});var lf=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},uf=function(e,t){return function(n,r){t(n,r,e)}};const df=new k(`hasSymbols`,!1,z(`hasSymbols`,`Whether there are symbol locations that can be navigated via keyboard-only.`)),ff=yi(`ISymbolNavigationService`);var pf=class{constructor(e,t,n,r){this._editorService=t,this._notificationService=n,this._keybindingService=r,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=df.bindTo(e)}reset(){var e,t;this._ctxHasSymbols.reset(),(e=this._currentState)==null||e.dispose(),(t=this._currentMessage)==null||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){let t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();let n=new mf(this._editorService);this._currentState=S(n,n.onDidChange(e=>{if(this._ignoreEditorChange)return;let n=this._editorService.getActiveCodeEditor();if(!n)return;let r=n.getModel(),i=n.getPosition();if(!r||!i)return;let a=!1,o=!1;for(let e of t.references)if(Kt(e.uri,r.uri))a=!0,o||=W.containsPosition(e.range,i);else if(a)break;(!a||!o)&&this.reset()}))}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;let t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:W.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){var e;(e=this._currentMessage)==null||e.dispose();let t=this._keybindingService.lookupKeybinding(`editor.gotoNextSymbolFromResult`),n=t?z(`location.kb`,`Symbol {0} of {1}, {2} for next`,this._currentIdx+1,this._currentModel.references.length,t.getLabel()):z(`location`,`Symbol {0} of {1}`,this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(n)}};pf=lf([uf(0,D),uf(1,po),uf(2,Ft),uf(3,Oo)],pf),Bi(ff,pf,!0),F(new class extends ft{constructor(){super({id:`editor.gotoNextSymbolFromResult`,precondition:df,kbOpts:{weight:100,primary:70}})}runEditorCommand(e,t){return e.get(ff).revealNext(t)}}),ln.registerCommandAndKeybindingRule({id:`editor.gotoNextSymbolFromResult.cancel`,weight:100,when:df,primary:9,handler(e){e.get(ff).reset()}});var mf=class{constructor(e){this._listener=new Map,this._disposables=new K,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),y(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,S(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){var t;(t=this._listener.get(e))==null||t.dispose(),this._listener.delete(e)}};mf=lf([uf(0,po)],mf);var hf=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};function gf(e,t,n,r){let i=n.ordered(e).map(n=>Promise.resolve(r(n,e,t)).then(void 0,e=>{nt(e)}));return Promise.all(i).then(e=>{let t=[];for(let n of e)Array.isArray(n)?t.push(...n):n&&t.push(n);return t})}function _f(e,t,n){return gf(e,t,Aa,(e,t,r)=>e.provideDefinition(t,r,n))}function vf(e,t,n){return gf(e,t,Zt,(e,t,r)=>e.provideDeclaration(t,r,n))}function yf(e,t,n){return gf(e,t,wn,(e,t,r)=>e.provideImplementation(t,r,n))}function bf(e,t,n){return gf(e,t,Fi,(e,t,r)=>e.provideTypeDefinition(t,r,n))}function xf(e,t,n,r){return gf(e,t,gt,(e,t,i)=>hf(this,void 0,void 0,function*(){let a=yield e.provideReferences(t,i,{includeDeclaration:!0},r);if(!n||!a||a.length!==2)return a;let o=yield e.provideReferences(t,i,{includeDeclaration:!1},r);return o&&o.length===1?o:a}))}function Sf(e){return hf(this,void 0,void 0,function*(){let t=new Fd(yield e(),``),n=t.references.map(e=>e.link);return t.dispose(),n})}Ro(`_executeDefinitionProvider`,(e,t)=>Sf(()=>_f(e,t,j.None))),Ro(`_executeDeclarationProvider`,(e,t)=>Sf(()=>vf(e,t,j.None))),Ro(`_executeImplementationProvider`,(e,t)=>Sf(()=>yf(e,t,j.None))),Ro(`_executeTypeDefinitionProvider`,(e,t)=>Sf(()=>bf(e,t,j.None))),Ro(`_executeReferenceProvider`,(e,t)=>Sf(()=>xf(e,t,!1,j.None)));var Cf=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},wf,Tf,Ef,Df,Of,kf,Af,jf;cs.appendMenuItem(N.EditorContext,{submenu:N.EditorContextPeek,title:z(`peek.submenu`,`Peek`),group:`navigation`,order:100});var Mf=new Set;function Nf(e){let t=new e;return io(t),Mf.add(t.id),t}var Pf=class extends V{constructor(e,t){super(t),this._configuration=e}run(e,t){if(!t.hasModel())return Promise.resolve(void 0);let n=e.get(Ft),r=e.get(po),i=e.get(ua),a=e.get(ff),o=t.getModel(),s=t.getPosition(),c=new Ae(t,5),l=Or(this._getLocationModel(o,s,c.token),c.token).then(e=>Cf(this,void 0,void 0,function*(){if(!e||c.token.isCancellationRequested)return;Fn(e.ariaMessage);let n;if(e.referenceAt(o.uri,s)){let e=this._getAlternativeCommand(t);e!==this.id&&Mf.has(e)&&(n=t.getAction(e))}let i=e.references.length;if(i===0){if(!this._configuration.muteMessage){let e=o.getWordAtPosition(s);Sl.get(t).showMessage(this._getNoResultFoundMessage(e),s)}}else if(i===1&&n)n.run();else return this._onResult(r,a,t,e)}),e=>{n.error(e)}).finally(()=>{c.dispose()});return i.showWhile(l,250),l}_onResult(e,t,n,r){return Cf(this,void 0,void 0,function*(){let i=this._getGoToPreference(n);if(!(n instanceof Hu)&&(this._configuration.openInPeek||i===`peek`&&r.references.length>1))this._openInPeek(n,r);else{let a=r.firstReference(),o=r.references.length>1&&i===`gotoAndPeek`,s=yield this._openReference(n,e,a,this._configuration.openToSide,!o);o&&s?this._openInPeek(s,r):r.dispose(),i===`goto`&&t.put(a)}})}_openReference(e,t,n,r,i){return Cf(this,void 0,void 0,function*(){let a;if(Bo(n)&&(a=n.targetSelectionRange),a||=n.range,!a)return;let o=yield t.openCodeEditor({resource:n.uri,options:{selection:W.collapseToStart(a),selectionRevealType:3}},e,r);if(o){if(i){let e=o.getModel(),t=o.deltaDecorations([],[{range:a,options:{description:`symbol-navigate-action-highlight`,className:`symbolHighlight`}}]);setTimeout(()=>{o.getModel()===e&&o.deltaDecorations(t,[])},350)}return o}})}_openInPeek(e,t){let n=sf.get(e);n&&e.hasModel()?n.toggleWidget(e.getSelection(),No(e=>Promise.resolve(t)),this._configuration.openInPeek):t.dispose()}},Ff=class extends Pf{_getLocationModel(e,t,n){return Cf(this,void 0,void 0,function*(){return new Fd(yield _f(e,t,n),z(`def.title`,`Definitions`))})}_getNoResultFoundMessage(e){return e&&e.word?z(`noResultWord`,`No definition found for '{0}'`,e.word):z(`generic.noResults`,`No definition found`)}_getAlternativeCommand(e){return e.getOption(50).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(50).multipleDefinitions}},If=Be&&!pa?2118:70;Nf((wf=class e extends Ff{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,label:z(`actions.goToDecl.label`,`Go to Definition`),alias:`Go to Definition`,precondition:w.and(A.hasDefinitionProvider,A.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:A.editorTextFocus,primary:If,weight:100},contextMenuOpts:{group:`navigation`,order:1.1}}),vs.registerCommandAlias(`editor.action.goToDeclaration`,e.id)}},wf.id=`editor.action.revealDefinition`,wf)),Nf((Tf=class e extends Ff{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:e.id,label:z(`actions.goToDeclToSide.label`,`Open Definition to the Side`),alias:`Open Definition to the Side`,precondition:w.and(A.hasDefinitionProvider,A.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,If),weight:100}}),vs.registerCommandAlias(`editor.action.openDeclarationToTheSide`,e.id)}},Tf.id=`editor.action.revealDefinitionAside`,Tf)),Nf((Ef=class e extends Ff{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.id,label:z(`actions.previewDecl.label`,`Peek Definition`),alias:`Peek Definition`,precondition:w.and(A.hasDefinitionProvider,fd.notInPeekEditor,A.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:A.editorTextFocus,primary:582,linux:{primary:3140},weight:100},contextMenuOpts:{menuId:N.EditorContextPeek,group:`peek`,order:2}}),vs.registerCommandAlias(`editor.action.previewDeclaration`,e.id)}},Ef.id=`editor.action.peekDefinition`,Ef));var Lf=class extends Pf{_getLocationModel(e,t,n){return Cf(this,void 0,void 0,function*(){return new Fd(yield vf(e,t,n),z(`decl.title`,`Declarations`))})}_getNoResultFoundMessage(e){return e&&e.word?z(`decl.noResultWord`,`No declaration found for '{0}'`,e.word):z(`decl.generic.noResults`,`No declaration found`)}_getAlternativeCommand(e){return e.getOption(50).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(50).multipleDeclarations}};Nf((Df=class e extends Lf{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.id,label:z(`actions.goToDeclaration.label`,`Go to Declaration`),alias:`Go to Declaration`,precondition:w.and(A.hasDeclarationProvider,A.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{group:`navigation`,order:1.3}})}_getNoResultFoundMessage(e){return e&&e.word?z(`decl.noResultWord`,`No declaration found for '{0}'`,e.word):z(`decl.generic.noResults`,`No declaration found`)}},Df.id=`editor.action.revealDeclaration`,Df)),Nf(class extends Lf{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:`editor.action.peekDeclaration`,label:z(`actions.peekDecl.label`,`Peek Declaration`),alias:`Peek Declaration`,precondition:w.and(A.hasDeclarationProvider,fd.notInPeekEditor,A.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:N.EditorContextPeek,group:`peek`,order:3}})}});var Rf=class extends Pf{_getLocationModel(e,t,n){return Cf(this,void 0,void 0,function*(){return new Fd(yield bf(e,t,n),z(`typedef.title`,`Type Definitions`))})}_getNoResultFoundMessage(e){return e&&e.word?z(`goToTypeDefinition.noResultWord`,`No type definition found for '{0}'`,e.word):z(`goToTypeDefinition.generic.noResults`,`No type definition found`)}_getAlternativeCommand(e){return e.getOption(50).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(50).multipleTypeDefinitions}};Nf((Of=class e extends Rf{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,label:z(`actions.goToTypeDefinition.label`,`Go to Type Definition`),alias:`Go to Type Definition`,precondition:w.and(A.hasTypeDefinitionProvider,A.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:A.editorTextFocus,primary:0,weight:100},contextMenuOpts:{group:`navigation`,order:1.4}})}},Of.ID=`editor.action.goToTypeDefinition`,Of)),Nf((kf=class e extends Rf{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,label:z(`actions.peekTypeDefinition.label`,`Peek Type Definition`),alias:`Peek Type Definition`,precondition:w.and(A.hasTypeDefinitionProvider,fd.notInPeekEditor,A.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:N.EditorContextPeek,group:`peek`,order:4}})}},kf.ID=`editor.action.peekTypeDefinition`,kf));var zf=class extends Pf{_getLocationModel(e,t,n){return Cf(this,void 0,void 0,function*(){return new Fd(yield yf(e,t,n),z(`impl.title`,`Implementations`))})}_getNoResultFoundMessage(e){return e&&e.word?z(`goToImplementation.noResultWord`,`No implementation found for '{0}'`,e.word):z(`goToImplementation.generic.noResults`,`No implementation found`)}_getAlternativeCommand(e){return e.getOption(50).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(50).multipleImplementations}};Nf((Af=class e extends zf{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:e.ID,label:z(`actions.goToImplementation.label`,`Go to Implementations`),alias:`Go to Implementations`,precondition:w.and(A.hasImplementationProvider,A.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:A.editorTextFocus,primary:2118,weight:100},contextMenuOpts:{group:`navigation`,order:1.45}})}},Af.ID=`editor.action.goToImplementation`,Af)),Nf((jf=class e extends zf{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:e.ID,label:z(`actions.peekImplementation.label`,`Peek Implementations`),alias:`Peek Implementations`,precondition:w.and(A.hasImplementationProvider,fd.notInPeekEditor,A.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:A.editorTextFocus,primary:3142,weight:100},contextMenuOpts:{menuId:N.EditorContextPeek,group:`peek`,order:5}})}},jf.ID=`editor.action.peekImplementation`,jf));var Bf=class extends Pf{_getNoResultFoundMessage(e){return e?z(`references.no`,`No references found for '{0}'`,e.word):z(`references.noGeneric`,`No references found`)}_getAlternativeCommand(e){return e.getOption(50).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(50).multipleReferences}};Nf(class extends Bf{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:`editor.action.goToReferences`,label:z(`goToReferences.label`,`Go to References`),alias:`Go to References`,precondition:w.and(A.hasReferenceProvider,fd.notInPeekEditor,A.isInWalkThroughSnippet.toNegated()),kbOpts:{kbExpr:A.editorTextFocus,primary:1094,weight:100},contextMenuOpts:{group:`navigation`,order:1.45}})}_getLocationModel(e,t,n){return Cf(this,void 0,void 0,function*(){return new Fd(yield xf(e,t,!0,n),z(`ref.title`,`References`))})}}),Nf(class extends Bf{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:`editor.action.referenceSearch.trigger`,label:z(`references.action.label`,`Peek References`),alias:`Peek References`,precondition:w.and(A.hasReferenceProvider,fd.notInPeekEditor,A.isInWalkThroughSnippet.toNegated()),contextMenuOpts:{menuId:N.EditorContextPeek,group:`peek`,order:6}})}_getLocationModel(e,t,n){return Cf(this,void 0,void 0,function*(){return new Fd(yield xf(e,t,!1,n),z(`ref.title`,`References`))})}});var Vf=class extends Pf{constructor(e,t,n){super(e,{id:`editor.action.goToLocation`,label:z(`label.generic`,`Go to Any Symbol`),alias:`Go to Any Symbol`,precondition:w.and(fd.notInPeekEditor,A.isInWalkThroughSnippet.toNegated())}),this._references=t,this._gotoMultipleBehaviour=n}_getLocationModel(e,t,n){return Cf(this,void 0,void 0,function*(){return new Fd(this._references,z(`generic.title`,`Locations`))})}_getNoResultFoundMessage(e){return e&&z(`generic.noResult`,`No results for '{0}'`,e.word)||``}_getGoToPreference(e){return this._gotoMultipleBehaviour??e.getOption(50).multipleReferences}_getAlternativeCommand(){return``}};vs.registerCommand({id:`editor.action.goToLocations`,description:{description:`Go to locations from a position in a file`,args:[{name:`uri`,description:`The text document in which to start`,constraint:L},{name:`position`,description:`The position at which to start`,constraint:P.isIPosition},{name:`locations`,description:`An array of locations.`,constraint:Array},{name:`multiple`,description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:`noResultsMessage`,description:`Human readable message that shows when locations is empty.`}]},handler:(e,t,n,r,i,a,o)=>Cf(void 0,void 0,void 0,function*(){Fs(L.isUri(t)),Fs(P.isIPosition(n)),Fs(Array.isArray(r)),Fs(i===void 0||typeof i==`string`),Fs(o===void 0||typeof o==`boolean`);let s=e.get(po),c=yield s.openCodeEditor({resource:t},s.getFocusedCodeEditor());if($n(c))return c.setPosition(n),c.revealPositionInCenterIfOutsideViewport(n,0),c.invokeWithinContext(e=>{let t=new class extends Vf{_getNoResultFoundMessage(e){return a||super._getNoResultFoundMessage(e)}}({muteMessage:!a,openInPeek:!!o,openToSide:!1},r,i);e.get(H).invokeFunction(t.run.bind(t),c)})})}),vs.registerCommand({id:`editor.action.peekLocations`,description:{description:`Peek locations from a position in a file`,args:[{name:`uri`,description:`The text document in which to start`,constraint:L},{name:`position`,description:`The position at which to start`,constraint:P.isIPosition},{name:`locations`,description:`An array of locations.`,constraint:Array},{name:`multiple`,description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:(e,t,n,r,i)=>Cf(void 0,void 0,void 0,function*(){e.get(Hs).executeCommand(`editor.action.goToLocations`,t,n,r,i,void 0,!0)})}),vs.registerCommand({id:`editor.action.findReferences`,handler:(e,t,n)=>{Fs(L.isUri(t)),Fs(P.isIPosition(n));let r=e.get(po);return r.openCodeEditor({resource:t},r.getFocusedCodeEditor()).then(e=>{if(!$n(e)||!e.hasModel())return;let t=sf.get(e);if(!t)return;let r=No(t=>xf(e.getModel(),P.lift(n),!1,t).then(e=>new Fd(e,z(`ref.title`,`References`)))),i=new W(n.lineNumber,n.column,n.lineNumber,n.column);return Promise.resolve(t.toggleWidget(i,r,!1))})}}),vs.registerCommandAlias(`editor.action.showReferences`,`editor.action.peekLocations`),cs.appendMenuItems([{id:N.MenubarGoMenu,item:{command:{id:`editor.action.revealDefinition`,title:z({key:`miGotoDefinition`,comment:[`&& denotes a mnemonic`]},`Go to &&Definition`)},group:`4_symbol_nav`,order:2}},{id:N.MenubarGoMenu,item:{command:{id:`editor.action.revealDeclaration`,title:z({key:`miGotoDeclaration`,comment:[`&& denotes a mnemonic`]},`Go to &&Declaration`)},group:`4_symbol_nav`,order:3}},{id:N.MenubarGoMenu,item:{command:{id:`editor.action.goToTypeDefinition`,title:z({key:`miGotoTypeDefinition`,comment:[`&& denotes a mnemonic`]},`Go to &&Type Definition`)},group:`4_symbol_nav`,order:3}},{id:N.MenubarGoMenu,item:{command:{id:`editor.action.goToImplementation`,title:z({key:`miGotoImplementation`,comment:[`&& denotes a mnemonic`]},`Go to &&Implementations`)},group:`4_symbol_nav`,order:4}},{id:N.MenubarGoMenu,item:{command:{id:`editor.action.goToReferences`,title:z({key:`miGotoReference`,comment:[`&& denotes a mnemonic`]},`Go to &&References`)},group:`4_symbol_nav`,order:5}}]);var Hf=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Uf=function(e,t){return function(n,r){t(n,r,e)}},Wf=class e{constructor(e,t,n){this.textModelResolverService=t,this.modeService=n,this.toUnhook=new K,this.toUnhookForKeyboard=new K,this.linkDecorations=[],this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e;let r=new zu(e);this.toUnhook.add(r),this.toUnhook.add(r.onMouseMoveOrRelevantKeyDown(([e,t])=>{this.startFindDefinitionFromMouse(e,xe(t))})),this.toUnhook.add(r.onExecute(e=>{this.isEnabled(e)&&this.gotoDefinition(e.target.position,e.hasSideBySideModifier).then(()=>{this.removeLinkDecorations()},e=>{this.removeLinkDecorations(),C(e)})})),this.toUnhook.add(r.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(t){return t.getContribution(e.ID)}startFindDefinitionFromCursor(e){return this.startFindDefinition(e).then(()=>{this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(e=>{e&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))})}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}let n=e.target.position;this.startFindDefinition(n)}startFindDefinition(e){this.toUnhookForKeyboard.clear();let t=e?this.editor.getModel()?.getWordAtPosition(e):null;if(!t)return this.currentWordAtPosition=null,this.removeLinkDecorations(),Promise.resolve(0);if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===t.startColumn&&this.currentWordAtPosition.endColumn===t.endColumn&&this.currentWordAtPosition.word===t.word)return Promise.resolve(0);this.currentWordAtPosition=t;let n=new Yn(this.editor,15);return this.previousPromise&&=(this.previousPromise.cancel(),null),this.previousPromise=No(t=>this.findDefinition(e,t)),this.previousPromise.then(r=>{if(!r||!r.length||!n.validate(this.editor)){this.removeLinkDecorations();return}if(r.length>1)this.addDecoration(new W(e.lineNumber,t.startColumn,e.lineNumber,t.endColumn),new ue().appendText(z(`multipleResults`,`Click to show {0} definitions.`,r.length)));else{let n=r[0];if(!n.uri)return;this.textModelResolverService.createModelReference(n.uri).then(r=>{if(!r.object||!r.object.textEditorModel){r.dispose();return}let{object:{textEditorModel:i}}=r,{startLineNumber:a}=n.range;if(a<1||a>i.getLineCount()){r.dispose();return}let o=this.getPreviewValue(i,a,n),s;s=n.originSelectionRange?W.lift(n.originSelectionRange):new W(e.lineNumber,t.startColumn,e.lineNumber,t.endColumn);let c=this.modeService.getModeIdByFilepathOrFirstLine(i.uri);this.addDecoration(s,new ue().appendCodeblock(c||``,o)),r.dispose()})}}).then(void 0,C)}getPreviewValue(t,n,r){let i=r.targetSelectionRange?r.range:this.getPreviewRangeBasedOnBrackets(t,n);return i.endLineNumber-i.startLineNumber>=e.MAX_SOURCE_PREVIEW_LINES&&(i=this.getPreviewRangeBasedOnIndentation(t,n)),this.stripIndentationFromPreviewRange(t,n,i)}stripIndentationFromPreviewRange(e,t,n){let r=e.getLineFirstNonWhitespaceColumn(t);for(let i=t+1;i<n.endLineNumber;i++){let t=e.getLineFirstNonWhitespaceColumn(i);r=Math.min(r,t)}return e.getValueInRange(n).replace(RegExp(`^\\s{${r-1}}`,`gm`),``).trim()}getPreviewRangeBasedOnIndentation(t,n){let r=t.getLineFirstNonWhitespaceColumn(n),i=Math.min(t.getLineCount(),n+e.MAX_SOURCE_PREVIEW_LINES),a=n+1;for(;a<i&&r!==t.getLineFirstNonWhitespaceColumn(a);a++);return new W(n,1,a+1,1)}getPreviewRangeBasedOnBrackets(t,n){let r=Math.min(t.getLineCount(),n+e.MAX_SOURCE_PREVIEW_LINES),i=[],a=!0,o=t.findNextBracket(new P(n,1));for(;o!==null;){if(i.length===0)i.push(o);else{let e=i[i.length-1];if(e.open[0]===o.open[0]&&e.isOpen&&!o.isOpen?i.pop():i.push(o),i.length===0)if(a)a=!1;else return new W(n,1,o.range.endLineNumber+1,1)}let e=t.getLineMaxColumn(n),s=o.range.endLineNumber,c=o.range.endColumn;if(e===o.range.endColumn&&(s++,c=1),s>r)return new W(n,1,r+1,1);o=t.findNextBracket(new P(s,c))}return new W(n,1,r+1,1)}addDecoration(e,t){let n={range:e,options:{description:`goto-definition-link`,inlineClassName:`goto-definition-link`,hoverMessage:t}};this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[n])}removeLinkDecorations(){this.linkDecorations.length>0&&(this.linkDecorations=this.editor.deltaDecorations(this.linkDecorations,[]))}isEnabled(e,t){return this.editor.hasModel()&&e.isNoneOrSingleMouseDown&&e.target.type===6&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&Aa.has(this.editor.getModel())}findDefinition(e,t){let n=this.editor.getModel();return n?_f(n,e,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(e=>new Ff({openToSide:t,openInPeek:!t&&this.editor.getOption(77)&&!this.isInPeekEditor(e),muteMessage:!0},{alias:``,label:``,id:``,precondition:void 0}).run(e,this.editor))}isInPeekEditor(e){let t=e.get(D);return fd.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose()}};Wf.ID=`editor.contrib.gotodefinitionatposition`,Wf.MAX_SOURCE_PREVIEW_LINES=8,Wf=Hf([Uf(1,ms),Uf(2,zs)],Wf),U(Wf.ID,Wf),Ya((e,t)=>{let n=e.getColor(ls);n&&t.addRule(`.monaco-editor .goto-definition-link { color: ${n} !important; }`)});var Gf=G,Kf=class extends _{constructor(){super(),this.containerDomNode=document.createElement(`div`),this.containerDomNode.className=`monaco-hover`,this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute(`role`,`tooltip`),this.contentsDomNode=document.createElement(`div`),this.contentsDomNode.className=`monaco-hover-content`,this._scrollbar=this._register(new jt(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this._scrollbar.getDomNode())}onContentsChanged(){this._scrollbar.scanDomNode()}},qf=class e extends _{constructor(e,t,n){super(),this.actionContainer=q(e,Gf(`div.action-container`)),this.action=q(this.actionContainer,Gf(`a.action`)),this.action.setAttribute(`href`,`#`),this.action.setAttribute(`role`,`button`),t.iconClass&&q(this.action,Gf(`span.icon.${t.iconClass}`));let r=q(this.action,Gf(`span`));r.textContent=n?`${t.label} (${n})`:t.label,this._register(Qr(this.actionContainer,Do.MOUSE_DOWN,e=>{e.stopPropagation(),e.preventDefault(),t.run(this.actionContainer)})),this.setEnabled(!0)}static render(t,n,r){return new e(t,n,r)}setEnabled(e){e?(this.actionContainer.classList.remove(`disabled`),this.actionContainer.removeAttribute(`aria-disabled`)):(this.actionContainer.classList.add(`disabled`),this.actionContainer.setAttribute(`aria-disabled`,`true`))}},Jf=class{constructor(e,t,n){this.presentationIndex=n,this._onColorFlushed=new J,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new J,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new J,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){for(let e=0;e<this.colorPresentations.length;e++)if(t.toLowerCase()===this.colorPresentations[e].label){this.presentationIndex=e,this._onDidChangePresentation.fire(this.presentation);break}}flushColor(){this._onColorFlushed.fire(this._color)}},Yf=G,Xf=class extends _{constructor(e,t,n){super(),this.model=t,this.domNode=Yf(`.colorpicker-header`),q(e,this.domNode),this.pickedColorNode=q(this.domNode,Yf(`.picked-color`));let r=z(`clickToToggleColorOptions`,`Click to toggle color options (rgb/hsl/hex)`);this.pickedColorNode.setAttribute(`title`,r);let i=q(this.domNode,Yf(`.original-color`));i.style.backgroundColor=O.Format.CSS.format(this.model.originalColor)||``,this.backgroundColor=n.getColorTheme().getColor(Ps)||O.white,this._register(Ya((e,t)=>{this.backgroundColor=e.getColor(Ps)||O.white})),this._register(Qr(this.pickedColorNode,Do.CLICK,()=>this.model.selectNextColorPresentation())),this._register(Qr(i,Do.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this.pickedColorNode.style.backgroundColor=O.Format.CSS.format(t.color)||``,this.pickedColorNode.classList.toggle(`light`,t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter())}onDidChangeColor(e){this.pickedColorNode.style.backgroundColor=O.Format.CSS.format(e)||``,this.pickedColorNode.classList.toggle(`light`,e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this.pickedColorNode.textContent=this.model.presentation?this.model.presentation.label:``,this.pickedColorNode.prepend(Yf(`.codicon.codicon-color-mode`))}},Zf=class extends _{constructor(e,t,n){super(),this.model=t,this.pixelRatio=n,this.domNode=Yf(`.colorpicker-body`),q(e,this.domNode),this.saturationBox=new Qf(this.domNode,this.model,this.pixelRatio),this._register(this.saturationBox),this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this.saturationBox.onColorFlushed(this.flushColor,this)),this.opacityStrip=new ep(this.domNode,this.model),this._register(this.opacityStrip),this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this.opacityStrip.onColorFlushed(this.flushColor,this)),this.hueStrip=new tp(this.domNode,this.model),this._register(this.hueStrip),this._register(this.hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this.hueStrip.onColorFlushed(this.flushColor,this))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){let n=this.model.color.hsva;this.model.color=new O(new kt(n.h,e,t,n.a))}onDidOpacityChange(e){let t=this.model.color.hsva;this.model.color=new O(new kt(t.h,t.s,t.v,e))}onDidHueChange(e){let t=this.model.color.hsva,n=(1-e)*360;this.model.color=new O(new kt(n===360?0:n,t.s,t.v,t.a))}layout(){this.saturationBox.layout(),this.opacityStrip.layout(),this.hueStrip.layout()}},Qf=class extends _{constructor(e,t,n){super(),this.model=t,this.pixelRatio=n,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new J,this.onColorFlushed=this._onColorFlushed.event,this.domNode=Yf(`.saturation-wrap`),q(e,this.domNode),this.canvas=document.createElement(`canvas`),this.canvas.className=`saturation-box`,q(this.domNode,this.canvas),this.selection=Yf(`.saturation-selection`),q(this.domNode,this.selection),this.layout(),this._register(la(this.domNode,e=>this.onMouseDown(e))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}onMouseDown(e){this.monitor=this._register(new dr);let t=rn(this.domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.buttons,Qe,e=>this.onDidChangePosition(e.posx-t.left,e.posy-t.top),()=>null);let n=ea(document,()=>{this._onColorFlushed.fire(),n.dispose(),this.monitor&&=(this.monitor.stopMonitoring(!0),null)},!0)}onDidChangePosition(e,t){let n=Math.max(0,Math.min(1,e/this.width)),r=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(n,r),this._onDidChange.fire({s:n,v:r})}layout(){this.width=this.domNode.offsetWidth,this.height=this.domNode.offsetHeight,this.canvas.width=this.width*this.pixelRatio,this.canvas.height=this.height*this.pixelRatio,this.paint();let e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){let e=this.model.color.hsva,t=new O(new kt(e.h,1,1,1)),n=this.canvas.getContext(`2d`),r=n.createLinearGradient(0,0,this.canvas.width,0);r.addColorStop(0,`rgba(255, 255, 255, 1)`),r.addColorStop(.5,`rgba(255, 255, 255, 0.5)`),r.addColorStop(1,`rgba(255, 255, 255, 0)`);let i=n.createLinearGradient(0,0,0,this.canvas.height);i.addColorStop(0,`rgba(0, 0, 0, 0)`),i.addColorStop(1,`rgba(0, 0, 0, 1)`),n.rect(0,0,this.canvas.width,this.canvas.height),n.fillStyle=O.Format.CSS.format(t),n.fill(),n.fillStyle=r,n.fill(),n.fillStyle=i,n.fill()}paintSelection(e,t){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-t*this.height}px`}onDidChangeColor(){this.monitor&&this.monitor.isMonitoring()||this.paint()}},$f=class extends _{constructor(e,t){super(),this.model=t,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new J,this.onColorFlushed=this._onColorFlushed.event,this.domNode=q(e,Yf(`.strip`)),this.overlay=q(this.domNode,Yf(`.overlay`)),this.slider=q(this.domNode,Yf(`.slider`)),this.slider.style.top=`0px`,this._register(la(this.domNode,e=>this.onMouseDown(e))),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;let e=this.getValue(this.model.color);this.updateSliderPosition(e)}onMouseDown(e){let t=this._register(new dr),n=rn(this.domNode);this.domNode.classList.add(`grabbing`),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.buttons,Qe,e=>this.onDidChangeTop(e.posy-n.top),()=>null);let r=ea(document,()=>{this._onColorFlushed.fire(),r.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove(`grabbing`)},!0)}onDidChangeTop(e){let t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}},ep=class extends $f{constructor(e,t){super(e,t),this.domNode.classList.add(`opacity-strip`),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){let{r:t,g:n,b:r}=e.rgba,i=new O(new kn(t,n,r,1)),a=new O(new kn(t,n,r,0));this.overlay.style.background=`linear-gradient(to bottom, ${i} 0%, ${a} 100%)`}getValue(e){return e.hsva.a}},tp=class extends $f{constructor(e,t){super(e,t),this.domNode.classList.add(`hue-strip`)}getValue(e){return 1-e.hsva.h/360}},np=class extends ec{constructor(e,t,n,r){super(),this.model=t,this.pixelRatio=n,this._register(ni(()=>this.layout()));let i=Yf(`.colorpicker-widget`);e.appendChild(i);let a=new Xf(i,this.model,r);this.body=new Zf(i,this.model,this.pixelRatio),this._register(a),this._register(this.body)}layout(){this.body.layout()}},rp=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ip=function(e,t){return function(n,r){t(n,r,e)}},ap=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},op=class{constructor(e,t,n,r){this.owner=e,this.range=t,this.model=n,this.provider=r,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}},sp=class{constructor(e,t,n){this._editor=e,this._hover=t,this._themeService=n}computeSync(e,t){return[]}computeAsync(e,t,n){return ap(this,void 0,void 0,function*(){if(!this._editor.hasModel())return[];let e=Nu.get(this._editor);for(let n of t){if(n.options.description!==`color-detector-color`)continue;let t=e.getColorData(n.range.getStartPosition());if(t)return[yield this._createColorHover(this._editor.getModel(),t.colorInfo,t.provider)]}return[]})}_createColorHover(e,t,n){return ap(this,void 0,void 0,function*(){let r=e.getValueInRange(t.range),{red:i,green:a,blue:o,alpha:s}=t.color,c=new O(new kn(Math.round(i*255),Math.round(a*255),Math.round(o*255),s)),l=yield ku(e,t,n,j.None),u=new Jf(c,[],0);return u.colorPresentations=l||[],u.guessColorPresentation(c,r),new op(this,W.lift(t.range),u,n)})}renderHoverParts(e,t,n){if(e.length===0||!this._editor.hasModel())return _.None;let r=new K,i=e[0],a=this._editor.getModel(),o=i.model,s=r.add(new np(t,o,this._editor.getOption(127),this._themeService)),c=new W(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn),l=()=>{let e,t;if(o.presentation.textEdit){e=[o.presentation.textEdit],t=new W(o.presentation.textEdit.range.startLineNumber,o.presentation.textEdit.range.startColumn,o.presentation.textEdit.range.endLineNumber,o.presentation.textEdit.range.endColumn);let n=this._editor.getModel()._setTrackedRange(null,t,3);this._editor.pushUndoStop(),this._editor.executeEdits(`colorpicker`,e),t=this._editor.getModel()._getTrackedRange(n)||t}else e=[{identifier:null,range:c,text:o.presentation.label,forceMoveMarkers:!1}],t=c.setEndPosition(c.endLineNumber,c.startColumn+o.presentation.label.length),this._editor.pushUndoStop(),this._editor.executeEdits(`colorpicker`,e);o.presentation.additionalTextEdits&&(e=[...o.presentation.additionalTextEdits],this._editor.executeEdits(`colorpicker`,e),this._hover.hide()),this._editor.pushUndoStop(),c=t},u=e=>ku(a,{range:c,color:{red:e.rgba.r/255,green:e.rgba.g/255,blue:e.rgba.b/255,alpha:e.rgba.a}},i.provider,j.None).then(e=>{o.colorPresentations=e||[]});return r.add(o.onColorFlushed(e=>{u(e).then(l)})),r.add(o.onDidChangeColor(u)),this._hover.setColorPicker(s),r}};sp=rp([ip(2,Vi)],sp);var cp=class{constructor(e,t,n,r,i){this._computer=e,this._state=0,this._hoverTime=i,this._firstWaitScheduler=new T(()=>this._triggerAsyncComputation(),0),this._secondWaitScheduler=new T(()=>this._triggerSyncComputation(),0),this._loadingMessageScheduler=new T(()=>this._showLoadingMessage(),0),this._asyncComputationPromise=null,this._asyncComputationPromiseDone=!1,this._completeCallback=t,this._errorCallback=n,this._progressCallback=r}setHoverTime(e){this._hoverTime=e}_firstWaitTime(){return this._hoverTime/2}_secondWaitTime(){return this._hoverTime/2}_loadingMessageTime(){return 3*this._hoverTime}_triggerAsyncComputation(){this._state=2,this._secondWaitScheduler.schedule(this._secondWaitTime()),this._computer.computeAsync?(this._asyncComputationPromiseDone=!1,this._asyncComputationPromise=No(e=>this._computer.computeAsync(e)),this._asyncComputationPromise.then(e=>{this._asyncComputationPromiseDone=!0,this._withAsyncResult(e)},e=>this._onError(e))):this._asyncComputationPromiseDone=!0}_triggerSyncComputation(){this._computer.computeSync&&this._computer.onResult(this._computer.computeSync(),!0),this._asyncComputationPromiseDone?(this._state=0,this._onComplete(this._computer.getResult())):(this._state=3,this._onProgress(this._computer.getResult()))}_showLoadingMessage(){this._state===3&&this._onProgress(this._computer.getResultWithLoadingMessage())}_withAsyncResult(e){e&&this._computer.onResult(e,!1),this._state===3&&(this._state=0,this._onComplete(this._computer.getResult()))}_onComplete(e){this._completeCallback(e)}_onError(e){this._errorCallback?this._errorCallback(e):C(e)}_onProgress(e){this._progressCallback(e)}start(e){if(e===0)this._state===0&&(this._state=1,this._firstWaitScheduler.schedule(this._firstWaitTime()),this._loadingMessageScheduler.schedule(this._loadingMessageTime()));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._loadingMessageScheduler.cancel(),this._state===1&&this._firstWaitScheduler.cancel(),this._state===2&&(this._secondWaitScheduler.cancel(),this._asyncComputationPromise&&=(this._asyncComputationPromise.cancel(),null)),this._state===3&&(this._asyncComputationPromise&&=(this._asyncComputationPromise.cancel(),null)),this._state=0}},lp=class{constructor(e,t){this.priority=e,this.range=t,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}},up=class{constructor(e,t,n){this.priority=e,this.owner=t,this.range=n,this.type=2}equals(e){return e.type===2&&this.owner===e.owner}canAdoptVisibleHover(e,t){return e.type===2&&this.owner===e.owner}};function dp(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var fp=Object.hasOwnProperty,pp=Object.setPrototypeOf,mp=Object.isFrozen,hp=Object.getPrototypeOf,gp=Object.getOwnPropertyDescriptor,_p=Object.freeze,vp=Object.seal,yp=Object.create,bp=typeof Reflect<`u`&&Reflect,xp=bp.apply,Sp=bp.construct;xp||=function(e,t,n){return e.apply(t,n)},_p||=function(e){return e},vp||=function(e){return e},Sp||=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(dp(t))))};var Cp=Np(Array.prototype.forEach),wp=Np(Array.prototype.pop),Tp=Np(Array.prototype.push),Ep=Np(String.prototype.toLowerCase),Dp=Np(String.prototype.match),Op=Np(String.prototype.replace),kp=Np(String.prototype.indexOf),Ap=Np(String.prototype.trim),jp=Np(RegExp.prototype.test),Mp=Pp(TypeError);function Np(e){return function(t){var n=[...arguments].slice(1);return xp(e,t,n)}}function Pp(e){return function(){return Sp(e,[...arguments])}}function Z(e,t){pp&&pp(e,null);for(var n=t.length;n--;){var r=t[n];if(typeof r==`string`){var i=Ep(r);i!==r&&(mp(t)||(t[n]=i),r=i)}e[r]=!0}return e}function Fp(e){var t=yp(null),n=void 0;for(n in e)xp(fp,e,[n])&&(t[n]=e[n]);return t}function Ip(e,t){for(;e!==null;){var n=gp(e,t);if(n){if(n.get)return Np(n.get);if(typeof n.value==`function`)return Np(n.value)}e=hp(e)}function r(e){return console.warn(`fallback value for`,e),null}return r}var Lp=_p(`a.abbr.acronym.address.area.article.aside.audio.b.bdi.bdo.big.blink.blockquote.body.br.button.canvas.caption.center.cite.code.col.colgroup.content.data.datalist.dd.decorator.del.details.dfn.dialog.dir.div.dl.dt.element.em.fieldset.figcaption.figure.font.footer.form.h1.h2.h3.h4.h5.h6.head.header.hgroup.hr.html.i.img.input.ins.kbd.label.legend.li.main.map.mark.marquee.menu.menuitem.meter.nav.nobr.ol.optgroup.option.output.p.picture.pre.progress.q.rp.rt.ruby.s.samp.section.select.shadow.small.source.spacer.span.strike.strong.style.sub.summary.sup.table.tbody.td.template.textarea.tfoot.th.thead.time.tr.track.tt.u.ul.var.video.wbr`.split(`.`)),Rp=_p(`svg.a.altglyph.altglyphdef.altglyphitem.animatecolor.animatemotion.animatetransform.circle.clippath.defs.desc.ellipse.filter.font.g.glyph.glyphref.hkern.image.line.lineargradient.marker.mask.metadata.mpath.path.pattern.polygon.polyline.radialgradient.rect.stop.style.switch.symbol.text.textpath.title.tref.tspan.view.vkern`.split(`.`)),zp=_p([`feBlend`,`feColorMatrix`,`feComponentTransfer`,`feComposite`,`feConvolveMatrix`,`feDiffuseLighting`,`feDisplacementMap`,`feDistantLight`,`feFlood`,`feFuncA`,`feFuncB`,`feFuncG`,`feFuncR`,`feGaussianBlur`,`feMerge`,`feMergeNode`,`feMorphology`,`feOffset`,`fePointLight`,`feSpecularLighting`,`feSpotLight`,`feTile`,`feTurbulence`]),Bp=_p([`animate`,`color-profile`,`cursor`,`discard`,`fedropshadow`,`feimage`,`font-face`,`font-face-format`,`font-face-name`,`font-face-src`,`font-face-uri`,`foreignobject`,`hatch`,`hatchpath`,`mesh`,`meshgradient`,`meshpatch`,`meshrow`,`missing-glyph`,`script`,`set`,`solidcolor`,`unknown`,`use`]),Vp=_p(`math.menclose.merror.mfenced.mfrac.mglyph.mi.mlabeledtr.mmultiscripts.mn.mo.mover.mpadded.mphantom.mroot.mrow.ms.mspace.msqrt.mstyle.msub.msup.msubsup.mtable.mtd.mtext.mtr.munder.munderover`.split(`.`)),Hp=_p([`maction`,`maligngroup`,`malignmark`,`mlongdiv`,`mscarries`,`mscarry`,`msgroup`,`mstack`,`msline`,`msrow`,`semantics`,`annotation`,`annotation-xml`,`mprescripts`,`none`]),Up=_p([`#text`]),Wp=_p(`accept.action.align.alt.autocapitalize.autocomplete.autopictureinpicture.autoplay.background.bgcolor.border.capture.cellpadding.cellspacing.checked.cite.class.clear.color.cols.colspan.controls.controlslist.coords.crossorigin.datetime.decoding.default.dir.disabled.disablepictureinpicture.disableremoteplayback.download.draggable.enctype.enterkeyhint.face.for.headers.height.hidden.high.href.hreflang.id.inputmode.integrity.ismap.kind.label.lang.list.loading.loop.low.max.maxlength.media.method.min.minlength.multiple.muted.name.noshade.novalidate.nowrap.open.optimum.pattern.placeholder.playsinline.poster.preload.pubdate.radiogroup.readonly.rel.required.rev.reversed.role.rows.rowspan.spellcheck.scope.selected.shape.size.sizes.span.srclang.start.src.srcset.step.style.summary.tabindex.title.translate.type.usemap.valign.value.width.xmlns.slot`.split(`.`)),Gp=_p(`accent-height.accumulate.additive.alignment-baseline.ascent.attributename.attributetype.azimuth.basefrequency.baseline-shift.begin.bias.by.class.clip.clippathunits.clip-path.clip-rule.color.color-interpolation.color-interpolation-filters.color-profile.color-rendering.cx.cy.d.dx.dy.diffuseconstant.direction.display.divisor.dur.edgemode.elevation.end.fill.fill-opacity.fill-rule.filter.filterunits.flood-color.flood-opacity.font-family.font-size.font-size-adjust.font-stretch.font-style.font-variant.font-weight.fx.fy.g1.g2.glyph-name.glyphref.gradientunits.gradienttransform.height.href.id.image-rendering.in.in2.k.k1.k2.k3.k4.kerning.keypoints.keysplines.keytimes.lang.lengthadjust.letter-spacing.kernelmatrix.kernelunitlength.lighting-color.local.marker-end.marker-mid.marker-start.markerheight.markerunits.markerwidth.maskcontentunits.maskunits.max.mask.media.method.mode.min.name.numoctaves.offset.operator.opacity.order.orient.orientation.origin.overflow.paint-order.path.pathlength.patterncontentunits.patterntransform.patternunits.points.preservealpha.preserveaspectratio.primitiveunits.r.rx.ry.radius.refx.refy.repeatcount.repeatdur.restart.result.rotate.scale.seed.shape-rendering.specularconstant.specularexponent.spreadmethod.startoffset.stddeviation.stitchtiles.stop-color.stop-opacity.stroke-dasharray.stroke-dashoffset.stroke-linecap.stroke-linejoin.stroke-miterlimit.stroke-opacity.stroke.stroke-width.style.surfacescale.systemlanguage.tabindex.targetx.targety.transform.text-anchor.text-decoration.text-rendering.textlength.type.u1.u2.unicode.values.viewbox.visibility.version.vert-adv-y.vert-origin-x.vert-origin-y.width.word-spacing.wrap.writing-mode.xchannelselector.ychannelselector.x.x1.x2.xmlns.y.y1.y2.z.zoomandpan`.split(`.`)),Kp=_p(`accent.accentunder.align.bevelled.close.columnsalign.columnlines.columnspan.denomalign.depth.dir.display.displaystyle.encoding.fence.frame.height.href.id.largeop.length.linethickness.lspace.lquote.mathbackground.mathcolor.mathsize.mathvariant.maxsize.minsize.movablelimits.notation.numalign.open.rowalign.rowlines.rowspacing.rowspan.rspace.rquote.scriptlevel.scriptminsize.scriptsizemultiplier.selection.separator.separators.stretchy.subscriptshift.supscriptshift.symmetric.voffset.width.xmlns`.split(`.`)),qp=_p([`xlink:href`,`xml:id`,`xlink:title`,`xml:space`,`xmlns:xlink`]),Jp=vp(/\{\{[\s\S]*|[\s\S]*\}\}/gm),Yp=vp(/<%[\s\S]*|[\s\S]*%>/gm),Xp=vp(/^data-[\-\w.\u00B7-\uFFFF]/),Zp=vp(/^aria-[\-\w]+$/),Qp=vp(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$p=vp(/^(?:\w+script|data):/i),em=vp(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),tm=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e};function nm(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}else return Array.from(e)}var rm=function(){return typeof window>`u`?null:window},im=function(e,t){if((e===void 0?`undefined`:tm(e))!==`object`||typeof e.createPolicy!=`function`)return null;var n=null,r=`data-tt-policy-suffix`;t.currentScript&&t.currentScript.hasAttribute(r)&&(n=t.currentScript.getAttribute(r));var i=`dompurify`+(n?`#`+n:``);try{return e.createPolicy(i,{createHTML:function(e){return e}})}catch{return console.warn(`TrustedTypes policy `+i+` could not be created.`),null}};function am(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rm(),t=function(e){return am(e)};if(t.version=`2.3.1`,t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,r=e.document,i=e.DocumentFragment,a=e.HTMLTemplateElement,o=e.Node,s=e.Element,c=e.NodeFilter,l=e.NamedNodeMap,u=l===void 0?e.NamedNodeMap||e.MozNamedAttrMap:l,d=e.Text,f=e.Comment,p=e.DOMParser,m=e.trustedTypes,h=s.prototype,ee=Ip(h,`cloneNode`),g=Ip(h,`nextSibling`),te=Ip(h,`childNodes`),ne=Ip(h,`parentNode`);if(typeof a==`function`){var re=r.createElement(`template`);re.content&&re.content.ownerDocument&&(r=re.content.ownerDocument)}var ie=im(m,n),ae=ie&&je?ie.createHTML(``):``,oe=r,se=oe.implementation,ce=oe.createNodeIterator,le=oe.createDocumentFragment,ue=oe.getElementsByTagName,de=n.importNode,_={};try{_=Fp(r).documentMode?r.documentMode:{}}catch{}var fe={};t.isSupported=typeof ne==`function`&&se&&se.createHTMLDocument!==void 0&&_!==9;var pe=Jp,me=Yp,v=Xp,he=Zp,ge=$p,_e=em,ve=Qp,y=null,ye=Z({},[].concat(nm(Lp),nm(Rp),nm(zp),nm(Vp),nm(Up))),be=null,xe=Z({},[].concat(nm(Wp),nm(Gp),nm(Kp),nm(qp))),Se=null,Ce=null,b=!0,we=!0,x=!1,S=!1,Te=!1,Ee=!1,De=!1,Oe=!1,ke=!1,Ae=!0,je=!1,Me=!0,C=!0,w=!1,Ne={},Pe=null,Fe=Z({},[`annotation-xml`,`audio`,`colgroup`,`desc`,`foreignobject`,`head`,`iframe`,`math`,`mi`,`mn`,`mo`,`ms`,`mtext`,`noembed`,`noframes`,`noscript`,`plaintext`,`script`,`style`,`svg`,`template`,`thead`,`title`,`video`,`xmp`]),Ie=null,Le=Z({},[`audio`,`video`,`img`,`source`,`image`,`track`]),Re=null,ze=Z({},[`alt`,`class`,`for`,`id`,`label`,`name`,`pattern`,`placeholder`,`role`,`summary`,`title`,`value`,`style`,`xmlns`]),Be=`http://www.w3.org/1998/Math/MathML`,Ve=`http://www.w3.org/2000/svg`,He=`http://www.w3.org/1999/xhtml`,Ue=He,We=!1,T=null,Ge=r.createElement(`form`),Ke=function(e){T&&T===e||((!e||(e===void 0?`undefined`:tm(e))!==`object`)&&(e={}),e=Fp(e),y=`ALLOWED_TAGS`in e?Z({},e.ALLOWED_TAGS):ye,be=`ALLOWED_ATTR`in e?Z({},e.ALLOWED_ATTR):xe,Re=`ADD_URI_SAFE_ATTR`in e?Z(Fp(ze),e.ADD_URI_SAFE_ATTR):ze,Ie=`ADD_DATA_URI_TAGS`in e?Z(Fp(Le),e.ADD_DATA_URI_TAGS):Le,Pe=`FORBID_CONTENTS`in e?Z({},e.FORBID_CONTENTS):Fe,Se=`FORBID_TAGS`in e?Z({},e.FORBID_TAGS):{},Ce=`FORBID_ATTR`in e?Z({},e.FORBID_ATTR):{},Ne=`USE_PROFILES`in e?e.USE_PROFILES:!1,b=e.ALLOW_ARIA_ATTR!==!1,we=e.ALLOW_DATA_ATTR!==!1,x=e.ALLOW_UNKNOWN_PROTOCOLS||!1,S=e.SAFE_FOR_TEMPLATES||!1,Te=e.WHOLE_DOCUMENT||!1,Oe=e.RETURN_DOM||!1,ke=e.RETURN_DOM_FRAGMENT||!1,Ae=e.RETURN_DOM_IMPORT!==!1,je=e.RETURN_TRUSTED_TYPE||!1,De=e.FORCE_BODY||!1,Me=e.SANITIZE_DOM!==!1,C=e.KEEP_CONTENT!==!1,w=e.IN_PLACE||!1,ve=e.ALLOWED_URI_REGEXP||ve,Ue=e.NAMESPACE||He,S&&(we=!1),ke&&(Oe=!0),Ne&&(y=Z({},[].concat(nm(Up))),be=[],Ne.html===!0&&(Z(y,Lp),Z(be,Wp)),Ne.svg===!0&&(Z(y,Rp),Z(be,Gp),Z(be,qp)),Ne.svgFilters===!0&&(Z(y,zp),Z(be,Gp),Z(be,qp)),Ne.mathMl===!0&&(Z(y,Vp),Z(be,Kp),Z(be,qp))),e.ADD_TAGS&&(y===ye&&(y=Fp(y)),Z(y,e.ADD_TAGS)),e.ADD_ATTR&&(be===xe&&(be=Fp(be)),Z(be,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&Z(Re,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(Pe===Fe&&(Pe=Fp(Pe)),Z(Pe,e.FORBID_CONTENTS)),C&&(y[`#text`]=!0),Te&&Z(y,[`html`,`head`,`body`]),y.table&&(Z(y,[`tbody`]),delete Se.tbody),_p&&_p(e),T=e)},qe=Z({},[`mi`,`mo`,`mn`,`ms`,`mtext`]),Je=Z({},[`foreignobject`,`desc`,`title`,`annotation-xml`]),Ye=Z({},Rp);Z(Ye,zp),Z(Ye,Bp);var Xe=Z({},Vp);Z(Xe,Hp);var Ze=function(e){var t=ne(e);(!t||!t.tagName)&&(t={namespaceURI:He,tagName:`template`});var n=Ep(e.tagName),r=Ep(t.tagName);if(e.namespaceURI===Ve)return t.namespaceURI===He?n===`svg`:t.namespaceURI===Be?n===`svg`&&(r===`annotation-xml`||qe[r]):!!Ye[n];if(e.namespaceURI===Be)return t.namespaceURI===He?n===`math`:t.namespaceURI===Ve?n===`math`&&Je[r]:!!Xe[n];if(e.namespaceURI===He){if(t.namespaceURI===Ve&&!Je[r]||t.namespaceURI===Be&&!qe[r])return!1;var i=Z({},[`title`,`style`,`font`,`a`,`script`]);return!Xe[n]&&(i[n]||!Ye[n])}return!1},Qe=function(e){Tp(t.removed,{element:e});try{e.parentNode.removeChild(e)}catch{try{e.outerHTML=ae}catch{e.remove()}}},$e=function(e,n){try{Tp(t.removed,{attribute:n.getAttributeNode(e),from:n})}catch{Tp(t.removed,{attribute:null,from:n})}if(n.removeAttribute(e),e===`is`&&!be[e])if(Oe||ke)try{Qe(n)}catch{}else try{n.setAttribute(e,``)}catch{}},et=function(e){var t=void 0,n=void 0;if(De)e=`<remove></remove>`+e;else{var i=Dp(e,/^[\r\n\t ]+/);n=i&&i[0]}var a=ie?ie.createHTML(e):e;if(Ue===He)try{t=new p().parseFromString(a,`text/html`)}catch{}if(!t||!t.documentElement){t=se.createDocument(Ue,`template`,null);try{t.documentElement.innerHTML=We?``:a}catch{}}var o=t.body||t.documentElement;return e&&n&&o.insertBefore(r.createTextNode(n),o.childNodes[0]||null),Ue===He?ue.call(t,Te?`html`:`body`)[0]:Te?t.documentElement:o},E=function(e){return ce.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},tt=function(e){return e instanceof d||e instanceof f?!1:typeof e.nodeName!=`string`||typeof e.textContent!=`string`||typeof e.removeChild!=`function`||!(e.attributes instanceof u)||typeof e.removeAttribute!=`function`||typeof e.setAttribute!=`function`||typeof e.namespaceURI!=`string`||typeof e.insertBefore!=`function`},nt=function(e){return(o===void 0?`undefined`:tm(o))===`object`?e instanceof o:e&&(e===void 0?`undefined`:tm(e))===`object`&&typeof e.nodeType==`number`&&typeof e.nodeName==`string`},D=function(e,n,r){fe[e]&&Cp(fe[e],function(e){e.call(t,n,r,T)})},rt=function(e){var n=void 0;if(D(`beforeSanitizeElements`,e,null),tt(e)||Dp(e.nodeName,/[\u0080-\uFFFF]/))return Qe(e),!0;var r=Ep(e.nodeName);if(D(`uponSanitizeElement`,e,{tagName:r,allowedTags:y}),!nt(e.firstElementChild)&&(!nt(e.content)||!nt(e.content.firstElementChild))&&jp(/<[/\w]/g,e.innerHTML)&&jp(/<[/\w]/g,e.textContent)||r===`select`&&jp(/<template/i,e.innerHTML))return Qe(e),!0;if(!y[r]||Se[r]){if(C&&!Pe[r]){var i=ne(e)||e.parentNode,a=te(e)||e.childNodes;if(a&&i)for(var o=a.length-1;o>=0;--o)i.insertBefore(ee(a[o],!0),g(e))}return Qe(e),!0}return e instanceof s&&!Ze(e)||(r===`noscript`||r===`noembed`)&&jp(/<\/no(script|embed)/i,e.innerHTML)?(Qe(e),!0):(S&&e.nodeType===3&&(n=e.textContent,n=Op(n,pe,` `),n=Op(n,me,` `),e.textContent!==n&&(Tp(t.removed,{element:e.cloneNode()}),e.textContent=n)),D(`afterSanitizeElements`,e,null),!1)},it=function(e,t,n){return!(Me&&(t===`id`||t===`name`)&&(n in r||n in Ge)||!(we&&!Ce[t]&&jp(v,t))&&!(b&&jp(he,t))&&(!be[t]||Ce[t]||!Re[t]&&!jp(ve,Op(n,_e,``))&&!((t===`src`||t===`xlink:href`||t===`href`)&&e!==`script`&&kp(n,`data:`)===0&&Ie[e])&&!(x&&!jp(ge,Op(n,_e,``)))&&n))},O=function(e){var n=void 0,r=void 0,i=void 0,a=void 0;D(`beforeSanitizeAttributes`,e,null);var o=e.attributes;if(o){var s={attrName:``,attrValue:``,keepAttr:!0,allowedAttributes:be};for(a=o.length;a--;){n=o[a];var c=n,l=c.name,u=c.namespaceURI;if(r=Ap(n.value),i=Ep(l),s.attrName=i,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,D(`uponSanitizeAttribute`,e,s),r=s.attrValue,!s.forceKeepAttr&&($e(l,e),s.keepAttr)){if(jp(/\/>/i,r)){$e(l,e);continue}if(S&&(r=Op(r,pe,` `),r=Op(r,me,` `)),it(e.nodeName.toLowerCase(),i,r))try{u?e.setAttributeNS(u,l,r):e.setAttribute(l,r),wp(t.removed)}catch{}}}D(`afterSanitizeAttributes`,e,null)}},at=function e(t){var n=void 0,r=E(t);for(D(`beforeSanitizeShadowDOM`,t,null);n=r.nextNode();)D(`uponSanitizeShadowNode`,n,null),!rt(n)&&(n.content instanceof i&&e(n.content),O(n));D(`afterSanitizeShadowDOM`,t,null)};return t.sanitize=function(r,a){var s=void 0,c=void 0,l=void 0,u=void 0,d=void 0;if(We=!r,We&&(r=`<!-->`),typeof r!=`string`&&!nt(r)){if(typeof r.toString!=`function`)throw Mp(`toString is not a function`);if(r=r.toString(),typeof r!=`string`)throw Mp(`dirty is not a string, aborting`)}if(!t.isSupported){if(tm(e.toStaticHTML)===`object`||typeof e.toStaticHTML==`function`){if(typeof r==`string`)return e.toStaticHTML(r);if(nt(r))return e.toStaticHTML(r.outerHTML)}return r}if(Ee||Ke(a),t.removed=[],typeof r==`string`&&(w=!1),!w)if(r instanceof o)s=et(`<!---->`),c=s.ownerDocument.importNode(r,!0),c.nodeType===1&&c.nodeName===`BODY`||c.nodeName===`HTML`?s=c:s.appendChild(c);else{if(!Oe&&!S&&!Te&&r.indexOf(`<`)===-1)return ie&&je?ie.createHTML(r):r;if(s=et(r),!s)return Oe?null:ae}s&&De&&Qe(s.firstChild);for(var f=E(w?r:s);l=f.nextNode();)l.nodeType===3&&l===u||rt(l)||(l.content instanceof i&&at(l.content),O(l),u=l);if(u=null,w)return r;if(Oe){if(ke)for(d=le.call(s.ownerDocument);s.firstChild;)d.appendChild(s.firstChild);else d=s;return Ae&&(d=de.call(n,d,!0)),d}var p=Te?s.outerHTML:s.innerHTML;return S&&(p=Op(p,pe,` `),p=Op(p,me,` `)),ie&&je?ie.createHTML(p):p},t.setConfig=function(e){Ke(e),Ee=!0},t.clearConfig=function(){T=null,Ee=!1},t.isValidAttribute=function(e,t,n){return T||Ke({}),it(Ep(e),Ep(t),n)},t.addHook=function(e,t){typeof t==`function`&&(fe[e]=fe[e]||[],Tp(fe[e],t))},t.removeHook=function(e){fe[e]&&wp(fe[e])},t.removeHooks=function(e){fe[e]&&(fe[e]=[])},t.removeAllHooks=function(){fe={}},t}var om=am();om.version,om.isSupported;const sm=om.sanitize;om.setConfig,om.clearConfig,om.isValidAttribute;const cm=om.addHook,lm=om.removeHook;om.removeHooks,om.removeAllHooks;var um;(function(){function e(e){um=e()}e.amd=!0,(function(t,n){typeof exports==`object`&&typeof module<`u`?module.exports=n():typeof e==`function`&&e.amd?e(n):(t=typeof globalThis<`u`?globalThis:t||self,t.marked=n())})(this,(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,`value`in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function n(e,t){if(e){if(typeof e==`string`)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`)return Array.from(e);if(n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}function r(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){var r=typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=n(e))||t&&e&&typeof e.length==`number`){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a={exports:{}};function o(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:``,highlight:null,langPrefix:`language-`,mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function s(e){a.exports.defaults=e}a.exports={defaults:o(),getDefaults:o,changeDefaults:s};var c=/[&<>"']/,l=/[&<>"']/g,u=/[<>"']|&(?!#?\w+;)/,d=/[<>"']|&(?!#?\w+;)/g,f={"&":`&amp;`,"<":`&lt;`,">":`&gt;`,'"':`&quot;`,"'":`&#39;`},p=function(e){return f[e]};function m(e,t){if(t){if(c.test(e))return e.replace(l,p)}else if(u.test(e))return e.replace(d,p);return e}var h=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function ee(e){return e.replace(h,function(e,t){return t=t.toLowerCase(),t===`colon`?`:`:t.charAt(0)===`#`?t.charAt(1)===`x`?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):``})}var g=/(^|[^\[])\^/g;function te(e,t){e=e.source||e,t||=``;var n={replace:function(t,r){return r=r.source||r,r=r.replace(g,`$1`),e=e.replace(t,r),n},getRegex:function(){return new RegExp(e,t)}};return n}var ne=/[^\w:]/g,re=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function ie(e,t,n){if(e){var r;try{r=decodeURIComponent(ee(n)).replace(ne,``).toLowerCase()}catch{return null}if(r.indexOf(`javascript:`)===0||r.indexOf(`vbscript:`)===0||r.indexOf(`data:`)===0)return null}t&&!re.test(n)&&(n=le(t,n));try{n=encodeURI(n).replace(/%25/g,`%`)}catch{return null}return n}var ae={},oe=/^[^:]+:\/*[^/]*$/,se=/^([^:]+:)[\s\S]*$/,ce=/^([^:]+:\/*[^/]*)[\s\S]*$/;function le(e,t){ae[` `+e]||(oe.test(e)?ae[` `+e]=e+`/`:ae[` `+e]=fe(e,`/`,!0)),e=ae[` `+e];var n=e.indexOf(`:`)===-1;return t.substring(0,2)===`//`?n?t:e.replace(se,`$1`)+t:t.charAt(0)===`/`?n?t:e.replace(ce,`$1`)+t:e+t}var ue={exec:function(){}};function de(e){for(var t=1,n,r;t<arguments.length;t++)for(r in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}function _(e,t){var n=e.replace(/\|/g,function(e,t,n){for(var r=!1,i=t;--i>=0&&n[i]===`\\`;)r=!r;return r?`|`:` |`}).split(/ \|/),r=0;if(n[0].trim()||n.shift(),n[n.length-1].trim()||n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push(``);for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,`|`);return n}function fe(e,t,n){var r=e.length;if(r===0)return``;for(var i=0;i<r;){var a=e.charAt(r-i-1);if(a===t&&!n)i++;else if(a!==t&&n)i++;else break}return e.substr(0,r-i)}function pe(e,t){if(e.indexOf(t[1])===-1)return-1;for(var n=e.length,r=0,i=0;i<n;i++)if(e[i]===`\\`)i++;else if(e[i]===t[0])r++;else if(e[i]===t[1]&&(r--,r<0))return i;return-1}function me(e){e&&e.sanitize&&!e.silent&&console.warn(`marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options`)}function v(e,t){if(t<1)return``;for(var n=``;t>1;)t&1&&(n+=e),t>>=1,e+=e;return n+e}var he={escape:m,unescape:ee,edit:te,cleanUrl:ie,resolveUrl:le,noopTest:ue,merge:de,splitCells:_,rtrim:fe,findClosingBracket:pe,checkSanitizeDeprecation:me,repeatString:v},ge=a.exports.defaults,_e=he.rtrim,ve=he.splitCells,y=he.escape,ye=he.findClosingBracket;function be(e,t,n,r){var i=t.href,a=t.title?y(t.title):null,o=e[1].replace(/\\([\[\]])/g,`$1`);if(e[0].charAt(0)!==`!`){r.state.inLink=!0;var s={type:`link`,raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o,[])};return r.state.inLink=!1,s}else return{type:`image`,raw:n,href:i,title:a,text:y(o)}}function xe(e,t){var n=e.match(/^(\s+)(?:```)/);if(n===null)return t;var r=n[1];return t.split(`
`).map(function(e){var t=e.match(/^\s+/);return t===null?e:t[0].length>=r.length?e.slice(r.length):e}).join(`
`)}var Se=function(){function e(e){this.options=e||ge}var t=e.prototype;return t.space=function(e){var t=this.rules.block.newline.exec(e);if(t)return t[0].length>1?{type:`space`,raw:t[0]}:{raw:`
`}},t.code=function(e){var t=this.rules.block.code.exec(e);if(t){var n=t[0].replace(/^ {1,4}/gm,``);return{type:`code`,raw:t[0],codeBlockStyle:`indented`,text:this.options.pedantic?n:_e(n,`
`)}}},t.fences=function(e){var t=this.rules.block.fences.exec(e);if(t){var n=t[0],r=xe(n,t[3]||``);return{type:`code`,raw:n,lang:t[2]?t[2].trim():t[2],text:r}}},t.heading=function(e){var t=this.rules.block.heading.exec(e);if(t){var n=t[2].trim();if(/#$/.test(n)){var r=_e(n,`#`);(this.options.pedantic||!r||/ $/.test(r))&&(n=r.trim())}var i={type:`heading`,raw:t[0],depth:t[1].length,text:n,tokens:[]};return this.lexer.inline(i.text,i.tokens),i}},t.hr=function(e){var t=this.rules.block.hr.exec(e);if(t)return{type:`hr`,raw:t[0]}},t.blockquote=function(e){var t=this.rules.block.blockquote.exec(e);if(t){var n=t[0].replace(/^ *> ?/gm,``);return{type:`blockquote`,raw:t[0],tokens:this.lexer.blockTokens(n,[]),text:n}}},t.list=function(e){var t=this.rules.block.list.exec(e);if(t){var n,r,i,a,o,s,c,l,u,d,f=t[1].trim(),p=f.length>1,m={type:`list`,raw:``,ordered:p,start:p?+f.slice(0,-1):``,loose:!1,items:[]};f=p?`\\d{1,9}\\`+f.slice(-1):`\\`+f,this.options.pedantic&&(f=p?f:`[*+-]`);for(var h=RegExp(`^( {0,3}`+f+`)((?: [^\\n]*| *)(?:\\n[^\\n]*)*(?:\\n|$))`);e&&!(this.rules.block.hr.test(e)||!(t=h.exec(e)));){u=t[2].split(`
`),this.options.pedantic?(a=2,d=u[0].trimLeft()):(a=t[2].search(/[^ ]/),a=t[1].length+(a>4?1:a),d=u[0].slice(a-t[1].length)),s=!1,n=t[0],!u[0]&&/^ *$/.test(u[1])&&(n=t[1]+u.slice(0,2).join(`
`)+`
`,m.loose=!0,u=[]);var ee=RegExp(`^ {0,`+Math.min(3,a-1)+`}(?:[*+-]|\\d{1,9}[.)])`);for(o=1;o<u.length;o++){if(l=u[o],this.options.pedantic&&(l=l.replace(/^ {1,4}(?=( {4})*[^ ])/g,`  `)),ee.test(l)){n=t[1]+u.slice(0,o).join(`
`)+`
`;break}if(!s){l.trim()||(s=!0),l.search(/[^ ]/)>=a?d+=`
`+l.slice(a):d+=`
`+l;continue}if(l.search(/[^ ]/)>=a||!l.trim()){d+=`
`+l.slice(a);continue}else{n=t[1]+u.slice(0,o).join(`
`)+`
`;break}}m.loose||(c?m.loose=!0:/\n *\n *$/.test(n)&&(c=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(d),r&&(i=r[0]!==`[ ] `,d=d.replace(/^\[[ xX]\] +/,``))),m.items.push({type:`list_item`,raw:n,task:!!r,checked:i,loose:!1,text:d}),m.raw+=n,e=e.slice(n.length)}m.items[m.items.length-1].raw=n.trimRight(),m.items[m.items.length-1].text=d.trimRight(),m.raw=m.raw.trimRight();var g=m.items.length;for(o=0;o<g;o++)this.lexer.state.top=!1,m.items[o].tokens=this.lexer.blockTokens(m.items[o].text,[]),m.items[o].tokens.some(function(e){return e.type===`space`})&&(m.loose=!0,m.items[o].loose=!0);return m}},t.html=function(e){var t=this.rules.block.html.exec(e);if(t){var n={type:`html`,raw:t[0],pre:!this.options.sanitizer&&(t[1]===`pre`||t[1]===`script`||t[1]===`style`),text:t[0]};return this.options.sanitize&&(n.type=`paragraph`,n.text=this.options.sanitizer?this.options.sanitizer(t[0]):y(t[0]),n.tokens=[],this.lexer.inline(n.text,n.tokens)),n}},t.def=function(e){var t=this.rules.block.def.exec(e);if(t)return t[3]&&=t[3].substring(1,t[3].length-1),{type:`def`,tag:t[1].toLowerCase().replace(/\s+/g,` `),raw:t[0],href:t[2],title:t[3]}},t.table=function(e){var t=this.rules.block.table.exec(e);if(t){var n={type:`table`,header:ve(t[1]).map(function(e){return{text:e}}),align:t[2].replace(/^ *|\| *$/g,``).split(/ *\| */),rows:t[3]?t[3].replace(/\n$/,``).split(`
`):[]};if(n.header.length===n.align.length){n.raw=t[0];var r=n.align.length,i,a,o,s;for(i=0;i<r;i++)/^ *-+: *$/.test(n.align[i])?n.align[i]=`right`:/^ *:-+: *$/.test(n.align[i])?n.align[i]=`center`:/^ *:-+ *$/.test(n.align[i])?n.align[i]=`left`:n.align[i]=null;for(r=n.rows.length,i=0;i<r;i++)n.rows[i]=ve(n.rows[i],n.header.length).map(function(e){return{text:e}});for(r=n.header.length,a=0;a<r;a++)n.header[a].tokens=[],this.lexer.inlineTokens(n.header[a].text,n.header[a].tokens);for(r=n.rows.length,a=0;a<r;a++)for(s=n.rows[a],o=0;o<s.length;o++)s[o].tokens=[],this.lexer.inlineTokens(s[o].text,s[o].tokens);return n}}},t.lheading=function(e){var t=this.rules.block.lheading.exec(e);if(t){var n={type:`heading`,raw:t[0],depth:t[2].charAt(0)===`=`?1:2,text:t[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}},t.paragraph=function(e){var t=this.rules.block.paragraph.exec(e);if(t){var n={type:`paragraph`,raw:t[0],text:t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}},t.text=function(e){var t=this.rules.block.text.exec(e);if(t){var n={type:`text`,raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}},t.escape=function(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:`escape`,raw:t[0],text:y(t[1])}},t.tag=function(e){var t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?`text`:`html`,raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):y(t[0]):t[0]}},t.link=function(e){var t=this.rules.inline.link.exec(e);if(t){var n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;var r=_e(n.slice(0,-1),`\\`);if((n.length-r.length)%2==0)return}else{var i=ye(t[2],`()`);if(i>-1){var a=(t[0].indexOf(`!`)===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,a).trim(),t[3]=``}}var o=t[2],s=``;if(this.options.pedantic){var c=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(o);c&&(o=c[1],s=c[3])}else s=t[3]?t[3].slice(1,-1):``;return o=o.trim(),/^</.test(o)&&(o=this.options.pedantic&&!/>$/.test(n)?o.slice(1):o.slice(1,-1)),be(t,{href:o&&o.replace(this.rules.inline._escapes,`$1`),title:s&&s.replace(this.rules.inline._escapes,`$1`)},t[0],this.lexer)}},t.reflink=function(e,t){var n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){var r=(n[2]||n[1]).replace(/\s+/g,` `);if(r=t[r.toLowerCase()],!r||!r.href){var i=n[0].charAt(0);return{type:`text`,raw:i,text:i}}return be(n,r,n[0],this.lexer)}},t.emStrong=function(e,t,n){n===void 0&&(n=``);var r=this.rules.inline.emStrong.lDelim.exec(e);if(r&&!(r[3]&&n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82C[\uDC00-\uDD1E\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var i=r[1]||r[2]||``;if(!i||i&&(n===``||this.rules.inline.punctuation.exec(n))){var a=r[0].length-1,o,s,c=a,l=0,u=r[0][0]===`*`?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+a);(r=u.exec(t))!=null;)if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],o){if(s=o.length,r[3]||r[4]){c+=s;continue}else if((r[5]||r[6])&&a%3&&!((a+s)%3)){l+=s;continue}if(c-=s,!(c>0)){if(s=Math.min(s,s+c+l),Math.min(a,s)%2){var d=e.slice(1,a+r.index+s);return{type:`em`,raw:e.slice(0,a+r.index+s+1),text:d,tokens:this.lexer.inlineTokens(d,[])}}var f=e.slice(2,a+r.index+s-1);return{type:`strong`,raw:e.slice(0,a+r.index+s+1),text:f,tokens:this.lexer.inlineTokens(f,[])}}}}}},t.codespan=function(e){var t=this.rules.inline.code.exec(e);if(t){var n=t[2].replace(/\n/g,` `),r=/[^ ]/.test(n),i=/^ /.test(n)&&/ $/.test(n);return r&&i&&(n=n.substring(1,n.length-1)),n=y(n,!0),{type:`codespan`,raw:t[0],text:n}}},t.br=function(e){var t=this.rules.inline.br.exec(e);if(t)return{type:`br`,raw:t[0]}},t.del=function(e){var t=this.rules.inline.del.exec(e);if(t)return{type:`del`,raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}},t.autolink=function(e,t){var n=this.rules.inline.autolink.exec(e);if(n){var r,i;return n[2]===`@`?(r=y(this.options.mangle?t(n[1]):n[1]),i=`mailto:`+r):(r=y(n[1]),i=r),{type:`link`,raw:n[0],text:r,href:i,tokens:[{type:`text`,raw:r,text:r}]}}},t.url=function(e,t){var n;if(n=this.rules.inline.url.exec(e)){var r,i;if(n[2]===`@`)r=y(this.options.mangle?t(n[0]):n[0]),i=`mailto:`+r;else{var a;do a=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(a!==n[0]);r=y(n[0]),i=n[1]===`www.`?`http://`+r:r}return{type:`link`,raw:n[0],text:r,href:i,tokens:[{type:`text`,raw:r,text:r}]}}},t.inlineText=function(e,t){var n=this.rules.inline.text.exec(e);if(n){var r=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):y(n[0]):n[0]:y(this.options.smartypants?t(n[0]):n[0]);return{type:`text`,raw:n[0],text:r}}},e}(),Ce=he.noopTest,b=he.edit,we=he.merge,x={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:`^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))`,def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:Ce,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html| +\n)[^\n]+)*)/,text:/^[^\n]+/};x._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,x._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,x.def=b(x.def).replace(`label`,x._label).replace(`title`,x._title).getRegex(),x.bullet=/(?:[*+-]|\d{1,9}[.)])/,x.listItemStart=b(/^( *)(bull) */).replace(`bull`,x.bullet).getRegex(),x.list=b(x.list).replace(/bull/g,x.bullet).replace(`hr`,`\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))`).replace(`def`,`\\n+(?=`+x.def.source+`)`).getRegex(),x._tag=`address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul`,x._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,x.html=b(x.html,`i`).replace(`comment`,x._comment).replace(`tag`,x._tag).replace(`attribute`,/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),x.paragraph=b(x._paragraph).replace(`hr`,x.hr).replace(`heading`,` {0,3}#{1,6} `).replace(`|lheading`,``).replace(`blockquote`,` {0,3}>`).replace(`fences`," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace(`list`,` {0,3}(?:[*+-]|1[.)]) `).replace(`html`,`</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)`).replace(`tag`,x._tag).getRegex(),x.blockquote=b(x.blockquote).replace(`paragraph`,x.paragraph).getRegex(),x.normal=we({},x),x.gfm=we({},x.normal,{table:`^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)\\|?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)`}),x.gfm.table=b(x.gfm.table).replace(`hr`,x.hr).replace(`heading`,` {0,3}#{1,6} `).replace(`blockquote`,` {0,3}>`).replace(`code`,` {4}[^\\n]`).replace(`fences`," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace(`list`,` {0,3}(?:[*+-]|1[.)]) `).replace(`html`,`</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)`).replace(`tag`,x._tag).getRegex(),x.pedantic=we({},x.normal,{html:b(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace(`comment`,x._comment).replace(/tag/g,`(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b`).getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ce,paragraph:b(x.normal._paragraph).replace(`hr`,x.hr).replace(`heading`,` *#{1,6} *[^
]`).replace(`lheading`,x.lheading).replace(`blockquote`,` {0,3}>`).replace(`|fences`,``).replace(`|list`,``).replace(`|html`,``).getRegex()});var S={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Ce,tag:`^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>`,link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:`reflink|nolink(?!\\()`,emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/\_\_[^_*]*?\*[^_*]*?\_\_|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/\*\*[^_*]*?\_[^_*]*?\*\*|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Ce,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};S._punctuation=`!"#$%&'()+\\-.,/:;<=>?@\\[\\]\`^{|}~`,S.punctuation=b(S.punctuation).replace(/punctuation/g,S._punctuation).getRegex(),S.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,S.escapedEmSt=/\\\*|\\_/g,S._comment=b(x._comment).replace(`(?:-->|$)`,`-->`).getRegex(),S.emStrong.lDelim=b(S.emStrong.lDelim).replace(/punct/g,S._punctuation).getRegex(),S.emStrong.rDelimAst=b(S.emStrong.rDelimAst,`g`).replace(/punct/g,S._punctuation).getRegex(),S.emStrong.rDelimUnd=b(S.emStrong.rDelimUnd,`g`).replace(/punct/g,S._punctuation).getRegex(),S._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,S._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,S._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,S.autolink=b(S.autolink).replace(`scheme`,S._scheme).replace(`email`,S._email).getRegex(),S._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,S.tag=b(S.tag).replace(`comment`,S._comment).replace(`attribute`,S._attribute).getRegex(),S._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,S._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,S._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,S.link=b(S.link).replace(`label`,S._label).replace(`href`,S._href).replace(`title`,S._title).getRegex(),S.reflink=b(S.reflink).replace(`label`,S._label).getRegex(),S.reflinkSearch=b(S.reflinkSearch,`g`).replace(`reflink`,S.reflink).replace(`nolink`,S.nolink).getRegex(),S.normal=we({},S),S.pedantic=we({},S.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:b(/^!?\[(label)\]\((.*?)\)/).replace(`label`,S._label).getRegex(),reflink:b(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace(`label`,S._label).getRegex()}),S.gfm=we({},S.normal,{escape:b(S.escape).replace(`])`,`~|])`).getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),S.gfm.url=b(S.gfm.url,`i`).replace(`email`,S.gfm._extended_email).getRegex(),S.breaks=we({},S.gfm,{br:b(S.br).replace(`{2,}`,`*`).getRegex(),text:b(S.gfm.text).replace(`\\b_`,`\\b_| {2,}\\n`).replace(/\{2,\}/g,`*`).getRegex()});var Te={block:x,inline:S},Ee=Se,De=a.exports.defaults,Oe=Te.block,ke=Te.inline,Ae=he.repeatString;function je(e){return e.replace(/---/g,``).replace(/--/g,``).replace(/(^|[-\u2014/(\[{"\s])'/g,`$1`).replace(/'/g,``).replace(/(^|[-\u2014/(\[{\u2018\s])"/g,`$1`).replace(/"/g,``).replace(/\.{3}/g,``)}function Me(e){var t=``,n,r,i=e.length;for(n=0;n<i;n++)r=e.charCodeAt(n),Math.random()>.5&&(r=`x`+r.toString(16)),t+=`&#`+r+`;`;return t}var C=function(){function e(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||De,this.options.tokenizer=this.options.tokenizer||new Ee,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var t={block:Oe.normal,inline:ke.normal};this.options.pedantic?(t.block=Oe.pedantic,t.inline=ke.pedantic):this.options.gfm&&(t.block=Oe.gfm,this.options.breaks?t.inline=ke.breaks:t.inline=ke.gfm),this.tokenizer.rules=t}e.lex=function(t,n){return new e(n).lex(t)},e.lexInline=function(t,n){return new e(n).inlineTokens(t)};var n=e.prototype;return n.lex=function(e){e=e.replace(/\r\n|\r/g,`
`).replace(/\t/g,`    `),this.blockTokens(e,this.tokens);for(var t;t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens},n.blockTokens=function(e,t){var n=this;t===void 0&&(t=[]),this.options.pedantic&&(e=e.replace(/^ +$/gm,``));for(var r,i,a,o;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(function(i){return(r=i.call({lexer:n},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1}))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),r.type&&t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type===`paragraph`||i.type===`text`)?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&(i.type===`paragraph`||i.type===`text`)?(i.raw+=`
`+r.raw,i.text+=`
`+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(a=e,this.options.extensions&&this.options.extensions.startBlock&&(function(){var t=1/0,r=e.slice(1),i=void 0;n.options.extensions.startBlock.forEach(function(e){i=e.call({lexer:this},r),typeof i==`number`&&i>=0&&(t=Math.min(t,i))}),t<1/0&&t>=0&&(a=e.substring(0,t+1))})(),this.state.top&&(r=this.tokenizer.paragraph(a))){i=t[t.length-1],o&&i.type===`paragraph`?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r),o=a.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&i.type===`text`?(i.raw+=`
`+r.raw,i.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):t.push(r);continue}if(e){var s=`Infinite loop on byte: `+e.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw Error(s)}}return this.state.top=!0,t},n.inline=function(e,t){this.inlineQueue.push({src:e,tokens:t})},n.inlineTokens=function(e,t){var n=this;t===void 0&&(t=[]);var r,i,a,o=e,s,c,l;if(this.tokens.links){var u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(s[0].slice(s[0].lastIndexOf(`[`)+1,-1))&&(o=o.slice(0,s.index)+`[`+Ae(`a`,s[0].length-2)+`]`+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,s.index)+`[`+Ae(`a`,s[0].length-2)+`]`+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,s.index)+`++`+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(c||(l=``),c=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(function(i){return(r=i.call({lexer:n},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1}))){if(r=this.tokenizer.escape(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.tag(e)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type===`text`&&i.type===`text`?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.link(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(r.raw.length),i=t[t.length-1],i&&r.type===`text`&&i.type===`text`?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(r=this.tokenizer.emStrong(e,o,l)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.codespan(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.br(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.del(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.autolink(e,Me)){e=e.substring(r.raw.length),t.push(r);continue}if(!this.state.inLink&&(r=this.tokenizer.url(e,Me))){e=e.substring(r.raw.length),t.push(r);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline&&(function(){var t=1/0,r=e.slice(1),i=void 0;n.options.extensions.startInline.forEach(function(e){i=e.call({lexer:this},r),typeof i==`number`&&i>=0&&(t=Math.min(t,i))}),t<1/0&&t>=0&&(a=e.substring(0,t+1))})(),r=this.tokenizer.inlineText(a,je)){e=e.substring(r.raw.length),r.raw.slice(-1)!==`_`&&(l=r.raw.slice(-1)),c=!0,i=t[t.length-1],i&&i.type===`text`?(i.raw+=r.raw,i.text+=r.text):t.push(r);continue}if(e){var d=`Infinite loop on byte: `+e.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw Error(d)}}return t},t(e,null,[{key:`rules`,get:function(){return{block:Oe,inline:ke}}}]),e}(),w=a.exports.defaults,Ne=he.cleanUrl,Pe=he.escape,Fe=function(){function e(e){this.options=e||w}var t=e.prototype;return t.code=function(e,t,n){var r=(t||``).match(/\S*/)[0];if(this.options.highlight){var i=this.options.highlight(e,r);i!=null&&i!==e&&(n=!0,e=i)}return e=e.replace(/\n$/,``)+`
`,r?`<pre><code class="`+this.options.langPrefix+Pe(r,!0)+`">`+(n?e:Pe(e,!0))+`</code></pre>
`:`<pre><code>`+(n?e:Pe(e,!0))+`</code></pre>
`},t.blockquote=function(e){return`<blockquote>
`+e+`</blockquote>
`},t.html=function(e){return e},t.heading=function(e,t,n,r){return this.options.headerIds?`<h`+t+` id="`+this.options.headerPrefix+r.slug(n)+`">`+e+`</h`+t+`>
`:`<h`+t+`>`+e+`</h`+t+`>
`},t.hr=function(){return this.options.xhtml?`<hr/>
`:`<hr>
`},t.list=function(e,t,n){var r=t?`ol`:`ul`,i=t&&n!==1?` start="`+n+`"`:``;return`<`+r+i+`>
`+e+`</`+r+`>
`},t.listitem=function(e){return`<li>`+e+`</li>
`},t.checkbox=function(e){return`<input `+(e?`checked="" `:``)+`disabled="" type="checkbox"`+(this.options.xhtml?` /`:``)+`> `},t.paragraph=function(e){return`<p>`+e+`</p>
`},t.table=function(e,t){return t&&=`<tbody>`+t+`</tbody>`,`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`},t.tablerow=function(e){return`<tr>
`+e+`</tr>
`},t.tablecell=function(e,t){var n=t.header?`th`:`td`;return(t.align?`<`+n+` align="`+t.align+`">`:`<`+n+`>`)+e+`</`+n+`>
`},t.strong=function(e){return`<strong>`+e+`</strong>`},t.em=function(e){return`<em>`+e+`</em>`},t.codespan=function(e){return`<code>`+e+`</code>`},t.br=function(){return this.options.xhtml?`<br/>`:`<br>`},t.del=function(e){return`<del>`+e+`</del>`},t.link=function(e,t,n){if(e=Ne(this.options.sanitize,this.options.baseUrl,e),e===null)return n;var r=`<a href="`+Pe(e)+`"`;return t&&(r+=` title="`+t+`"`),r+=`>`+n+`</a>`,r},t.image=function(e,t,n){if(e=Ne(this.options.sanitize,this.options.baseUrl,e),e===null)return n;var r=`<img src="`+e+`" alt="`+n+`"`;return t&&(r+=` title="`+t+`"`),r+=this.options.xhtml?`/>`:`>`,r},t.text=function(e){return e},e}(),Ie=function(){function e(){}var t=e.prototype;return t.strong=function(e){return e},t.em=function(e){return e},t.codespan=function(e){return e},t.del=function(e){return e},t.html=function(e){return e},t.text=function(e){return e},t.link=function(e,t,n){return``+n},t.image=function(e,t,n){return``+n},t.br=function(){return``},e}(),Le=function(){function e(){this.seen={}}var t=e.prototype;return t.serialize=function(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,``).replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,``).replace(/\s/g,`-`)},t.getNextSafeSlug=function(e,t){var n=e,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[e];do r++,n=e+`-`+r;while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=r,this.seen[n]=0),n},t.slug=function(e,t){t===void 0&&(t={});var n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)},e}(),Re=Fe,ze=Ie,Be=Le,Ve=a.exports.defaults,He=he.unescape,Ue=function(){function e(e){this.options=e||Ve,this.options.renderer=this.options.renderer||new Re,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new ze,this.slugger=new Be}e.parse=function(t,n){return new e(n).parse(t)},e.parseInline=function(t,n){return new e(n).parseInline(t)};var t=e.prototype;return t.parse=function(e,t){t===void 0&&(t=!0);var n=``,r,i,a,o,s,c,l,u,d,f,p,m,h,ee,g,te,ne,re,ie,ae=e.length;for(r=0;r<ae;r++){if(f=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[f.type]&&(ie=this.options.extensions.renderers[f.type].call({parser:this},f),ie!==!1||![`space`,`hr`,`heading`,`code`,`table`,`blockquote`,`list`,`html`,`paragraph`,`text`].includes(f.type))){n+=ie||``;continue}switch(f.type){case`space`:continue;case`hr`:n+=this.renderer.hr();continue;case`heading`:n+=this.renderer.heading(this.parseInline(f.tokens),f.depth,He(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue;case`code`:n+=this.renderer.code(f.text,f.lang,f.escaped);continue;case`table`:for(u=``,l=``,o=f.header.length,i=0;i<o;i++)l+=this.renderer.tablecell(this.parseInline(f.header[i].tokens),{header:!0,align:f.align[i]});for(u+=this.renderer.tablerow(l),d=``,o=f.rows.length,i=0;i<o;i++){for(c=f.rows[i],l=``,s=c.length,a=0;a<s;a++)l+=this.renderer.tablecell(this.parseInline(c[a].tokens),{header:!1,align:f.align[a]});d+=this.renderer.tablerow(l)}n+=this.renderer.table(u,d);continue;case`blockquote`:d=this.parse(f.tokens),n+=this.renderer.blockquote(d);continue;case`list`:for(p=f.ordered,m=f.start,h=f.loose,o=f.items.length,d=``,i=0;i<o;i++)g=f.items[i],te=g.checked,ne=g.task,ee=``,g.task&&(re=this.renderer.checkbox(te),h?g.tokens.length>0&&g.tokens[0].type===`paragraph`?(g.tokens[0].text=re+` `+g.tokens[0].text,g.tokens[0].tokens&&g.tokens[0].tokens.length>0&&g.tokens[0].tokens[0].type===`text`&&(g.tokens[0].tokens[0].text=re+` `+g.tokens[0].tokens[0].text)):g.tokens.unshift({type:`text`,text:re}):ee+=re),ee+=this.parse(g.tokens,h),d+=this.renderer.listitem(ee,ne,te);n+=this.renderer.list(d,p,m);continue;case`html`:n+=this.renderer.html(f.text);continue;case`paragraph`:n+=this.renderer.paragraph(this.parseInline(f.tokens));continue;case`text`:for(d=f.tokens?this.parseInline(f.tokens):f.text;r+1<ae&&e[r+1].type===`text`;)f=e[++r],d+=`
`+(f.tokens?this.parseInline(f.tokens):f.text);n+=t?this.renderer.paragraph(d):d;continue;default:var oe=`Token with "`+f.type+`" type was not found.`;if(this.options.silent){console.error(oe);return}else throw Error(oe)}}return n},t.parseInline=function(e,t){t||=this.renderer;var n=``,r,i,a,o=e.length;for(r=0;r<o;r++){if(i=e[r],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]&&(a=this.options.extensions.renderers[i.type].call({parser:this},i),a!==!1||![`escape`,`html`,`link`,`image`,`strong`,`em`,`codespan`,`br`,`del`,`text`].includes(i.type))){n+=a||``;continue}switch(i.type){case`escape`:n+=t.text(i.text);break;case`html`:n+=t.html(i.text);break;case`link`:n+=t.link(i.href,i.title,this.parseInline(i.tokens,t));break;case`image`:n+=t.image(i.href,i.title,i.text);break;case`strong`:n+=t.strong(this.parseInline(i.tokens,t));break;case`em`:n+=t.em(this.parseInline(i.tokens,t));break;case`codespan`:n+=t.codespan(i.text);break;case`br`:n+=t.br();break;case`del`:n+=t.del(this.parseInline(i.tokens,t));break;case`text`:n+=t.text(i.text);break;default:var s=`Token with "`+i.type+`" type was not found.`;if(this.options.silent){console.error(s);return}else throw Error(s)}}return n},e}(),We=C,T=Ue,Ge=Se,Ke=Fe,qe=Ie,Je=Le,Ye=he.merge,Xe=he.checkSanitizeDeprecation,Ze=he.escape,Qe=a.exports.getDefaults,$e=a.exports.changeDefaults,et=a.exports.defaults;function E(e,t,n){if(e==null)throw Error(`marked(): input parameter is undefined or null`);if(typeof e!=`string`)throw Error(`marked(): input parameter is of type `+Object.prototype.toString.call(e)+`, string expected`);if(typeof t==`function`&&(n=t,t=null),t=Ye({},E.defaults,t||{}),Xe(t),n){var r=t.highlight,i;try{i=We.lex(e,t)}catch(e){return n(e)}var a=function(e){var a;if(!e)try{t.walkTokens&&E.walkTokens(i,t.walkTokens),a=T.parse(i,t)}catch(t){e=t}return t.highlight=r,e?n(e):n(null,a)};if(!r||r.length<3||(delete t.highlight,!i.length))return a();var o=0;E.walkTokens(i,function(e){e.type===`code`&&(o++,setTimeout(function(){r(e.text,e.lang,function(t,n){if(t)return a(t);n!=null&&n!==e.text&&(e.text=n,e.escaped=!0),o--,o===0&&a()})},0))}),o===0&&a();return}try{var s=We.lex(e,t);return t.walkTokens&&E.walkTokens(s,t.walkTokens),T.parse(s,t)}catch(e){if(e.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return`<p>An error occurred:</p><pre>`+Ze(e.message+``,!0)+`</pre>`;throw e}}return E.options=E.setOptions=function(e){return Ye(E.defaults,e),$e(E.defaults),E},E.getDefaults=Qe,E.defaults=et,E.use=function(){var e=this,t=[...arguments],n=Ye.apply(void 0,[{}].concat(t)),r=E.defaults.extensions||{renderers:{},childTokens:{}},i;t.forEach(function(t){if(t.extensions&&(i=!0,t.extensions.forEach(function(e){if(!e.name)throw Error(`extension name required`);if(e.renderer){var t=r.renderers?r.renderers[e.name]:null;t?r.renderers[e.name]=function(){var n=[...arguments],r=e.renderer.apply(this,n);return r===!1&&(r=t.apply(this,n)),r}:r.renderers[e.name]=e.renderer}if(e.tokenizer){if(!e.level||e.level!==`block`&&e.level!==`inline`)throw Error(`extension level must be 'block' or 'inline'`);r[e.level]?r[e.level].unshift(e.tokenizer):r[e.level]=[e.tokenizer],e.start&&(e.level===`block`?r.startBlock?r.startBlock.push(e.start):r.startBlock=[e.start]:e.level===`inline`&&(r.startInline?r.startInline.push(e.start):r.startInline=[e.start]))}e.childTokens&&(r.childTokens[e.name]=e.childTokens)})),t.renderer&&(function(){var e=E.defaults.renderer||new Ke,r=function(n){var r=e[n];e[n]=function(){var i=[...arguments],a=t.renderer[n].apply(e,i);return a===!1&&(a=r.apply(e,i)),a}};for(var i in t.renderer)r(i);n.renderer=e})(),t.tokenizer&&(function(){var e=E.defaults.tokenizer||new Ge,r=function(n){var r=e[n];e[n]=function(){var i=[...arguments],a=t.tokenizer[n].apply(e,i);return a===!1&&(a=r.apply(e,i)),a}};for(var i in t.tokenizer)r(i);n.tokenizer=e})(),t.walkTokens){var a=E.defaults.walkTokens;n.walkTokens=function(n){t.walkTokens.call(e,n),a&&a(n)}}i&&(n.extensions=r),E.setOptions(n)})},E.walkTokens=function(e,t){for(var n=function(){var e=a.value;switch(t(e),e.type){case`table`:for(var n=i(e.header),r;!(r=n()).done;){var o=r.value;E.walkTokens(o.tokens,t)}for(var s=i(e.rows),c;!(c=s()).done;)for(var l=c.value,u=i(l),d;!(d=u()).done;){var f=d.value;E.walkTokens(f.tokens,t)}break;case`list`:E.walkTokens(e.items,t);break;default:E.defaults.extensions&&E.defaults.extensions.childTokens&&E.defaults.extensions.childTokens[e.type]?E.defaults.extensions.childTokens[e.type].forEach(function(n){E.walkTokens(e[n],t)}):e.tokens&&E.walkTokens(e.tokens,t)}},r=i(e),a;!(a=r()).done;)n()},E.parseInline=function(e,t){if(e==null)throw Error(`marked.parseInline(): input parameter is undefined or null`);if(typeof e!=`string`)throw Error(`marked.parseInline(): input parameter is of type `+Object.prototype.toString.call(e)+`, string expected`);t=Ye({},E.defaults,t||{}),Xe(t);try{var n=We.lexInline(e,t);return t.walkTokens&&E.walkTokens(n,t.walkTokens),T.parseInline(n,t)}catch(e){if(e.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return`<p>An error occurred:</p><pre>`+Ze(e.message+``,!0)+`</pre>`;throw e}},E.Parser=T,E.parser=T.parse,E.Renderer=Ke,E.TextRenderer=qe,E.Lexer=We,E.lexer=We.lex,E.Tokenizer=Ge,E.Slugger=Je,E.parse=E,E}))})(),um.Parser,um.parser;var dm=um.Renderer;um.TextRenderer,um.Lexer,um.lexer,um.Tokenizer,um.Slugger;var fm=um.parse;function pm(e,t={},n={}){let r=new K,i=!1,a=r.add(new hs),o=ka(t),c=function(t){let n;try{n=Zs(decodeURIComponent(t))}catch{}return n?(n=To(n,t=>{if(e.uris&&e.uris[t])return L.revive(e.uris[t])}),encodeURIComponent(JSON.stringify(n))):t},l=function(t,n){let r=e.uris&&e.uris[t];if(!r)return t;let i=L.revive(r);return n?t.startsWith($e.data+`:`)?t:fr.asBrowserUri(i).toString(!0):L.parse(t).toString()===i.toString()?t:(i.query&&(i=i.with({query:c(i.query)})),i.toString())},u,d=new Promise(e=>u=e),f=new dm;if(f.image=(e,n,r)=>{let i=[],a=[];if(e){({href:e,dimensions:i}=Vn(e)),e=l(e,!0);try{let n=L.parse(e);t.baseUrl&&n.scheme===$e.file&&(e=it(t.baseUrl,e).toString())}catch{}a.push(`src="${e}"`)}return r&&a.push(`alt="${r}"`),n&&a.push(`title="${n}"`),i.length&&(a=a.concat(i)),`<img `+a.join(` `)+`>`},f.link=(n,r,i)=>(n===i&&(i=we(i)),n=l(n,!1),t.baseUrl&&(/^\w[\w\d+.-]*:/.test(n)||(n=it(t.baseUrl,n).toString())),r=we(r),n=we(n),!n||n.match(/^data:|javascript:/i)||n.match(/^command:/i)&&!e.isTrusted||n.match(/^command:(\/\/\/)?_workbench\.downloadResource/i)?i:(n=n.replace(/&/g,`&amp;`).replace(/</g,`&lt;`).replace(/>/g,`&gt;`).replace(/"/g,`&quot;`).replace(/'/g,`&#39;`),`<a href="#" data-href="${n}" title="${r||n}">${i}</a>`)),f.paragraph=e=>`<p>${e}</p>`,t.codeBlockRenderer&&(f.code=(e,n)=>{let r=t.codeBlockRenderer(n,e),s=Mt.nextId();return Or(Promise.all([r,d]),a.token).then(e=>{var n;if(!i&&e){let r=o.querySelector(`div[data-code="${s}"]`);r&&At(r,e[0]),(n=t.asyncRenderCallback)==null||n.call(t)}}).catch(()=>{}),`<div class="code" data-code="${s}">${Pr(e)}</div>`}),t.actionHandler){let e=t.actionHandler.disposables.add(new Oa(o,`click`)),n=t.actionHandler.disposables.add(new Oa(o,`auxclick`));t.actionHandler.disposables.add(ui.any(e.event,n.event)(e=>{let n=new s(e);if(!n.leftButton&&!n.middleButton)return;let r=n.target;if(!(r.tagName!==`A`&&(r=r.parentElement,!r||r.tagName!==`A`)))try{let e=r.dataset.href;e&&t.actionHandler.callback(e,n)}catch(e){C(e)}finally{n.preventDefault()}}))}e.supportHtml||(n.sanitizer=t=>e.isTrusted&&t.match(/^(<span[^>]+>)|(<\/\s*span>)$/)?t:``,n.sanitize=!0,n.silent=!0),n.renderer=f;let p=e.value??``;p.length>1e5&&(p=`${p.substr(0,1e5)}`),e.supportThemeIcons&&(p=Rr(p));let m=fm(p,n);if(e.supportThemeIcons&&(m=on(m).map(e=>typeof e==`string`?e:e.outerHTML).join(``)),o.innerHTML=mm(e,m),u(),t.asyncRenderCallback)for(let e of o.getElementsByTagName(`img`)){let n=r.add(Qr(e,`load`,()=>{n.dispose(),t.asyncRenderCallback()}))}return{element:o,dispose:()=>{i=!0,a.cancel(),r.dispose()}}}function mm(e,t){let{config:n,allowedSchemes:r}=hm(e);cm(`uponSanitizeAttribute`,(e,t)=>{if(t.attrName===`style`||t.attrName===`class`){if(e.tagName===`SPAN`){if(t.attrName===`style`){t.keepAttr=/^(color\:#[0-9a-fA-F]+;)?(background-color\:#[0-9a-fA-F]+;)?$/.test(t.attrValue);return}else if(t.attrName===`class`){t.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(t.attrValue);return}}t.keepAttr=!1;return}});let i=document.createElement(`a`);cm(`afterSanitizeAttributes`,e=>{for(let t of[`href`,`src`])e.hasAttribute(t)&&(i.href=e.getAttribute(t),r.includes(i.protocol.replace(/:$/,``))||e.removeAttribute(t))});try{return sm(t,Object.assign(Object.assign({},n),{RETURN_TRUSTED_TYPE:!0}))}finally{lm(`uponSanitizeAttribute`),lm(`afterSanitizeAttributes`)}}function hm(e){let t=[$e.http,$e.https,$e.mailto,$e.data,$e.file,$e.vscodeFileResource,$e.vscodeRemote,$e.vscodeRemoteResource];return e.isTrusted&&t.push($e.command),{config:{ALLOWED_TAGS:`ul.li.p.b.i.code.blockquote.ol.h1.h2.h3.h4.h5.h6.hr.em.pre.table.thead.tbody.tr.th.td.div.del.a.strong.br.img.span`.split(`.`),ALLOWED_ATTR:[`href`,`data-href`,`target`,`title`,`src`,`alt`,`class`,`style`,`data-code`,`width`,`height`,`align`],ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:t}}var gm=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_m=function(e,t){return function(n,r){t(n,r,e)}},vm=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},ym=class e{constructor(e,t,n){this._options=e,this._modeService=t,this._openerService=n,this._onDidRenderAsync=new J,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,n){if(!e)return{element:document.createElement(`span`),dispose:()=>{}};let r=new K;return{element:r.add(pm(e,Object.assign(Object.assign({},this._getRenderOptions(e,r)),t),n)).element,dispose:()=>r.dispose()}}_getRenderOptions(t,r){return{baseUrl:this._options.baseUrl,codeBlockRenderer:(t,r)=>vm(this,void 0,void 0,function*(){let i;t?i=this._modeService.getModeIdForLanguageName(t):this._options.editor&&(i=this._options.editor.getModel()?.getLanguageId()),i||=`plaintext`,this._modeService.triggerMode(i);let a=(yield n.getPromise(i))??void 0,o=document.createElement(`span`);if(o.innerHTML=e._ttpTokenizer?.createHTML(r,this._modeService.languageIdCodec,a)??ot(r,this._modeService.languageIdCodec,a),this._options.editor){let e=this._options.editor.getOption(43);xt.applyFontInfoSlow(o,e)}else this._options.codeBlockFontFamily&&(o.style.fontFamily=this._options.codeBlockFontFamily);return o}),asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:e=>this._openerService.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:t.isTrusted}).catch(C),disposables:r}}}};ym._ttpTokenizer=window.trustedTypes?.createPolicy(`tokenizeToString`,{createHTML(e,t,n){return ot(e,t,n)}}),ym=gm([_m(1,zs),_m(2,Qi)],ym);function bm(e,t,n){let i=Tt.ordered(e).map(r=>Promise.resolve(r.provideHover(e,t,n)).then(e=>e&&xm(e)?e:void 0,e=>{nt(e)}));return Promise.all(i).then(r)}Ro(`_executeHoverProvider`,(e,t)=>bm(e,t,j.None));function xm(e){let t=e.range!==void 0,n=e.contents!==void 0&&e.contents&&e.contents.length>0;return t&&n}var Sm=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Cm=function(e,t){return function(n,r){t(n,r,e)}},wm=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Tm=G,Em=class{constructor(e,t,n){this.owner=e,this.range=t,this.contents=n}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}},Dm=class{constructor(e,t,n,r,i){this._editor=e,this._hover=t,this._modeService=n,this._openerService=r,this._configurationService=i}createLoadingMessage(e){return new Em(this,e.range,[new ue().appendText(z(`modesContentHover.loading`,`Loading...`))])}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];let n=this._editor.getModel(),r=e.range.startLineNumber,i=n.getLineMaxColumn(r),a=[];for(let n of t){let t=n.range.startLineNumber===r?n.range.startColumn:1,o=n.range.endLineNumber===r?n.range.endColumn:i,s=n.options.hoverMessage;if(!s||Ss(s))continue;let c=new W(e.range.startLineNumber,t,e.range.startLineNumber,o);a.push(new Em(this,c,Br(s)))}let o=n.getLineLength(r),s=n.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),c=this._configurationService.getValue(`editor.maxTokenizationLineLength`,{overrideIdentifier:s});return typeof c==`number`&&o>=c&&a.push(new Em(this,e.range,[{value:z(`too many characters`,"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}])),a}computeAsync(e,t,n){return wm(this,void 0,void 0,function*(){if(!this._editor.hasModel()||e.type!==1)return Promise.resolve([]);let t=this._editor.getModel();if(!Tt.has(t))return Promise.resolve([]);let r=yield bm(t,new P(e.range.startLineNumber,e.range.startColumn),n),i=[];for(let t of r){if(Ss(t.contents))continue;let n=t.range?W.lift(t.range):e.range;i.push(new Em(this,n,t.contents))}return i})}renderHoverParts(e,t,n){let r=new K;for(let n of e)for(let e of n.contents){if(Ss(e))continue;let n=Tm(`div.hover-row.markdown-hover`),i=q(n,Tm(`div.hover-contents`)),a=r.add(new ym({editor:this._editor},this._modeService,this._openerService));r.add(a.onDidRenderAsync(()=>{i.className=`hover-contents code-hover-contents`,this._hover.onContentsChanged()}));let o=r.add(a.render(e));i.appendChild(o.element),t.appendChild(n)}return r}};Dm=Sm([Cm(2,zs),Cm(3,Qi),Cm(4,xo)],Dm);var Om=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},km=function(e,t){return function(n,r){t(n,r,e)}},Am=class{constructor(e,t,n){this.marker=e,this.index=t,this.total=n}},jm=class e{constructor(t,n){this._markerService=n,this._onDidChange=new J,this.onDidChange=this._onDidChange.event,this._dispoables=new K,this._markers=[],this._nextIdx=-1,L.isUri(t)?this._resourceFilter=e=>e.toString()===t.toString():t&&(this._resourceFilter=t);let r=()=>{this._markers=this._markerService.read({resource:L.isUri(t)?t:void 0,severities:Ks.Error|Ks.Warning|Ks.Info}),typeof t==`function`&&(this._markers=this._markers.filter(e=>this._resourceFilter(e.resource))),this._markers.sort(e._compareMarker)};r(),this._dispoables.add(n.onMarkerChanged(e=>{(!this._resourceFilter||e.some(e=>this._resourceFilter(e)))&&(r(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){let e=this._markers[this._nextIdx];return e&&new Am(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,n){let r=!1,i=this._markers.findIndex(t=>t.resource.toString()===e.uri.toString());i<0&&(i=_n(this._markers,{resource:e.uri},(e,t)=>Ue(e.resource.toString(),t.resource.toString())),i<0&&(i=~i));for(let n=i;n<this._markers.length;n++){let i=W.lift(this._markers[n]);if(i.isEmpty()){let t=e.getWordAtPosition(i.getStartPosition());t&&(i=new W(i.startLineNumber,t.startColumn,i.startLineNumber,t.endColumn))}if(t&&(i.containsPosition(t)||t.isBeforeOrEqual(i.getStartPosition()))){this._nextIdx=n,r=!0;break}if(this._markers[n].resource.toString()!==e.uri.toString())break}r||(this._nextIdx=n?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,n){if(this._markers.length===0)return!1;let r=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,n,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),r!==this._nextIdx}find(e,t){let n=this._markers.findIndex(t=>t.resource.toString()===e.toString());if(!(n<0)){for(;n<this._markers.length;n++)if(W.containsPosition(this._markers[n],t))return new Am(this._markers[n],n+1,this._markers.length)}}static _compareMarker(e,t){let n=Ue(e.resource.toString(),t.resource.toString());return n===0&&(n=Ks.compare(e.severity,t.severity)),n===0&&(n=W.compareRangesUsingStarts(e,t)),n}};jm=Om([km(1,Cn)],jm);const Mm=yi(`IMarkerNavigationService`);var Nm=class{constructor(e){this._markerService=e,this._provider=new Pn}getMarkerList(e){for(let t of this._provider){let n=t.getMarkerList(e);if(n)return n}return new jm(e,this._markerService)}};Nm=Om([km(0,Cn)],Nm),Bi(Mm,Nm,!0);var Pm;(function(e){function t(e){switch(e){case Ve.Ignore:return`severity-ignore `+M.info.classNames;case Ve.Info:return M.info.classNames;case Ve.Warning:return M.warning.classNames;case Ve.Error:return M.error.classNames;default:return``}}e.className=t})(Pm||={}),Ya((e,t)=>{let n=e.getColor(Zr);if(n){let e=M.error.cssSelector;t.addRule(`
			.monaco-editor .zone-widget ${e},
			.markers-panel .marker-icon${e},
			.text-search-provider-messages .providerMessage ${e},
			.extensions-viewlet > .extensions ${e} {
				color: ${n};
			}
		`)}let r=e.getColor(Us);if(r){let e=M.warning.cssSelector;t.addRule(`
			.monaco-editor .zone-widget ${e},
			.markers-panel .marker-icon${e},
			.extensions-viewlet > .extensions ${e},
			.extension-editor ${e},
			.text-search-provider-messages .providerMessage ${e},
			.preferences-editor ${e} {
				color: ${r};
			}
		`)}let i=e.getColor(ys);if(i){let e=M.info.cssSelector;t.addRule(`
			.monaco-editor .zone-widget ${e},
			.markers-panel .marker-icon${e},
			.extensions-viewlet > .extensions ${e},
			.text-search-provider-messages .providerMessage ${e},
			.extension-editor ${e} {
				color: ${i};
			}
		`)}});var Fm=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Im=function(e,t){return function(n,r){t(n,r,e)}},Lm=class{constructor(e,t,n,r,i){this._openerService=r,this._labelService=i,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new K,this._editor=t;let a=document.createElement(`div`);a.className=`descriptioncontainer`,this._messageBlock=document.createElement(`div`),this._messageBlock.classList.add(`message`),this._messageBlock.setAttribute(`aria-live`,`assertive`),this._messageBlock.setAttribute(`role`,`alert`),a.appendChild(this._messageBlock),this._relatedBlock=document.createElement(`div`),a.appendChild(this._relatedBlock),this._disposables.add(hi(this._relatedBlock,`click`,e=>{e.preventDefault();let t=this._relatedDiagnostics.get(e.target);t&&n(t)})),this._scrollable=new jn(a,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:3,verticalScrollbarSize:3}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(e=>{a.style.left=`-${e.scrollLeft}px`,a.style.top=`-${e.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){y(this._disposables)}update(e){let{source:t,message:n,relatedInformation:r,code:i}=e,a=(t?.length||0)+2;i&&(typeof i==`string`?a+=i.length:a+=i.value.length);let o=Xo(n);this._lines=o.length,this._longestLineLength=0;for(let e of o)this._longestLineLength=Math.max(e.length+a,this._longestLineLength);he(this._messageBlock),this._messageBlock.setAttribute(`aria-label`,this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let s=this._messageBlock;for(let e of o)s=document.createElement(`div`),s.innerText=e,e===``&&(s.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(s);if(t||i){let e=document.createElement(`span`);if(e.classList.add(`details`),s.appendChild(e),t){let n=document.createElement(`span`);n.innerText=t,n.classList.add(`source`),e.appendChild(n)}if(i)if(typeof i==`string`){let t=document.createElement(`span`);t.innerText=`(${i})`,t.classList.add(`code`),e.appendChild(t)}else{this._codeLink=G(`a.code-link`),this._codeLink.setAttribute(`href`,`${i.target.toString()}`),this._codeLink.onclick=e=>{this._openerService.open(i.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()};let t=q(this._codeLink,G(`span`));t.innerText=i.value,e.appendChild(this._codeLink)}}if(he(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),ti(r)){let e=this._relatedBlock.appendChild(document.createElement(`div`));e.style.paddingTop=`${Math.floor(this._editor.getOption(58)*.66)}px`,this._lines+=1;for(let t of r){let n=document.createElement(`div`),r=document.createElement(`a`);r.classList.add(`filename`),r.innerText=`${Id(t.resource)}(${t.startLineNumber}, ${t.startColumn}): `,r.title=this._labelService.getUriLabel(t.resource),this._relatedDiagnostics.set(r,t);let i=document.createElement(`span`);i.innerText=t.message,n.appendChild(r),n.appendChild(i),this._lines+=1,e.appendChild(n)}}let c=this._editor.getOption(43),l=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),u=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:l,scrollHeight:u})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t=``;switch(e.severity){case Ks.Error:t=z(`Error`,`Error`);break;case Ks.Warning:t=z(`Warning`,`Warning`);break;case Ks.Info:t=z(`Info`,`Info`);break;case Ks.Hint:t=z(`Hint`,`Hint`);break}let n=z(`marker aria`,`{0} at {1}. `,t,e.startLineNumber+`:`+e.startColumn),r=this._editor.getModel();return r&&e.startLineNumber<=r.getLineCount()&&e.startLineNumber>=1&&(n=`${r.getLineContent(e.startLineNumber)}, ${n}`),n}},Rm=class e extends gd{constructor(e,t,n,r,i,a,o){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},i),this._themeService=t,this._openerService=n,this._menuService=r,this._contextKeyService=a,this._labelService=o,this._callOnDispose=new K,this._onDidSelectRelatedInformation=new J,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=Ks.Warning,this._backgroundColor=O.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(Jm);let t=Hm,n=Um;this._severity===Ks.Warning?(t=Wm,n=Gm):this._severity===Ks.Info&&(t=Km,n=qm);let r=e.getColor(t),i=e.getColor(n);this.style({arrowColor:r,frameColor:r,headerBackgroundColor:i,primaryHeadingColor:e.getColor(vd),secondaryHeadingColor:e.getColor(yd)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():``),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(t){super._fillHead(t),this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun(e=>this.editor.focus()));let n=[],r=this._menuService.createMenu(e.TitleMenu,this._contextKeyService);nd(r,void 0,n),this._actionbarWidget.push(n,{label:!1,icon:!0,index:0}),r.dispose()}_fillTitleIcon(e){this._icon=q(e,G(``))}_fillBody(e){this._parentContainer=e,e.classList.add(`marker-widget`),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute(`role`,`tooltip`),this._container=document.createElement(`div`),e.appendChild(this._container),this._message=new Lm(this._container,this.editor,e=>this._onDidSelectRelatedInformation.fire(e),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw Error(`call showAtMarker`)}showAtMarker(e,t,n){this._container.classList.remove(`stale`),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());let r=W.lift(e),i=this.editor.getPosition(),a=i&&r.containsPosition(i)?i:r.getStartPosition();super.show(a,this.computeRequiredHeight());let o=this.editor.getModel();if(o){let e=n>1?z(`problems`,`{0} of {1} problems`,t,n):z(`change`,`{0} of {1} problem`,t,n);this.setTitle(Pa(o.uri),e)}this._icon.className=`codicon ${Pm.className(Ks.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(a,0),this.editor.focus()}updateMarker(e){this._container.classList.remove(`stale`),this._message.update(e)}showStale(){this._container.classList.add(`stale`),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};Rm.TitleMenu=new N(`gotoErrorTitleMenu`),Rm=Fm([Im(1,Vi),Im(2,Qi),Im(3,Ko),Im(4,H),Im(5,D),Im(6,ko)],Rm);var zm=Qa(wo,Hi),Bm=Qa(ae,Xs),Vm=Qa(be,Ee);const Hm=v(`editorMarkerNavigationError.background`,{dark:zm,light:zm,hc:Va},z(`editorMarkerNavigationError`,`Editor marker navigation widget error color.`)),Um=v(`editorMarkerNavigationError.headerBackground`,{dark:Rt(Hm,.1),light:Rt(Hm,.1),hc:null},z(`editorMarkerNavigationErrorHeaderBackground`,`Editor marker navigation widget error heading background.`)),Wm=v(`editorMarkerNavigationWarning.background`,{dark:Bm,light:Bm,hc:Va},z(`editorMarkerNavigationWarning`,`Editor marker navigation widget warning color.`)),Gm=v(`editorMarkerNavigationWarning.headerBackground`,{dark:Rt(Wm,.1),light:Rt(Wm,.1),hc:`#0C141F`},z(`editorMarkerNavigationWarningBackground`,`Editor marker navigation widget warning heading background.`)),Km=v(`editorMarkerNavigationInfo.background`,{dark:Vm,light:Vm,hc:Va},z(`editorMarkerNavigationInfo`,`Editor marker navigation widget info color.`)),qm=v(`editorMarkerNavigationInfo.headerBackground`,{dark:Rt(Km,.1),light:Rt(Km,.1),hc:null},z(`editorMarkerNavigationInfoHeaderBackground`,`Editor marker navigation widget info heading background.`)),Jm=v(`editorMarkerNavigation.background`,{dark:Oi,light:Oi,hc:Oi},z(`editorMarkerNavigationBackground`,`Editor marker navigation widget background.`));Ya((e,t)=>{let n=e.getColor(h);n&&t.addRule(`.monaco-editor .marker-widget a.code-link span { color: ${n}; }`);let r=e.getColor(Fa);r&&t.addRule(`.monaco-editor .marker-widget a.code-link span:hover { color: ${r}; }`)});var Ym=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Xm=function(e,t){return function(n,r){t(n,r,e)}},Zm=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Qm=class e{constructor(e,t,n,r,i){this._markerNavigationService=t,this._contextKeyService=n,this._editorService=r,this._instantiationService=i,this._sessionDispoables=new K,this._editor=e,this._widgetVisible=ih.bindTo(this._contextKeyService)}static get(t){return t.getContribution(e.ID)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(Rm,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e=>{var t;(!this._model?.selected||!W.containsPosition(this._model?.selected.marker,e.position))&&((t=this._model)==null||t.resetIndex())})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;let e=this._model.find(this._editor.getModel().uri,this._widget.position);e?this._widget.updateMarker(e.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(e=>{this._editorService.openCodeEditor({resource:e.resource,options:{pinned:!0,revealIfOpened:!0,selection:W.lift(e).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){let t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new P(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(t,n){return Zm(this,void 0,void 0,function*(){if(this._editor.hasModel()){let r=this._getOrCreateModel(n?void 0:this._editor.getModel().uri);if(r.move(t,this._editor.getModel(),this._editor.getPosition()),!r.selected)return;if(r.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();let i=yield this._editorService.openCodeEditor({resource:r.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:r.selected.marker}},this._editor);i&&(e.get(i).close(),e.get(i).nagivate(t,n))}else this._widget.showAtMarker(r.selected.marker,r.selected.index,r.selected.total)}})}};Qm.ID=`editor.contrib.markerController`,Qm=Ym([Xm(1,Mm),Xm(2,D),Xm(3,po),Xm(4,H)],Qm);var $m=class extends V{constructor(e,t,n){super(n),this._next=e,this._multiFile=t}run(e,t){return Zm(this,void 0,void 0,function*(){t.hasModel()&&Qm.get(t).nagivate(this._next,this._multiFile)})}},eh=class e extends $m{constructor(){super(!0,!1,{id:e.ID,label:e.LABEL,alias:`Go to Next Problem (Error, Warning, Info)`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:578,weight:100},menuOpts:{menuId:Rm.TitleMenu,title:e.LABEL,icon:gi(`marker-navigation-next`,M.arrowDown,z(`nextMarkerIcon`,`Icon for goto next marker.`)),group:`navigation`,order:1}})}};eh.ID=`editor.action.marker.next`,eh.LABEL=z(`markerAction.next.label`,`Go to Next Problem (Error, Warning, Info)`);var th=class e extends $m{constructor(){super(!1,!1,{id:e.ID,label:e.LABEL,alias:`Go to Previous Problem (Error, Warning, Info)`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:1602,weight:100},menuOpts:{menuId:Rm.TitleMenu,title:eh.LABEL,icon:gi(`marker-navigation-previous`,M.arrowUp,z(`previousMarkerIcon`,`Icon for goto previous marker.`)),group:`navigation`,order:2}})}};th.ID=`editor.action.marker.prev`,th.LABEL=z(`markerAction.previous.label`,`Go to Previous Problem (Error, Warning, Info)`);var nh=class extends $m{constructor(){super(!0,!0,{id:`editor.action.marker.nextInFiles`,label:z(`markerAction.nextInFiles.label`,`Go to Next Problem in Files (Error, Warning, Info)`),alias:`Go to Next Problem in Files (Error, Warning, Info)`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:66,weight:100},menuOpts:{menuId:N.MenubarGoMenu,title:z({key:`miGotoNextProblem`,comment:[`&& denotes a mnemonic`]},`Next &&Problem`),group:`6_problem_nav`,order:1}})}},rh=class extends $m{constructor(){super(!1,!0,{id:`editor.action.marker.prevInFiles`,label:z(`markerAction.previousInFiles.label`,`Go to Previous Problem in Files (Error, Warning, Info)`),alias:`Go to Previous Problem in Files (Error, Warning, Info)`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:1090,weight:100},menuOpts:{menuId:N.MenubarGoMenu,title:z({key:`miGotoPreviousProblem`,comment:[`&& denotes a mnemonic`]},`Previous &&Problem`),group:`6_problem_nav`,order:2}})}};U(Qm.ID,Qm),o(eh),o(th),o(nh),o(rh);var ih=new k(`markersNavigationVisible`,!1);F(new(ft.bindToContribution(Qm.get))({id:`closeMarkersNavigation`,precondition:ih,handler:e=>e.close(),kbOpts:{weight:150,kbExpr:A.focus,primary:9,secondary:[1033]}}));var ah=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},oh=function(e,t){return function(n,r){t(n,r,e)}},sh=G,ch=class{constructor(e,t,n){this.owner=e,this.range=t,this.marker=n}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}},lh={type:1,filter:{include:X.QuickFix}},uh=class{constructor(e,t,n,r){this._editor=e,this._hover=t,this._markerDecorationsService=n,this._openerService=r,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];let n=this._editor.getModel(),r=e.range.startLineNumber,i=n.getLineMaxColumn(r),a=[];for(let o of t){let t=o.range.startLineNumber===r?o.range.startColumn:1,s=o.range.endLineNumber===r?o.range.endColumn:i,c=this._markerDecorationsService.getMarker(n.uri,o);if(!c)continue;let l=new W(e.range.startLineNumber,t,e.range.startLineNumber,s);a.push(new ch(this,l,c))}return a}renderHoverParts(e,t,n){if(!e.length)return _.None;let r=new K;e.forEach(e=>t.appendChild(this.renderMarkerHover(e,r)));let i=e.length===1?e[0]:e.sort((e,t)=>Ks.compare(e.marker.severity,t.marker.severity))[0];return this.renderMarkerStatusbar(i,n,r),r}renderMarkerHover(e,t){let n=sh(`div.hover-row`),r=q(n,sh(`div.marker.hover-contents`)),{source:i,message:a,code:o,relatedInformation:s}=e.marker;this._editor.applyFontInfo(r);let c=q(r,sh(`span`));if(c.style.whiteSpace=`pre-wrap`,c.innerText=a,i||o)if(o&&typeof o!=`string`){let e=sh(`span`);if(i){let t=q(e,sh(`span`));t.innerText=i}let n=q(e,sh(`a.code-link`));n.setAttribute(`href`,o.target.toString()),t.add(Qr(n,`click`,e=>{this._openerService.open(o.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()}));let a=q(n,sh(`span`));a.innerText=o.value;let s=q(r,e);s.style.opacity=`0.6`,s.style.paddingLeft=`6px`}else{let e=q(r,sh(`span`));e.style.opacity=`0.6`,e.style.paddingLeft=`6px`,e.innerText=i&&o?`${i}(${o})`:i||`(${o})`}if(ti(s))for(let{message:e,resource:n,startLineNumber:i,startColumn:a}of s){let o=q(r,sh(`div`));o.style.marginTop=`8px`;let s=q(o,sh(`a`));s.innerText=`${Pa(n)}(${i}, ${a}): `,s.style.cursor=`pointer`,t.add(Qr(s,`click`,e=>{e.stopPropagation(),e.preventDefault(),this._openerService&&this._openerService.open(n,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:i,startColumn:a}}}).catch(C)}));let c=q(o,sh(`span`));c.innerText=e,this._editor.applyFontInfo(c)}return n}renderMarkerStatusbar(e,t,n){if((e.marker.severity===Ks.Error||e.marker.severity===Ks.Warning||e.marker.severity===Ks.Info)&&t.addAction({label:z(`view problem`,`View Problem`),commandId:eh.ID,run:()=>{this._hover.hide(),Qm.get(this._editor).showAtMarker(e.marker),this._editor.focus()}}),!this._editor.getOption(80)){let r=t.append(sh(`div`));this.recentMarkerCodeActionsInfo&&(wt.makeKey(this.recentMarkerCodeActionsInfo.marker)===wt.makeKey(e.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(r.textContent=z(`noQuickFixes`,`No quick fixes available`)):this.recentMarkerCodeActionsInfo=void 0);let i=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?_.None:n.add(pt(()=>r.textContent=z(`checkingForQuickFixes`,`Checking for quick fixes...`),200));r.textContent||=`\xA0`;let a=this.getCodeActions(e.marker);n.add(ja(()=>a.cancel())),a.then(a=>{if(i.dispose(),this.recentMarkerCodeActionsInfo={marker:e.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),r.textContent=z(`noQuickFixes`,`No quick fixes available`);return}r.style.display=`none`;let o=!1;n.add(ja(()=>{o||a.dispose()})),t.addAction({label:z(`quick fixes`,`Quick Fix...`),commandId:au.Id,run:e=>{o=!0;let t=tu.get(this._editor),n=rn(e);this._hover.hide(),t.showCodeActions(lh,a,{x:n.left+6,y:n.top+n.height+6})}})},C)}}getCodeActions(e){return No(t=>_l(this._editor.getModel(),new W(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),lh,ta.None,t))}};uh=ah([oh(2,Ns),oh(3,Qi)],uh),Ya((e,t)=>{let n=e.getColor(h);n&&t.addRule(`.monaco-hover .hover-contents a.code-link span { color: ${n}; }`);let r=e.getColor(Fa);r&&t.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${r}; }`)});var dh=class{constructor(e,t,n=0){this.lineNumber=e,this.parts=t,this.additionalReservedLineCount=n}renderForScreenReader(e){if(this.parts.length===0)return``;let t=this.parts[this.parts.length-1];return ph(e.substr(0,t.column-1),this.parts.map(e=>({range:{startLineNumber:1,endLineNumber:1,startColumn:e.column,endColumn:e.column},text:e.lines.join(`
`)}))).substring(this.parts[0].column-1)}},fh=class{constructor(e){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}};function ph(e,t){let n=new fh(e),r=t.map(e=>{let t=W.lift(e.range);return{startOffset:n.getOffset(t.getStartPosition()),endOffset:n.getOffset(t.getEndPosition()),text:e.text}});r.sort((e,t)=>t.startOffset-e.startOffset);for(let t of r)e=e.substring(0,t.startOffset)+t.text+e.substring(t.endOffset);return e}var mh=class{constructor(e,t,n){this.column=e,this.lines=t,this.preview=n}},hh=class extends _{constructor(e){super(),this.editor=e,this._expanded=void 0,this.onDidChangeEmitter=new J,this.onDidChange=this.onDidChangeEmitter.event,this._register(e.onDidChangeConfiguration(e=>{e.hasChanged(105)&&this._expanded===void 0&&this.onDidChangeEmitter.fire()}))}setExpanded(e){this._expanded=!0,this.onDidChangeEmitter.fire()}};function gh(e,t){return e===t?!0:!e||!t?!1:e.range.equalsRange(t.range)&&e.text===t.text&&e.command===t.command}function _h(e,t,n,r,i=0){if(e.range.startLineNumber!==e.range.endLineNumber)return;let o=t.getLineContent(e.range.startLineNumber),s=a(o).length;if(e.range.startColumn-1<=s){let t=a(e.text).length,n=o.substring(e.range.startColumn-1,s);e={range:W.fromPositions(e.range.getStartPosition().delta(0,n.length),e.range.getEndPosition()),text:e.text.startsWith(n)?e.text.substring(n.length):e.text.substring(t),command:e.command}}let c=t.getValueInRange(e.range),l=yh(c,e.text);if(!l)return;let u=e.range.startLineNumber,d=[];if(n===`prefix`){let e=l.filter(e=>e.originalLength===0);if(e.length>1||e.length===1&&e[0].originalStart!==c.length)return}let f=e.text.length-i;for(let t of l){let i=e.range.startColumn+t.originalStart+t.originalLength;if(n===`subwordSmart`&&r&&r.lineNumber===e.range.startLineNumber&&i<r.column||t.originalLength>0)return;if(t.modifiedLength===0)continue;let a=t.modifiedStart+t.modifiedLength,o=Math.max(t.modifiedStart,Math.min(a,f)),s=e.text.substring(t.modifiedStart,o),c=e.text.substring(o,Math.max(t.modifiedStart,a));if(s.length>0){let e=Xo(s);d.push(new mh(i,e,!1))}if(c.length>0){let e=Xo(c);d.push(new mh(i,e,!0))}}return new dh(u,d,0)}var vh=void 0;function yh(e,t){if(vh?.originalValue===e&&vh?.newValue===t)return vh?.changes;{let n=bh(e,t);return vh={originalValue:e,newValue:t,changes:n},n}}function bh(e,t){if(e.length>5e3||t.length>5e3)return;function n(e){let t=0;for(let n=0,r=e.length;n<r;n++){let r=e.charCodeAt(n);r>t&&(t=r)}return t}let r=Math.max(n(e),n(t));function i(e){if(e<0)throw Error(`unexpected`);return r+e+1}function a(e){let t=0,n=0,r=new Int32Array(e.length);for(let a=0,o=e.length;a<o;a++){let o=n*100+t;e[a]===`(`?(r[a]=i(2*o),t++):e[a]===`)`?(r[a]=i(2*o+1),t===1&&n++,t=Math.max(t-1,0)):r[a]=e.charCodeAt(a)}return r}let o=a(e),s=a(t);return new za({getElements:()=>o},{getElements:()=>s}).ComputeDiff(!1).changes}var xh=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Sh=function(e,t){return function(n,r){t(n,r,e)}},Ch=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},wh=class extends _{constructor(e,t,n){super(),this.editor=e,this.cache=t,this.commandService=n,this.onDidChangeEmitter=new J,this.onDidChange=this.onDidChangeEmitter.event,this.completionSession=this._register(new Un),this.active=!1,this.disposed=!1,this._register(n.onDidExecuteCommand(t=>{new Set([bn.id,Ur.id,le.Tab.id,le.DeleteLeft.id,le.DeleteRight.id,`editor.action.inlineSuggest.commit`,`acceptSelectedSuggestion`]).has(t.commandId)&&e.hasTextFocus()&&this.handleUserInput()})),this._register(this.editor.onDidType(e=>{this.handleUserInput()})),this._register(this.editor.onDidChangeCursorPosition(e=>{this.session&&!this.session.isValid&&this.hide()})),this._register(ja(()=>{this.disposed=!0})),this._register(this.editor.onDidBlurEditorWidget(()=>{this.hide()}))}handleUserInput(){this.session&&!this.session.isValid&&this.hide(),setTimeout(()=>{this.disposed||this.startSessionIfTriggered()},0)}get session(){return this.completionSession.value}get ghostText(){return this.session?.ghostText}get minReservedLineCount(){return this.session?this.session.minReservedLineCount:0}setExpanded(e){var t;(t=this.session)==null||t.setExpanded(e)}setActive(e){var t;this.active=e,e&&((t=this.session)==null||t.scheduleAutomaticUpdate())}startSessionIfTriggered(){this.editor.getOption(54).enabled&&(this.session&&this.session.isValid||this.trigger(or.Automatic))}trigger(e){if(this.completionSession.value){e===or.Explicit&&this.completionSession.value.ensureUpdateWithExplicitContext();return}this.completionSession.value=new Th(this.editor,this.editor.getPosition(),()=>this.active,this.commandService,this.cache,e),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange(()=>{this.onDidChangeEmitter.fire()}))}hide(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}commitCurrentSuggestion(){var e;(e=this.session)==null||e.commitCurrentCompletion()}showNext(){var e;(e=this.session)==null||e.showNextInlineCompletion()}showPrevious(){var e;(e=this.session)==null||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){return Ch(this,void 0,void 0,function*(){let e=yield this.session?.hasMultipleInlineCompletions();return e===void 0?!1:e})}};wh=xh([Sh(2,Hs)],wh);var Th=class extends hh{constructor(e,t,n,r,i,a){super(e),this.triggerPosition=t,this.shouldUpdate=n,this.commandService=r,this.cache=i,this.initialTriggerKind=a,this.minReservedLineCount=0,this.updateOperation=this._register(new Un),this.updateSoon=this._register(new T(()=>{let e=this.initialTriggerKind;return this.initialTriggerKind=or.Automatic,this.update(e)},50)),this.currentlySelectedCompletionId=void 0;let o;this._register(this.onDidChange(()=>{let e=this.currentCompletion;if(e&&e.sourceInlineCompletion!==o){o=e.sourceInlineCompletion;let t=e.sourceProvider;t.handleItemDidShow&&t.handleItemDidShow(e.sourceInlineCompletions,o)}})),this._register(ja(()=>{this.cache.clear()})),this._register(this.editor.onDidChangeCursorPosition(e=>{this.cache.value&&this.onDidChangeEmitter.fire()})),this._register(this.editor.onDidChangeModelContent(e=>{this.scheduleAutomaticUpdate()})),this._register(qe.onDidChange(()=>{this.updateSoon.schedule()})),this.scheduleAutomaticUpdate()}fixAndGetIndexOfCurrentSelection(){if(!this.currentlySelectedCompletionId||!this.cache.value||this.cache.value.completions.length===0)return 0;let e=this.cache.value.completions.findIndex(e=>e.semanticId===this.currentlySelectedCompletionId);return e===-1?(this.currentlySelectedCompletionId=void 0,0):e}get currentCachedCompletion(){if(this.cache.value)return this.cache.value.completions[this.fixAndGetIndexOfCurrentSelection()]}showNextInlineCompletion(){return Ch(this,void 0,void 0,function*(){yield this.ensureUpdateWithExplicitContext();let e=this.cache.value?.completions||[];e.length>0?this.currentlySelectedCompletionId=e[(this.fixAndGetIndexOfCurrentSelection()+1)%e.length].semanticId:this.currentlySelectedCompletionId=void 0,this.onDidChangeEmitter.fire()})}showPreviousInlineCompletion(){return Ch(this,void 0,void 0,function*(){yield this.ensureUpdateWithExplicitContext();let e=this.cache.value?.completions||[];e.length>0?this.currentlySelectedCompletionId=e[(this.fixAndGetIndexOfCurrentSelection()+e.length-1)%e.length].semanticId:this.currentlySelectedCompletionId=void 0,this.onDidChangeEmitter.fire()})}ensureUpdateWithExplicitContext(){return Ch(this,void 0,void 0,function*(){this.updateOperation.value?this.updateOperation.value.triggerKind===or.Explicit?yield this.updateOperation.value.promise:yield this.update(or.Explicit):this.cache.value?.triggerKind!==or.Explicit&&(yield this.update(or.Explicit))})}hasMultipleInlineCompletions(){return Ch(this,void 0,void 0,function*(){return yield this.ensureUpdateWithExplicitContext(),(this.cache.value?.completions.length||0)>1})}get ghostText(){let e=this.currentCompletion,t=this.editor.getOptions().get(54).mode;return e?_h(e,this.editor.getModel(),t,this.editor.getPosition()):void 0}get currentCompletion(){let e=this.currentCachedCompletion;if(e)return e.toLiveInlineCompletion()}get isValid(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}scheduleAutomaticUpdate(){this.updateOperation.clear(),this.updateSoon.schedule()}update(e){return Ch(this,void 0,void 0,function*(){if(!this.shouldUpdate())return;let t=this.editor.getPosition(),n=No(n=>Ch(this,void 0,void 0,function*(){let r;try{r=yield Ah(t,this.editor.getModel(),{triggerKind:e,selectedSuggestionInfo:void 0},n)}catch(e){C(e);return}n.isCancellationRequested||(this.cache.setValue(this.editor,r,e),this.onDidChangeEmitter.fire())})),r=new Eh(n,e);this.updateOperation.value=r,yield n,this.updateOperation.value===r&&this.updateOperation.clear()})}takeOwnership(e){this._register(e)}commitCurrentCompletion(){if(!this.ghostText)return;let e=this.currentCompletion;e&&this.commit(e)}commit(e){let t=this.cache.clearAndLeak();this.editor.executeEdits(`inlineSuggestion.accept`,[En.replaceMove(e.range,e.text)]),e.command?this.commandService.executeCommand(e.command.id,...e.command.arguments||[]).finally(()=>{t?.dispose()}).then(void 0,nt):t?.dispose(),this.onDidChangeEmitter.fire()}},Eh=class{constructor(e,t){this.promise=e,this.triggerKind=t}dispose(){this.promise.cancel()}},Dh=class extends _{constructor(e,t,n,r){super(),this.triggerKind=r;let i=e.deltaDecorations([],t.items.map(e=>({range:e.range,options:{description:`inline-completion-tracking-range`}})));this._register(ja(()=>{e.deltaDecorations(i,[])})),this.completions=t.items.map((e,t)=>new Oh(e,i[t])),this._register(e.onDidChangeModelContent(()=>{let t=!1,r=e.getModel();for(let e of this.completions){let n=r.getDecorationRange(e.decorationId);if(!n){C(Error(`Decoration has no range`));continue}e.synchronizedRange.equalsRange(n)||(t=!0,e.synchronizedRange=n)}t&&n()})),this._register(t)}},Oh=class{constructor(e,t){this.inlineCompletion=e,this.decorationId=t,this.semanticId=JSON.stringify({text:this.inlineCompletion.text,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=e.range}toLiveInlineCompletion(){return{text:this.inlineCompletion.text,range:this.synchronizedRange,command:this.inlineCompletion.command,sourceProvider:this.inlineCompletion.sourceProvider,sourceInlineCompletions:this.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:this.inlineCompletion.sourceInlineCompletion}}};function kh(e,t){let n=t.getWordAtPosition(e),r=t.getLineMaxColumn(e.lineNumber);return n?new W(e.lineNumber,n.startColumn,e.lineNumber,r):W.fromPositions(e,e.with(void 0,r))}function Ah(e,t,n,r=j.None){return Ch(this,void 0,void 0,function*(){let i=kh(e,t),a=qe.all(t),o=yield Promise.all(a.map(i=>Ch(this,void 0,void 0,function*(){let a=yield i.provideInlineCompletions(t,e,n,r);return{completions:a,provider:i,dispose:()=>{a&&i.freeInlineCompletions(a)}}}))),s=new Map;for(let e of o){let t=e.completions;if(t)for(let n of t.items.map(n=>({text:n.text,range:n.range?W.lift(n.range):i,command:n.command,sourceProvider:e.provider,sourceInlineCompletions:t,sourceInlineCompletion:n})))n.range.startLineNumber===n.range.endLineNumber&&s.set(JSON.stringify({text:n.text,range:n.range}),n)}return{items:[...s.values()],dispose:()=>{for(let e of o)e.dispose()}}})}function jh(e,t){if(!t)return t;let n=e.getValueInRange(t.range),r=tr(n,t.text),i=e.getOffsetAt(t.range.getStartPosition())+r,a=e.getPositionAt(i),o=vr(n.substr(r),t.text),s=e.getPositionAt(Math.max(i,e.getOffsetAt(t.range.getEndPosition())-o));return{range:W.fromPositions(a,s),text:t.text.substr(r,t.text.length-r-o)}}var Mh=class e{constructor(){this.value=``,this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};let t=this.pos,n=0,r=this.value.charCodeAt(t),i;if(i=e._table[r],typeof i==`number`)return this.pos+=1,{type:i,pos:t,len:1};if(e.isDigitCharacter(r)){i=8;do n+=1,r=this.value.charCodeAt(t+n);while(e.isDigitCharacter(r));return this.pos+=n,{type:i,pos:t,len:n}}if(e.isVariableCharacter(r)){i=9;do r=this.value.charCodeAt(t+ ++n);while(e.isVariableCharacter(r)||e.isDigitCharacter(r));return this.pos+=n,{type:i,pos:t,len:n}}i=10;do n+=1,r=this.value.charCodeAt(t+n);while(!isNaN(r)&&e._table[r]===void 0&&!e.isDigitCharacter(r)&&!e.isVariableCharacter(r));return this.pos+=n,{type:i,pos:t,len:n}}};Mh._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};var Nh=class{constructor(){this._children=[]}appendChild(e){return e instanceof Ph&&this._children[this._children.length-1]instanceof Ph?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){let{parent:n}=e,r=n.children.indexOf(e),i=n.children.slice(0);i.splice(r,1,...t),n._children=i,(function e(t,n){for(let r of t)r.parent=n,e(r.children,r)})(t,n)}get children(){return this._children}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof Hh)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),``)}len(){return 0}},Ph=class e extends Nh{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new e(this.value)}},Fh=class extends Nh{},Ih=class e extends Fh{constructor(e){super(),this.index=e}static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof Lh?this._children[0]:void 0}clone(){let t=new e(this.index);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map(e=>e.clone()),t}},Lh=class e extends Nh{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof Ph&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){let t=new e;return this.options.forEach(t.appendChild,t),t}},Rh=class e extends Nh{constructor(){super(...arguments),this.regexp=RegExp(``)}resolve(e){let t=this,n=!1,r=e.replace(this.regexp,function(){return n=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!n&&this._children.some(e=>e instanceof zh&&!!e.elseValue)&&(r=this._replace([])),r}_replace(e){let t=``;for(let n of this._children)if(n instanceof zh){let r=e[n.index]||``;r=n.resolve(r),t+=r}else t+=n.toString();return t}toString(){return``}clone(){let t=new e;return t.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?`i`:``)+(this.regexp.global?`g`:``)),t._children=this.children.map(e=>e.clone()),t}},zh=class e extends Nh{constructor(e,t,n,r){super(),this.index=e,this.shorthandName=t,this.ifValue=n,this.elseValue=r}resolve(e){return this.shorthandName===`upcase`?e?e.toLocaleUpperCase():``:this.shorthandName===`downcase`?e?e.toLocaleLowerCase():``:this.shorthandName===`capitalize`?e?e[0].toLocaleUpperCase()+e.substr(1):``:this.shorthandName===`pascalcase`?e?this._toPascalCase(e):``:this.shorthandName===`camelcase`?e?this._toCamelCase(e):``:e&&typeof this.ifValue==`string`?this.ifValue:!e&&typeof this.elseValue==`string`?this.elseValue:e||``}_toPascalCase(e){let t=e.match(/[a-z0-9]+/gi);return t?t.map(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()).join(``):e}_toCamelCase(e){let t=e.match(/[a-z0-9]+/gi);return t?t.map((e,t)=>t===0?e.toLowerCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()).join(``):e}clone(){return new e(this.index,this.shorthandName,this.ifValue,this.elseValue)}},Bh=class e extends Fh{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||``)),t===void 0?!1:(this._children=[new Ph(t)],!0)}clone(){let t=new e(this.name);return this.transform&&(t.transform=this.transform.clone()),t._children=this.children.map(e=>e.clone()),t}};function Vh(e,t){let n=[...e];for(;n.length>0;){let e=n.shift();if(!t(e))break;n.unshift(...e.children)}}var Hh=class e extends Nh{get placeholderInfo(){if(!this._placeholders){let e=[],t;this.walk(function(n){return n instanceof Ih&&(e.push(n),t=!t||t.index<n.index?n:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){let{all:e}=this.placeholderInfo;return e}offset(e){let t=0,n=!1;return this.walk(r=>r===e?(n=!0,!1):(t+=r.len(),!0)),n?t:-1}fullLen(e){let t=0;return Vh([e],e=>(t+=e.len(),!0)),t}enclosingPlaceholders(e){let t=[],{parent:n}=e;for(;n;)n instanceof Ih&&t.push(n),n=n.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof Bh&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){let t=new e;return this._children=this.children.map(e=>e.clone()),t}walk(e){Vh(this.children,e)}},Uh=class{constructor(){this._scanner=new Mh,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,`\\$&`)}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,n){this._scanner.text(e),this._token=this._scanner.next();let r=new Hh;for(;this._parse(r););let i=new Map,a=[],o=0;r.walk(e=>(e instanceof Ih&&(o+=1,e.isFinalTabstop?i.set(0,void 0):!i.has(e.index)&&e.children.length>0?i.set(e.index,e.children):a.push(e)),!0));for(let e of a){let t=i.get(e.index);if(t){let n=new Ih(e.index);n.transform=e.transform;for(let e of t)n.appendChild(e.clone());r.replace(e,[n])}}return n||=o>0&&t,!i.has(0)&&n&&r.appendChild(new Ih(0)),r}_accept(e,t){if(e===void 0||this._token.type===e){let e=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),e}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){let t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){let e=this._scanner.next();if(e.type!==0&&e.type!==4&&e.type!==5)return!1}this._token=this._scanner.next()}let n=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,`$1`);return this._token=this._scanner.next(),n}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new Ph(t)),!0):!1}_parseTabstopOrVariableName(e){let t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new Ih(Number(t)):new Bh(t)),!0):this._backTo(n)}_parseComplexPlaceholder(e){let t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);let r=new Ih(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new Ph("${"+t+`:`)),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7)){let t=new Lh;for(;;){if(this._parseChoiceElement(t)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(t),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)}_parseChoiceElement(e){let t=this._token,n=[];for(;!(this._token.type===2||this._token.type===7);){let e;if(e=(e=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||e:this._accept(void 0,!0),!e)return this._backTo(t),!1;n.push(e)}return n.length===0?(this._backTo(t),!1):(e.appendChild(new Ph(n.join(``))),!0)}_parseComplexVariable(e){let t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);let r=new Bh(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new Ph("${"+t+`:`)),r.children.forEach(e.appendChild,e),!0}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)}_parseTransform(e){let t=new Rh,n=``,r=``;for(;!this._accept(6);){let e;if(e=this._accept(5,!0)){e=this._accept(6,!0)||e,n+=e;continue}if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let e;if(e=this._accept(5,!0)){e=this._accept(5,!0)||this._accept(6,!0)||e,t.appendChild(new Ph(e));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){r+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(n,r)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){let t=this._token;if(!this._accept(0))return!1;let n=!1;this._accept(3)&&(n=!0);let r=this._accept(8,!0);if(r)if(n){if(this._accept(4))return e.appendChild(new zh(Number(r))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new zh(Number(r))),!0;else return this._backTo(t),!1;if(this._accept(6)){let n=this._accept(9,!0);return!n||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new zh(Number(r),n)),!0)}else if(this._accept(11)){let t=this._until(4);if(t)return e.appendChild(new zh(Number(r),void 0,t,void 0)),!0}else if(this._accept(12)){let t=this._until(4);if(t)return e.appendChild(new zh(Number(r),void 0,void 0,t)),!0}else if(this._accept(13)){let t=this._until(1);if(t){let n=this._until(4);if(n)return e.appendChild(new zh(Number(r),void 0,t,n)),!0}}else{let t=this._until(4);if(t)return e.appendChild(new zh(Number(r),void 0,void 0,t)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type===14?!1:(e.appendChild(new Ph(this._scanner.tokenText(this._token))),this._accept(void 0),!0)}},Wh=new Uint8Array(16),Gh=[];for(let e=0;e<256;e++)Gh.push(e.toString(16).padStart(2,`0`));var Kh=typeof crypto==`object`&&typeof crypto.getRandomValues==`function`?crypto.getRandomValues.bind(crypto):function(e){for(let t=0;t<e.length;t++)e[t]=Math.floor(Math.random()*256);return e};function qh(){Kh(Wh),Wh[6]=Wh[6]&15|64,Wh[8]=Wh[8]&63|128;let e=0,t=``;return t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=`-`,t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=`-`,t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=`-`,t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=`-`,t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t+=Gh[Wh[e++]],t}function Jh(e){let t=e;return typeof t?.id==`string`&&L.isUri(t.uri)}function Yh(e){if(e.configuration)return{id:e.id,configPath:e.configuration};if(e.folders.length===1)return{id:e.id,uri:e.folders[0].uri}}var Xh=class{constructor(e){this._delegates=e}resolve(e){for(let t of this._delegates){let n=t.resolve(e);if(n!==void 0)return n}}},Zh=class{constructor(e,t,n,r){this._model=e,this._selection=t,this._selectionIdx=n,this._overtypingCapturer=r}resolve(e){let{name:t}=e;if(t===`SELECTION`||t===`TM_SELECTED_TEXT`){let t=this._model.getValueInRange(this._selection)||void 0,n=this._selection.startLineNumber!==this._selection.endLineNumber;if(!t&&this._overtypingCapturer){let e=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);e&&(t=e.value,n=e.multiline)}if(t&&n&&e.snippet){let n=a(this._model.getLineContent(this._selection.startLineNumber),0,this._selection.startColumn-1),r=n;e.snippet.walk(t=>t===e?!1:(t instanceof Ph&&(r=a(Xo(t.value).pop())),!0));let i=tr(r,n);t=t.replace(/(\r\n|\r|\n)(.*)/g,(e,t,n)=>`${t}${r.substr(i)}${n}`)}return t}else if(t===`TM_CURRENT_LINE`)return this._model.getLineContent(this._selection.positionLineNumber);else if(t===`TM_CURRENT_WORD`){let e=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return e&&e.word||void 0}else if(t===`TM_LINE_INDEX`)return String(this._selection.positionLineNumber-1);else if(t===`TM_LINE_NUMBER`)return String(this._selection.positionLineNumber)}},Qh=class{constructor(e,t){this._labelService=e,this._model=t}resolve(e){let{name:t}=e;if(t===`TM_FILENAME`)return So(this._model.uri.fsPath);if(t===`TM_FILENAME_BASE`){let e=So(this._model.uri.fsPath),t=e.lastIndexOf(`.`);return t<=0?e:e.slice(0,t)}else if(t===`TM_DIRECTORY`)return Ja(this._model.uri.fsPath)===`.`?``:this._labelService.getUriLabel(Ta(this._model.uri));else if(t===`TM_FILEPATH`)return this._labelService.getUriLabel(this._model.uri);else if(t===`RELATIVE_FILEPATH`)return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}},$h=class{constructor(e,t,n,r){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=n,this._spread=r}resolve(e){if(e.name!==`CLIPBOARD`)return;let t=this._readClipboardText();if(t){if(this._spread){let e=t.split(/\r\n|\n|\r/).filter(e=>!is(e));if(e.length===this._selectionCount)return e[this._selectionIdx]}return t}}},eg=class{constructor(e,t){this._model=e,this._selection=t}resolve(e){let{name:t}=e,n=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),r=Ei.getComments(n);if(r){if(t===`LINE_COMMENT`)return r.lineCommentToken||void 0;if(t===`BLOCK_COMMENT_START`)return r.blockCommentStartToken||void 0;if(t===`BLOCK_COMMENT_END`)return r.blockCommentEndToken||void 0}}},tg=class e{constructor(){this._date=new Date}resolve(t){let{name:n}=t;if(n===`CURRENT_YEAR`)return String(this._date.getFullYear());if(n===`CURRENT_YEAR_SHORT`)return String(this._date.getFullYear()).slice(-2);if(n===`CURRENT_MONTH`)return String(this._date.getMonth().valueOf()+1).padStart(2,`0`);if(n===`CURRENT_DATE`)return String(this._date.getDate().valueOf()).padStart(2,`0`);if(n===`CURRENT_HOUR`)return String(this._date.getHours().valueOf()).padStart(2,`0`);if(n===`CURRENT_MINUTE`)return String(this._date.getMinutes().valueOf()).padStart(2,`0`);if(n===`CURRENT_SECOND`)return String(this._date.getSeconds().valueOf()).padStart(2,`0`);if(n===`CURRENT_DAY_NAME`)return e.dayNames[this._date.getDay()];if(n===`CURRENT_DAY_NAME_SHORT`)return e.dayNamesShort[this._date.getDay()];if(n===`CURRENT_MONTH_NAME`)return e.monthNames[this._date.getMonth()];if(n===`CURRENT_MONTH_NAME_SHORT`)return e.monthNamesShort[this._date.getMonth()];if(n===`CURRENT_SECONDS_UNIX`)return String(Math.floor(this._date.getTime()/1e3))}};tg.dayNames=[z(`Sunday`,`Sunday`),z(`Monday`,`Monday`),z(`Tuesday`,`Tuesday`),z(`Wednesday`,`Wednesday`),z(`Thursday`,`Thursday`),z(`Friday`,`Friday`),z(`Saturday`,`Saturday`)],tg.dayNamesShort=[z(`SundayShort`,`Sun`),z(`MondayShort`,`Mon`),z(`TuesdayShort`,`Tue`),z(`WednesdayShort`,`Wed`),z(`ThursdayShort`,`Thu`),z(`FridayShort`,`Fri`),z(`SaturdayShort`,`Sat`)],tg.monthNames=[z(`January`,`January`),z(`February`,`February`),z(`March`,`March`),z(`April`,`April`),z(`May`,`May`),z(`June`,`June`),z(`July`,`July`),z(`August`,`August`),z(`September`,`September`),z(`October`,`October`),z(`November`,`November`),z(`December`,`December`)],tg.monthNamesShort=[z(`JanuaryShort`,`Jan`),z(`FebruaryShort`,`Feb`),z(`MarchShort`,`Mar`),z(`AprilShort`,`Apr`),z(`MayShort`,`May`),z(`JuneShort`,`Jun`),z(`JulyShort`,`Jul`),z(`AugustShort`,`Aug`),z(`SeptemberShort`,`Sep`),z(`OctoberShort`,`Oct`),z(`NovemberShort`,`Nov`),z(`DecemberShort`,`Dec`)];var ng=class{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;let t=Yh(this._workspaceService.getWorkspace());if(t){if(e.name===`WORKSPACE_NAME`)return this._resolveWorkspaceName(t);if(e.name===`WORKSPACE_FOLDER`)return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(Jh(e))return So(e.uri.path);let t=So(e.configPath.path);return t.endsWith(`code-workspace`)&&(t=t.substr(0,t.length-14-1)),t}_resoveWorkspacePath(e){if(Jh(e))return Ld(e.uri.fsPath);let t=So(e.configPath.path),n=e.configPath.fsPath;return n.endsWith(t)&&(n=n.substr(0,n.length-t.length-1)),n?Ld(n):`/`}},rg=class{resolve(e){let{name:t}=e;if(t===`RANDOM`)return Math.random().toString().slice(-6);if(t===`RANDOM_HEX`)return Math.random().toString(16).slice(-6);if(t===`UUID`)return qh()}};Ya((e,t)=>{function n(t){let n=e.getColor(t);return n?n.toString():`transparent`}t.addRule(`.monaco-editor .snippet-placeholder { background-color: ${n(Oe)}; outline-color: ${n(Se)}; }`),t.addRule(`.monaco-editor .finish-snippet-placeholder { background-color: ${n(Ds)}; outline-color: ${n(qn)}; }`)});var ig=class e{constructor(e,t,n,r){this._editor=e,this._snippet=t,this._offset=n,this._snippetLineLeadingWhitespace=r,this._nestingLevel=1,this._placeholderGroups=Io(t.placeholders,Ih.compareByIndex),this._placeholderGroupsIdx=-1}dispose(){this._placeholderDecorations&&this._editor.deltaDecorations([...this._placeholderDecorations.values()],[]),this._placeholderGroups.length=0}_initDecorations(){if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;let t=this._editor.getModel();this._editor.changeDecorations(n=>{for(let r of this._snippet.placeholders){let i=this._snippet.offset(r),a=this._snippet.fullLen(r),o=W.fromPositions(t.getPositionAt(this._offset+i),t.getPositionAt(this._offset+i+a)),s=r.isFinalTabstop?e._decor.inactiveFinal:e._decor.inactive,c=n.addDecoration(o,s);this._placeholderDecorations.set(r,c)}})}move(t){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){let e=[];for(let t of this._placeholderGroups[this._placeholderGroupsIdx])if(t.transform){let n=this._placeholderDecorations.get(t),r=this._editor.getModel().getDecorationRange(n),i=this._editor.getModel().getValueInRange(r),a=t.transform.resolve(i).split(/\r\n|\r|\n/);for(let e=1;e<a.length;e++)a[e]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+a[e]);e.push(En.replace(r,a.join(this._editor.getModel().getEOL())))}e.length>0&&this._editor.executeEdits(`snippet.placeholderTransform`,e)}let n=!1;t===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,n=!0):t===!1&&this._placeholderGroupsIdx>0&&(--this._placeholderGroupsIdx,n=!0);let r=this._editor.getModel().changeDecorations(t=>{let r=new Set,i=[];for(let a of this._placeholderGroups[this._placeholderGroupsIdx]){let o=this._placeholderDecorations.get(a),s=this._editor.getModel().getDecorationRange(o);i.push(new R(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn)),n&&=this._hasPlaceholderBeenCollapsed(a),t.changeDecorationOptions(o,a.isFinalTabstop?e._decor.activeFinal:e._decor.active),r.add(a);for(let n of this._snippet.enclosingPlaceholders(a)){let i=this._placeholderDecorations.get(n);t.changeDecorationOptions(i,n.isFinalTabstop?e._decor.activeFinal:e._decor.active),r.add(n)}}for(let[n,i]of this._placeholderDecorations)r.has(n)||t.changeDecorationOptions(i,n.isFinalTabstop?e._decor.inactiveFinal:e._decor.inactive);return i});return n?this.move(t):r??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof Ih){let e=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(e).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}computePossibleSelections(){let e=new Map;for(let t of this._placeholderGroups){let n;for(let r of t){if(r.isFinalTabstop)break;n||(n=[],e.set(r.index,n));let t=this._placeholderDecorations.get(r),i=this._editor.getModel().getDecorationRange(t);if(!i){e.delete(r.index);break}n.push(i)}}return e}get choice(){return this._placeholderGroups[this._placeholderGroupsIdx][0].choice}merge(t){let n=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(r=>{for(let i of this._placeholderGroups[this._placeholderGroupsIdx]){let a=t.shift();console.assert(!a._placeholderDecorations);let o=a._snippet.placeholderInfo.last.index;for(let e of a._snippet.placeholderInfo.all)e.isFinalTabstop?e.index=i.index+(o+1)/this._nestingLevel:e.index=i.index+e.index/this._nestingLevel;this._snippet.replace(i,a._snippet.children);let s=this._placeholderDecorations.get(i);r.removeDecoration(s),this._placeholderDecorations.delete(i);for(let t of a._snippet.placeholders){let i=a._snippet.offset(t),o=a._snippet.fullLen(t),s=W.fromPositions(n.getPositionAt(a._offset+i),n.getPositionAt(a._offset+i+o)),c=r.addDecoration(s,e._decor.inactive);this._placeholderDecorations.set(t,c)}}this._placeholderGroups=Io(this._snippet.placeholders,Ih.compareByIndex)})}};ig._decor={active:I.register({description:`snippet-placeholder-1`,stickiness:0,className:`snippet-placeholder`}),inactive:I.register({description:`snippet-placeholder-2`,stickiness:1,className:`snippet-placeholder`}),activeFinal:I.register({description:`snippet-placeholder-3`,stickiness:1,className:`finish-snippet-placeholder`}),inactiveFinal:I.register({description:`snippet-placeholder-4`,stickiness:1,className:`finish-snippet-placeholder`})};var ag={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},og=class e{constructor(e,t,n=ag){this._templateMerges=[],this._snippets=[],this._editor=e,this._template=t,this._options=n}static adjustWhitespace(e,t,n,r,i){let o=a(e.getLineContent(t.lineNumber),0,t.column-1),s;return n.walk(t=>{if(!(t instanceof Ph)||t.parent instanceof Lh)return!0;let i=t.value.split(/\r\n|\r|\n/);if(r){let r=n.offset(t);if(r===0)i[0]=e.normalizeIndentation(i[0]);else{s??=n.toString();let t=s.charCodeAt(r-1);(t===10||t===13)&&(i[0]=e.normalizeIndentation(o+i[0]))}for(let t=1;t<i.length;t++)i[t]=e.normalizeIndentation(o+i[t])}let a=i.join(e.getEOL());return a!==t.value&&(t.parent.replace(t,[new Ph(a)]),s=void 0),!0}),o}static adjustSelection(e,t,n,r){if(n!==0||r!==0){let{positionLineNumber:i,positionColumn:a}=t,o=a-n,s=a+r,c=e.validateRange({startLineNumber:i,startColumn:o,endLineNumber:i,endColumn:s});t=R.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,t.getDirection())}return t}static createEditsAndSnippets(t,n,r,i,a,o,s,c){let l=[],u=[];if(!t.hasModel())return{edits:l,snippets:u};let d=t.getModel(),f=t.invokeWithinContext(e=>e.get(Ca)),p=t.invokeWithinContext(e=>new Qh(e.get(ko),d)),m=()=>s,h=0,ee=d.getValueInRange(e.adjustSelection(d,t.getSelection(),r,0)),g=d.getValueInRange(e.adjustSelection(d,t.getSelection(),0,i)),te=d.getLineFirstNonWhitespaceColumn(t.getSelection().positionLineNumber),ne=t.getSelections().map((e,t)=>({selection:e,idx:t})).sort((e,t)=>W.compareRangesUsingStarts(e.selection,t.selection));for(let{selection:s,idx:re}of ne){let ie=e.adjustSelection(d,s,r,0),ae=e.adjustSelection(d,s,0,i);ee!==d.getValueInRange(ie)&&(ie=s),g!==d.getValueInRange(ae)&&(ae=s);let oe=s.setStartPosition(ie.startLineNumber,ie.startColumn).setEndPosition(ae.endLineNumber,ae.endColumn),se=new Uh().parse(n,!0,a),ce=oe.getStartPosition(),le=e.adjustWhitespace(d,ce,se,o||re>0&&te!==d.getLineFirstNonWhitespaceColumn(s.positionLineNumber),!0);se.resolveVariables(new Xh([p,new $h(m,re,ne.length,t.getOption(70)===`spread`),new Zh(d,s,re,c),new eg(d,s),new tg,new ng(f),new rg]));let ue=d.getOffsetAt(ce)+h;h+=se.toString().length-d.getValueLengthInRange(oe),l[re]=En.replace(oe,se.toString()),l[re].identifier={major:re,minor:0},u[re]=new ig(t,se,ue,le)}return{edits:l,snippets:u}}dispose(){y(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(` -> `)}"`}insert(){if(!this._editor.hasModel())return;let{edits:t,snippets:n}=e.createEditsAndSnippets(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer);this._snippets=n,this._editor.executeEdits(`snippet`,t,e=>this._snippets[0].hasPlaceholder?this._move(!0):e.filter(e=>!!e.identifier).map(e=>R.fromPositions(e.range.getEndPosition()))),this._editor.revealRange(this._editor.getSelections()[0])}merge(t,n=ag){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,t]);let{edits:r,snippets:i}=e.createEditsAndSnippets(this._editor,t,n.overwriteBefore,n.overwriteAfter,!0,n.adjustWhitespace,n.clipboardText,n.overtypingCapturer);this._editor.executeEdits(`snippet`,r,e=>{for(let e of this._snippets)e.merge(i);return console.assert(i.length===0),this._snippets[0].hasPlaceholder?this._move(void 0):e.filter(e=>!!e.identifier).map(e=>R.fromPositions(e.range.getEndPosition()))})}next(){let e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){let e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){let t=[];for(let n of this._snippets){let r=n.move(e);t.push(...r)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get choice(){return this._snippets[0].choice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;let e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;let t=new Map;for(let n of this._snippets){let r=n.computePossibleSelections();if(t.size===0)for(let[n,i]of r){i.sort(W.compareRangesUsingStarts);for(let r of e)if(i[0].containsRange(r)){t.set(n,[]);break}}if(t.size===0)return!1;t.forEach((e,t)=>{e.push(...r.get(t))})}e.sort(W.compareRangesUsingStarts);for(let[n,r]of t){if(r.length!==e.length){t.delete(n);continue}r.sort(W.compareRangesUsingStarts);for(let i=0;i<r.length;i++)if(!r[i].containsRange(e[i])){t.delete(n);continue}}return t.size>0}},sg=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};const Q={Visible:new k(`suggestWidgetVisible`,!1,z(`suggestWidgetVisible`,`Whether suggestion are visible`)),DetailsVisible:new k(`suggestWidgetDetailsVisible`,!1,z(`suggestWidgetDetailsVisible`,`Whether suggestion details are visible`)),MultipleSuggestions:new k(`suggestWidgetMultipleSuggestions`,!1,z(`suggestWidgetMultipleSuggestions`,`Whether there are multiple suggestions to pick from`)),MakesTextEdit:new k(`suggestionMakesTextEdit`,!0,z(`suggestionMakesTextEdit`,`Whether inserting the current suggestion yields in a change or has everything already been typed`)),AcceptSuggestionsOnEnter:new k(`acceptSuggestionOnEnter`,!0,z(`acceptSuggestionOnEnter`,`Whether suggestions are inserted when pressing Enter`)),HasInsertAndReplaceRange:new k(`suggestionHasInsertAndReplaceRange`,!1,z(`suggestionHasInsertAndReplaceRange`,`Whether the current suggestion has insert and replace behaviour`)),InsertMode:new k(`suggestionInsertMode`,void 0,{type:`string`,description:z(`suggestionInsertMode`,`Whether the default behaviour is to insert or replace`)}),CanResolve:new k(`suggestionCanResolve`,!1,z(`suggestionCanResolve`,`Whether the current suggestion supports to resolve further details`))},cg=new N(`suggestWidgetStatusBar`);var lg=class{constructor(e,n,r,i){this.position=e,this.completion=n,this.container=r,this.provider=i,this.isInvalid=!1,this.score=t.Default,this.distance=0,this.textLabel=typeof n.label==`string`?n.label:n.label.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=n.sortText&&n.sortText.toLowerCase(),this.filterTextLow=n.filterText&&n.filterText.toLowerCase(),W.isIRange(n.range)?(this.editStart=new P(n.range.startLineNumber,n.range.startColumn),this.editInsertEnd=new P(n.range.endLineNumber,n.range.endColumn),this.editReplaceEnd=new P(n.range.endLineNumber,n.range.endColumn),this.isInvalid=this.isInvalid||W.spansMultipleLines(n.range)||n.range.startLineNumber!==e.lineNumber):(this.editStart=new P(n.range.insert.startLineNumber,n.range.insert.startColumn),this.editInsertEnd=new P(n.range.insert.endLineNumber,n.range.insert.endColumn),this.editReplaceEnd=new P(n.range.replace.endLineNumber,n.range.replace.endColumn),this.isInvalid=this.isInvalid||W.spansMultipleLines(n.range.insert)||W.spansMultipleLines(n.range.replace)||n.range.insert.startLineNumber!==e.lineNumber||n.range.replace.startLineNumber!==e.lineNumber||n.range.insert.startColumn!==n.range.replace.startColumn),typeof i.resolveCompletionItem!=`function`&&(this._resolveCache=Promise.resolve(),this._isResolved=!0)}get isResolved(){return!!this._isResolved}resolve(e){return sg(this,void 0,void 0,function*(){if(!this._resolveCache){let t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._isResolved=!1});this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(e=>{Object.assign(this.completion,e),this._isResolved=!0,t.dispose()},e=>{cn(e)&&(this._resolveCache=void 0,this._isResolved=!1)})}return this._resolveCache})}},ug=class{constructor(e=2,t=new Set,n=new Set,r=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=n,this.showDeprecated=r}};ug.default=new ug;var dg;function fg(){return dg}var pg=class{constructor(e,t,n,r){this.items=e,this.needsClipboard=t,this.durations=n,this.disposable=r}};function mg(e,t,n=ug.default,r={triggerKind:0},i=j.None){return sg(this,void 0,void 0,function*(){let a=new Ms(!0);t=t.clone();let o=e.getWordAtPosition(t),s=o?new W(t.lineNumber,o.startColumn,t.lineNumber,o.endColumn):W.fromPositions(t),c={replace:s,insert:s.setEndPosition(t.lineNumber,t.column)},l=[],u=new K,d=[],f=!1,p=(e,r,i)=>{if(r){for(let i of r.suggestions)if(!n.kindFilter.has(i.kind)){if(!n.showDeprecated&&(i?.tags)?.includes(1))continue;i.range||=c,i.sortText||=typeof i.label==`string`?i.label:i.label.label,!f&&i.insertTextRules&&i.insertTextRules&4&&(f=Uh.guessNeedsClipboard(i.insertText)),l.push(new lg(t,i,r,e))}Qt(r)&&u.add(r),d.push({providerName:e._debugDisplayName??`unkown_provider`,elapsedProvider:r.duration??-1,elapsedOverall:i.elapsed()})}},m=(()=>sg(this,void 0,void 0,function*(){}))();for(let a of ve.orderedGroups(e)){let o=l.length;if(yield Promise.all(a.map(a=>sg(this,void 0,void 0,function*(){if(!(n.providerFilter.size>0&&!n.providerFilter.has(a)))try{let n=new Ms(!0);p(a,yield a.provideCompletionItems(e,t,r,i),n)}catch(e){nt(e)}}))),o!==l.length||i.isCancellationRequested)break}return yield m,i.isCancellationRequested?(u.dispose(),Promise.reject(Pt())):new pg(l.sort(yg(n.snippetSortOrder)),f,{entries:d,elapsed:a.elapsed()},u)})}function hg(e,t){if(e.sortTextLow&&t.sortTextLow){if(e.sortTextLow<t.sortTextLow)return-1;if(e.sortTextLow>t.sortTextLow)return 1}return e.completion.label<t.completion.label?-1:e.completion.label>t.completion.label?1:e.completion.kind-t.completion.kind}function gg(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return hg(e,t)}function _g(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return hg(e,t)}var vg=new Map;vg.set(0,gg),vg.set(2,_g),vg.set(1,hg);function yg(e){return vg.get(e)}vs.registerCommand(`_executeCompletionItemProvider`,(e,...t)=>sg(void 0,void 0,void 0,function*(){let[n,r,i,a]=t;Fs(L.isUri(n)),Fs(P.isIPosition(r)),Fs(typeof i==`string`||!i),Fs(typeof a==`number`||!a);let o=yield e.get(ms).createModelReference(n);try{let e={incomplete:!1,suggestions:[]},t=[],n=yield mg(o.object.textEditorModel,P.lift(r),void 0,{triggerCharacter:i,triggerKind:i?1:0});for(let r of n.items)t.length<(a??0)&&t.push(r.resolve(j.None)),e.incomplete=e.incomplete||r.container.incomplete,e.suggestions.push(r.completion);try{return yield Promise.all(t),e}finally{setTimeout(()=>n.disposable.dispose(),100)}}finally{o.dispose()}}));var bg=new class{constructor(){this.onlyOnceSuggestions=[]}provideCompletionItems(){let e={suggestions:this.onlyOnceSuggestions.slice(0)};return this.onlyOnceSuggestions.length=0,e}};ve.register(`*`,bg);function xg(e,t){setTimeout(()=>{bg.onlyOnceSuggestions.push(...t),e.getContribution(`editor.contrib.suggestController`).triggerSuggest(new Set().add(bg))},0)}var Sg=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Cg=function(e,t){return function(n,r){t(n,r,e)}},wg={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0},Tg=class e{constructor(t,n,r){this._editor=t,this._logService=n,this._snippetListener=new K,this._modelVersionId=-1,this._inSnippet=e.InSnippetMode.bindTo(r),this._hasNextTabstop=e.HasNextTabstop.bindTo(r),this._hasPrevTabstop=e.HasPrevTabstop.bindTo(r)}static get(t){return t.getContribution(e.ID)}dispose(){var e;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),(e=this._session)==null||e.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,t===void 0?wg:Object.assign(Object.assign({},wg),t))}catch(t){this.cancel(),this._logService.error(t),this._logService.error(`snippet_error`),this._logService.error(`insert_template=`,e),this._logService.error(`existing_template=`,this._session?this._session._logInfo():`<no_session>`)}}_doInsert(e,t){this._editor.hasModel()&&(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session?this._session.merge(e,t):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new og(this._editor,e,t),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(e=>e.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState())))}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId()||!this._session.hasPlaceholder||this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}let{choice:e}=this._session;if(!e){this._currentChoice=void 0;return}if(this._currentChoice!==e){this._currentChoice=e,this._editor.setSelections(this._editor.getSelections().map(e=>R.fromPositions(e.getStartPosition())));let[t]=e.options;xg(this._editor,e.options.map((e,n)=>({kind:13,label:e.value,insertText:e.value,sortText:`a`.repeat(n+1),range:W.fromPositions(this._editor.getPosition(),this._editor.getPosition().delta(0,t.value.length))})))}}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){var t;this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),(t=this._session)==null||t.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session&&this._session.prev(),this._updateState()}next(){this._session&&this._session.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}};Tg.ID=`snippetController2`,Tg.InSnippetMode=new k(`inSnippetMode`,!1,z(`inSnippetMode`,`Whether the editor in current in snippet mode`)),Tg.HasNextTabstop=new k(`hasNextTabstop`,!1,z(`hasNextTabstop`,`Whether there is a next tab stop when in snippet mode`)),Tg.HasPrevTabstop=new k(`hasPrevTabstop`,!1,z(`hasPrevTabstop`,`Whether there is a previous tab stop when in snippet mode`)),Tg=Sg([Cg(1,wr),Cg(2,D)],Tg),U(Tg.ID,Tg);var Eg=ft.bindToContribution(Tg.get);F(new Eg({id:`jumpToNextSnippetPlaceholder`,precondition:w.and(Tg.InSnippetMode,Tg.HasNextTabstop),handler:e=>e.next(),kbOpts:{weight:130,kbExpr:A.editorTextFocus,primary:2}})),F(new Eg({id:`jumpToPrevSnippetPlaceholder`,precondition:w.and(Tg.InSnippetMode,Tg.HasPrevTabstop),handler:e=>e.prev(),kbOpts:{weight:130,kbExpr:A.editorTextFocus,primary:1026}})),F(new Eg({id:`leaveSnippet`,precondition:Tg.InSnippetMode,handler:e=>e.cancel(!0),kbOpts:{weight:130,kbExpr:A.editorTextFocus,primary:9,secondary:[1033]}})),F(new Eg({id:`acceptSnippet`,precondition:Tg.InSnippetMode,handler:e=>e.finish()}));var Dg=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Og=function(e,t){return function(n,r){t(n,r,e)}},kg=class{constructor(e){this.name=e}select(e,t,n){if(n.length===0)return 0;let r=n[0].score[0];for(let e=0;e<n.length;e++){let{score:t,completion:i}=n[e];if(t[0]!==r)break;if(i.preselect)return e}return 0}},Ag=class extends kg{constructor(){super(`first`)}memorize(e,t,n){}toJSON(){}fromJSON(){}},jg=class extends kg{constructor(){super(`recentlyUsed`),this._cache=new oe(300,.66),this._seq=0}memorize(e,t,n){let r=`${e.getLanguageId()}/${n.textLabel}`;this._cache.set(r,{touch:this._seq++,type:n.completion.kind,insertText:n.completion.insertText})}select(e,t,n){if(n.length===0)return 0;let r=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(r))return super.select(e,t,n);let i=n[0].score[0],a=-1,o=-1,s=-1;for(let t=0;t<n.length&&n[t].score[0]===i;t++){let r=`${e.getLanguageId()}/${n[t].textLabel}`,i=this._cache.peek(r);if(i&&i.touch>s&&i.type===n[t].completion.kind&&i.insertText===n[t].completion.insertText&&(s=i.touch,o=t),n[t].completion.preselect&&a===-1)return a=t}return o===-1?a===-1?0:a:o}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();for(let[t,n]of e)n.touch=0,n.type=typeof n.type==`number`?n.type:ns(n.type),this._cache.set(t,n);this._seq=this._cache.size}},Mg=class extends kg{constructor(){super(`recentlyUsedByPrefix`),this._trie=Ze.forStrings(),this._seq=0}memorize(e,t,n){let{word:r}=e.getWordUntilPosition(t),i=`${e.getLanguageId()}/${r}`;this._trie.set(i,{type:n.completion.kind,insertText:n.completion.insertText,touch:this._seq++})}select(e,t,n){let{word:r}=e.getWordUntilPosition(t);if(!r)return super.select(e,t,n);let i=`${e.getLanguageId()}/${r}`,a=this._trie.get(i);if(a||=this._trie.findSubstr(i),a)for(let e=0;e<n.length;e++){let{kind:t,insertText:r}=n[e].completion;if(t===a.type&&r===a.insertText)return e}return super.select(e,t,n)}toJSON(){let e=[];return this._trie.forEach((t,n)=>e.push([n,t])),e.sort((e,t)=>-(e[1].touch-t[1].touch)).forEach((e,t)=>e[1].touch=t),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(let[t,n]of e)n.type=typeof n.type==`number`?n.type:ns(n.type),this._trie.set(t,n)}}},Ng=class e{constructor(e,t){this._storageService=e,this._configService=t,this._disposables=new K,this._persistSoon=new T(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(e=>{e.reason===E.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,n){this._withStrategy(e,t).memorize(e,t,n),this._persistSoon.schedule()}select(e,t,n){return this._withStrategy(e,t).select(e,t,n)}_withStrategy(t,n){let r=this._configService.getValue(`editor.suggestSelection`,{overrideIdentifier:t.getLanguageIdAtPosition(n.lineNumber,n.column),resource:t.uri});if(this._strategy?.name!==r){this._saveState(),this._strategy=new((e._strategyCtors.get(r))||Ag);try{let t=this._configService.getValue(`editor.suggest.shareSuggestSelections`)?0:1,n=this._storageService.get(`${e._storagePrefix}/${r}`,t);n&&this._strategy.fromJSON(JSON.parse(n))}catch{}}return this._strategy}_saveState(){if(this._strategy){let t=this._configService.getValue(`editor.suggest.shareSuggestSelections`)?0:1,n=JSON.stringify(this._strategy);this._storageService.store(`${e._storagePrefix}/${this._strategy.name}`,n,t,1)}}};Ng._strategyCtors=new Map([[`recentlyUsedByPrefix`,Mg],[`recentlyUsed`,jg],[`first`,Ag]]),Ng._storagePrefix=`suggest/memories`,Ng=Dg([Og(0,je),Og(1,xo)],Ng);const Pg=yi(`ISuggestMemories`);Bi(Pg,Ng,!0);var Fg=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Ig=function(e,t){return function(n,r){t(n,r,e)}},Lg=class e{constructor(t,n){this._editor=t,this._enabled=!1,this._ckAtEnd=e.AtEnd.bindTo(n),this._configListener=this._editor.onDidChangeConfiguration(e=>e.hasChanged(110)&&this._update()),this._update()}dispose(){var e;this._configListener.dispose(),(e=this._selectionListener)==null||e.dispose(),this._ckAtEnd.reset()}_update(){let e=this._editor.getOption(110)===`on`;if(this._enabled!==e)if(this._enabled=e,this._enabled){let e=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}let e=this._editor.getModel(),t=this._editor.getSelection(),n=e.getWordAtPosition(t.getStartPosition());if(!n){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(n.endColumn===t.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(e),e()}else this._selectionListener&&=(this._ckAtEnd.reset(),this._selectionListener.dispose(),void 0)}};Lg.AtEnd=new k(`atEndOfWord`,!1),Lg=Fg([Ig(1,D)],Lg);var Rg=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},zg=function(e,t){return function(n,r){t(n,r,e)}},Bg=class e{constructor(t,n){this._editor=t,this._index=0,this._ckOtherSuggestions=e.OtherSuggestions.bindTo(n)}dispose(){this.reset()}reset(){var e;this._ckOtherSuggestions.reset(),(e=this._listener)==null||e.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:t,index:n},r){if(t.items.length===0){this.reset();return}if(e._moveIndex(!0,t,n)===n){this.reset();return}this._acceptNext=r,this._model=t,this._index=n,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,n){let r=n;for(;r=(r+t.items.length+(e?1:-1))%t.items.length,!(r===n||!t.items[r].completion.additionalTextEdits););return r}next(){this._move(!0)}prev(){this._move(!1)}_move(t){if(this._model)try{this._ignore=!0,this._index=e._moveIndex(t,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}};Bg.OtherSuggestions=new k(`hasOtherSuggestions`,!1),Bg=Rg([zg(1,D)],Bg);var Vg=class{constructor(e,t,n){this._disposables=new K,this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(r=>{if(this._active&&!t.isFrozen()){let t=r.charCodeAt(r.length-1);this._active.acceptCharacters.has(t)&&e.getOption(0)&&n(this._active.item)}}))}_onItem(e){if(!e||!ti(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;let t=new vi;for(let n of e.item.completion.commitCharacters)n.length>0&&t.add(n.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}},Hg=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ug=class e{provideSelectionRanges(t,n){return Hg(this,void 0,void 0,function*(){let r=[];for(let i of n){let n=[];r.push(n);let a=new Map;yield new Promise(n=>e._bracketsRightYield(n,0,t,i,a)),yield new Promise(r=>e._bracketsLeftYield(r,0,t,i,a,n))}return r})}static _bracketsRightYield(t,n,r,i,a){let o=new Map,s=Date.now();for(;;){if(n>=e._maxRounds){t();break}if(!i){t();break}let c=r.findNextBracket(i);if(!c){t();break}if(Date.now()-s>e._maxDuration){setTimeout(()=>e._bracketsRightYield(t,n+1,r,i,a));break}let l=c.close[0];if(c.isOpen){let e=o.has(l)?o.get(l):0;o.set(l,e+1)}else{let e=o.has(l)?o.get(l):0;if(--e,o.set(l,Math.max(0,e)),e<0){let e=a.get(l);e||(e=new Pn,a.set(l,e)),e.push(c.range)}}i=c.range.getEndPosition()}}static _bracketsLeftYield(t,n,r,i,a,o){let s=new Map,c=Date.now();for(;;){if(n>=e._maxRounds&&a.size===0){t();break}if(!i){t();break}let l=r.findPrevBracket(i);if(!l){t();break}if(Date.now()-c>e._maxDuration){setTimeout(()=>e._bracketsLeftYield(t,n+1,r,i,a,o));break}let u=l.close[0];if(l.isOpen){let t=s.has(u)?s.get(u):0;if(--t,s.set(u,Math.max(0,t)),t<0){let t=a.get(u);if(t){let n=t.shift();t.size===0&&a.delete(u);let i=W.fromPositions(l.range.getEndPosition(),n.getStartPosition()),s=W.fromPositions(l.range.getStartPosition(),n.getEndPosition());o.push({range:i}),o.push({range:s}),e._addBracketLeading(r,s,o)}}}else{let e=s.has(u)?s.get(u):0;s.set(u,e+1)}i=l.range.getStartPosition()}}static _addBracketLeading(e,t,n){if(t.startLineNumber===t.endLineNumber)return;let r=t.startLineNumber,i=e.getLineFirstNonWhitespaceColumn(r);i!==0&&i!==t.startColumn&&(n.push({range:W.fromPositions(new P(r,i),t.getEndPosition())}),n.push({range:W.fromPositions(new P(r,1),t.getEndPosition())}));let a=r-1;if(a>0){let r=e.getLineFirstNonWhitespaceColumn(a);r===t.startColumn&&r!==e.getLineLastNonWhitespaceColumn(a)&&(n.push({range:W.fromPositions(new P(a,r),t.getEndPosition())}),n.push({range:W.fromPositions(new P(a,1),t.getEndPosition())}))}}};Ug._maxDuration=30,Ug._maxRounds=2;var Wg=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Gg=class e{static create(t,n){return Wg(this,void 0,void 0,function*(){if(!n.getOption(105).localityBonus||!n.hasModel())return e.None;let r=n.getModel(),i=n.getPosition();if(!t.canComputeWordRanges(r.uri))return e.None;let[a]=yield new Ug().provideSelectionRanges(r,[i]);if(a.length===0)return e.None;let o=yield t.computeWordRanges(r.uri,a[0].range);if(!o)return e.None;let s=r.getWordUntilPosition(i);return delete o[s.word],new class extends e{distance(e,t){if(!i.equals(n.getPosition()))return 0;if(t.kind===17)return 2<<20;let r=o[typeof t.label==`string`?t.label:t.label.label];if(fa(r))return 2<<20;let s=_n(r,W.fromPositions(e),W.compareRangesUsingStarts),c=s>=0?r[s]:r[Math.max(0,~s-1)],l=a.length;for(let e of a){if(!W.containsRange(e.range,c))break;--l}return l}}})}};Gg.None=new class extends Gg{distance(){return 0}};var Kg=class e{constructor(t,n,r,i,a,o,s){this.clipboardText=s,this._snippetCompareFn=e._compareCompletionItems,this._items=t,this._column=n,this._wordDistance=i,this._options=a,this._refilterKind=1,this._lineContext=r,o===`top`?this._snippetCompareFn=e._compareCompletionItemsSnippetsUp:o===`bottom`&&(this._snippetCompareFn=e._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}get allProvider(){return this._ensureCachedState(),this._providerInfo.keys()}get incomplete(){this._ensureCachedState();let e=new Set;for(let[t,n]of this._providerInfo)n&&e.add(t);return e}adopt(e){let t=[];for(let n=0;n<this._items.length;)e.has(this._items[n].provider)?n++:(t.push(this._items[n]),this._items[n]=this._items[this._items.length-1],this._items.pop());return this._refilterKind=1,t}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._providerInfo=new Map;let e=[],{leadingLineContent:n,characterCountDelta:r}=this._lineContext,i=``,a=``,o=this._refilterKind===1?this._items:this._filteredItems,s=[],c=!this._options.filterGraceful||o.length>2e3?lo:Uo;for(let l=0;l<o.length;l++){let u=o[l];if(u.isInvalid)continue;this._providerInfo.set(u.provider,!!u.container.incomplete);let d=u.position.column-u.editStart.column,f=d+r-(u.position.column-this._column);if(i.length!==f&&(i=f===0?``:n.slice(-f),a=i.toLowerCase()),u.word=i,f===0)u.score=t.Default;else{let e=0;for(;e<d;){let t=i.charCodeAt(e);if(t===32||t===9)e+=1;else break}if(e>=f)u.score=t.Default;else if(typeof u.completion.filterText==`string`){let t=c(i,a,e,u.completion.filterText,u.filterTextLow,0,!1);if(!t)continue;bt(u.completion.filterText,u.textLabel)===0?u.score=t:(u.score=Ri(i,a,e,u.textLabel,u.labelLow,0),u.score[0]=t[0])}else{let t=c(i,a,e,u.textLabel,u.labelLow,0,!1);if(!t)continue;u.score=t}}u.idx=l,u.distance=this._wordDistance.distance(u.position,u.completion),s.push(u),e.push(u.textLabel.length)}this._filteredItems=s.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?fo(e.length-.85,e,(e,t)=>e-t):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(t,n){if(t.completion.kind!==n.completion.kind){if(t.completion.kind===27)return 1;if(n.completion.kind===27)return-1}return e._compareCompletionItems(t,n)}static _compareCompletionItemsSnippetsUp(t,n){if(t.completion.kind!==n.completion.kind){if(t.completion.kind===27)return-1;if(n.completion.kind===27)return 1}return e._compareCompletionItems(t,n)}},qg=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Jg=function(e,t){return function(n,r){t(n,r,e)}},Yg=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Xg=class{constructor(e,t,n,r){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.auto=n,this.shy=r}static shouldAutoTrigger(e){if(!e.hasModel())return!1;let t=e.getModel(),n=e.getPosition();t.tokenizeIfCheap(n.lineNumber);let r=t.getWordAtPosition(n);return!(!r||r.endColumn!==n.column||!isNaN(Number(r.word)))}};function Zg(e,t,n){if(!t.getContextKeyValue(`inlineSuggestionVisible`))return!0;let r=n.getValue(`editor.inlineSuggest.allowQuickSuggestions`);return r===void 0?!1:!!r}function Qg(e,t,n){if(!t.getContextKeyValue(`inlineSuggestionVisible`))return!0;let r=n.getValue(`editor.inlineSuggest.allowSuggestOnTriggerCharacters`);return r===void 0?!1:!!r}var $g=class e{constructor(e,t,n,r,i,a,o){this._editor=e,this._editorWorkerService=t,this._clipboardService=n,this._telemetryService=r,this._logService=i,this._contextKeyService=a,this._configurationService=o,this._toDispose=new K,this._quickSuggestDelay=10,this._triggerCharacterListener=new K,this._triggerQuickSuggest=new St,this._state=0,this._completionDisposables=new K,this._onDidCancel=new J,this._onDidTrigger=new J,this._onDidSuggest=new J,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new R(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters(),this._updateQuickSuggest()})),this._toDispose.add(ve.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(e=>{this._onCursorChange(e)}));let s=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{s=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{s=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{s||this._refilterCompletionItems()})),this._updateTriggerCharacters(),this._updateQuickSuggest()}dispose(){y(this._triggerCharacterListener),y([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateQuickSuggest(){this._quickSuggestDelay=this._editor.getOption(79),(isNaN(this._quickSuggestDelay)||!this._quickSuggestDelay&&this._quickSuggestDelay!==0||this._quickSuggestDelay<0)&&(this._quickSuggestDelay=10)}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(80)||!this._editor.hasModel()||!this._editor.getOption(108))return;let e=new Map;for(let t of ve.all(this._editor.getModel()))for(let n of t.triggerCharacters||[]){let r=e.get(n);r||(r=new Set,r.add(fg()),e.set(n,r)),r.add(t)}let t=t=>{if(!Qg(this._editor,this._contextKeyService,this._configurationService)||Xg.shouldAutoTrigger(this._editor))return;if(!t){let e=this._editor.getPosition();t=this._editor.getModel().getLineContent(e.lineNumber).substr(0,e.column-1)}let n=``;Ho(t.charCodeAt(t.length-1))?co(t.charCodeAt(t.length-2))&&(n=t.substr(t.length-2)):n=t.charAt(t.length-1);let r=e.get(n);if(r){let e=this._completionModel?{items:this._completionModel.adopt(r),clipboardText:this._completionModel.clipboardText}:void 0;this.trigger({auto:!0,shy:!1,triggerCharacter:n},!!this._completionModel,r,e)}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(t))}get state(){return this._state}cancel(e=!1){var t;this._state!==0&&(this._triggerQuickSuggest.cancel(),(t=this._requestToken)==null||t.cancel(),this._requestToken=void 0,this._state=0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._state!==0&&(!this._editor.hasModel()||!ve.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._state===2,shy:!1},!0))}_onCursorChange(e){if(!this._editor.hasModel())return;let t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!==`keyboard`&&e.source!==`deleteLeft`){this.cancel();return}this._state===0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._state!==0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._state===0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){this._editor.getOption(78)!==!1&&(this._editor.getOption(105).snippetsPreventQuickSuggestions&&Tg.get(this._editor).isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._state!==0||!Xg.shouldAutoTrigger(this._editor)||!this._editor.hasModel())return;let e=this._editor.getModel(),t=this._editor.getPosition(),n=this._editor.getOption(78);if(n!==!1){if(n!==!0){e.tokenizeIfCheap(t.lineNumber);let r=e.getLineTokens(t.lineNumber),i=r.getStandardTokenType(r.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(!(n.other&&i===0||n.comments&&i===1||n.strings&&i===2))return}Zg(this._editor,this._contextKeyService,this._configurationService)&&ve.has(e)&&this.trigger({auto:!0,shy:!1})}},this._quickSuggestDelay)))}_refilterCompletionItems(){Promise.resolve().then(()=>{if(this._state===0||!this._editor.hasModel())return;let e=new Xg(this._editor.getModel(),this._editor.getPosition(),this._state===2,!1);this._onNewContext(e)})}trigger(t,n=!1,r,i){if(!this._editor.hasModel())return;let a=this._editor.getModel(),o=t.auto,s=new Xg(a,this._editor.getPosition(),o,t.shy);this.cancel(n),this._state=o?2:1,this._onDidTrigger.fire({auto:o,shy:t.shy,position:this._editor.getPosition()}),this._context=s;let c={triggerKind:t.triggerKind??0};t.triggerCharacter&&(c={triggerKind:1,triggerCharacter:t.triggerCharacter}),this._requestToken=new hs;let l=this._editor.getOption(100),u=1;switch(l){case`top`:u=0;break;case`bottom`:u=2;break}let{itemKind:d,showDeprecated:f}=e._createSuggestFilter(this._editor),p=Gg.create(this._editorWorkerService,this._editor),m=mg(a,this._editor.getPosition(),new ug(u,d,r,f),c,this._requestToken.token);Promise.all([m,p]).then(([e,n])=>Yg(this,void 0,void 0,function*(){var r;if((r=this._requestToken)==null||r.dispose(),!this._editor.hasModel())return;let a=i?.clipboardText;if(!a&&e.needsClipboard&&(a=yield this._clipboardService.readText()),this._state===0)return;let s=this._editor.getModel(),c=e.items;if(i){let e=yg(u);c=c.concat(i.items).sort(e)}let l=new Xg(s,this._editor.getPosition(),o,t.shy);this._completionModel=new Kg(c,this._context.column,{leadingLineContent:l.leadingLineContent,characterCountDelta:l.column-this._context.column},n,this._editor.getOption(105),this._editor.getOption(100),a),this._completionDisposables.add(e.disposable),this._onNewContext(l),this._reportDurationsTelemetry(e.durations)})).catch(C)}_reportDurationsTelemetry(e){this._telemetryGate++%230==0&&setTimeout(()=>{this._telemetryService.publicLog2(`suggest.durations.json`,{data:JSON.stringify(e)}),this._logService.debug(`suggest.durations.json`,e)})}static _createSuggestFilter(e){let t=new Set;e.getOption(100)===`none`&&t.add(27);let n=e.getOption(105);return n.showMethods||t.add(0),n.showFunctions||t.add(1),n.showConstructors||t.add(2),n.showFields||t.add(3),n.showVariables||t.add(4),n.showClasses||t.add(5),n.showStructs||t.add(6),n.showInterfaces||t.add(7),n.showModules||t.add(8),n.showProperties||t.add(9),n.showEvents||t.add(10),n.showOperators||t.add(11),n.showUnits||t.add(12),n.showValues||t.add(13),n.showConstants||t.add(14),n.showEnums||t.add(15),n.showEnumMembers||t.add(16),n.showKeywords||t.add(17),n.showWords||t.add(18),n.showColors||t.add(19),n.showFiles||t.add(20),n.showReferences||t.add(21),n.showColors||t.add(22),n.showFolders||t.add(23),n.showTypeParameters||t.add(24),n.showSnippets||t.add(27),n.showUsers||t.add(25),n.showIssues||t.add(26),{itemKind:t,showDeprecated:n.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(a(e.leadingLineContent)!==a(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.auto,shy:!1},!0):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){let e=new Set(ve.all(this._editor.getModel()));for(let t of this._completionModel.allProvider)e.delete(t);let t=this._completionModel.adopt(new Set);this.trigger({auto:this._context.auto,shy:!1},!0,e,{items:t,clipboardText:this._completionModel.clipboardText});return}if(e.column>this._context.column&&this._completionModel.incomplete.size>0&&e.leadingWord.word.length!==0){let{incomplete:e}=this._completionModel,t=this._completionModel.adopt(e);this.trigger({auto:this._state===2,shy:!1,triggerKind:2},!0,e,{items:t,clipboardText:this._completionModel.clipboardText})}else{let t=this._completionModel.lineContext,n=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){if(Xg.shouldAutoTrigger(this._editor)&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.auto,shy:!1},!0);return}if(this._context.auto){this.cancel();return}else if(this._completionModel.lineContext=t,n=this._completionModel.items.length>0,n&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,auto:this._context.auto,shy:this._context.shy,isFrozen:n})}}}}};$g=qg([Jg(1,li),Jg(2,$r),Jg(3,mo),Jg(4,wr),Jg(5,D),Jg(6,xo)],$g);var e_=class e{constructor(t,n){this._disposables=new K,this._lastOvertyped=[],this._empty=!0,this._disposables.add(t.onWillType(()=>{if(!this._empty||!t.hasModel())return;let n=t.getSelections(),r=n.length,i=!1;for(let e=0;e<r;e++)if(!n[e].isEmpty()){i=!0;break}if(!i)return;this._lastOvertyped=[];let a=t.getModel();for(let t=0;t<r;t++){let r=n[t];if(a.getValueLengthInRange(r)>e._maxSelectionLength)return;this._lastOvertyped[t]={value:a.getValueInRange(r),multiline:r.startLineNumber!==r.endLineNumber}}this._empty=!1})),this._disposables.add(n.onDidCancel(e=>{!this._empty&&!e.retrigger&&(this._empty=!0)}))}getLastOvertypedInfo(e){if(!this._empty&&e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}};e_._maxSelectionLength=51200;var t_=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},n_=function(e,t){return function(n,r){t(n,r,e)}},r_=class e extends ad{updateLabel(){let t=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!t)return super.updateLabel();this.label&&(this.label.textContent=z(`ddd`,`{0} ({1})`,this._action.label,e.symbolPrintEnter(t)))}static symbolPrintEnter(e){return e.getLabel()?.replace(/\benter\b/gi,``)}},i_=class{constructor(e,t,n,r){this._menuService=n,this._contextKeyService=r,this._menuDisposables=new K,this.element=q(e,G(`.suggest-status-bar`));let i=(e=>e instanceof Ba?t.createInstance(r_,e,void 0):void 0);this._leftActions=new Bn(this.element,{actionViewItemProvider:i}),this._rightActions=new Bn(this.element,{actionViewItemProvider:i}),this._leftActions.domNode.classList.add(`left`),this._rightActions.domNode.classList.add(`right`)}dispose(){this._menuDisposables.dispose(),this.element.remove()}show(){let e=this._menuService.createMenu(cg,this._contextKeyService),t=()=>{let t=[],n=[];for(let[r,i]of e.getActions())r===`left`?t.push(...i):n.push(...i);this._leftActions.clear(),this._leftActions.push(t),this._rightActions.clear(),this._rightActions.push(n)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};i_=t_([n_(1,H),n_(2,Ko),n_(3,D)],i_);const a_=v(`symbolIcon.arrayForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.arrayForeground`,`The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),o_=v(`symbolIcon.booleanForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.booleanForeground`,`The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),s_=v(`symbolIcon.classForeground`,{dark:`#EE9D28`,light:`#D67E00`,hc:`#EE9D28`},z(`symbolIcon.classForeground`,`The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),c_=v(`symbolIcon.colorForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.colorForeground`,`The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),l_=v(`symbolIcon.constantForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.constantForeground`,`The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),u_=v(`symbolIcon.constructorForeground`,{dark:`#B180D7`,light:`#652D90`,hc:`#B180D7`},z(`symbolIcon.constructorForeground`,`The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),d_=v(`symbolIcon.enumeratorForeground`,{dark:`#EE9D28`,light:`#D67E00`,hc:`#EE9D28`},z(`symbolIcon.enumeratorForeground`,`The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),f_=v(`symbolIcon.enumeratorMemberForeground`,{dark:`#75BEFF`,light:`#007ACC`,hc:`#75BEFF`},z(`symbolIcon.enumeratorMemberForeground`,`The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),p_=v(`symbolIcon.eventForeground`,{dark:`#EE9D28`,light:`#D67E00`,hc:`#EE9D28`},z(`symbolIcon.eventForeground`,`The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),m_=v(`symbolIcon.fieldForeground`,{dark:`#75BEFF`,light:`#007ACC`,hc:`#75BEFF`},z(`symbolIcon.fieldForeground`,`The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),h_=v(`symbolIcon.fileForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.fileForeground`,`The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),g_=v(`symbolIcon.folderForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.folderForeground`,`The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),__=v(`symbolIcon.functionForeground`,{dark:`#B180D7`,light:`#652D90`,hc:`#B180D7`},z(`symbolIcon.functionForeground`,`The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),v_=v(`symbolIcon.interfaceForeground`,{dark:`#75BEFF`,light:`#007ACC`,hc:`#75BEFF`},z(`symbolIcon.interfaceForeground`,`The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),y_=v(`symbolIcon.keyForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.keyForeground`,`The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),b_=v(`symbolIcon.keywordForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.keywordForeground`,`The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),x_=v(`symbolIcon.methodForeground`,{dark:`#B180D7`,light:`#652D90`,hc:`#B180D7`},z(`symbolIcon.methodForeground`,`The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),S_=v(`symbolIcon.moduleForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.moduleForeground`,`The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),C_=v(`symbolIcon.namespaceForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.namespaceForeground`,`The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),w_=v(`symbolIcon.nullForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.nullForeground`,`The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),T_=v(`symbolIcon.numberForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.numberForeground`,`The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),E_=v(`symbolIcon.objectForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.objectForeground`,`The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),D_=v(`symbolIcon.operatorForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.operatorForeground`,`The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),O_=v(`symbolIcon.packageForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.packageForeground`,`The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),k_=v(`symbolIcon.propertyForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.propertyForeground`,`The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),A_=v(`symbolIcon.referenceForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.referenceForeground`,`The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),j_=v(`symbolIcon.snippetForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.snippetForeground`,`The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),M_=v(`symbolIcon.stringForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.stringForeground`,`The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),N_=v(`symbolIcon.structForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.structForeground`,`The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),P_=v(`symbolIcon.textForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.textForeground`,`The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),F_=v(`symbolIcon.typeParameterForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.typeParameterForeground`,`The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),I_=v(`symbolIcon.unitForeground`,{dark:B,light:B,hc:B},z(`symbolIcon.unitForeground`,`The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`)),L_=v(`symbolIcon.variableForeground`,{dark:`#75BEFF`,light:`#007ACC`,hc:`#75BEFF`},z(`symbolIcon.variableForeground`,`The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.`));Ya((e,t)=>{let n=e.getColor(a_);n&&t.addRule(`${M.symbolArray.cssSelector} { color: ${n}; }`);let r=e.getColor(o_);r&&t.addRule(`${M.symbolBoolean.cssSelector} { color: ${r}; }`);let i=e.getColor(s_);i&&t.addRule(`${M.symbolClass.cssSelector} { color: ${i}; }`);let a=e.getColor(x_);a&&t.addRule(`${M.symbolMethod.cssSelector} { color: ${a}; }`);let o=e.getColor(c_);o&&t.addRule(`${M.symbolColor.cssSelector} { color: ${o}; }`);let s=e.getColor(l_);s&&t.addRule(`${M.symbolConstant.cssSelector} { color: ${s}; }`);let c=e.getColor(u_);c&&t.addRule(`${M.symbolConstructor.cssSelector} { color: ${c}; }`);let l=e.getColor(d_);l&&t.addRule(`
			${M.symbolValue.cssSelector},${M.symbolEnum.cssSelector} { color: ${l}; }`);let u=e.getColor(f_);u&&t.addRule(`${M.symbolEnumMember.cssSelector} { color: ${u}; }`);let d=e.getColor(p_);d&&t.addRule(`${M.symbolEvent.cssSelector} { color: ${d}; }`);let f=e.getColor(m_);f&&t.addRule(`${M.symbolField.cssSelector} { color: ${f}; }`);let p=e.getColor(h_);p&&t.addRule(`${M.symbolFile.cssSelector} { color: ${p}; }`);let m=e.getColor(g_);m&&t.addRule(`${M.symbolFolder.cssSelector} { color: ${m}; }`);let h=e.getColor(__);h&&t.addRule(`${M.symbolFunction.cssSelector} { color: ${h}; }`);let ee=e.getColor(v_);ee&&t.addRule(`${M.symbolInterface.cssSelector} { color: ${ee}; }`);let g=e.getColor(y_);g&&t.addRule(`${M.symbolKey.cssSelector} { color: ${g}; }`);let te=e.getColor(b_);te&&t.addRule(`${M.symbolKeyword.cssSelector} { color: ${te}; }`);let ne=e.getColor(S_);ne&&t.addRule(`${M.symbolModule.cssSelector} { color: ${ne}; }`);let re=e.getColor(C_);re&&t.addRule(`${M.symbolNamespace.cssSelector} { color: ${re}; }`);let ie=e.getColor(w_);ie&&t.addRule(`${M.symbolNull.cssSelector} { color: ${ie}; }`);let ae=e.getColor(T_);ae&&t.addRule(`${M.symbolNumber.cssSelector} { color: ${ae}; }`);let oe=e.getColor(E_);oe&&t.addRule(`${M.symbolObject.cssSelector} { color: ${oe}; }`);let se=e.getColor(D_);se&&t.addRule(`${M.symbolOperator.cssSelector} { color: ${se}; }`);let ce=e.getColor(O_);ce&&t.addRule(`${M.symbolPackage.cssSelector} { color: ${ce}; }`);let le=e.getColor(k_);le&&t.addRule(`${M.symbolProperty.cssSelector} { color: ${le}; }`);let ue=e.getColor(A_);ue&&t.addRule(`${M.symbolReference.cssSelector} { color: ${ue}; }`);let de=e.getColor(j_);de&&t.addRule(`${M.symbolSnippet.cssSelector} { color: ${de}; }`);let _=e.getColor(M_);_&&t.addRule(`${M.symbolString.cssSelector} { color: ${_}; }`);let fe=e.getColor(N_);fe&&t.addRule(`${M.symbolStruct.cssSelector} { color: ${fe}; }`);let pe=e.getColor(P_);pe&&t.addRule(`${M.symbolText.cssSelector} { color: ${pe}; }`);let me=e.getColor(F_);me&&t.addRule(`${M.symbolTypeParameter.cssSelector} { color: ${me}; }`);let v=e.getColor(I_);v&&t.addRule(`${M.symbolUnit.cssSelector} { color: ${v}; }`);let he=e.getColor(L_);he&&t.addRule(`${M.symbolVariable.cssSelector} { color: ${he}; }`)});var R_=class{constructor(){this._onDidWillResize=new J,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new J,this.onDidResize=this._onDidResize.event,this._sashListener=new K,this._size=new ji(0,0),this._minSize=new ji(0,0),this._maxSize=new ji(2**53-1,2**53-1),this.domNode=document.createElement(`div`),this._eastSash=new g(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new g(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new g(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:La.North}),this._southSash=new g(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:La.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,n=0;this._sashListener.add(ui.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,n=0)})),this._sashListener.add(ui.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,n=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(r=>{e&&(n=r.currentX-r.startX,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(r=>{e&&(n=-(r.currentX-r.startX),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(r=>{e&&(t=-(r.currentY-r.startY),this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(r=>{e&&(t=r.currentY-r.startY,this.layout(e.height+t,e.width+n),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(ui.any(this._eastSash.onDidReset,this._westSash.onDidReset)(e=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(ui.any(this._northSash.onDidReset,this._southSash.onDidReset)(e=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,n,r){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=n?3:0,this._westSash.state=r?3:0}layout(e=this.size.height,t=this.size.width){let{height:n,width:r}=this._minSize,{height:i,width:a}=this._maxSize;e=Math.max(n,Math.min(i,e)),t=Math.max(r,Math.min(a,t));let o=new ji(t,e);ji.equals(o,this._size)||(this.domNode.style.height=e+`px`,this.domNode.style.width=t+`px`,this._size=o,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}},z_=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},B_=function(e,t){return function(n,r){t(n,r,e)}};function V_(e){return!!e&&!!(e.completion.documentation||e.completion.detail&&e.completion.detail!==e.completion.label)}var H_=class{constructor(e,t){this._editor=e,this._onDidClose=new J,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new J,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new K,this._renderDisposeable=new K,this._borderWidth=1,this._size=new ji(330,0),this.domNode=G(`.suggest-details`),this.domNode.classList.add(`no-docs`),this._markdownRenderer=t.createInstance(ym,{editor:e}),this._body=G(`.body`),this._scrollbar=new jt(this._body,{}),q(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=q(this._body,G(`.header`)),this._close=q(this._header,G(`span`+M.close.cssSelector)),this._close.title=z(`details.close`,`Close`),this._type=q(this._header,G(`p.type`)),this._docs=q(this._body,G(`p.docs`)),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(e=>{e.hasChanged(43)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){let e=this._editor.getOptions(),t=e.get(43),n=t.getMassagedFontFamily(Lo?Et.fontFamily:null),r=e.get(106)||t.fontSize,i=e.get(107)||t.lineHeight,a=t.fontWeight,o=`${r}px`,s=`${i}px`;this.domNode.style.fontSize=o,this.domNode.style.lineHeight=`${i/r}`,this.domNode.style.fontWeight=a,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=n,this._close.style.height=s,this._close.style.width=s}getLayoutInfo(){let e=this._editor.getOption(107)||this._editor.getOption(43).lineHeight,t=this._borderWidth;return{lineHeight:e,borderWidth:t,borderHeight:t*2,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=z(`loading`,`Loading...`),this._docs.textContent=``,this.domNode.classList.remove(`no-docs`,`no-type`),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){this._renderDisposeable.clear();let{detail:n,documentation:r}=e.completion;if(t){let t=``;t+=`score: ${e.score[0]}\n`,t+=`prefix: ${e.word??`(no prefix)`}\n`,t+=`word: ${e.completion.filterText?e.completion.filterText+` (filterText)`:e.textLabel}\n`,t+=`distance: ${e.distance} (localityBonus-setting)\n`,t+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||`label`}\n`,t+=`commit_chars: ${e.completion.commitCharacters?.join(``)}\n`,r=new ue().appendCodeblock(`empty`,t),n=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!V_(e)){this.clearContents();return}if(this.domNode.classList.remove(`no-docs`,`no-type`),n){let e=n.length>1e5?`${n.substr(0,1e5)}`:n;this._type.textContent=e,this._type.title=e,An(this._type),this._type.classList.toggle(`auto-wrap`,!/\r?\n^\s+/gim.test(e))}else he(this._type),this._type.title=``,zt(this._type),this.domNode.classList.add(`no-type`);if(he(this._docs),typeof r==`string`)this._docs.classList.remove(`markdown-docs`),this._docs.textContent=r;else if(r){this._docs.classList.add(`markdown-docs`),he(this._docs);let e=this._markdownRenderer.render(r);this._docs.appendChild(e.element),this._renderDisposeable.add(e),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect=`text`,this.domNode.tabIndex=-1,this._close.onmousedown=e=>{e.preventDefault(),e.stopPropagation()},this._close.onclick=e=>{e.preventDefault(),e.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add(`no-docs`),this._type.textContent=``,this._docs.textContent=``}get size(){return this._size}layout(e,t){let n=new ji(e,t);ji.equals(n,this._size)||(this._size=n,$s(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}};H_=z_([B_(1,H)],H_);var U_=class{constructor(e,t){this.widget=e,this._editor=t,this._disposables=new K,this._added=!1,this._resizable=new R_,this._resizable.domNode.classList.add(`suggest-details-container`),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let n,r,i=0,a=0;this._disposables.add(this._resizable.onDidWillResize(()=>{n=this._topLeft,r=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(e=>{if(n&&r){this.widget.layout(e.dimension.width,e.dimension.height);let t=!1;e.west&&(a=r.width-e.dimension.width,t=!0),e.north&&(i=r.height-e.dimension.height,t=!0),t&&this._applyTopLeft({top:n.top+i,left:n.left+a})}e.done&&(n=void 0,r=void 0,i=0,a=0,this._userSize=e.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return`suggest.details`}getDomNode(){return this._resizable.domNode}getPosition(){return null}show(){this._added||=(this._editor.addOverlayWidget(this),this.getDomNode().style.position=`fixed`,!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e){this._anchorBox=rn(e),this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size)}_placeAtAnchor(e,t){let n=ke(document.body),r=this.widget.getLayoutInfo(),i=new ji(220,2*r.lineHeight),a=e.top,o=(function(){let o=n.width-(e.left+e.width+r.borderWidth+r.horizontalPadding),s=-r.borderWidth+e.left+e.width,c=new ji(o,n.height-e.top-r.borderHeight-r.verticalPadding),l=c.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:s,fit:o-t.width,maxSizeTop:c,maxSizeBottom:l,minSize:i.with(Math.min(o,i.width))}})(),s=[o,(function(){let o=e.left-r.borderWidth-r.horizontalPadding,s=Math.max(r.horizontalPadding,e.left-t.width-r.borderWidth),c=new ji(o,n.height-e.top-r.borderHeight-r.verticalPadding),l=c.with(void 0,e.top+e.height-r.borderHeight-r.verticalPadding);return{top:a,left:s,fit:o-t.width,maxSizeTop:c,maxSizeBottom:l,minSize:i.with(Math.min(o,i.width))}})(),(function(){let a=e.left,o=-r.borderWidth+e.top+e.height,s=new ji(e.width-r.borderHeight,n.height-e.top-e.height-r.verticalPadding);return{top:o,left:a,fit:s.height-t.height,maxSizeBottom:s,maxSizeTop:s,minSize:i.with(s.width)}})()],c=s.find(e=>e.fit>=0)??s.sort((e,t)=>t.fit-e.fit)[0],l=e.top+e.height-r.borderHeight,u,d=t.height,f=Math.max(c.maxSizeTop.height,c.maxSizeBottom.height);d>f&&(d=f);let p;d<=c.maxSizeTop.height?(u=!0,p=c.maxSizeTop):(u=!1,p=c.maxSizeBottom),this._applyTopLeft({left:c.left,top:u?c.top:l-d}),this.getDomNode().style.position=`fixed`,this._resizable.enableSashes(!u,c===o,u,c!==o),this._resizable.minSize=c.minSize,this._resizable.maxSize=p,this._resizable.layout(d,Math.min(p.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this.getDomNode().style.left=`${this._topLeft.left}px`,this.getDomNode().style.top=`${this._topLeft.top}px`}},W_;(function(e){e[e.FILE=0]=`FILE`,e[e.FOLDER=1]=`FOLDER`,e[e.ROOT_FOLDER=2]=`ROOT_FOLDER`})(W_||={});function G_(e,t,n,r){let i=r===W_.ROOT_FOLDER?[`rootfolder-icon`]:r===W_.FOLDER?[`folder-icon`]:[`file-icon`];if(n){let a;if(a=n.scheme===$e.data?tn.parseMetaData(n).get(tn.META_DATA_LABEL):q_(m(n).toLowerCase()),r===W_.FOLDER)i.push(`${a}-name-folder-icon`);else{if(a){if(i.push(`${a}-name-file-icon`),a.length<=255){let e=a.split(`.`);for(let t=1;t<e.length;t++)i.push(`${e.slice(t).join(`.`)}-ext-file-icon`)}i.push(`ext-file-icon`)}let r=K_(e,t,n);r&&i.push(`${q_(r)}-lang-file-icon`)}}return i}function K_(e,t,n){if(!n)return null;let r=null;if(n.scheme===$e.data){let e=tn.parseMetaData(n).get(tn.META_DATA_MIME);e&&(r=t.getModeId(e))}else{let t=e.getModel(n);t&&(r=t.getLanguageId())}return r&&r!==`plaintext`?r:t.getModeIdByFilepathOrFirstLine(n)}function q_(e){return e.replace(/[\11\12\14\15\40]/g,`/`)}var J_=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Y_=function(e,t){return function(n,r){t(n,r,e)}},X_;function Z_(e){return`suggest-aria-id:${e}`}const Q_=gi(`suggest-more-info`,M.chevronRight,z(`suggestMoreInfoIcon`,`Icon for more information in the suggest widget.`));var $_=new(X_=class e{extract(t,n){if(t.textLabel.match(e._regexStrict))return n[0]=t.textLabel,!0;if(t.completion.detail&&t.completion.detail.match(e._regexStrict))return n[0]=t.completion.detail,!0;if(typeof t.completion.documentation==`string`){let r=e._regexRelaxed.exec(t.completion.documentation);if(r&&(r.index===0||r.index+r[0].length===t.completion.documentation.length))return n[0]=r[0],!0}return!1}},X_._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,X_._regexStrict=RegExp(`^${X_._regexRelaxed.source}$`,`i`),X_),ev=class{constructor(e,t,n,r){this._editor=e,this._modelService=t,this._modeService=n,this._themeService=r,this._onDidToggleDetails=new J,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId=`suggestion`}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){let t=Object.create(null);t.disposables=new K,t.root=e,t.root.classList.add(`show-file-icons`),t.icon=q(e,G(`.icon`)),t.colorspan=q(t.icon,G(`span.colorspan`));let n=q(q(e,G(`.contents`)),G(`.main`));t.iconContainer=q(n,G(`.icon-label.codicon`)),t.left=q(n,G(`span.left`)),t.right=q(n,G(`span.right`)),t.iconLabel=new Mn(t.left,{supportHighlights:!0,supportIcons:!0}),t.disposables.add(t.iconLabel),t.parametersLabel=q(t.left,G(`span.signature-label`)),t.qualifierLabel=q(t.left,G(`span.qualifier-label`)),t.detailsLabel=q(t.right,G(`span.details-label`)),t.readMore=q(t.right,G(`span.readMore`+Co.asCSSSelector(Q_))),t.readMore.title=z(`readMore`,`Read More`);let r=()=>{let e=this._editor.getOptions(),r=e.get(43),i=r.getMassagedFontFamily(Lo?Et.fontFamily:null),a=r.fontFeatureSettings,o=e.get(106)||r.fontSize,s=e.get(107)||r.lineHeight,c=r.fontWeight,l=`${o}px`,u=`${s}px`;t.root.style.fontSize=l,t.root.style.fontWeight=c,n.style.fontFamily=i,n.style.fontFeatureSettings=a,n.style.lineHeight=u,t.icon.style.height=u,t.icon.style.width=u,t.readMore.style.height=u,t.readMore.style.width=u};return r(),t.disposables.add(this._editor.onDidChangeConfiguration(e=>{(e.hasChanged(43)||e.hasChanged(106)||e.hasChanged(107))&&r()})),t}renderElement(e,t,n){let{completion:r}=e;n.root.id=Z_(t),n.colorspan.style.backgroundColor=``;let i={labelEscapeNewLines:!0,matches:as(e.score)},a=[];if(r.kind===19&&$_.extract(e,a))n.icon.className=`icon customcolor`,n.iconContainer.className=`icon hide`,n.colorspan.style.backgroundColor=a[0];else if(r.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){n.icon.className=`icon hide`,n.iconContainer.className=`icon hide`;let t=G_(this._modelService,this._modeService,L.from({scheme:`fake`,path:e.textLabel}),W_.FILE),a=G_(this._modelService,this._modeService,L.from({scheme:`fake`,path:r.detail}),W_.FILE);i.extraClasses=t.length>a.length?t:a}else r.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(n.icon.className=`icon hide`,n.iconContainer.className=`icon hide`,i.extraClasses=no([G_(this._modelService,this._modeService,L.from({scheme:`fake`,path:e.textLabel}),W_.FOLDER),G_(this._modelService,this._modeService,L.from({scheme:`fake`,path:r.detail}),W_.FOLDER)])):(n.icon.className=`icon hide`,n.iconContainer.className=``,n.iconContainer.classList.add(`suggest-icon`,...oo(r.kind).split(` `)));r.tags&&r.tags.indexOf(1)>=0&&(i.extraClasses=(i.extraClasses||[]).concat([`deprecated`]),i.matches=[]),n.iconLabel.setLabel(e.textLabel,void 0,i),typeof r.label==`string`?(n.parametersLabel.textContent=``,n.detailsLabel.textContent=tv(r.detail||``),n.root.classList.add(`string-label`)):(n.parametersLabel.textContent=tv(r.label.detail||``),n.detailsLabel.textContent=tv(r.label.description||``),n.root.classList.remove(`string-label`)),this._editor.getOption(105).showInlineDetails?An(n.detailsLabel):zt(n.detailsLabel),V_(e)?(n.right.classList.add(`can-expand-details`),An(n.readMore),n.readMore.onmousedown=e=>{e.stopPropagation(),e.preventDefault()},n.readMore.onclick=e=>{e.stopPropagation(),e.preventDefault(),this._onDidToggleDetails.fire()}):(n.right.classList.remove(`can-expand-details`),zt(n.readMore),n.readMore.onmousedown=null,n.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};ev=J_([Y_(1,Jo),Y_(2,zs),Y_(3,Vi)],ev);function tv(e){return e.replace(/\r\n|\r|\n/g,``)}var nv=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},rv=function(e,t){return function(n,r){t(n,r,e)}},iv=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};const av=v(`editorSuggestWidget.background`,{dark:lr,light:lr,hc:lr},z(`editorSuggestWidgetBackground`,`Background color of the suggest widget.`)),ov=v(`editorSuggestWidget.border`,{dark:Xe,light:Xe,hc:Xe},z(`editorSuggestWidgetBorder`,`Border color of the suggest widget.`)),sv=v(`editorSuggestWidget.foreground`,{dark:fi,light:fi,hc:fi},z(`editorSuggestWidgetForeground`,`Foreground color of the suggest widget.`)),cv=v(`editorSuggestWidget.selectedForeground`,{dark:Is,light:Is,hc:Is},z(`editorSuggestWidgetSelectedForeground`,`Foreground color of the selected entry in the suggest widget.`)),lv=v(`editorSuggestWidget.selectedIconForeground`,{dark:Rn,light:Rn,hc:Rn},z(`editorSuggestWidgetSelectedIconForeground`,`Icon foreground color of the selected entry in the suggest widget.`)),uv=v(`editorSuggestWidget.selectedBackground`,{dark:mi,light:mi,hc:mi},z(`editorSuggestWidgetSelectedBackground`,`Background color of the selected entry in the suggest widget.`)),dv=v(`editorSuggestWidget.highlightForeground`,{dark:Ai,light:Ai,hc:Ai},z(`editorSuggestWidgetHighlightForeground`,`Color of the match highlights in the suggest widget.`)),fv=v(`editorSuggestWidget.focusHighlightForeground`,{dark:ds,light:ds,hc:ds},z(`editorSuggestWidgetFocusHighlightForeground`,`Color of the match highlights in the suggest widget when an item is focused.`));var pv=class{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof Hu}`}restore(){let e=this._service.get(this._key,0)??``;try{let t=JSON.parse(e);if(ji.is(t))return ji.lift(t)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}},mv=class e{constructor(e,t,n,r,i){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new St,this._disposables=new K,this._onDidSelect=new J,this._onDidFocus=new J,this._onDidHide=new J,this._onDidShow=new J,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new J,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new R_,this.element.domNode.classList.add(`editor-widget`,`suggest-widget`),this._contentWidget=new hv(this,e),this._persistedSize=new pv(t,e);class a{constructor(e,t,n=!1,r=!1){this.persistedSize=e,this.currentSize=t,this.persistHeight=n,this.persistWidth=r}}let o;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),o=new a(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(e=>{if(this._resize(e.dimension.width,e.dimension.height),o&&(o.persistHeight=o.persistHeight||!!e.north||!!e.south,o.persistWidth=o.persistWidth||!!e.east||!!e.west),e.done){if(o){let{itemHeight:e,defaultSize:t}=this.getLayoutInfo(),n=Math.round(e/2),{width:r,height:i}=this.element.size;(!o.persistHeight||Math.abs(o.currentSize.height-i)<=n)&&(i=o.persistedSize?.height??t.height),(!o.persistWidth||Math.abs(o.currentSize.width-r)<=n)&&(r=o.persistedSize?.width??t.width),this._persistedSize.store(new ji(r,i))}this._contentWidget.unlockPreference(),o=void 0}})),this._messageElement=q(this.element.domNode,G(`.message`)),this._listElement=q(this.element.domNode,G(`.tree`));let s=i.createInstance(H_,this.editor);s.onDidClose(this.toggleDetails,this,this._disposables),this._details=new U_(s,this.editor);let c=()=>this.element.domNode.classList.toggle(`no-icons`,!this.editor.getOption(105).showIcons);c();let l=i.createInstance(ev,this.editor);this._disposables.add(l),this._disposables.add(l.onDidToggleDetails(()=>this.toggleDetails())),this._list=new ht(`SuggestWidget`,this._listElement,{getHeight:e=>this.getLayoutInfo().itemHeight,getTemplateId:e=>`suggestion`},[l],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,accessibilityProvider:{getRole:()=>`option`,getAriaLabel:e=>{if(e.isResolved&&this._isDetailsVisible()){let{documentation:t,detail:n}=e.completion,r=yn(`{0}{1}`,n||``,t?typeof t==`string`?t:t.value:``);return z(`ariaCurrenttSuggestionReadDetails`,`{0}, docs: {1}`,e.textLabel,r)}else return e.textLabel},getWidgetAriaLabel:()=>z(`suggest`,`Suggest`),getWidgetRole:()=>`listbox`}}),this._status=i.createInstance(i_,this.element.domNode);let u=()=>this.element.domNode.classList.toggle(`with-status-bar`,this.editor.getOption(105).showStatusBar);u(),this._disposables.add(Sr(this._list,r,{listInactiveFocusBackground:uv,listInactiveFocusOutline:bi})),this._disposables.add(r.onDidColorThemeChange(e=>this._onThemeChange(e))),this._onThemeChange(r.getColorTheme()),this._disposables.add(this._list.onMouseDown(e=>this._onListMouseDownOrTap(e))),this._disposables.add(this._list.onTap(e=>this._onListMouseDownOrTap(e))),this._disposables.add(this._list.onDidChangeSelection(e=>this._onListSelection(e))),this._disposables.add(this._list.onDidChangeFocus(e=>this._onListFocus(e))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(e=>{e.hasChanged(105)&&(u(),c())})),this._ctxSuggestWidgetVisible=Q.Visible.bindTo(n),this._ctxSuggestWidgetDetailsVisible=Q.DetailsVisible.bindTo(n),this._ctxSuggestWidgetMultipleSuggestions=Q.MultipleSuggestions.bindTo(n),this._disposables.add(hi(this._details.widget.domNode,`keydown`,e=>{this._onDetailsKeydown.fire(e)})),this._disposables.add(this.editor.onMouseDown(e=>this._onEditorMouseDown(e)))}dispose(){var e;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),(e=this._loadingTimeout)==null||e.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){e.element===void 0||e.index===void 0||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){let n=this._completionModel;n&&(this._onDidSelect.fire({item:e,index:t,model:n}),this.editor.focus())}_onThemeChange(e){let t=e.getColor(av);t&&(this.element.domNode.style.backgroundColor=t.toString(),this._messageElement.style.backgroundColor=t.toString(),this._details.widget.domNode.style.backgroundColor=t.toString());let n=e.getColor(ov);n&&(this.element.domNode.style.borderColor=n.toString(),this._messageElement.style.borderColor=n.toString(),this._status.element.style.borderTopColor=n.toString(),this._details.widget.domNode.style.borderColor=n.toString(),this._detailsBorderColor=n.toString());let r=e.getColor(yt);r&&(this._detailsFocusBorderColor=r.toString()),this._details.widget.borderWidth=e.type===`hc`?2:1}_onListFocus(e){var t;if(this._ignoreFocusEvents)return;if(!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0});return}if(!this._completionModel)return;let n=e.elements[0],r=e.indexes[0];n!==this._focusedItem&&((t=this._currentSuggestionDetails)==null||t.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=n,this._list.reveal(r),this._currentSuggestionDetails=No(e=>iv(this,void 0,void 0,function*(){let t=pt(()=>{this._isDetailsVisible()&&this.showDetails(!0)},250);e.onCancellationRequested(()=>t.dispose());let r=yield n.resolve(e);return t.dispose(),r})),this._currentSuggestionDetails.then(()=>{r>=this._list.length||n!==this._list.element(r)||(this._ignoreFocusEvents=!0,this._list.splice(r,1,[n]),this._list.setFocus([r]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove(`docs-side`),this.editor.setAriaOptions({activeDescendant:Z_(r)}))}).catch(C)),this._onDidFocus.fire({item:n,index:r,model:this._completionModel})}_setState(t){if(this._state!==t)switch(this._state=t,this.element.domNode.classList.toggle(`frozen`,t===4),this.element.domNode.classList.remove(`message`),t){case 0:zt(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove(`visible`),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add(`message`),this._messageElement.textContent=e.LOADING_MESSAGE,zt(this._listElement,this._status.element),An(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 2:this.element.domNode.classList.add(`message`),this._messageElement.textContent=e.NO_SUGGESTIONS_MESSAGE,zt(this._listElement,this._status.element),An(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0;break;case 3:zt(this._messageElement),An(this._listElement,this._status.element),this._show();break;case 4:zt(this._messageElement),An(this._listElement,this._status.element),this._show();break;case 5:zt(this._messageElement),An(this._listElement,this._status.element),this._details.show(),this._show();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add(`visible`),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=pt(()=>this._setState(1),t)))}showSuggestions(e,t,n,r){var i,a;if(this._contentWidget.setPosition(this.editor.getPosition()),(i=this._loadingTimeout)==null||i.dispose(),(a=this._currentSuggestionDetails)==null||a.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),n&&this._state!==2&&this._state!==0){this._setState(4);return}let o=this._completionModel.items.length,s=o===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(o>1),s){this._setState(r?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._list.splice(0,this._list.length,this._completionModel.items),this._setState(n?4:3),this._list.reveal(t,0),this._list.setFocus([t]),this._layout(this.element.size),this._detailsBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsBorderColor)}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._detailsBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsBorderColor)):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._detailsFocusBorderColor&&(this._details.widget.domNode.style.borderColor=this._detailsFocusBorderColor))}toggleDetails(){this._isDetailsVisible()?(this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove(`shows-details`)):(V_(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(e){this._details.show(),e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._positionDetails(),this.editor.focus(),this.element.domNode.classList.add(`shows-details`)}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){var e;(e=this._loadingTimeout)==null||e.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();let t=this._persistedSize.restore(),n=Math.ceil(this.getLayoutInfo().itemHeight*4.3);t&&t.height<n&&this._persistedSize.store(t.with(void 0,n))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&this._details.show(),this._positionDetails())}_layout(e){if(!this.editor.hasModel()||!this.editor.getDomNode())return;let t=ke(document.body),n=this.getLayoutInfo();e||=n.defaultSize;let r=e.height,i=e.width;if(this._status.element.style.lineHeight=`${n.itemHeight}px`,this._state===2||this._state===1)r=n.itemHeight+n.borderHeight,i=n.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new ji(i,r),this._contentWidget.setPreference(2);else{let a=t.width-n.borderHeight-2*n.horizontalPadding;i>a&&(i=a);let o=this._completionModel?this._completionModel.stats.pLabelLen*n.typicalHalfwidthCharacterWidth:i,s=n.statusBarHeight+this._list.contentHeight+n.borderHeight,c=n.itemHeight+n.statusBarHeight,l=rn(this.editor.getDomNode()),u=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),d=l.top+u.top+u.height,f=Math.min(t.height-d-n.verticalPadding,s),p=l.top+u.top-n.verticalPadding,m=Math.min(p,s),h=Math.min(Math.max(m,f)+n.borderHeight,s);r===this._cappedHeight?.capped&&(r=this._cappedHeight.wanted),r<c&&(r=c),r>h&&(r=h),r>f||this._forceRenderingAbove&&p>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),h=m):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),h=f),this.element.preferredSize=new ji(o,n.defaultSize.height),this.element.maxSize=new ji(a,h),this.element.minSize=new ji(220,c),this._cappedHeight=r===s?{wanted:this._cappedHeight?.wanted??e.height,capped:r}:void 0}this._resize(i,r)}_resize(e,t){let{width:n,height:r}=this.element.maxSize;e=Math.min(n,e),t=Math.min(r,t);let{statusBarHeight:i}=this.getLayoutInfo();this._list.layout(t-i,e),this._listElement.style.height=`${t-i}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode)}getLayoutInfo(){let e=this.editor.getOption(43),t=xi(this.editor.getOption(107)||e.lineHeight,8,1e3),n=!this.editor.getOption(105).showStatusBar||this._state===2||this._state===1?0:t,r=this._details.widget.borderWidth,i=2*r;return{itemHeight:t,statusBarHeight:n,borderWidth:r,borderHeight:i,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new ji(430,n+12*t+i)}}_isDetailsVisible(){return this._storageService.getBoolean(`expandSuggestionDocs`,0,!1)}_setDetailsVisible(e){this._storageService.store(`expandSuggestionDocs`,e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}};mv.LOADING_MESSAGE=z(`suggestWidget.loading`,`Loading...`),mv.NO_SUGGESTIONS_MESSAGE=z(`suggestWidget.noSuggestions`,`No suggestions.`),mv=nv([rv(1,je),rv(2,D),rv(3,Vi),rv(4,H)],mv);var hv=class{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return`editor.widget.suggestWidget`}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){let{height:e,width:t}=this._widget.element.size,{borderWidth:n,horizontalPadding:r}=this._widget.getLayoutInfo();return new ji(t+2*n+r,e+2*n)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}};Ya((e,t)=>{let n=e.getColor(dv);n&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${n}; }`);let r=e.getColor(fv);n&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .monaco-highlighted-label .highlight { color: ${r}; }`);let i=e.getColor(sv);i&&t.addRule(`.monaco-editor .suggest-widget, .monaco-editor .suggest-details { color: ${i}; }`);let a=e.getColor(cv);a&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused { color: ${a}; }`);let o=e.getColor(lv);o&&t.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .codicon { color: ${o}; }`);let s=e.getColor(h);s&&t.addRule(`.monaco-editor .suggest-details a { color: ${s}; }`);let c=e.getColor(Fa);c&&t.addRule(`.monaco-editor .suggest-details a:hover { color: ${c}; }`);let l=e.getColor(nn);l&&t.addRule(`.monaco-editor .suggest-details code { background-color: ${l}; }`)});var gv=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_v=function(e,t){return function(n,r){t(n,r,e)}},vv=class{constructor(e,t){if(this._model=e,this._position=t,e.getLineMaxColumn(t.lineNumber)!==t.column){let n=e.getOffsetAt(t),r=e.getPositionAt(n+1);this._marker=e.deltaDecorations([],[{range:W.fromPositions(t,r),options:{description:`suggest-line-suffix`,stickiness:1}}])}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.deltaDecorations(this._marker,[])}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){let t=this._model.getDecorationRange(this._marker[0]);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}},yv=class e{constructor(e,t,n,r,i,a){this._memoryService=t,this._commandService=n,this._contextKeyService=r,this._instantiationService=i,this._logService=a,this._lineSuffix=new Un,this._toDispose=new K,this._selectors=new bv(e=>e.priority),this.editor=e,this.model=i.createInstance($g,this.editor);let o=Q.InsertMode.bindTo(r);o.set(e.getOption(105).insertMode),this.model.onDidTrigger(()=>o.set(e.getOption(105).insertMode)),this.widget=this._toDispose.add(new br(()=>{let e=this._instantiationService.createInstance(mv,this.editor);this._toDispose.add(e),this._toDispose.add(e.onDidSelect(e=>this._insertSuggestion(e,0),this));let t=new Vg(this.editor,e,e=>this._insertSuggestion(e,2));this._toDispose.add(t),this._toDispose.add(this.model.onDidSuggest(e=>{e.completionModel.items.length===0&&t.reset()}));let n=Q.MakesTextEdit.bindTo(this._contextKeyService),r=Q.HasInsertAndReplaceRange.bindTo(this._contextKeyService),i=Q.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(ja(()=>{n.reset(),r.reset(),i.reset()})),this._toDispose.add(e.onDidFocus(({item:e})=>{let t=this.editor.getPosition(),a=e.editStart.column,o=t.column,s=!0;this.editor.getOption(1)===`smart`&&this.model.state===2&&!e.completion.additionalTextEdits&&!(e.completion.insertTextRules&4)&&o-a===e.completion.insertText.length&&(s=this.editor.getModel().getValueInRange({startLineNumber:t.lineNumber,startColumn:a,endLineNumber:t.lineNumber,endColumn:o})!==e.completion.insertText),n.set(s),r.set(!P.equals(e.editInsertEnd,e.editReplaceEnd)),i.set(!!e.provider.resolveCompletionItem||!!e.completion.documentation||e.completion.detail!==e.completion.label)})),this._toDispose.add(e.onDetailsKeyDown(e=>{if(e.toKeybinding().equals(new es(!0,!1,!1,!1,33))||Qn&&e.toKeybinding().equals(new es(!1,!1,!1,!0,33))){e.stopPropagation();return}e.toKeybinding().isModifierKey()||this.editor.focus()})),e})),this._overtypingCapturer=this._toDispose.add(new br(()=>this._toDispose.add(new e_(this.editor,this.model)))),this._alternatives=this._toDispose.add(new br(()=>this._toDispose.add(new Bg(this.editor,this._contextKeyService)))),this._toDispose.add(i.createInstance(Lg,e)),this._toDispose.add(this.model.onDidTrigger(e=>{this.widget.value.showTriggered(e.auto,e.shy?250:50),this._lineSuffix.value=new vv(this.editor.getModel(),e.position)})),this._toDispose.add(this.model.onDidSuggest(e=>{if(!e.shy){let t=-1;for(let n of this._selectors.itemsOrderedByPriorityDesc)if(t=n.select(this.editor.getModel(),this.editor.getPosition(),e.completionModel.items),t!==-1)break;t===-1&&(t=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),e.completionModel.items)),this.widget.value.showSuggestions(e.completionModel,t,e.isFrozen,e.auto)}})),this._toDispose.add(this.model.onDidCancel(e=>{e.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));let s=Q.AcceptSuggestionsOnEnter.bindTo(r),c=()=>{let e=this.editor.getOption(1);s.set(e===`on`||e===`smart`)};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>c())),c()}static get(t){return t.getContribution(e.ID)}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose()}_insertSuggestion(e,t){if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;let n=this.editor.getModel(),r=n.getAlternativeVersionId(),{item:i}=e,a=[],o=new hs;t&1||this.editor.pushUndoStop();let s=this.getOverwriteInfo(i,!!(t&8));if(this._memoryService.memorize(n,this.editor.getPosition(),i),Array.isArray(i.completion.additionalTextEdits)){let e=b.capture(this.editor);this.editor.executeEdits(`suggestController.additionalTextEdits.sync`,i.completion.additionalTextEdits.map(e=>En.replace(W.lift(e.range),e.text))),e.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!i.isResolved){let e=new Ms(!0),r,s=n.onDidChangeContent(e=>{if(e.isFlush){o.cancel(),s.dispose();return}for(let t of e.changes){let e=W.getEndPosition(t.range);(!r||P.isBefore(e,r))&&(r=e)}}),c=t;t|=2;let l=!1,u=this.editor.onWillType(()=>{u.dispose(),l=!0,c&2||this.editor.pushUndoStop()});a.push(i.resolve(o.token).then(()=>{if(!i.completion.additionalTextEdits||o.token.isCancellationRequested||r&&i.completion.additionalTextEdits.some(e=>P.isBefore(r,W.getStartPosition(e.range))))return!1;l&&this.editor.pushUndoStop();let e=b.capture(this.editor);return this.editor.executeEdits(`suggestController.additionalTextEdits.async`,i.completion.additionalTextEdits.map(e=>En.replace(W.lift(e.range),e.text))),e.restoreRelativeVerticalPositionOfCursor(this.editor),(l||!(c&2))&&this.editor.pushUndoStop(),!0}).then(t=>{this._logService.trace(`[suggest] async resolving of edits DONE (ms, applied?)`,e.elapsed(),t),s.dispose(),u.dispose()}))}let{insertText:c}=i.completion;i.completion.insertTextRules&4||(c=Uh.escape(c)),Tg.get(this.editor).insert(c,{overwriteBefore:s.overwriteBefore,overwriteAfter:s.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(i.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),t&2||this.editor.pushUndoStop(),i.completion.command?i.completion.command.id===xv.id?this.model.trigger({auto:!0,shy:!1},!0):(a.push(this._commandService.executeCommand(i.completion.command.id,...i.completion.command.arguments?[...i.completion.command.arguments]:[]).catch(C)),this.model.cancel()):this.model.cancel(),t&4&&this._alternatives.value.set(e,e=>{for(o.cancel();n.canUndo();){r!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(e,3|(t&8?8:0));break}}),this._alertCompletionItem(i),Promise.all(a).finally(()=>{this.model.clear(),o.dispose()})}getOverwriteInfo(e,t){Fs(this.editor.hasModel());let n=this.editor.getOption(105).insertMode===`replace`;t&&(n=!n);let r=e.position.column-e.editStart.column,i=(n?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,a=this.editor.getPosition().column-e.position.column,o=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:r+a,overwriteAfter:i+o}}_alertCompletionItem(e){ti(e.completion.additionalTextEdits)&&Fn(z(`aria.alert.snippet`,`Accepting '{0}' made {1} additional edits`,e.textLabel,e.completion.additionalTextEdits.length))}triggerSuggest(e){this.editor.hasModel()&&(this.model.trigger({auto:!1,shy:!1},!1,e),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;let t=this.editor.getPosition(),n=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},r=e=>{if(e.completion.insertTextRules&4||e.completion.additionalTextEdits)return!0;let t=this.editor.getPosition(),n=e.editStart.column,r=t.column;return r-n===e.completion.insertText.length?this.editor.getModel().getValueInRange({startLineNumber:t.lineNumber,startColumn:n,endLineNumber:t.lineNumber,endColumn:r})!==e.completion.insertText:!0};ui.once(this.model.onDidTrigger)(e=>{let t=[];ui.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{y(t),n()},void 0,t),this.model.onDidSuggest(({completionModel:e})=>{if(y(t),e.items.length===0){n();return}let i=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),e.items),a=e.items[i];if(!r(a)){n();return}this.editor.pushUndoStop(),this._insertSuggestion({index:i,item:a,model:e},7)},void 0,t)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){let n=this.widget.value.getFocusedItem(),r=0;e&&(r|=4),t&&(r|=8),this._insertSuggestion(n,r)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}};yv.ID=`editor.contrib.suggestController`,yv=gv([_v(1,Pg),_v(2,Hs),_v(3,D),_v(4,H),_v(5,wr)],yv);var bv=class{constructor(e){this.prioritySelector=e,this._items=[]}register(e){if(this._items.indexOf(e)!==-1)throw Error(`Value is already registered`);return this._items.push(e),this._items.sort((e,t)=>this.prioritySelector(t)-this.prioritySelector(e)),{dispose:()=>{let t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}},xv=class e extends V{constructor(){super({id:e.id,label:z(`suggest.trigger.label`,`Trigger Suggest`),alias:`Trigger Suggest`,precondition:w.and(A.writable,A.hasCompletionItemProvider),kbOpts:{kbExpr:A.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t){let n=yv.get(t);n&&n.triggerSuggest()}};xv.id=`editor.action.triggerSuggest`,U(yv.ID,yv),o(xv);var Sv=190,Cv=ft.bindToContribution(yv.get);F(new Cv({id:`acceptSelectedSuggestion`,precondition:Q.Visible,handler(e){e.acceptSelectedSuggestion(!0,!1)}})),ln.registerKeybindingRule({id:`acceptSelectedSuggestion`,when:w.and(Q.Visible,A.textInputFocus),primary:2,weight:Sv}),ln.registerKeybindingRule({id:`acceptSelectedSuggestion`,when:w.and(Q.Visible,A.textInputFocus,Q.AcceptSuggestionsOnEnter,Q.MakesTextEdit),primary:3,weight:Sv}),cs.appendMenuItem(cg,{command:{id:`acceptSelectedSuggestion`,title:z(`accept.insert`,`Insert`)},group:`left`,order:1,when:Q.HasInsertAndReplaceRange.toNegated()}),cs.appendMenuItem(cg,{command:{id:`acceptSelectedSuggestion`,title:z(`accept.insert`,`Insert`)},group:`left`,order:1,when:w.and(Q.HasInsertAndReplaceRange,Q.InsertMode.isEqualTo(`insert`))}),cs.appendMenuItem(cg,{command:{id:`acceptSelectedSuggestion`,title:z(`accept.replace`,`Replace`)},group:`left`,order:1,when:w.and(Q.HasInsertAndReplaceRange,Q.InsertMode.isEqualTo(`replace`))}),F(new Cv({id:`acceptAlternativeSelectedSuggestion`,precondition:w.and(Q.Visible,A.textInputFocus),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:1027,secondary:[1026]},handler(e){e.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:cg,group:`left`,order:2,when:w.and(Q.HasInsertAndReplaceRange,Q.InsertMode.isEqualTo(`insert`)),title:z(`accept.replace`,`Replace`)},{menuId:cg,group:`left`,order:2,when:w.and(Q.HasInsertAndReplaceRange,Q.InsertMode.isEqualTo(`replace`)),title:z(`accept.insert`,`Insert`)}]})),vs.registerCommandAlias(`acceptSelectedSuggestionOnEnter`,`acceptSelectedSuggestion`),F(new Cv({id:`hideSuggestWidget`,precondition:Q.Visible,handler:e=>e.cancelSuggestWidget(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:9,secondary:[1033]}})),F(new Cv({id:`selectNextSuggestion`,precondition:w.and(Q.Visible,Q.MultipleSuggestions),handler:e=>e.selectNextSuggestion(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})),F(new Cv({id:`selectNextPageSuggestion`,precondition:w.and(Q.Visible,Q.MultipleSuggestions),handler:e=>e.selectNextPageSuggestion(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:12,secondary:[2060]}})),F(new Cv({id:`selectLastSuggestion`,precondition:w.and(Q.Visible,Q.MultipleSuggestions),handler:e=>e.selectLastSuggestion()})),F(new Cv({id:`selectPrevSuggestion`,precondition:w.and(Q.Visible,Q.MultipleSuggestions),handler:e=>e.selectPrevSuggestion(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})),F(new Cv({id:`selectPrevPageSuggestion`,precondition:w.and(Q.Visible,Q.MultipleSuggestions),handler:e=>e.selectPrevPageSuggestion(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:11,secondary:[2059]}})),F(new Cv({id:`selectFirstSuggestion`,precondition:w.and(Q.Visible,Q.MultipleSuggestions),handler:e=>e.selectFirstSuggestion()})),F(new Cv({id:`toggleSuggestionDetails`,precondition:Q.Visible,handler:e=>e.toggleSuggestionDetails(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:cg,group:`right`,order:1,when:w.and(Q.DetailsVisible,Q.CanResolve),title:z(`detail.more`,`show less`)},{menuId:cg,group:`right`,order:1,when:w.and(Q.DetailsVisible.toNegated(),Q.CanResolve),title:z(`detail.less`,`show more`)}]})),F(new Cv({id:`toggleExplainMode`,precondition:Q.Visible,handler:e=>e.toggleExplainMode(),kbOpts:{weight:100,primary:2133}})),F(new Cv({id:`toggleSuggestionFocus`,precondition:Q.Visible,handler:e=>e.toggleSuggestionFocus(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:2570,mac:{primary:778}}})),F(new Cv({id:`insertBestCompletion`,precondition:w.and(A.textInputFocus,w.equals(`config.editor.tabCompletion`,`on`),Lg.AtEnd,Q.Visible.toNegated(),Bg.OtherSuggestions.toNegated(),Tg.InSnippetMode.toNegated()),handler:(e,t)=>{e.triggerSuggestAndAcceptBest(Es(t)?Object.assign({fallback:`tab`},t):{fallback:`tab`})},kbOpts:{weight:Sv,primary:2}})),F(new Cv({id:`insertNextSuggestion`,precondition:w.and(A.textInputFocus,w.equals(`config.editor.tabCompletion`,`on`),Bg.OtherSuggestions,Q.Visible.toNegated(),Tg.InSnippetMode.toNegated()),handler:e=>e.acceptNextSuggestion(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:2}})),F(new Cv({id:`insertPrevSuggestion`,precondition:w.and(A.textInputFocus,w.equals(`config.editor.tabCompletion`,`on`),Bg.OtherSuggestions,Q.Visible.toNegated(),Tg.InSnippetMode.toNegated()),handler:e=>e.acceptPrevSuggestion(),kbOpts:{weight:Sv,kbExpr:A.textInputFocus,primary:1026}})),o(class extends V{constructor(){super({id:`editor.action.resetSuggestSize`,label:z(`suggest.reset.label`,`Reset Suggest Widget Size`),alias:`Reset Suggest Widget Size`,precondition:void 0})}run(e,t){yv.get(t).resetWidgetSize()}});function wv(e,t){return{object:e,dispose:()=>t?.dispose()}}function Tv(e,t){return(n,r)=>t(e(n),e(r))}function Ev(){return(e,t)=>e-t}function Dv(e,t){let n;for(let r of e)(n===void 0||t(r,n)>0)&&(n=r);return n}var Ov=class extends _{constructor(e,t){super(),this.editor=e,this.suggestControllerPreselector=t,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentInlineCompletion=void 0,this.onDidChangeEmitter=new J,this.onDidChange=this.onDidChangeEmitter.event,this.setInactiveDelayed=this._register(new T(()=>{this.isSuggestWidgetVisible||this._isActive&&(this._isActive=!1,this.onDidChangeEmitter.fire())},100)),this._register(e.onKeyDown(e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(e.onKeyUp(e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));let n=yv.get(this.editor);if(n){this._register(n.registerSelector({priority:100,select:(e,t,r)=>{let i=this.editor.getModel(),a=jh(i,this.suggestControllerPreselector());if(!a)return-1;let o=P.lift(t),s=Dv(r.map((e,t)=>{let r=jh(i,Av(n,o,e,this.isShiftKeyPressed));if(r)return{index:t,valid:kv(a.range,r.range)&&a.text.startsWith(r.text),prefixLength:r.text.length,suggestItem:e}}).filter(e=>e&&e.valid),Tv(e=>e.prefixLength,Ev()));return s?s.index:-1}}));let e=!1,t=()=>{e||(e=!0,this._register(n.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(n.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.setInactiveDelayed.schedule(),this.update(this._isActive)})),this._register(n.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(ui.once(n.model.onDidTrigger)(e=>{t()}))}this.update(this._isActive)}get state(){if(this._isActive)return{selectedItemAsInlineCompletion:this._currentInlineCompletion}}update(e){let t=this.getInlineCompletion(),n=!1;gh(this._currentInlineCompletion,t)||(this._currentInlineCompletion=t,n=!0),this._isActive!==e&&(this._isActive=e,n=!0),n&&this.onDidChangeEmitter.fire()}getInlineCompletion(){let e=yv.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;let t=e.widget.value.getFocusedItem();if(t)return Av(e,this.editor.getPosition(),t.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){let e=yv.get(this.editor);e&&e.stopForceRenderingAbove()}forceRenderingAbove(){let e=yv.get(this.editor);e&&e.forceRenderingAbove()}};function kv(e,t){return e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&(e.endLineNumber<t.endLineNumber||e.endLineNumber===t.endLineNumber&&e.endColumn<=t.endColumn)}function Av(e,t,n,r){if(Array.isArray(n.completion.additionalTextEdits)&&n.completion.additionalTextEdits.length>0)return{text:``,range:W.fromPositions(t,t)};let{insertText:i}=n.completion;if(n.completion.insertTextRules&4){let n=new Uh().parse(i),r=e.editor.getModel();if(n.children.length>100)return;og.adjustWhitespace(r,t,n,!0,!0),i=n.toString()}let a=e.getOverwriteInfo(n,r);return{text:i,range:W.fromPositions(t.delta(0,-a.overwriteBefore),t.delta(0,Math.max(a.overwriteAfter,0)))}}var jv=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Mv=class extends hh{constructor(e,t){super(e),this.cache=t,this.suggestionInlineCompletionSource=this._register(new Ov(this.editor,()=>(this.cache.value?.completions[0])?.toLiveInlineCompletion())),this.updateOperation=this._register(new Un),this.updateCacheSoon=this._register(new T(()=>this.updateCache(),50)),this.minReservedLineCount=0,this._register(this.suggestionInlineCompletionSource.onDidChange(()=>{this.updateCacheSoon.schedule(),this.suggestionInlineCompletionSource.state||(this.minReservedLineCount=0);let e=this.ghostText;e&&(this.minReservedLineCount=Math.max(this.minReservedLineCount,Nv(e.parts.map(e=>e.lines.length-1)))),this.minReservedLineCount>=1&&this.isSuggestionPreviewEnabled()?this.suggestionInlineCompletionSource.forceRenderingAbove():this.suggestionInlineCompletionSource.stopForceRenderingAbove(),this.onDidChangeEmitter.fire()})),this._register(this.cache.onDidChange(()=>{this.onDidChangeEmitter.fire()})),this._register(this.editor.onDidChangeCursorPosition(e=>{this.isSuggestionPreviewEnabled()&&(this.minReservedLineCount=0,this.updateCacheSoon.schedule(),this.onDidChangeEmitter.fire())})),this._register(ja(()=>this.suggestionInlineCompletionSource.stopForceRenderingAbove()))}get isActive(){return this.suggestionInlineCompletionSource.state!==void 0}isSuggestionPreviewEnabled(){return this.editor.getOption(105).preview}updateCache(){return jv(this,void 0,void 0,function*(){let e=this.suggestionInlineCompletionSource.state;if(!e||!e.selectedItemAsInlineCompletion)return;let t={text:e.selectedItemAsInlineCompletion.text,range:e.selectedItemAsInlineCompletion.range},n=this.editor.getPosition(),r=No(e=>jv(this,void 0,void 0,function*(){let r;try{r=yield Ah(n,this.editor.getModel(),{triggerKind:or.Automatic,selectedSuggestionInfo:t},e)}catch(e){C(e);return}e.isCancellationRequested||(this.cache.setValue(this.editor,r,or.Automatic),this.onDidChangeEmitter.fire())})),i=new Eh(r,or.Automatic);this.updateOperation.value=i,yield r,this.updateOperation.value===i&&this.updateOperation.clear()})}get ghostText(){if(!this.isSuggestionPreviewEnabled())return;let e=this.suggestionInlineCompletionSource.state,t=jh(this.editor.getModel(),e?.selectedItemAsInlineCompletion),n=jh(this.editor.getModel(),(this.cache.value?.completions[0])?.toLiveInlineCompletion()),r=n&&t&&n.text.startsWith(t.text)&&n.range.equalsRange(t.range)?n:t||n,i=t?(r?.text.length||0)-t.text.length:0;return(e=>{let t=this.editor.getOptions().get(105).previewMode;return e?_h(e,this.editor.getModel(),t,this.editor.getPosition(),i)||new dh(e.range.endLineNumber,[],this.minReservedLineCount):void 0})(r)}};function Nv(e){return e.reduce((e,t)=>e+t,0)}var Pv=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Fv=function(e,t){return function(n,r){t(n,r,e)}},Iv=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Lv=class extends _{constructor(){super(...arguments),this.onDidChangeEmitter=new J,this.onDidChange=this.onDidChangeEmitter.event,this.hasCachedGhostText=!1,this.currentModelRef=this._register(new Un)}get targetModel(){return this.currentModelRef.value?.object}setTargetModel(e){this.currentModelRef.value?.object!==e&&(this.currentModelRef.clear(),this.currentModelRef.value=e?wv(e,e.onDidChange(()=>{this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire()})):void 0,this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire())}get ghostText(){return this.hasCachedGhostText||=(this.cachedGhostText=this.currentModelRef.value?.object?.ghostText,!0),this.cachedGhostText}setExpanded(e){var t;(t=this.targetModel)==null||t.setExpanded(e)}get minReservedLineCount(){return this.targetModel?this.targetModel.minReservedLineCount:0}},Rv=class extends Lv{constructor(e,t){super(),this.editor=e,this.commandService=t,this.sharedCache=this._register(new zv),this.suggestWidgetAdapterModel=this._register(new Mv(this.editor,this.sharedCache)),this.inlineCompletionsModel=this._register(new wh(this.editor,this.sharedCache,this.commandService)),this._register(this.suggestWidgetAdapterModel.onDidChange(()=>{this.updateModel()})),this.updateModel()}get activeInlineCompletionsModel(){if(this.targetModel===this.inlineCompletionsModel)return this.inlineCompletionsModel}updateModel(){this.setTargetModel(this.suggestWidgetAdapterModel.isActive?this.suggestWidgetAdapterModel:this.inlineCompletionsModel),this.inlineCompletionsModel.setActive(this.targetModel===this.inlineCompletionsModel)}shouldShowHoverAt(e){let t=this.activeInlineCompletionsModel?.ghostText;return t?t.parts.some(n=>e.containsPosition(new P(t.lineNumber,n.column))):!1}triggerInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)==null||e.trigger(or.Explicit)}commitInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)==null||e.commitCurrentSuggestion()}hideInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)==null||e.hide()}showNextInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)==null||e.showNext()}showPreviousInlineCompletion(){var e;(e=this.activeInlineCompletionsModel)==null||e.showPrevious()}hasMultipleInlineCompletions(){return Iv(this,void 0,void 0,function*(){let e=yield this.activeInlineCompletionsModel?.hasMultipleInlineCompletions();return e===void 0?!1:e})}};Rv=Pv([Fv(1,Hs)],Rv);var zv=class extends _{constructor(){super(...arguments),this.onDidChangeEmitter=new J,this.onDidChange=this.onDidChangeEmitter.event,this.cache=this._register(new Un)}get value(){return this.cache.value}setValue(e,t,n){this.cache.value=new Dh(e,t,()=>this.onDidChangeEmitter.fire(),n)}clearAndLeak(){return this.cache.clearAndLeak()}clear(){this.cache.clear()}},Bv=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Vv=function(e,t){return function(n,r){t(n,r,e)}},Hv=window.trustedTypes?.createPolicy(`editorGhostText`,{createHTML:e=>e}),Uv=class extends _{constructor(e,t,n,r){super(),this.editor=e,this.model=t,this.instantiationService=n,this.modeService=r,this.disposed=!1,this.partsWidget=this._register(this.instantiationService.createInstance(Wv,this.editor)),this.additionalLinesWidget=this._register(new Kv(this.editor,this.modeService.languageIdCodec)),this.viewMoreContentWidget=void 0,this._register(this.editor.onDidChangeConfiguration(e=>{(e.hasChanged(29)||e.hasChanged(104)||e.hasChanged(87)||e.hasChanged(82)||e.hasChanged(44)||e.hasChanged(43)||e.hasChanged(58))&&this.update()})),this._register(ja(()=>{var e;this.disposed=!0,this.update(),(e=this.viewMoreContentWidget)==null||e.dispose(),this.viewMoreContentWidget=void 0})),this._register(t.onDidChange(()=>{this.update()})),this.update()}shouldShowHoverAtViewZone(e){return this.additionalLinesWidget.viewZoneId===e}update(){var e;let t=this.model.ghostText;if(!this.editor.hasModel()||!t||this.disposed){this.partsWidget.clear(),this.additionalLinesWidget.clear();return}let n=[],r=[];function i(e,t){if(r.length>0){let n=r[r.length-1];t&&n.decorations.push(new lt(n.content.length+1,n.content.length+1+e[0].length,t,0)),n.content+=e[0],e=e.slice(1)}for(let n of e)r.push({content:n,decorations:t?[new lt(1,n.length+1,t,0)]:[]})}let a=this.editor.getModel().getLineContent(t.lineNumber);this.editor.getModel().getLineTokens(t.lineNumber);let o,s=0;for(let e of t.parts){let t=e.lines;o===void 0?(n.push({column:e.column,text:t[0],preview:e.preview}),t=t.slice(1)):i([a.substring(s,e.column-1)],void 0),t.length>0&&(i(t,`ghost-text`),o===void 0&&e.column<=a.length&&(o=e.column)),s=e.column-1}o!==void 0&&i([a.substring(s)],void 0),this.partsWidget.setParts(t.lineNumber,n,o===void 0?void 0:{column:o,length:a.length+1-o}),this.additionalLinesWidget.updateLines(t.lineNumber,r,t.additionalReservedLineCount),t.parts.some(e=>e.lines.length<0)?this.viewMoreContentWidget=this.renderViewMoreLines(new P(t.lineNumber,this.editor.getModel().getLineMaxColumn(t.lineNumber)),``,0):((e=this.viewMoreContentWidget)==null||e.dispose(),this.viewMoreContentWidget=void 0)}renderViewMoreLines(e,t,n){let r=this.editor.getOption(43),i=document.createElement(`div`);i.className=`suggest-preview-additional-widget`,xt.applyFontInfoSlow(i,r);let a=document.createElement(`span`);a.className=`content-spacer`,a.append(t),i.append(a);let o=document.createElement(`span`);o.className=`content-newline suggest-preview-text`,o.append(`  `),i.append(o);let s=new K,c=document.createElement(`div`);return c.className=`button suggest-preview-text`,c.append(`+${n} lines`),s.add(hi(c,`mousedown`,e=>{var t;(t=this.model)==null||t.setExpanded(!0),e.preventDefault(),this.editor.focus()})),i.append(c),new Xv(this.editor,e,i,s)}};Uv=Bv([Vv(2,H),Vv(3,zs)],Uv);var Wv=class{constructor(e,t,n,r){this.editor=e,this.codeEditorService=t,this.themeService=n,this.contextKeyService=r,this.decorationIds=[],this.disposableStore=new K}dispose(){this.clear(),this.disposableStore.dispose()}clear(){this.editor.deltaDecorations(this.decorationIds,[]),this.disposableStore.clear()}setParts(e,t,n){this.disposableStore.clear();let r=this.themeService.getColorTheme(),i=r.getColor(ho),a,o;i&&(a=String(i.rgba.a),o=O.Format.CSS.format(Gv(i)));let s=r.getColor(ii),c;s&&(c=`2px dashed ${s}`);let l=this.editor.getModel();if(!l)return;let{tabSize:u}=l.getOptions(),d=l.getLineContent(e)||``,f=0,p=``,m=[];n&&m.push({range:W.fromPositions(new P(e,n.column),new P(e,n.column+n.length)),options:{inlineClassName:`ghost-text-hidden`,description:`ghost-text-hidden`}});let h=this.contextKeyService.getContextKeyValue(`config.editor.useInjectedText`),ee=h===void 0?!0:!!h;this.decorationIds=this.editor.deltaDecorations(this.decorationIds,t.map(t=>{p+=d.substring(f,t.column-1),f=t.column-1;let n=ee?t.text:this.renderSingleLineText(t.text,p,u,!1),r=this.disposableStore.add(Yv(this.codeEditorService,`ghost-text`,`0-ghost-text-`,{after:{contentText:n,opacity:a,color:o,border:c,fontWeight:t.preview?`bold`:`normal`}}));return{range:W.fromPositions(new P(e,t.column)),options:ee?{description:`ghost-text`,after:{content:n,inlineClassName:t.preview?`ghost-text-decoration-preview`:`ghost-text-decoration`},showIfCollapsed:!0}:Object.assign({},r.resolve())}}).concat(m))}renderSingleLineText(e,t,n,r){let i=t+e,a=fn.visibleColumnsByColumns(i,n),o=``,s=t.length+1;for(let t of e){if(t===`	`){let e=a[s+1]-a[s];if(r){o+=``;for(let t=1;t<e;t++)o+=`\xA0`}else for(let t=0;t<e;t++)o+=`\xA0`}else t===` `?r?o+=``:o+=`\xA0`:o+=t;s+=1}return o}};Wv=Bv([Vv(1,po),Vv(2,Vi),Vv(3,D)],Wv);function Gv(e){let{r:t,b:n,g:r}=e.rgba;return new O(new kn(t,r,n,255))}var Kv=class{constructor(e,t){this.editor=e,this.languageIdCodec=t,this._viewZoneId=void 0}get viewZoneId(){return this._viewZoneId}dispose(){this.clear()}clear(){this.editor.changeViewZones(e=>{this._viewZoneId&&=(e.removeZone(this._viewZoneId),void 0)})}updateLines(e,t,n){let r=this.editor.getModel();if(!r)return;let{tabSize:i}=r.getOptions();this.editor.changeViewZones(r=>{this._viewZoneId&&=(r.removeZone(this._viewZoneId),void 0);let a=Math.max(t.length,n);if(a>0){let n=document.createElement(`div`);qv(n,i,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=r.addZone({afterLineNumber:e,heightInLines:a,domNode:n})}})}};function qv(e,t,n,r,i){let a=r.get(29),o=r.get(104),s=r.get(82),c=r.get(44),l=r.get(43),u=r.get(58),d=Ji(1e4);d.appendASCIIString(`<div class="suggest-preview-text">`);for(let e=0,r=n.length;e<r;e++){let r=n[e],f=r.content;d.appendASCIIString(`<div class="view-line`),d.appendASCIIString(`" style="top:`),d.appendASCIIString(String(e*u)),d.appendASCIIString(`px;width:1000000px;">`);let p=Li(f),m=Mo(f),h=Mr.createEmpty(f,i);jo(new vt(l.isMonospace&&!a,l.canUseHalfwidthRightwardsArrow,f,!1,p,m,0,h,r.decorations,t,0,l.spaceWidth,l.middotWidth,l.wsmiddotWidth,o,`none`,s,c!==Tn.OFF,null),d),d.appendASCIIString(`</div>`)}d.appendASCIIString(`</div>`),xt.applyFontInfoSlow(e,l);let f=d.build();e.innerHTML=Hv?Hv.createHTML(f):f}var Jv=0;function Yv(e,t,n,r){let i=n+ Jv++;return e.registerDecorationType(t,i,r),{dispose(){e.removeDecorationType(i)},resolve(){return e.resolveDecorationOptions(i,!0)}}}var Xv=class extends _{constructor(e,t,n,r){super(),this.editor=e,this.position=t,this.domNode=n,this.allowEditorOverflow=!1,this.suppressMouseDown=!1,this._register(r),this._register(ja(()=>{this.editor.removeContentWidget(this)})),this.editor.addContentWidget(this)}getId(){return`editor.widget.viewMoreLinesWidget`}getDomNode(){return this.domNode}getPosition(){return{position:this.position,preference:[0]}}};Ya((e,t)=>{let n=e.getColor(ho);if(n){let e=String(n.rgba.a),r=O.Format.CSS.format(Gv(n));t.addRule(`.monaco-editor .ghost-text-decoration { opacity: ${e} !important; color: ${r} !important; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { color: ${n.toString()} !important; }`),t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { opacity: ${e} !important; color: ${r} !important; }`)}let r=e.getColor(ii);r&&(t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 1px solid ${r}; }`),t.addRule(`.monaco-editor .ghost-text-decoration { border: 1px solid ${r}; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { border: 1px solid ${r}; }`))});var Zv=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Qv=function(e,t){return function(n,r){t(n,r,e)}},$v=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},ey=class e extends _{constructor(e,t){super(),this.editor=e,this.instantiationService=t,this.triggeredExplicitly=!1,this.activeController=this._register(new Un),this._register(this.editor.onDidChangeModel(()=>{this.updateModelController()})),this._register(this.editor.onDidChangeConfiguration(e=>{e.hasChanged(105)&&this.updateModelController(),e.hasChanged(54)&&this.updateModelController()})),this.updateModelController()}static get(t){return t.getContribution(e.ID)}get activeModel(){return this.activeController.value?.model}updateModelController(){let e=this.editor.getOption(105),t=this.editor.getOption(54);this.activeController.value=void 0,this.activeController.value=this.editor.hasModel()&&(e.preview||t.enabled||this.triggeredExplicitly)?this.instantiationService.createInstance(ny,this.editor):void 0}shouldShowHoverAt(e){return this.activeModel?.shouldShowHoverAt(e)||!1}shouldShowHoverAtViewZone(e){return(this.activeController.value?.widget)?.shouldShowHoverAtViewZone(e)||!1}trigger(){var e;this.triggeredExplicitly=!0,this.activeController.value||this.updateModelController(),(e=this.activeModel)==null||e.triggerInlineCompletion()}commit(){var e;(e=this.activeModel)==null||e.commitInlineCompletion()}hide(){var e;(e=this.activeModel)==null||e.hideInlineCompletion()}showNextInlineCompletion(){var e;(e=this.activeModel)==null||e.showNextInlineCompletion()}showPreviousInlineCompletion(){var e;(e=this.activeModel)==null||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){return $v(this,void 0,void 0,function*(){let e=yield this.activeModel?.hasMultipleInlineCompletions();return e===void 0?!1:e})}};ey.inlineSuggestionVisible=new k(`inlineSuggestionVisible`,!1,z(`inlineSuggestionVisible`,`Whether an inline suggestion is visible`)),ey.inlineSuggestionHasIndentation=new k(`inlineSuggestionHasIndentation`,!1,z(`inlineSuggestionHasIndentation`,`Whether the inline suggestion starts with whitespace`)),ey.inlineSuggestionHasIndentationLessThanTabSize=new k(`inlineSuggestionHasIndentationLessThanTabSize`,!0,z(`inlineSuggestionHasIndentationLessThanTabSize`,`Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab`)),ey.ID=`editor.contrib.ghostTextController`,ey=Zv([Qv(1,H)],ey);var ty=class{constructor(e){this.contextKeyService=e,this.inlineCompletionVisible=ey.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=ey.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=ey.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService)}},ny=class extends _{constructor(e,t,n){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=n,this.contextKeys=new ty(this.contextKeyService),this.model=this._register(this.instantiationService.createInstance(Rv,this.editor)),this.widget=this._register(this.instantiationService.createInstance(Uv,this.editor,this.model)),this._register(ja(()=>{this.contextKeys.inlineCompletionVisible.set(!1),this.contextKeys.inlineCompletionSuggestsIndentation.set(!1),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(!0)})),this._register(this.model.onDidChange(()=>{this.updateContextKeys()})),this.updateContextKeys()}updateContextKeys(){this.contextKeys.inlineCompletionVisible.set(this.model.activeInlineCompletionsModel?.ghostText!==void 0);let e=!1,t=!0,n=this.model.inlineCompletionsModel.ghostText;if(this.model.activeInlineCompletionsModel&&n&&n.parts.length>0){let{column:r,lines:i}=n.parts[0],a=i[0];if(r<=this.editor.getModel().getLineIndentColumn(n.lineNumber)){let n=Hr(a);n===-1&&(n=a.length-1),e=n>0;let r=this.editor.getModel().getOptions().tabSize;t=fn.visibleColumnFromColumn(a,n+1,r)<r}}this.contextKeys.inlineCompletionSuggestsIndentation.set(e),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(t)}};ny=Zv([Qv(1,H),Qv(2,D)],ny);var ry=ft.bindToContribution(ey.get);const iy=new ry({id:`editor.action.inlineSuggest.commit`,precondition:ey.inlineSuggestionVisible,handler(e){e.commit(),e.editor.focus()}});F(iy),ln.registerKeybindingRule({primary:2,weight:200,id:iy.id,when:w.and(iy.precondition,A.tabMovesFocus.toNegated(),ey.inlineSuggestionHasIndentationLessThanTabSize)}),F(new ry({id:`editor.action.inlineSuggest.hide`,precondition:ey.inlineSuggestionVisible,kbOpts:{weight:100,primary:9},handler(e){e.hide()}}));var ay=class e extends V{constructor(){super({id:e.ID,label:z(`action.inlineSuggest.showNext`,`Show Next Inline Suggestion`),alias:`Show Next Inline Suggestion`,precondition:w.and(A.writable,ey.inlineSuggestionVisible),kbOpts:{weight:100,primary:601}})}run(e,t){return $v(this,void 0,void 0,function*(){let e=ey.get(t);e&&(e.showNextInlineCompletion(),t.focus())})}};ay.ID=`editor.action.inlineSuggest.showNext`;var oy=class e extends V{constructor(){super({id:e.ID,label:z(`action.inlineSuggest.showPrevious`,`Show Previous Inline Suggestion`),alias:`Show Previous Inline Suggestion`,precondition:w.and(A.writable,ey.inlineSuggestionVisible),kbOpts:{weight:100,primary:599}})}run(e,t){return $v(this,void 0,void 0,function*(){let e=ey.get(t);e&&(e.showPreviousInlineCompletion(),t.focus())})}};oy.ID=`editor.action.inlineSuggest.showPrevious`;var sy=class extends V{constructor(){super({id:`editor.action.inlineSuggest.trigger`,label:z(`action.inlineSuggest.trigger`,`Trigger Inline Suggestion`),alias:`Trigger Inline Suggestion`,precondition:A.writable})}run(e,t){return $v(this,void 0,void 0,function*(){let e=ey.get(t);e&&e.trigger()})}};U(ey.ID,ey),o(sy),o(ay),o(oy);var cy=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ly=function(e,t){return function(n,r){t(n,r,e)}},uy=class{constructor(e,t,n){this.owner=e,this.range=t,this.controller=n}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}hasMultipleSuggestions(){return this.controller.hasMultipleInlineCompletions()}},dy=class{constructor(e,t,n,r,i,a,o,s){this._editor=e,this._hover=t,this._commandService=n,this._menuService=r,this._contextKeyService=i,this._modeService=a,this._openerService=o,this.accessibilityService=s}suggestHoverAnchor(e){let t=ey.get(this._editor);if(!t)return null;if(e.target.type===8){let n=e.target.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new up(1e3,this,W.fromPositions(n.positionBefore||n.position,n.positionBefore||n.position))}return e.target.type===7&&e.target.range&&t.shouldShowHoverAt(e.target.range)||e.target.type===6&&e.target.range&&e.target.detail&&e.target.detail.mightBeForeignElement&&t.shouldShowHoverAt(e.target.range)?new up(1e3,this,e.target.range):null}computeSync(e,t){let n=ey.get(this._editor);return n&&n.shouldShowHoverAt(e.range)?[new uy(this,e.range,n)]:[]}renderHoverParts(e,t,n){let r=new K,i=e[0];this.accessibilityService.isScreenReaderOptimized()&&this.renderScreenReaderText(i,t,r);let a=r.add(this._menuService.createMenu(N.InlineCompletionsActions,this._contextKeyService)),o=n.addAction({label:z(`showNextInlineSuggestion`,`Next`),commandId:ay.ID,run:()=>this._commandService.executeCommand(ay.ID)}),s=n.addAction({label:z(`showPreviousInlineSuggestion`,`Previous`),commandId:oy.ID,run:()=>this._commandService.executeCommand(oy.ID)});n.addAction({label:z(`acceptInlineSuggestion`,`Accept`),commandId:iy.id,run:()=>this._commandService.executeCommand(iy.id)});let c=[o,s];for(let e of c)e.setEnabled(!1);i.hasMultipleSuggestions().then(e=>{for(let t of c)t.setEnabled(e)});for(let[e,t]of a.getActions())for(let e of t)e instanceof Ba&&n.addAction({label:e.label,commandId:e.item.id,run:()=>this._commandService.executeCommand(e.item.id)});return r}renderScreenReaderText(e,t,n){let r=G,i=r(`div.hover-row.markdown-hover`),a=q(i,r(`div.hover-contents`)),o=n.add(new ym({editor:this._editor},this._modeService,this._openerService)),s=e=>{n.add(o.onDidRenderAsync(()=>{a.className=`hover-contents code-hover-contents`,this._hover.onContentsChanged()}));let t=z(`inlineSuggestionFollows`,`Suggestion:`),r=n.add(o.render(new ue().appendText(t).appendCodeblock(`text`,e)));a.replaceChildren(r.element)},c=e.controller.activeModel?.inlineCompletionsModel?.ghostText;if(c){let e=this._editor.getModel().getLineContent(c.lineNumber);s(c.renderForScreenReader(e))}t.appendChild(i)}};dy=cy([ly(2,Hs),ly(3,Ko),ly(4,D),ly(5,zs),ly(6,Qi),ly(7,mn)],dy);var fy=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},py=function(e,t){return function(n,r){t(n,r,e)}},my=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},hy=G,gy=class extends _{constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=hy(`div.hover-row.status-bar`),this.actionsElement=q(this.hoverElement,hy(`div.actions`))}get hasContent(){return this._hasContent}addAction(e){let t=this._keybindingService.lookupKeybinding(e.commandId),n=t?t.getLabel():null;return this._hasContent=!0,this._register(qf.render(this.actionsElement,e,n))}append(e){let t=q(this.actionsElement,e);return this._hasContent=!0,t}};gy=fy([py(0,Oo)],gy);var _y=class e{constructor(e,t){this._participants=t,this._editor=e,this._result=[],this._anchor=null}setAnchor(e){this._anchor=e,this._result=[]}clearResult(){this._result=[]}static _getLineDecorations(e,t){if(t.type!==1)return[];let n=e.getModel(),r=t.range.startLineNumber,i=n.getLineMaxColumn(r);return e.getLineDecorations(r).filter(e=>{if(e.options.isWholeLine)return!0;let n=e.range.startLineNumber===r?e.range.startColumn:1,a=e.range.endLineNumber===r?e.range.endColumn:i;return!(n>t.range.startColumn||t.range.endColumn>a)})}computeAsync(t){return my(this,void 0,void 0,function*(){let n=this._anchor;if(!this._editor.hasModel()||!n)return Promise.resolve([]);let r=e._getLineDecorations(this._editor,n);return no(yield Promise.all(this._participants.map(e=>this._computeAsync(e,r,n,t))))})}_computeAsync(e,t,n,r){return my(this,void 0,void 0,function*(){return e.computeAsync?e.computeAsync(n,t,r):[]})}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];let t=e._getLineDecorations(this._editor,this._anchor),n=[];for(let e of this._participants)n=n.concat(e.computeSync(this._anchor,t));return r(n)}onResult(e,t){t?this._result=e.concat(this._result):this._result=this._result.concat(e)}getResult(){return this._result.slice(0)}getResultWithLoadingMessage(){if(this._anchor){for(let e of this._participants)if(e.createLoadingMessage){let t=e.createLoadingMessage(this._anchor);if(t)return this._result.slice(0).concat([t])}}return this._result.slice(0)}},vy=class e extends ec{constructor(e,t,r,i,a){super(),this._hoverVisibleKey=t,this._keybindingService=i,this._contextKeyService=a,this.allowEditorOverflow=!0,this._participants=[r.createInstance(sp,e,this),r.createInstance(Dm,e,this),r.createInstance(dy,e,this),r.createInstance(uh,e,this)],this._editor=e,this._isVisible=!1,this._stoleFocus=!1,this._renderDisposable=null,this._hover=this._register(new Kf),this._hover.containerDomNode.classList.toggle(`hidden`,!this._isVisible),this.onkeydown(this._hover.containerDomNode,e=>{e.equals(9)&&this.hide()}),this._register(this._editor.onDidChangeConfiguration(e=>{e.hasChanged(43)&&this._updateFont()})),this._editor.onDidLayoutChange(()=>this.layout()),this.layout(),this._editor.addContentWidget(this),this._showAtPosition=null,this._showAtRange=null,this._stoleFocus=!1,this._messages=[],this._lastAnchor=null,this._computer=new _y(this._editor,this._participants),this._highlightDecorations=[],this._isChangingDecorations=!1,this._shouldFocus=!1,this._colorPicker=null,this._preferAbove=this._editor.getOption(52).above,this._hoverOperation=new cp(this._computer,e=>this._withResult(e,!0),null,e=>this._withResult(e,!1),this._editor.getOption(52).delay),this._register(hi(this.getDomNode(),Do.FOCUS,()=>{this._colorPicker&&this.getDomNode().classList.add(`colorpicker-hover`)})),this._register(hi(this.getDomNode(),Do.BLUR,()=>{this.getDomNode().classList.remove(`colorpicker-hover`)})),this._register(e.onDidChangeConfiguration(()=>{this._hoverOperation.setHoverTime(this._editor.getOption(52).delay),this._preferAbove=this._editor.getOption(52).above})),this._register(n.onDidChange(()=>{this._isVisible&&this._lastAnchor&&this._messages.length>0&&(this._hover.contentsDomNode.textContent=``,this._renderMessages(this._lastAnchor,this._messages))}))}dispose(){this._hoverOperation.cancel(),this._editor.removeContentWidget(this),super.dispose()}getId(){return e.ID}getDomNode(){return this._hover.containerDomNode}_shouldShowAt(e){let t=e.target.type;if(t===6)return!0;if(t===7){let t=this._editor.getOption(43).typicalHalfwidthCharacterWidth/2,n=e.target.detail;if(n&&!n.isAfterLines&&typeof n.horizontalDistanceToText==`number`&&n.horizontalDistanceToText<t)return!0}return!1}maybeShowAt(e){let t=[];for(let n of this._participants)if(typeof n.suggestHoverAnchor==`function`){let r=n.suggestHoverAnchor(e);r&&t.push(r)}if(this._shouldShowAt(e)&&e.target.range){let n=[...e.target.element?.classList.values()||[]].find(e=>e.startsWith(`ced-colorBox`))&&e.target.range.endColumn-e.target.range.startColumn===1?new W(e.target.range.startLineNumber,e.target.range.startColumn+1,e.target.range.endLineNumber,e.target.range.endColumn+1):e.target.range;t.push(new lp(0,n))}return t.length===0?!1:(t.sort((e,t)=>t.priority-e.priority),this._startShowingAt(t[0],0,!1),!0)}_showAt(e,t,n){this._showAtPosition=e,this._showAtRange=t,this._hoverVisibleKey.set(!0),this._isVisible=!0,this._hover.containerDomNode.classList.toggle(`hidden`,!this._isVisible),this._editor.layoutContentWidget(this),this._editor.render(),this._stoleFocus=n,n&&this._hover.containerDomNode.focus()}getPosition(){if(this._isVisible){let e=this._preferAbove;return!e&&this._contextKeyService.getContextKeyValue(Q.Visible.key)&&(e=!0),{position:this._showAtPosition,range:this._showAtRange,preference:e?[1,2]:[2,1]}}return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName(`code`)).forEach(e=>this._editor.applyFontInfo(e))}_updateContents(e){this._hover.contentsDomNode.textContent=``,this._hover.contentsDomNode.appendChild(e),this._updateFont(),this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}layout(){let e=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:t,lineHeight:n}=this._editor.getOption(43);this._hover.contentsDomNode.style.fontSize=`${t}px`,this._hover.contentsDomNode.style.lineHeight=`${n/t}`,this._hover.contentsDomNode.style.maxHeight=`${e}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(this._editor.getLayoutInfo().width*.66,500)}px`}onModelDecorationsChanged(){this._isChangingDecorations||this._isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._colorPicker||this._hoverOperation.start(0))}startShowingAtRange(e,t,n){this._startShowingAt(new lp(0,e),t,n)}_startShowingAt(e,t,n){if(!(this._lastAnchor&&this._lastAnchor.equals(e))){if(this._hoverOperation.cancel(),this._isVisible)if(!this._showAtPosition||!this._lastAnchor||!e.canAdoptVisibleHover(this._lastAnchor,this._showAtPosition))this.hide();else{let t=this._messages.filter(t=>t.isValidForHoverAnchor(e));if(t.length===0)this.hide();else if(t.length===this._messages.length)return;else this._renderMessages(e,t)}this._lastAnchor=e,this._computer.setAnchor(e),this._shouldFocus=n,this._hoverOperation.start(t)}}hide(){this._lastAnchor=null,this._hoverOperation.cancel(),this._isVisible&&(setTimeout(()=>{this._isVisible||this._hoverVisibleKey.set(!1)},0),this._isVisible=!1,this._hover.containerDomNode.classList.toggle(`hidden`,!this._isVisible),this._editor.layoutContentWidget(this),this._stoleFocus&&this._editor.focus()),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,[]),this._isChangingDecorations=!1,this._renderDisposable&&=(this._renderDisposable.dispose(),null),this._colorPicker=null}isColorPickerVisible(){return!!this._colorPicker}setColorPicker(e){this._colorPicker=e}onContentsChanged(){this._hover.onContentsChanged()}_withResult(e,t){this._messages=e,this._lastAnchor&&this._messages.length>0?this._renderMessages(this._lastAnchor,this._messages):t&&this.hide()}_renderMessages(t,n){this._renderDisposable&&=(this._renderDisposable.dispose(),null),this._colorPicker=null;let r=1073741824,i=n[0].range,a=null,o=document.createDocumentFragment(),s=new K,c=new Map;for(let e of n)r=Math.min(r,e.range.startColumn),i=W.plusRange(i,e.range),e.forceShowAtRange&&(a=e.range),c.has(e.owner)||c.set(e.owner,[]),c.get(e.owner).push(e);let l=s.add(new gy(this._keybindingService));for(let[e,t]of c)s.add(e.renderHoverParts(t,o,l));l.hasContent&&o.appendChild(l.hoverElement),this._renderDisposable=s,o.hasChildNodes()&&(a?this._showAt(a.getStartPosition(),a,this._shouldFocus):this._showAt(new P(t.range.startLineNumber,r),i,this._shouldFocus),this._updateContents(o)),this._colorPicker&&this._colorPicker.layout(),this._isChangingDecorations=!0,this._highlightDecorations=this._editor.deltaDecorations(this._highlightDecorations,i?[{range:i,options:e._DECORATION_OPTIONS}]:[]),this._isChangingDecorations=!1}};vy.ID=`editor.contrib.modesContentHoverWidget`,vy._DECORATION_OPTIONS=I.register({description:`content-hover-highlight`,className:`hoverHighlight`}),vy=fy([py(2,H),py(3,Oo),py(4,D)],vy);var yy=G,by=class{constructor(e){this._editor=e,this._lineNumber=-1,this._result=[]}setLineNumber(e){this._lineNumber=e,this._result=[]}clearResult(){this._result=[]}computeSync(){let e=e=>({value:e}),t=this._editor.getLineDecorations(this._lineNumber),n=[];if(!t)return n;for(let r of t){if(!r.options.glyphMarginClassName)continue;let t=r.options.glyphMarginHoverMessage;!t||Ss(t)||n.push(...Br(t).map(e))}return n}onResult(e,t){this._result=this._result.concat(e)}getResult(){return this._result}getResultWithLoadingMessage(){return this.getResult()}},xy=class e extends ec{constructor(e,t,n=Xr){super(),this._renderDisposeables=this._register(new K),this._editor=e,this._isVisible=!1,this._messages=[],this._lastLineNumber=-1,this._hover=this._register(new Kf),this._hover.containerDomNode.classList.toggle(`hidden`,!this._isVisible),this._markdownRenderer=this._register(new ym({editor:this._editor},t,n)),this._computer=new by(this._editor),this._hoverOperation=new cp(this._computer,e=>this._withResult(e),void 0,e=>this._withResult(e),300),this._register(this._editor.onDidChangeConfiguration(e=>{e.hasChanged(43)&&this._updateFont()})),this._editor.addOverlayWidget(this)}dispose(){this._hoverOperation.cancel(),this._editor.removeOverlayWidget(this),super.dispose()}getId(){return e.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle(`hidden`,!this._isVisible));let t=this._editor.getLayoutInfo(),n=this._editor.getTopForLineNumber(e),r=this._editor.getScrollTop(),i=this._editor.getOption(58),a=this._hover.containerDomNode.clientHeight,o=n-r-(a-i)/2;this._hover.containerDomNode.style.left=`${t.glyphMarginLeft+t.glyphMarginWidth}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(o),0)}px`}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName(`code`)).forEach(e=>this._editor.applyFontInfo(e))}_updateContents(e){this._hover.contentsDomNode.textContent=``,this._hover.contentsDomNode.appendChild(e),this._updateFont()}onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._computer.clearResult(),this._hoverOperation.start(0))}startShowingAt(e){this._lastLineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._lastLineNumber=e,this._computer.setLineNumber(e),this._hoverOperation.start(0))}hide(){this._lastLineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle(`hidden`,!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._lastLineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();let n=document.createDocumentFragment();for(let e of t){let t=yy(`div.hover-row.markdown-hover`),r=q(t,yy(`div.hover-contents`)),i=this._renderDisposeables.add(this._markdownRenderer.render(e.value));r.appendChild(i.element),n.appendChild(t)}this._updateContents(n),this._showAt(e)}};xy.ID=`editor.contrib.modesGlyphHoverWidget`;var Sy=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Cy=function(e,t){return function(n,r){t(n,r,e)}},wy=class e{constructor(e,t,n,r,i){this._editor=e,this._instantiationService=t,this._openerService=n,this._modeService=r,this._toUnhook=new K,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._hookEvents(),this._didChangeConfigurationHandler=this._editor.onDidChangeConfiguration(e=>{e.hasChanged(52)&&(this._unhookEvents(),this._hookEvents())}),this._hoverVisibleKey=A.hoverVisible.bindTo(i)}static get(t){return t.getContribution(e.ID)}_hookEvents(){let e=()=>this._hideWidgets(),t=this._editor.getOption(52);this._isHoverEnabled=t.enabled,this._isHoverSticky=t.sticky,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown(e=>this._onEditorMouseDown(e))),this._toUnhook.add(this._editor.onMouseUp(e=>this._onEditorMouseUp(e))),this._toUnhook.add(this._editor.onMouseMove(e=>this._onEditorMouseMove(e))),this._toUnhook.add(this._editor.onKeyDown(e=>this._onKeyDown(e))),this._toUnhook.add(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged()))):(this._toUnhook.add(this._editor.onMouseMove(e=>this._onEditorMouseMove(e))),this._toUnhook.add(this._editor.onKeyDown(e=>this._onKeyDown(e)))),this._toUnhook.add(this._editor.onMouseLeave(e)),this._toUnhook.add(this._editor.onDidChangeModel(e)),this._toUnhook.add(this._editor.onDidScrollChange(e=>this._onEditorScrollChanged(e)))}_unhookEvents(){this._toUnhook.clear()}_onModelDecorationsChanged(){var e,t;(e=this._contentWidget)==null||e.onModelDecorationsChanged(),(t=this._glyphWidget)==null||t.onModelDecorationsChanged()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._isMouseDown=!0;let t=e.target.type;if(t===9&&e.target.detail===vy.ID){this._hoverClicked=!0;return}t===12&&e.target.detail===xy.ID||(t!==12&&e.target.detail!==xy.ID&&(this._hoverClicked=!1),this._hideWidgets())}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseMove(e){var t,n;let r=e.target.type;if(!(this._isMouseDown&&this._hoverClicked)&&!(this._isHoverSticky&&r===9&&e.target.detail===vy.ID)&&!(this._isHoverSticky&&!e.event.browserEvent.view?.getSelection()?.isCollapsed)&&!(!this._isHoverSticky&&r===9&&e.target.detail===vy.ID&&this._contentWidget?.isColorPickerVisible())&&!(this._isHoverSticky&&r===12&&e.target.detail===xy.ID)){if(!this._isHoverEnabled){this._hideWidgets();return}if(this._getOrCreateContentWidget().maybeShowAt(e)){(t=this._glyphWidget)==null||t.hide();return}if(r===2&&e.target.position){(n=this._contentWidget)==null||n.hide(),this._glyphWidget||=new xy(this._editor,this._modeService,this._openerService),this._glyphWidget.startShowingAt(e.target.position.lineNumber);return}this._hideWidgets()}}_onKeyDown(e){e.keyCode!==5&&e.keyCode!==6&&e.keyCode!==57&&e.keyCode!==4&&this._hideWidgets()}_hideWidgets(){var e,t;this._isMouseDown&&this._hoverClicked&&this._contentWidget?.isColorPickerVisible()||(this._hoverClicked=!1,(e=this._glyphWidget)==null||e.hide(),(t=this._contentWidget)==null||t.hide())}_getOrCreateContentWidget(){return this._contentWidget||=this._instantiationService.createInstance(vy,this._editor,this._hoverVisibleKey),this._contentWidget}isColorPickerVisible(){return this._contentWidget?.isColorPickerVisible()||!1}showContentHover(e,t,n){this._getOrCreateContentWidget().startShowingAtRange(e,t,n)}dispose(){var e,t;this._unhookEvents(),this._toUnhook.dispose(),this._didChangeConfigurationHandler.dispose(),(e=this._glyphWidget)==null||e.dispose(),(t=this._contentWidget)==null||t.dispose()}};wy.ID=`editor.contrib.hover`,wy=Sy([Cy(1,H),Cy(2,Qi),Cy(3,zs),Cy(4,D)],wy);var Ty=class extends V{constructor(){super({id:`editor.action.showHover`,label:z({key:`showHover`,comment:[`Label for action that will trigger the showing of a hover in the editor.`,`This allows for users to show the hover without using the mouse.`]},`Show Hover`),alias:`Show Hover`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2087),weight:100}})}run(e,t){if(!t.hasModel())return;let n=wy.get(t);if(!n)return;let r=t.getPosition(),i=new W(r.lineNumber,r.column,r.lineNumber,r.column),a=t.getOption(2)===2;n.showContentHover(i,1,a)}},Ey=class extends V{constructor(){super({id:`editor.action.showDefinitionPreviewHover`,label:z({key:`showDefinitionPreviewHover`,comment:[`Label for action that will trigger the showing of definition preview hover in the editor.`,`This allows for users to show the definition preview hover without using the mouse.`]},`Show Definition Preview Hover`),alias:`Show Definition Preview Hover`,precondition:void 0})}run(e,t){let n=wy.get(t);if(!n)return;let r=t.getPosition();if(!r)return;let i=new W(r.lineNumber,r.column,r.lineNumber,r.column);Wf.get(t).startFindDefinitionFromCursor(r).then(()=>{n.showContentHover(i,1,!0)})}};U(wy.ID,wy),o(Ty),o(Ey),Ya((e,t)=>{let n=e.getColor(Ts);n&&t.addRule(`.monaco-editor .hoverHighlight { background-color: ${n}; }`);let r=e.getColor(Ps);r&&t.addRule(`.monaco-editor .monaco-hover { background-color: ${r}; }`);let i=e.getColor(In);i&&(t.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${i}; }`),t.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${i.transparent(.5)}; }`),t.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${i.transparent(.5)}; }`));let a=e.getColor(h);a&&t.addRule(`.monaco-editor .monaco-hover a { color: ${a}; }`);let o=e.getColor(Fa);o&&t.addRule(`.monaco-editor .monaco-hover a:hover { color: ${o}; }`);let s=e.getColor(pe);s&&t.addRule(`.monaco-editor .monaco-hover { color: ${s}; }`);let c=e.getColor(Gn);c&&t.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${c}; }`);let l=e.getColor(nn);l&&t.addRule(`.monaco-editor .monaco-hover code { background-color: ${l}; }`)});var Dy=class extends _{constructor(e){super(),this._editor=e,this._register(e.onMouseDown(e=>this.onMouseDown(e)))}dispose(){super.dispose()}onMouseDown(e){if(e.target.type!==6||![...e.target.element?.classList.values()||[]].find(e=>e.startsWith(`ced-colorBox`))||!e.target.range)return;let t=this._editor.getContribution(wy.ID);if(!t.isColorPickerVisible()){let n=new W(e.target.range.startLineNumber,e.target.range.startColumn+1,e.target.range.endLineNumber,e.target.range.endColumn+1);t.showContentHover(n,0,!1)}}};Dy.ID=`editor.contrib.colorContribution`,U(Dy.ID,Dy);var Oy=class e{constructor(e,t){this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,n){if(n<0)return!1;let r=t.length,i=e.length;if(n+r>i)return!1;for(let i=0;i<r;i++){let r=e.charCodeAt(n+i),a=t.charCodeAt(i);if(r!==a&&!(r>=65&&r<=90&&r+32===a)&&!(a>=65&&a<=90&&a+32===r))return!1}return!0}_createOperationsForBlockComment(t,n,r,i,a,o){let s=t.startLineNumber,c=t.startColumn,l=t.endLineNumber,u=t.endColumn,d=a.getLineContent(s),f=a.getLineContent(l),p=d.lastIndexOf(n,c-1+n.length),m=f.indexOf(r,u-1-r.length);if(p!==-1&&m!==-1)if(s===l)d.substring(p+n.length,m).indexOf(r)>=0&&(p=-1,m=-1);else{let e=d.substring(p+n.length),t=f.substring(0,m);(e.indexOf(r)>=0||t.indexOf(r)>=0)&&(p=-1,m=-1)}let h;p!==-1&&m!==-1?(i&&p+n.length<d.length&&d.charCodeAt(p+n.length)===32&&(n+=` `),i&&m>0&&f.charCodeAt(m-1)===32&&(r=` `+r,--m),h=e._createRemoveBlockCommentOperations(new W(s,p+n.length+1,l,m+1),n,r)):(h=e._createAddBlockCommentOperations(t,n,r,this._insertSpace),this._usedEndToken=h.length===1?r:null);for(let e of h)o.addTrackedEditOperation(e.range,e.text)}static _createRemoveBlockCommentOperations(e,t,n){let r=[];return W.isEmpty(e)?r.push(En.delete(new W(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+n.length))):(r.push(En.delete(new W(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),r.push(En.delete(new W(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+n.length)))),r}static _createAddBlockCommentOperations(e,t,n,r){let i=[];return W.isEmpty(e)?i.push(En.replace(new W(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+`  `+n)):(i.push(En.insert(new P(e.startLineNumber,e.startColumn),t+(r?` `:``))),i.push(En.insert(new P(e.endLineNumber,e.endColumn),(r?` `:``)+n))),i}getEditOperations(e,t){let n=this._selection.startLineNumber,r=this._selection.startColumn;e.tokenizeIfCheap(n);let i=e.getLanguageIdAtPosition(n,r),a=Ei.getComments(i);!a||!a.blockCommentStartToken||!a.blockCommentEndToken||this._createOperationsForBlockComment(this._selection,a.blockCommentStartToken,a.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){let n=t.getInverseEditOperations();if(n.length===2){let e=n[0],t=n[1];return new R(e.range.endLineNumber,e.range.endColumn,t.range.startLineNumber,t.range.startColumn)}else{let e=n[0].range,t=this._usedEndToken?-this._usedEndToken.length-1:0;return new R(e.endLineNumber,e.endColumn+t,e.endLineNumber,e.endColumn+t)}}},ky=class e{constructor(e,t,n,r,i,a){this._selection=e,this._tabSize=t,this._type=n,this._insertSpace=r,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=i,this._ignoreFirstLine=a||!1}static _gatherPreflightCommentStrings(e,t,n){e.tokenizeIfCheap(t);let r=e.getLanguageIdAtPosition(t,1),i=Ei.getComments(r),a=i?i.lineCommentToken:null;if(!a)return null;let o=[];for(let e=0,r=n-t+1;e<r;e++)o[e]={ignore:!1,commentStr:a,commentStrOffset:0,commentStrLength:a.length};return o}static _analyzeLines(e,t,n,r,i,a,o){let s=!0,c;c=e===0?!0:e!==1;for(let l=0,u=r.length;l<u;l++){let u=r[l],d=i+l;if(d===i&&o){u.ignore=!0;continue}let f=n.getLineContent(d),p=Hr(f);if(p===-1){u.ignore=a,u.commentStrOffset=f.length;continue}if(s=!1,u.ignore=!1,u.commentStrOffset=p,c&&!Oy._haystackHasNeedleAtOffset(f,u.commentStr,p)&&(e===0?c=!1:e===1||(u.ignore=!0)),c&&t){let e=p+u.commentStrLength;e<f.length&&f.charCodeAt(e)===32&&(u.commentStrLength+=1)}}if(e===0&&s){c=!1;for(let e=0,t=r.length;e<t;e++)r[e].ignore=!1}return{supported:!0,shouldRemoveComments:c,lines:r}}static _gatherPreflightData(t,n,r,i,a,o,s){let c=e._gatherPreflightCommentStrings(r,i,a);return c===null?{supported:!1}:e._analyzeLines(t,n,r,c,i,o,s)}_executeLineComments(t,n,r,i){let a;r.shouldRemoveComments?a=e._createRemoveLineCommentsOperations(r.lines,i.startLineNumber):(e._normalizeInsertionPoint(t,r.lines,i.startLineNumber,this._tabSize),a=this._createAddLineCommentsOperations(r.lines,i.startLineNumber));let o=new P(i.positionLineNumber,i.positionColumn);for(let e=0,r=a.length;e<r;e++)n.addEditOperation(a[e].range,a[e].text),W.isEmpty(a[e].range)&&W.getStartPosition(a[e].range).equals(o)&&t.getLineContent(o.lineNumber).length+1===o.column&&(this._deltaColumn=(a[e].text||``).length);this._selectionId=n.trackSelection(i)}_attemptRemoveBlockComment(e,t,n,r){let i=t.startLineNumber,a=t.endLineNumber,o=r.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn),s=e.getLineContent(i).lastIndexOf(n,o-1),c=e.getLineContent(a).indexOf(r,t.endColumn-1-n.length);return s!==-1&&c===-1&&(c=e.getLineContent(i).indexOf(r,s+n.length),a=i),s===-1&&c!==-1&&(s=e.getLineContent(a).lastIndexOf(n,c),i=a),t.isEmpty()&&(s===-1||c===-1)&&(s=e.getLineContent(i).indexOf(n),s!==-1&&(c=e.getLineContent(i).indexOf(r,s+n.length))),s!==-1&&e.getLineContent(i).charCodeAt(s+n.length)===32&&(n+=` `),c!==-1&&e.getLineContent(a).charCodeAt(c-1)===32&&(r=` `+r,--c),s!==-1&&c!==-1?Oy._createRemoveBlockCommentOperations(new W(i,s+n.length+1,a,c+1),n,r):null}_executeBlockComment(e,t,n){e.tokenizeIfCheap(n.startLineNumber);let r=e.getLanguageIdAtPosition(n.startLineNumber,1),i=Ei.getComments(r);if(!i||!i.blockCommentStartToken||!i.blockCommentEndToken)return;let a=i.blockCommentStartToken,o=i.blockCommentEndToken,s=this._attemptRemoveBlockComment(e,n,a,o);if(!s){if(n.isEmpty()){let t=e.getLineContent(n.startLineNumber),r=Hr(t);r===-1&&(r=t.length),s=Oy._createAddBlockCommentOperations(new W(n.startLineNumber,r+1,n.startLineNumber,t.length+1),a,o,this._insertSpace)}else s=Oy._createAddBlockCommentOperations(new W(n.startLineNumber,e.getLineFirstNonWhitespaceColumn(n.startLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),a,o,this._insertSpace);s.length===1&&(this._deltaColumn=a.length+1)}this._selectionId=t.trackSelection(n);for(let e of s)t.addEditOperation(e.range,e.text)}getEditOperations(t,n){let r=this._selection;if(this._moveEndPositionDown=!1,r.startLineNumber===r.endLineNumber&&this._ignoreFirstLine){n.addEditOperation(new W(r.startLineNumber,t.getLineMaxColumn(r.startLineNumber),r.startLineNumber+1,1),r.startLineNumber===t.getLineCount()?``:`
`),this._selectionId=n.trackSelection(r);return}r.startLineNumber<r.endLineNumber&&r.endColumn===1&&(this._moveEndPositionDown=!0,r=r.setEndPosition(r.endLineNumber-1,t.getLineMaxColumn(r.endLineNumber-1)));let i=e._gatherPreflightData(this._type,this._insertSpace,t,r.startLineNumber,r.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine);return i.supported?this._executeLineComments(t,n,i,r):this._executeBlockComment(t,n,r)}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(n=n.setEndPosition(n.endLineNumber+1,1)),new R(n.selectionStartLineNumber,n.selectionStartColumn+this._deltaColumn,n.positionLineNumber,n.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){let n=[];for(let r=0,i=e.length;r<i;r++){let i=e[r];i.ignore||n.push(En.delete(new W(t+r,i.commentStrOffset+1,t+r,i.commentStrOffset+i.commentStrLength+1)))}return n}_createAddLineCommentsOperations(e,t){let n=[],r=this._insertSpace?` `:``;for(let i=0,a=e.length;i<a;i++){let a=e[i];a.ignore||n.push(En.insert(new P(t+i,a.commentStrOffset+1),a.commentStr+r))}return n}static nextVisibleColumn(e,t,n,r){return n?e+(t-e%t):e+r}static _normalizeInsertionPoint(t,n,r,i){let a=1073741824,o,s;for(let o=0,s=n.length;o<s;o++){if(n[o].ignore)continue;let s=t.getLineContent(r+o),c=0;for(let t=0,r=n[o].commentStrOffset;c<a&&t<r;t++)c=e.nextVisibleColumn(c,i,s.charCodeAt(t)===9,1);c<a&&(a=c)}a=Math.floor(a/i)*i;for(let c=0,l=n.length;c<l;c++){if(n[c].ignore)continue;let l=t.getLineContent(r+c),u=0;for(o=0,s=n[c].commentStrOffset;u<a&&o<s;o++)u=e.nextVisibleColumn(u,i,l.charCodeAt(o)===9,1);u>a?n[c].commentStrOffset=o-1:n[c].commentStrOffset=o}}},Ay=class extends V{constructor(e,t){super(t),this._type=e}run(e,t){if(!t.hasModel())return;let n=t.getModel(),r=[],i=n.getOptions(),a=t.getOption(19),o=t.getSelections().map((e,t)=>({selection:e,index:t,ignoreFirstLine:!1}));o.sort((e,t)=>W.compareRangesUsingStarts(e.selection,t.selection));let s=o[0];for(let e=1;e<o.length;e++){let t=o[e];s.selection.endLineNumber===t.selection.startLineNumber&&(s.index<t.index?t.ignoreFirstLine=!0:(s.ignoreFirstLine=!0,s=t))}for(let e of o)r.push(new ky(e.selection,i.tabSize,this._type,a.insertSpace,a.ignoreEmptyLines,e.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}},jy=class extends Ay{constructor(){super(0,{id:`editor.action.commentLine`,label:z(`comment.line`,`Toggle Line Comment`),alias:`Toggle Line Comment`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:2133,weight:100},menuOpts:{menuId:N.MenubarEditMenu,group:`5_insert`,title:z({key:`miToggleLineComment`,comment:[`&& denotes a mnemonic`]},`&&Toggle Line Comment`),order:1}})}},My=class extends Ay{constructor(){super(1,{id:`editor.action.addCommentLine`,label:z(`comment.line.add`,`Add Line Comment`),alias:`Add Line Comment`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2081),weight:100}})}},Ny=class extends Ay{constructor(){super(2,{id:`editor.action.removeCommentLine`,label:z(`comment.line.remove`,`Remove Line Comment`),alias:`Remove Line Comment`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2099),weight:100}})}},Py=class extends V{constructor(){super({id:`editor.action.blockComment`,label:z(`comment.block`,`Toggle Block Comment`),alias:`Toggle Block Comment`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:N.MenubarEditMenu,group:`5_insert`,title:z({key:`miToggleBlockComment`,comment:[`&& denotes a mnemonic`]},`Toggle &&Block Comment`),order:2}})}run(e,t){if(!t.hasModel())return;let n=t.getOption(19),r=[],i=t.getSelections();for(let e of i)r.push(new Oy(e,n.insertSpace));t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}};o(jy),o(My),o(Ny),o(Py);var Fy=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Iy=function(e,t){return function(n,r){t(n,r,e)}},Ly=class e{constructor(e,t,n,r,i,a){this._contextMenuService=t,this._contextViewService=n,this._contextKeyService=r,this._keybindingService=i,this._menuService=a,this._toDispose=new K,this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.add(this._editor.onContextMenu(e=>this._onContextMenu(e))),this._toDispose.add(this._editor.onMouseWheel(e=>{if(this._contextMenuIsBeingShownCount>0){let t=this._contextViewService.getContextViewElement(),n=e.srcElement;n.shadowRoot&&Ia(t)===n.shadowRoot||this._contextViewService.hideContextView()}})),this._toDispose.add(this._editor.onKeyDown(e=>{e.keyCode===58&&(e.preventDefault(),e.stopPropagation(),this.showContextMenu())}))}static get(t){return t.getContribution(e.ID)}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(20)){this._editor.focus(),e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position);return}if(e.target.type===12||(e.event.preventDefault(),e.event.stopPropagation(),e.target.type!==6&&e.target.type!==7&&e.target.type!==1))return;if(this._editor.focus(),e.target.position){let t=!1;for(let n of this._editor.getSelections())if(n.containsPosition(e.target.position)){t=!0;break}t||this._editor.setPosition(e.target.position)}let t=null;e.target.type!==1&&(t={x:e.event.posx-1,width:2,y:e.event.posy-1,height:2}),this.showContextMenu(t)}showContextMenu(e){if(!this._editor.getOption(20)||!this._editor.hasModel())return;if(!this._contextMenuService){this._editor.focus();return}let t=this._getMenuActions(this._editor.getModel(),this._editor.isSimpleWidget?N.SimpleEditorContext:N.EditorContext);t.length>0&&this._doShowContextMenu(t,e)}_getMenuActions(e,t){let n=[],r=this._menuService.createMenu(t,this._contextKeyService),i=r.getActions({arg:e.uri});r.dispose();for(let t of i){let[,r]=t,i=0;for(let t of r)if(t instanceof Di){let r=this._getMenuActions(e,t.item.submenu);r.length>0&&(n.push(new di(t.id,t.label,r)),i++)}else n.push(t),i++;i&&n.push(new Bs)}return n.length&&n.pop(),n}_doShowContextMenu(e,t=null){if(!this._editor.hasModel())return;let n=this._editor.getOption(52);if(this._editor.updateOptions({hover:{enabled:!1}}),!t){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();let e=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),n=rn(this._editor.getDomNode());t={x:n.left+e.left,y:n.top+e.top+e.height}}let r=this._editor.getOption(113)&&!sr;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:r?this._editor.getDomNode():void 0,getAnchor:()=>t,getActions:()=>e,getActionViewItem:e=>{let t=this._keybindingFor(e);if(t)return new ge(e,e,{label:!0,keybinding:t.getLabel(),isMenu:!0});let n=e;return typeof n.getActionViewItem==`function`?n.getActionViewItem():new ge(e,e,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:e=>this._keybindingFor(e),onHide:e=>{this._contextMenuIsBeingShownCount--,this._editor.focus(),this._editor.updateOptions({hover:n})}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};Ly.ID=`editor.contrib.contextmenu`,Ly=Fy([Iy(1,xs),Iy(2,Gs),Iy(3,D),Iy(4,Oo),Iy(5,Ko)],Ly);var Ry=class extends V{constructor(){super({id:`editor.action.showContextMenu`,label:z(`action.showContextMenu.label`,`Show Editor Context Menu`),alias:`Show Editor Context Menu`,precondition:void 0,kbOpts:{kbExpr:A.textInputFocus,primary:1092,weight:100}})}run(e,t){Ly.get(t).showContextMenu()}};U(Ly.ID,Ly),o(Ry);var zy=class{constructor(e){this.selections=e}equals(e){let t=this.selections.length;if(t!==e.selections.length)return!1;for(let n=0;n<t;n++)if(!this.selections[n].equalsSelection(e.selections[n]))return!1;return!0}},By=class{constructor(e,t,n){this.cursorState=e,this.scrollTop=t,this.scrollLeft=n}},Vy=class e extends _{constructor(e){super(),this._editor=e,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(e.onDidChangeModel(e=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeModelContent(e=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeCursorSelection(t=>{if(this._isCursorUndoRedo||!t.oldSelections||t.oldModelVersionId!==t.modelVersionId)return;let n=new zy(t.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(n)||(this._undoStack.push(new By(n,e.getScrollTop(),e.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())}))}static get(t){return t.getContribution(e.ID)}cursorUndo(){!this._editor.hasModel()||this._undoStack.length===0||(this._redoStack.push(new By(new zy(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){!this._editor.hasModel()||this._redoStack.length===0||(this._undoStack.push(new By(new zy(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(e){this._isCursorUndoRedo=!0,this._editor.setSelections(e.cursorState.selections),this._editor.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),this._isCursorUndoRedo=!1}};Vy.ID=`editor.contrib.cursorUndoRedoController`;var Hy=class extends V{constructor(){super({id:`cursorUndo`,label:z(`cursor.undo`,`Cursor Undo`),alias:`Cursor Undo`,precondition:void 0,kbOpts:{kbExpr:A.textInputFocus,primary:2099,weight:100}})}run(e,t,n){Vy.get(t).cursorUndo()}},Uy=class extends V{constructor(){super({id:`cursorRedo`,label:z(`cursor.redo`,`Cursor Redo`),alias:`Cursor Redo`,precondition:void 0})}run(e,t,n){Vy.get(t).cursorRedo()}};U(Vy.ID,Vy),o(Hy),o(Uy);var Wy=class{constructor(e,t,n){this.selection=e,this.targetPosition=t,this.copy=n,this.targetSelection=null}getEditOperations(e,t){let n=e.getValueInRange(this.selection);if(this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new W(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),n),this.selection.containsPosition(this.targetPosition)&&!(this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition)))){this.targetSelection=this.selection;return}if(this.copy){this.targetSelection=new R(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber>this.selection.endLineNumber){this.targetSelection=new R(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber<this.selection.endLineNumber){this.targetSelection=new R(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new R(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,(this.selection.startLineNumber,this.selection.endLineNumber,this.targetPosition.column-this.selection.endColumn+this.selection.startColumn),this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new R(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn)}computeCursorState(e,t){return this.targetSelection}};function Gy(e){return Qn?e.altKey:e.ctrlKey}var Ky=class e extends _{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown(e=>this._onEditorMouseDown(e))),this._register(this._editor.onMouseUp(e=>this._onEditorMouseUp(e))),this._register(this._editor.onMouseDrag(e=>this._onEditorMouseDrag(e))),this._register(this._editor.onMouseDrop(e=>this._onEditorMouseDrop(e))),this._register(this._editor.onMouseDropCanceled(()=>this._onEditorMouseDropCanceled())),this._register(this._editor.onKeyDown(e=>this.onEditorKeyDown(e))),this._register(this._editor.onKeyUp(e=>this.onEditorKeyUp(e))),this._register(this._editor.onDidBlurEditorWidget(()=>this.onEditorBlur())),this._register(this._editor.onDidBlurEditorText(()=>this.onEditorBlur())),this._dndDecorationIds=[],this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){!this._editor.getOption(31)||this._editor.getOption(18)||(Gy(e)&&(this._modifierPressed=!0),this._mouseDown&&Gy(e)&&this._editor.updateOptions({mouseStyle:`copy`}))}onEditorKeyUp(t){!this._editor.getOption(31)||this._editor.getOption(18)||(Gy(t)&&(this._modifierPressed=!1),this._mouseDown&&t.keyCode===e.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:`default`}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:`text`})}_onEditorMouseDrag(e){let t=e.target;if(this._dragSelection===null){let e=(this._editor.getSelections()||[]).filter(e=>t.position&&e.containsPosition(t.position));if(e.length===1)this._dragSelection=e[0];else return}Gy(e.event)?this._editor.updateOptions({mouseStyle:`copy`}):this._editor.updateOptions({mouseStyle:`default`}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:`text`}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(t){if(t.target&&(this._hitContent(t.target)||this._hitMargin(t.target))&&t.target.position){let n=new P(t.target.position.lineNumber,t.target.position.column);if(this._dragSelection===null){let e=null;if(t.event.shiftKey){let t=this._editor.getSelection();if(t){let{selectionStartLineNumber:r,selectionStartColumn:i}=t;e=[new R(r,i,n.lineNumber,n.column)]}}else e=(this._editor.getSelections()||[]).map(e=>e.containsPosition(n)?new R(n.lineNumber,n.column,n.lineNumber,n.column):e);this._editor.setSelections(e||[],`mouse`,3)}else (!this._dragSelection.containsPosition(n)||(Gy(t.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(n)||this._dragSelection.getStartPosition().equals(n)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(e.ID,new Wy(this._dragSelection,n,Gy(t.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:`text`}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(t){let n=[{range:new W(t.lineNumber,t.column,t.lineNumber,t.column),options:e._DECORATION_OPTIONS}];this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,n),this._editor.revealPosition(t,1)}_removeDecoration(){this._dndDecorationIds=this._editor.deltaDecorations(this._dndDecorationIds,[])}_hitContent(e){return e.type===6||e.type===7}_hitMargin(e){return e.type===2||e.type===3||e.type===4}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}};Ky.ID=`editor.contrib.dragAndDrop`,Ky.TRIGGER_KEY_VALUE=Qn?6:5,Ky._DECORATION_OPTIONS=I.register({description:`dnd-target`,className:`dnd-target`}),U(Ky.ID,Ky);var qy=class e{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.deltaDecorations(this._allDecorations(),[]),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){let e=this._findScopeDecorationIds.map(e=>this._editor.getModel().getDecorationRange(e)).filter(e=>!!e);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){let t=this._decorations.indexOf(e);return t>=0?t+1:1}getCurrentMatchesPosition(t){let n=this._editor.getModel().getDecorationsInRange(t);for(let t of n){let n=t.options;if(n===e._FIND_MATCH_DECORATION||n===e._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(t.id)}return 0}setCurrentFindMatch(t){let n=null,r=0;if(t)for(let e=0,i=this._decorations.length;e<i;e++){let i=this._editor.getModel().getDecorationRange(this._decorations[e]);if(t.equalsRange(i)){n=this._decorations[e],r=e+1;break}}return(this._highlightedDecorationId!==null||n!==null)&&this._editor.changeDecorations(t=>{if(this._highlightedDecorationId!==null&&(t.changeDecorationOptions(this._highlightedDecorationId,e._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),n!==null&&(this._highlightedDecorationId=n,t.changeDecorationOptions(this._highlightedDecorationId,e._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(t.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),n!==null){let r=this._editor.getModel().getDecorationRange(n);if(r.startLineNumber!==r.endLineNumber&&r.endColumn===1){let e=r.endLineNumber-1,t=this._editor.getModel().getLineMaxColumn(e);r=new W(r.startLineNumber,r.startColumn,e,t)}this._rangeHighlightDecorationId=t.addDecoration(r,e._RANGE_HIGHLIGHT_DECORATION)}}),r}set(t,n){this._editor.changeDecorations(r=>{let i=e._FIND_MATCH_DECORATION,a=[];if(t.length>1e3){i=e._FIND_MATCH_NO_OVERVIEW_DECORATION;let n=this._editor.getModel().getLineCount(),r=this._editor.getLayoutInfo().height/n,o=Math.max(2,Math.ceil(3/r)),s=t[0].range.startLineNumber,c=t[0].range.endLineNumber;for(let n=1,r=t.length;n<r;n++){let r=t[n].range;c+o>=r.startLineNumber?r.endLineNumber>c&&(c=r.endLineNumber):(a.push({range:new W(s,1,c,1),options:e._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),s=r.startLineNumber,c=r.endLineNumber)}a.push({range:new W(s,1,c,1),options:e._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}let o=Array(t.length);for(let e=0,n=t.length;e<n;e++)o[e]={range:t[e].range,options:i};this._decorations=r.deltaDecorations(this._decorations,o),this._overviewRulerApproximateDecorations=r.deltaDecorations(this._overviewRulerApproximateDecorations,a),this._rangeHighlightDecorationId&&=(r.removeDecoration(this._rangeHighlightDecorationId),null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(e=>r.removeDecoration(e)),this._findScopeDecorationIds=[]),n?.length&&(this._findScopeDecorationIds=n.map(t=>r.addDecoration(t,e._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){let n=this._decorations[t],r=this._editor.getModel().getDecorationRange(n);if(!(!r||r.endLineNumber>e.lineNumber)&&(r.endLineNumber<e.lineNumber||!(r.endColumn>e.column)))return r}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,n=this._decorations.length;t<n;t++){let n=this._decorations[t],r=this._editor.getModel().getDecorationRange(n);if(!(!r||r.startLineNumber<e.lineNumber)&&(r.startLineNumber>e.lineNumber||!(r.startColumn<e.column)))return r}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}};qy._CURRENT_FIND_MATCH_DECORATION=I.register({description:`current-find-match`,stickiness:1,zIndex:13,className:`currentFindMatch`,showIfCollapsed:!0,overviewRuler:{color:aa(ca),position:ki.Center},minimap:{color:aa(Wi),position:us.Inline}}),qy._FIND_MATCH_DECORATION=I.register({description:`find-match`,stickiness:1,zIndex:10,className:`findMatch`,showIfCollapsed:!0,overviewRuler:{color:aa(ca),position:ki.Center},minimap:{color:aa(Wi),position:us.Inline}}),qy._FIND_MATCH_NO_OVERVIEW_DECORATION=I.register({description:`find-match-no-overview`,stickiness:1,className:`findMatch`,showIfCollapsed:!0}),qy._FIND_MATCH_ONLY_OVERVIEW_DECORATION=I.register({description:`find-match-only-overview`,stickiness:1,overviewRuler:{color:aa(ca),position:ki.Center}}),qy._RANGE_HIGHLIGHT_DECORATION=I.register({description:`find-range-highlight`,stickiness:1,className:`rangeHighlight`,isWholeLine:!0}),qy._FIND_SCOPE_DECORATION=I.register({description:`find-scope`,className:`findScope`,isWholeLine:!0});var Jy=class{constructor(e,t,n){this._editorSelection=e,this._ranges=t,this._replaceStrings=n,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){let e=[];for(let t=0;t<this._ranges.length;t++)e.push({range:this._ranges[t],text:this._replaceStrings[t]});e.sort((e,t)=>W.compareRangesUsingStarts(e.range,t.range));let n=[],r=e[0];for(let t=1;t<e.length;t++)r.range.endLineNumber===e[t].range.startLineNumber&&r.range.endColumn===e[t].range.startColumn?(r.range=r.range.plusRange(e[t].range),r.text+=e[t].text):(n.push(r),r=e[t]);n.push(r);for(let e of n)t.addEditOperation(e.range,e.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}};function Yy(e,t){if(e&&e[0]!==``){let n=Xy(e,t,`-`),r=Xy(e,t,`_`);return n&&!r?Zy(e,t,`-`):!n&&r?Zy(e,t,`_`):e[0].toUpperCase()===e[0]?t.toUpperCase():e[0].toLowerCase()===e[0]?t.toLowerCase():dt(e[0][0])&&t.length>0?t[0].toUpperCase()+t.substr(1):e[0][0].toUpperCase()!==e[0][0]&&t.length>0?t[0].toLowerCase()+t.substr(1):t}else return t}function Xy(e,t,n){return e[0].indexOf(n)!==-1&&t.indexOf(n)!==-1&&e[0].split(n).length===t.split(n).length}function Zy(e,t,n){let r=t.split(n),i=e[0].split(n),a=``;return r.forEach((e,t)=>{a+=Yy([i[t]],e)+n}),a.slice(0,-1)}var Qy=class{constructor(e){this.staticValue=e,this.kind=0}},$y=class{constructor(e){this.pieces=e,this.kind=1}},eb=class e{constructor(e){!e||e.length===0?this._state=new Qy(``):e.length===1&&e[0].staticValue!==null?this._state=new Qy(e[0].staticValue):this._state=new $y(e)}static fromStaticValue(t){return new e([tb.staticValue(t)])}get hasReplacementPatterns(){return this._state.kind===1}buildReplaceString(t,n){if(this._state.kind===0)return n?Yy(t,this._state.staticValue):this._state.staticValue;let r=``;for(let n=0,i=this._state.pieces.length;n<i;n++){let i=this._state.pieces[n];if(i.staticValue!==null){r+=i.staticValue;continue}let a=e._substitute(i.matchIndex,t);if(i.caseOps!==null&&i.caseOps.length>0){let e=[],t=i.caseOps.length,n=0;for(let r=0,o=a.length;r<o;r++){if(n>=t){e.push(a.slice(r));break}switch(i.caseOps[n]){case`U`:e.push(a[r].toUpperCase());break;case`u`:e.push(a[r].toUpperCase()),n++;break;case`L`:e.push(a[r].toLowerCase());break;case`l`:e.push(a[r].toLowerCase()),n++;break;default:e.push(a[r])}}a=e.join(``)}r+=a}return r}static _substitute(e,t){if(t===null)return``;if(e===0)return t[0];let n=``;for(;e>0;){if(e<t.length)return(t[e]||``)+n;n=String(e%10)+n,e=Math.floor(e/10)}return`$`+n}},tb=class e{constructor(e,t,n){this.staticValue=e,this.matchIndex=t,!n||n.length===0?this.caseOps=null:this.caseOps=n.slice(0)}static staticValue(t){return new e(t,-1,null)}static caseOps(t,n){return new e(null,t,n)}},nb=class{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=``}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,n){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=tb.staticValue(this._currentStaticPiece),this._currentStaticPiece=``),this._result[this._resultLen++]=tb.caseOps(e,n),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=tb.staticValue(this._currentStaticPiece),this._currentStaticPiece=``),new eb(this._result)}};function rb(e){if(!e||e.length===0)return new eb(null);let t=[],n=new nb(e);for(let r=0,i=e.length;r<i;r++){let a=e.charCodeAt(r);if(a===92){if(r++,r>=i)break;let a=e.charCodeAt(r);switch(a){case 92:n.emitUnchanged(r-1),n.emitStatic(`\\`,r+1);break;case 110:n.emitUnchanged(r-1),n.emitStatic(`
`,r+1);break;case 116:n.emitUnchanged(r-1),n.emitStatic(`	`,r+1);break;case 117:case 85:case 108:case 76:n.emitUnchanged(r-1),n.emitStatic(``,r+1),t.push(String.fromCharCode(a));break}continue}if(a===36){if(r++,r>=i)break;let a=e.charCodeAt(r);if(a===36){n.emitUnchanged(r-1),n.emitStatic(`$`,r+1);continue}if(a===48||a===38){n.emitUnchanged(r-1),n.emitMatchIndex(0,r+1,t),t.length=0;continue}if(49<=a&&a<=57){let o=a-48;if(r+1<i){let i=e.charCodeAt(r+1);if(48<=i&&i<=57){r++,o=o*10+(i-48),n.emitUnchanged(r-2),n.emitMatchIndex(o,r+1,t),t.length=0;continue}}n.emitUnchanged(r-1),n.emitMatchIndex(o,r+1,t),t.length=0;continue}}}return n.finalize()}const ib=new k(`findWidgetVisible`,!1),ab=new k(`findInputFocussed`,!1),ob=new k(`replaceInputFocussed`,!1),sb={primary:545,mac:{primary:2593}},cb={primary:565,mac:{primary:2613}},lb={primary:560,mac:{primary:2608}},ub={primary:554,mac:{primary:2602}},db={primary:558,mac:{primary:2606}},$={StartFindAction:`actions.find`,StartFindWithSelection:`actions.findWithSelection`,NextMatchFindAction:`editor.action.nextMatchFindAction`,PreviousMatchFindAction:`editor.action.previousMatchFindAction`,NextSelectionMatchFindAction:`editor.action.nextSelectionMatchFindAction`,PreviousSelectionMatchFindAction:`editor.action.previousSelectionMatchFindAction`,StartFindReplaceAction:`editor.action.startFindReplaceAction`,CloseFindWidgetCommand:`closeFindWidget`,ToggleCaseSensitiveCommand:`toggleFindCaseSensitive`,ToggleWholeWordCommand:`toggleFindWholeWord`,ToggleRegexCommand:`toggleFindRegex`,ToggleSearchScopeCommand:`toggleFindInSelection`,TogglePreserveCaseCommand:`togglePreserveCase`,ReplaceOneAction:`editor.action.replaceOne`,ReplaceAllAction:`editor.action.replaceAll`,SelectAllMatchesAction:`editor.action.selectAllMatches`},fb=19999;var pb=240,mb=class e{constructor(e,t){this._toDispose=new K,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new St,this._decorations=new qy(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new T(()=>this.research(!1),100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(e=>{(e.reason===3||e.reason===5||e.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(e=>{this._ignoreModelContentChanged||(e.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(e=>this._onStateChanged(e))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,y(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},pb)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let n=null;t===void 0?n=this._decorations.getFindScopes():t!==null&&(n=Array.isArray(t)?t:[t]),n!==null&&(n=n.map(e=>{if(e.startLineNumber!==e.endLineNumber){let t=e.endLineNumber;return e.endColumn===1&&--t,new W(e.startLineNumber,1,t,this._editor.getModel().getLineMaxColumn(t))}return e}));let r=this._findMatches(n,!1,fb);this._decorations.set(r,n);let i=this._editor.getSelection(),a=this._decorations.getCurrentMatchesPosition(i);if(a===0&&r.length>0){let e=$o(r.map(e=>e.range),e=>W.compareRangesUsingStarts(e,i)>=0);a=e>0?e-1+1:a}this._state.changeMatchInfo(a,this._decorations.getCount(),void 0),e&&this._editor.getOption(35).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){let e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){let t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf(`^`)>=0||this._state.searchString.indexOf(`$`)>=0),{lineNumber:n,column:r}=e,i=this._editor.getModel();return t||r===1?(n===1?n=i.getLineCount():n--,r=i.getLineMaxColumn(n)):r--,new P(n,r)}_moveToPrevMatch(t,n=!1){if(!this._state.canNavigateBack()){let e=this._decorations.matchAfterPosition(t);e&&this._setCurrentFindMatch(e);return}if(this._decorations.getCount()<19999){let e=this._decorations.matchBeforePosition(t);e&&e.isEmpty()&&e.getStartPosition().equals(t)&&(t=this._prevSearchPosition(t),e=this._decorations.matchBeforePosition(t)),e&&this._setCurrentFindMatch(e);return}if(this._cannotFind())return;let r=this._decorations.getFindScope(),i=e._getSearchRange(this._editor.getModel(),r);i.getEndPosition().isBefore(t)&&(t=i.getEndPosition()),t.isBefore(i.getStartPosition())&&(t=i.getEndPosition());let{lineNumber:a,column:o}=t,s=this._editor.getModel(),c=new P(a,o),l=s.findPreviousMatch(this._state.searchString,c,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,!1);if(l&&l.range.isEmpty()&&l.range.getStartPosition().equals(c)&&(c=this._prevSearchPosition(c),l=s.findPreviousMatch(this._state.searchString,c,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,!1)),l){if(!n&&!i.containsRange(l.range))return this._moveToPrevMatch(l.range.getStartPosition(),!0);this._setCurrentFindMatch(l.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){let t=this._state.isRegex&&(this._state.searchString.indexOf(`^`)>=0||this._state.searchString.indexOf(`$`)>=0),{lineNumber:n,column:r}=e,i=this._editor.getModel();return t||r===i.getLineMaxColumn(n)?(n===i.getLineCount()?n=1:n++,r=1):r++,new P(n,r)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){let t=this._decorations.matchBeforePosition(e);t&&this._setCurrentFindMatch(t);return}if(this._decorations.getCount()<19999){let t=this._decorations.matchAfterPosition(e);t&&t.isEmpty()&&t.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),t=this._decorations.matchAfterPosition(e)),t&&this._setCurrentFindMatch(t);return}let t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(t,n,r,i=!1){if(this._cannotFind())return null;let a=this._decorations.getFindScope(),o=e._getSearchRange(this._editor.getModel(),a);o.getEndPosition().isBefore(t)&&(t=o.getStartPosition()),t.isBefore(o.getStartPosition())&&(t=o.getStartPosition());let{lineNumber:s,column:c}=t,l=this._editor.getModel(),u=new P(s,c),d=l.findNextMatch(this._state.searchString,u,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,n);return r&&d&&d.range.isEmpty()&&d.range.getStartPosition().equals(u)&&(u=this._nextSearchPosition(u),d=l.findNextMatch(this._state.searchString,u,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,n)),d?!i&&!o.containsRange(d.range)?this._getNextMatch(d.range.getEndPosition(),n,r,!0):d:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_getReplacePattern(){return this._state.isRegex?rb(this._state.replaceString):eb.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;let e=this._getReplacePattern(),t=this._editor.getSelection(),n=this._getNextMatch(t.getStartPosition(),!0,!1);if(n)if(t.equalsRange(n.range)){let r=e.buildReplaceString(n.matches,this._state.preserveCase),i=new mt(t,r);this._executeEditorCommand(`replace`,i),this._decorations.setStartPosition(new P(t.startLineNumber,t.startColumn+r.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(n.range)}_findMatches(t,n,r){let i=(t||[null]).map(t=>e._getSearchRange(this._editor.getModel(),t));return this._editor.getModel().findMatches(this._state.searchString,i,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null,n,r)}replaceAll(){if(!this._hasMatches())return;let e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=19999?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){let e=new Qs(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(115):null).parseSearchRequest();if(!e)return;let t=e.regex;if(!t.multiline){let e=`mu`;t.ignoreCase&&(e+=`i`),t.global&&(e+=`g`),t=new RegExp(t.source,e)}let n=this._editor.getModel(),r=n.getValue(1),i=n.getFullModelRange(),a=this._getReplacePattern(),o,s=this._state.preserveCase;o=a.hasReplacementPatterns||s?r.replace(t,function(){return a.buildReplaceString(arguments,s)}):r.replace(t,a.buildReplaceString(null,s));let c=new Lr(i,o,this._editor.getSelection());this._executeEditorCommand(`replaceAll`,c)}_regularReplaceAll(e){let t=this._getReplacePattern(),n=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),r=[];for(let e=0,i=n.length;e<i;e++)r[e]=t.buildReplaceString(n[e].matches,this._state.preserveCase);let i=new Jy(this._editor.getSelection(),n.map(e=>e.range),r);this._executeEditorCommand(`replaceAll`,i)}selectAllMatches(){if(!this._hasMatches())return;let e=this._decorations.getFindScopes(),t=this._findMatches(e,!1,1073741824).map(e=>new R(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn)),n=this._editor.getSelection();for(let e=0,r=t.length;e<r;e++)if(t[e].equalsRange(n)){t=[n].concat(t.slice(0,e),t.slice(e+1));break}this._editor.setSelections(t)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}},hb={inputActiveOptionBorder:O.fromHex(`#007ACC00`),inputActiveOptionForeground:O.fromHex(`#FFFFFF`),inputActiveOptionBackground:O.fromHex(`#0E639C50`)},gb=class extends ec{constructor(e){super(),this._onChange=this._register(new J),this.onChange=this._onChange.event,this._onKeyDown=this._register(new J),this.onKeyDown=this._onKeyDown.event,this._opts=Object.assign(Object.assign({},hb),e),this._checked=this._opts.isChecked;let t=[`monaco-custom-checkbox`];this._opts.icon&&t.push(...ga.asClassNameArray(this._opts.icon)),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(` `)),this._checked&&t.push(`checked`),this.domNode=document.createElement(`div`),this.domNode.title=this._opts.title,this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute(`role`,`checkbox`),this.domNode.setAttribute(`aria-checked`,String(this._checked)),this.domNode.setAttribute(`aria-label`,this._opts.title),this.applyStyles(),this.onclick(this.domNode,e=>{this.checked=!this._checked,this._onChange.fire(!1),e.preventDefault()}),this.ignoreGesture(this.domNode),this.onkeydown(this.domNode,e=>{if(e.keyCode===10||e.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),e.preventDefault();return}this._onKeyDown.fire(e)})}get enabled(){return this.domNode.getAttribute(`aria-disabled`)!==`true`}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute(`aria-checked`,String(this._checked)),this.domNode.classList.toggle(`checked`,this._checked),this.applyStyles()}width(){return 22}style(e){e.inputActiveOptionBorder&&(this._opts.inputActiveOptionBorder=e.inputActiveOptionBorder),e.inputActiveOptionForeground&&(this._opts.inputActiveOptionForeground=e.inputActiveOptionForeground),e.inputActiveOptionBackground&&(this._opts.inputActiveOptionBackground=e.inputActiveOptionBackground),this.applyStyles()}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder?this._opts.inputActiveOptionBorder.toString():`transparent`,this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground?this._opts.inputActiveOptionForeground.toString():`inherit`,this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground?this._opts.inputActiveOptionBackground.toString():`transparent`)}enable(){this.domNode.setAttribute(`aria-disabled`,`false`)}disable(){this.domNode.setAttribute(`aria-disabled`,`true`)}},_b=z(`caseDescription`,`Match Case`),vb=z(`wordsDescription`,`Match Whole Word`),yb=z(`regexDescription`,`Use Regular Expression`),bb=class extends gb{constructor(e){super({icon:M.caseSensitive,title:_b+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},xb=class extends gb{constructor(e){super({icon:M.wholeWord,title:vb+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},Sb=class extends gb{constructor(e){super({icon:M.regex,title:yb+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},Cb=class e extends ec{constructor(e,t,n,r){super(),this._hideSoon=this._register(new T(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=n,this._domNode=document.createElement(`div`),this._domNode.className=`findOptionsWidget`,this._domNode.style.display=`none`,this._domNode.style.top=`10px`,this._domNode.setAttribute(`role`,`presentation`),this._domNode.setAttribute(`aria-hidden`,`true`);let i=r.getColorTheme().getColor(Tr),a=r.getColorTheme().getColor(Vr),o=r.getColorTheme().getColor(Nr);this.caseSensitive=this._register(new bb({appendTitle:this._keybindingLabelFor($.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,inputActiveOptionBorder:i,inputActiveOptionForeground:a,inputActiveOptionBackground:o})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new xb({appendTitle:this._keybindingLabelFor($.ToggleWholeWordCommand),isChecked:this._state.wholeWord,inputActiveOptionBorder:i,inputActiveOptionForeground:a,inputActiveOptionBackground:o})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new Sb({appendTitle:this._keybindingLabelFor($.ToggleRegexCommand),isChecked:this._state.isRegex,inputActiveOptionBorder:i,inputActiveOptionForeground:a,inputActiveOptionBackground:o})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(e=>{let t=!1;e.isRegex&&(this.regex.checked=this._state.isRegex,t=!0),e.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,t=!0),e.matchCase&&(this.caseSensitive.checked=this._state.matchCase,t=!0),!this._state.isRevealed&&t&&this._revealTemporarily()})),this._register(bs(this._domNode,e=>this._onMouseOut())),this._register(Qr(this._domNode,`mouseover`,e=>this._onMouseOver())),this._applyTheme(r.getColorTheme()),this._register(r.onDidColorThemeChange(this._applyTheme.bind(this)))}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:``}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return e.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseOut(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display=`block`)}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display=`none`)}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(Tr),inputActiveOptionForeground:e.getColor(Vr),inputActiveOptionBackground:e.getColor(Nr)};this.caseSensitive.style(t),this.wholeWords.style(t),this.regex.style(t)}};Cb.ID=`editor.contrib.findOptionsWidget`,Ya((e,t)=>{let n=e.getColor(lr);n&&t.addRule(`.monaco-editor .findOptionsWidget { background-color: ${n}; }`);let r=e.getColor(er);r&&t.addRule(`.monaco-editor .findOptionsWidget { color: ${r}; }`);let i=e.getColor(qt);i&&t.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${i}; }`);let a=e.getColor(Va);a&&t.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${a}; }`)});function wb(e,t){return e===1?!0:e===2?!1:t}var Tb=class extends _{constructor(){super(),this._onFindReplaceStateChange=this._register(new J),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString=``,this._replaceString=``,this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0}get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return wb(this._isRegexOverride,this._isRegex)}get wholeWord(){return wb(this._wholeWordOverride,this._wholeWord)}get matchCase(){return wb(this._matchCaseOverride,this._matchCase)}get preserveCase(){return wb(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}changeMatchInfo(e,t,n){let r={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},i=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,r.matchesPosition=!0,i=!0),this._matchesCount!==t&&(this._matchesCount=t,r.matchesCount=!0,i=!0),n!==void 0&&(W.equalsRange(this._currentMatch,n)||(this._currentMatch=n,r.currentMatch=!0,i=!0)),i&&this._onFindReplaceStateChange.fire(r)}change(e,t,n=!0){let r={moveCursor:t,updateHistory:n,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1},i=!1,a=this.isRegex,o=this.wholeWord,s=this.matchCase,c=this.preserveCase;e.searchString!==void 0&&this._searchString!==e.searchString&&(this._searchString=e.searchString,r.searchString=!0,i=!0),e.replaceString!==void 0&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,r.replaceString=!0,i=!0),e.isRevealed!==void 0&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,r.isRevealed=!0,i=!0),e.isReplaceRevealed!==void 0&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,r.isReplaceRevealed=!0,i=!0),e.isRegex!==void 0&&(this._isRegex=e.isRegex),e.wholeWord!==void 0&&(this._wholeWord=e.wholeWord),e.matchCase!==void 0&&(this._matchCase=e.matchCase),e.preserveCase!==void 0&&(this._preserveCase=e.preserveCase),e.searchScope!==void 0&&(e.searchScope?.every(e=>this._searchScope?.some(t=>!W.equalsRange(t,e)))||(this._searchScope=e.searchScope,r.searchScope=!0,i=!0)),e.loop!==void 0&&this._loop!==e.loop&&(this._loop=e.loop,r.loop=!0,i=!0),this._isRegexOverride=e.isRegexOverride===void 0?0:e.isRegexOverride,this._wholeWordOverride=e.wholeWordOverride===void 0?0:e.wholeWordOverride,this._matchCaseOverride=e.matchCaseOverride===void 0?0:e.matchCaseOverride,this._preserveCaseOverride=e.preserveCaseOverride===void 0?0:e.preserveCaseOverride,a!==this.isRegex&&(i=!0,r.isRegex=!0),o!==this.wholeWord&&(i=!0,r.wholeWord=!0),s!==this.matchCase&&(i=!0,r.matchCase=!0),c!==this.preserveCase&&(i=!0,r.preserveCase=!0),i&&this._onFindReplaceStateChange.fire(r)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=19999}},Eb=z(`defaultLabel`,`input`),Db=class extends ec{constructor(e,t,n,r){super(),this._showOptionButtons=n,this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this._onDidOptionChange=this._register(new J),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new J),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new J),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new J),this._onKeyUp=this._register(new J),this._onCaseSensitiveKeyDown=this._register(new J),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new J),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.contextViewProvider=t,this.placeholder=r.placeholder||``,this.validation=r.validation,this.label=r.label||Eb,this.inputActiveOptionBorder=r.inputActiveOptionBorder,this.inputActiveOptionForeground=r.inputActiveOptionForeground,this.inputActiveOptionBackground=r.inputActiveOptionBackground,this.inputBackground=r.inputBackground,this.inputForeground=r.inputForeground,this.inputBorder=r.inputBorder,this.inputValidationInfoBorder=r.inputValidationInfoBorder,this.inputValidationInfoBackground=r.inputValidationInfoBackground,this.inputValidationInfoForeground=r.inputValidationInfoForeground,this.inputValidationWarningBorder=r.inputValidationWarningBorder,this.inputValidationWarningBackground=r.inputValidationWarningBackground,this.inputValidationWarningForeground=r.inputValidationWarningForeground,this.inputValidationErrorBorder=r.inputValidationErrorBorder,this.inputValidationErrorBackground=r.inputValidationErrorBackground,this.inputValidationErrorForeground=r.inputValidationErrorForeground;let i=r.appendCaseSensitiveLabel||``,a=r.appendWholeWordsLabel||``,o=r.appendRegexLabel||``,s=r.history||[],c=!!r.flexibleHeight,l=!!r.flexibleWidth,u=r.flexibleMaxHeight;this.domNode=document.createElement(`div`),this.domNode.classList.add(`monaco-findInput`),this.inputBox=this._register(new Xt(this.domNode,this.contextViewProvider,{placeholder:this.placeholder||``,ariaLabel:this.label||``,validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:s,showHistoryHint:r.showHistoryHint,flexibleHeight:c,flexibleWidth:l,flexibleMaxHeight:u})),this.regex=this._register(new Sb({appendTitle:o,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.regex.onChange(e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(e=>{this._onRegexKeyDown.fire(e)})),this.wholeWords=this._register(new xb({appendTitle:a,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.wholeWords.onChange(e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new bb({appendTitle:i,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.caseSensitive.onChange(e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(e=>{this._onCaseSensitiveKeyDown.fire(e)})),this._showOptionButtons&&(this.inputBox.paddingRight=this.caseSensitive.width()+this.wholeWords.width()+this.regex.width());let d=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){let t=d.indexOf(document.activeElement);if(t>=0){let n=-1;e.equals(17)?n=(t+1)%d.length:e.equals(15)&&(n=t===0?d.length-1:t-1),e.equals(9)?(d[t].blur(),this.inputBox.focus()):n>=0&&d[n].focus(),Gi.stop(e,!0)}}});let f=document.createElement(`div`);f.className=`controls`,f.style.display=this._showOptionButtons?`block`:`none`,f.appendChild(this.caseSensitive.domNode),f.appendChild(this.wholeWords.domNode),f.appendChild(this.regex.domNode),this.domNode.appendChild(f),e&&e.appendChild(this.domNode),this._register(Qr(this.inputBox.inputElement,`compositionstart`,e=>{this.imeSessionInProgress=!0})),this._register(Qr(this.inputBox.inputElement,`compositionend`,e=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,e=>this._onKeyDown.fire(e)),this.onkeyup(this.inputBox.inputElement,e=>this._onKeyUp.fire(e)),this.oninput(this.inputBox.inputElement,e=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,e=>this._onMouseDown.fire(e))}enable(){this.domNode.classList.remove(`disabled`),this.inputBox.enable(),this.regex.enable(),this.wholeWords.enable(),this.caseSensitive.enable()}disable(){this.domNode.classList.add(`disabled`),this.inputBox.disable(),this.regex.disable(),this.wholeWords.disable(),this.caseSensitive.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){let e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.regex.style(e),this.wholeWords.style(e),this.caseSensitive.style(e);let t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive.checked}setCaseSensitive(e){this.caseSensitive.checked=e}getWholeWords(){return this.wholeWords.checked}setWholeWords(e){this.wholeWords.checked=e}getRegex(){return this.regex.checked}setRegex(e){this.regex.checked=e,this.validate()}focusOnCaseSensitive(){this.caseSensitive.focus()}highlightFindOptions(){this.domNode.classList.remove(`highlight-`+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add(`highlight-`+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}clearMessage(){this.inputBox.hideMessage()}},Ob=z(`defaultLabel`,`input`),kb=z(`label.preserveCaseCheckbox`,`Preserve Case`),Ab=class extends gb{constructor(e){super({icon:M.preserveCase,title:kb+e.appendTitle,isChecked:e.isChecked,inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}},jb=class extends ec{constructor(e,t,n,r){super(),this._showOptionButtons=n,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new J),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new J),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new J),this._onInput=this._register(new J),this._onKeyUp=this._register(new J),this._onPreserveCaseKeyDown=this._register(new J),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=r.placeholder||``,this.validation=r.validation,this.label=r.label||Ob,this.inputActiveOptionBorder=r.inputActiveOptionBorder,this.inputActiveOptionForeground=r.inputActiveOptionForeground,this.inputActiveOptionBackground=r.inputActiveOptionBackground,this.inputBackground=r.inputBackground,this.inputForeground=r.inputForeground,this.inputBorder=r.inputBorder,this.inputValidationInfoBorder=r.inputValidationInfoBorder,this.inputValidationInfoBackground=r.inputValidationInfoBackground,this.inputValidationInfoForeground=r.inputValidationInfoForeground,this.inputValidationWarningBorder=r.inputValidationWarningBorder,this.inputValidationWarningBackground=r.inputValidationWarningBackground,this.inputValidationWarningForeground=r.inputValidationWarningForeground,this.inputValidationErrorBorder=r.inputValidationErrorBorder,this.inputValidationErrorBackground=r.inputValidationErrorBackground,this.inputValidationErrorForeground=r.inputValidationErrorForeground;let i=r.appendPreserveCaseLabel||``,a=r.history||[],o=!!r.flexibleHeight,s=!!r.flexibleWidth,c=r.flexibleMaxHeight;this.domNode=document.createElement(`div`),this.domNode.classList.add(`monaco-findInput`),this.inputBox=this._register(new Xt(this.domNode,this.contextViewProvider,{ariaLabel:this.label||``,placeholder:this.placeholder||``,validationOptions:{validation:this.validation},inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder,history:a,showHistoryHint:r.showHistoryHint,flexibleHeight:o,flexibleWidth:s,flexibleMaxHeight:c})),this.preserveCase=this._register(new Ab({appendTitle:i,isChecked:!1,inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground})),this._register(this.preserveCase.onChange(e=>{this._onDidOptionChange.fire(e),!e&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(e=>{this._onPreserveCaseKeyDown.fire(e)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;let l=[this.preserveCase.domNode];this.onkeydown(this.domNode,e=>{if(e.equals(15)||e.equals(17)||e.equals(9)){let t=l.indexOf(document.activeElement);if(t>=0){let n=-1;e.equals(17)?n=(t+1)%l.length:e.equals(15)&&(n=t===0?l.length-1:t-1),e.equals(9)?(l[t].blur(),this.inputBox.focus()):n>=0&&l[n].focus(),Gi.stop(e,!0)}}});let u=document.createElement(`div`);u.className=`controls`,u.style.display=this._showOptionButtons?`block`:`none`,u.appendChild(this.preserveCase.domNode),this.domNode.appendChild(u),e&&e.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,e=>this._onKeyDown.fire(e)),this.onkeyup(this.inputBox.inputElement,e=>this._onKeyUp.fire(e)),this.oninput(this.inputBox.inputElement,e=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,e=>this._onMouseDown.fire(e))}enable(){this.domNode.classList.remove(`disabled`),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add(`disabled`),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}style(e){this.inputActiveOptionBorder=e.inputActiveOptionBorder,this.inputActiveOptionForeground=e.inputActiveOptionForeground,this.inputActiveOptionBackground=e.inputActiveOptionBackground,this.inputBackground=e.inputBackground,this.inputForeground=e.inputForeground,this.inputBorder=e.inputBorder,this.inputValidationInfoBackground=e.inputValidationInfoBackground,this.inputValidationInfoForeground=e.inputValidationInfoForeground,this.inputValidationInfoBorder=e.inputValidationInfoBorder,this.inputValidationWarningBackground=e.inputValidationWarningBackground,this.inputValidationWarningForeground=e.inputValidationWarningForeground,this.inputValidationWarningBorder=e.inputValidationWarningBorder,this.inputValidationErrorBackground=e.inputValidationErrorBackground,this.inputValidationErrorForeground=e.inputValidationErrorForeground,this.inputValidationErrorBorder=e.inputValidationErrorBorder,this.applyStyles()}applyStyles(){if(this.domNode){let e={inputActiveOptionBorder:this.inputActiveOptionBorder,inputActiveOptionForeground:this.inputActiveOptionForeground,inputActiveOptionBackground:this.inputActiveOptionBackground};this.preserveCase.style(e);let t={inputBackground:this.inputBackground,inputForeground:this.inputForeground,inputBorder:this.inputBorder,inputValidationInfoBackground:this.inputValidationInfoBackground,inputValidationInfoForeground:this.inputValidationInfoForeground,inputValidationInfoBorder:this.inputValidationInfoBorder,inputValidationWarningBackground:this.inputValidationWarningBackground,inputValidationWarningForeground:this.inputValidationWarningForeground,inputValidationWarningBorder:this.inputValidationWarningBorder,inputValidationErrorBackground:this.inputValidationErrorBackground,inputValidationErrorForeground:this.inputValidationErrorForeground,inputValidationErrorBorder:this.inputValidationErrorBorder};this.inputBox.style(t)}}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox&&this.inputBox.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.inputBox.width=e,this.domNode.style.width=e+`px`}dispose(){super.dispose()}},Mb=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Nb=function(e,t){return function(n,r){t(n,r,e)}};const Pb=`historyNavigationWidget`;var Fb=`historyNavigationForwardsEnabled`,Ib=`historyNavigationBackwardsEnabled`;function Lb(e,t,n){new k(n,t).bindTo(e)}function Rb(e,t){return e.createScoped(t.target)}function zb(e,t){return e.getContext(document.activeElement).getValue(t)}function Bb(e,t){let n=Rb(e,t);return Lb(n,t,Pb),{scopedContextKeyService:n,historyNavigationForwardsEnablement:new k(Fb,!0).bindTo(n),historyNavigationBackwardsEnablement:new k(Ib,!0).bindTo(n)}}var Vb=class extends Db{constructor(e,t,n,r,i=!1){super(e,t,i,n),this._register(Bb(r,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};Vb=Mb([Nb(3,D)],Vb);var Hb=class extends jb{constructor(e,t,n,r,i=!1){super(e,t,i,n),this._register(Bb(r,{target:this.inputBox.element,historyNavigator:this.inputBox}).scopedContextKeyService)}};Hb=Mb([Nb(3,D)],Hb),ln.registerCommandAndKeybindingRule({id:`history.showPrevious`,weight:200,when:w.and(w.has(Pb),w.equals(Ib,!0),Q.Visible.isEqualTo(!1)),primary:16,secondary:[528],handler:e=>{let t=zb(e.get(D),Pb);t&&t.historyNavigator.showPreviousValue()}}),ln.registerCommandAndKeybindingRule({id:`history.showNext`,weight:200,when:w.and(w.has(Pb),w.equals(Fb,!0),Q.Visible.isEqualTo(!1)),primary:18,secondary:[530],handler:e=>{let t=zb(e.get(D),Pb);t&&t.historyNavigator.showNextValue()}});function Ub(e){return e.lookupKeybinding(`history.showPrevious`)?.getElectronAccelerator()===`Up`&&e.lookupKeybinding(`history.showNext`)?.getElectronAccelerator()===`Down`}var Wb=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Gb=gi(`find-selection`,M.selection,z(`findSelectionIcon`,`Icon for 'Find in Selection' in the editor find widget.`)),Kb=gi(`find-collapsed`,M.chevronRight,z(`findCollapsedIcon`,`Icon to indicate that the editor find widget is collapsed.`)),qb=gi(`find-expanded`,M.chevronDown,z(`findExpandedIcon`,`Icon to indicate that the editor find widget is expanded.`));const Jb=gi(`find-replace`,M.replace,z(`findReplaceIcon`,`Icon for 'Replace' in the editor find widget.`)),Yb=gi(`find-replace-all`,M.replaceAll,z(`findReplaceAllIcon`,`Icon for 'Replace All' in the editor find widget.`)),Xb=gi(`find-previous-match`,M.arrowUp,z(`findPreviousMatchIcon`,`Icon for 'Find Previous' in the editor find widget.`)),Zb=gi(`find-next-match`,M.arrowDown,z(`findNextMatchIcon`,`Icon for 'Find Next' in the editor find widget.`));var Qb=z(`label.find`,`Find`),$b=z(`placeholder.find`,`Find`),ex=z(`label.previousMatchButton`,`Previous Match`),tx=z(`label.nextMatchButton`,`Next Match`),nx=z(`label.toggleSelectionFind`,`Find in Selection`),rx=z(`label.closeButton`,`Close`),ix=z(`label.replace`,`Replace`),ax=z(`placeholder.replace`,`Replace`),ox=z(`label.replaceButton`,`Replace`),sx=z(`label.replaceAllButton`,`Replace All`),cx=z(`label.toggleReplaceButton`,`Toggle Replace`),lx=z(`title.matchesCountLimit`,`Only the first {0} results are highlighted, but all find operations work on the entire text.`,fb);const ux=z(`label.matchesLocation`,`{0} of {1}`),dx=z(`label.noResults`,`No results`);var fx=419,px=221,mx=69,hx=33,gx=`ctrlEnterReplaceAll.windows.donotask`,_x=Qn?256:2048,vx=class{constructor(e){this.afterLineNumber=e,this.heightInPx=hx,this.suppressMouseDown=!1,this.domNode=document.createElement(`div`),this.domNode.className=`dock-find-viewzone`}};function yx(e,t,n){let r=!!t.match(/\n/);if(n&&r&&n.selectionStart>0){e.stopPropagation();return}}function bx(e,t,n){let r=!!t.match(/\n/);if(n&&r&&n.selectionEnd<n.value.length){e.stopPropagation();return}}var xx=class e extends ec{constructor(e,t,n,r,i,a,o,s,c){super(),this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=n,this._contextViewProvider=r,this._keybindingService=i,this._contextKeyService=a,this._storageService=s,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!s.getBoolean(gx,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new rr(500),this._register(ja(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(e=>this._onStateChanged(e))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(e=>{if(e.hasChanged(80)&&(this._codeEditor.getOption(80)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),e.hasChanged(129)&&this._tryUpdateWidgetWidth(),e.hasChanged(2)&&this.updateAccessibilitySupport(),e.hasChanged(35)){let e=this._codeEditor.getOption(35).addExtraSpaceOnTop;e&&!this._viewZone&&(this._viewZone=new vx(0),this._showViewZone()),!e&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(()=>Wb(this,void 0,void 0,function*(){if(this._isVisible){let e=yield this._controller.getGlobalBufferTerm();e&&e!==this._state.searchString&&(this._state.change({searchString:e},!1),this._findInput.select())}}))),this._findInputFocused=ab.bindTo(a),this._findFocusTracker=this._register(ce(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=ob.bindTo(a),this._replaceFocusTracker=this._register(ce(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(35).addExtraSpaceOnTop&&(this._viewZone=new vx(0)),this._applyTheme(o.getColorTheme()),this._register(o.onDidColorThemeChange(this._applyTheme.bind(this))),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(e=>{if(e.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return e.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(80)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=Da(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){let e=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle(`no-results`,e),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,C)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){this._matchesCount.style.minWidth=mx+`px`,this._state.matchesCount>=19999?this._matchesCount.title=lx:this._matchesCount.title=``,this._matchesCount.firstChild&&this._matchesCount.removeChild(this._matchesCount.firstChild);let e;if(this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=19999&&(t+=`+`);let n=String(this._state.matchesPosition);n===`0`&&(n=`?`),e=yn(ux,n,t)}else e=dx;this._matchesCount.appendChild(document.createTextNode(e)),Fn(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),mx=Math.max(mx,this._matchesCount.clientWidth)}_getAriaLabel(e,t,n){if(e===dx)return n===``?z(`ariaSearchNoResultEmpty`,`{0} found`,e):z(`ariaSearchNoResult`,`{0} found for '{1}'`,e,n);if(t){let r=z(`ariaSearchNoResultWithLineNum`,`{0} found for '{1}', at {2}`,e,n,t.startLineNumber+`:`+t.startColumn),i=this._codeEditor.getModel();return i&&t.startLineNumber<=i.getLineCount()&&t.startLineNumber>=1?`${i.getLineContent(t.startLineNumber)}, ${r}`:r}return z(`ariaSearchNoResultWithLineNumNoCurrentMatch`,`{0} found for '{1}'`,e,n)}_updateToggleSelectionFindButton(){let e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,n=this._toggleSelectionFind.checked;this._isVisible&&(n||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);let e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle(`replaceToggled`,this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);let n=!this._codeEditor.getOption(80);this._toggleReplaceBtn.setEnabled(this._isVisible&&n)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;let e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(35).autoFindInSelection){case`always`:this._toggleSelectionFind.checked=!0;break;case`never`:this._toggleSelectionFind.checked=!1;break;case`multiline`:let t=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=t;break;default:break}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add(`visible`),this._domNode.setAttribute(`aria-hidden`,`false`)},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(35).seedSearchStringFromSelection&&e){let n=this._codeEditor.getDomNode();if(n){let r=rn(n),i=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),a=r.left+(i?i.left:0),o=i?i.top:0;if(this._viewZone&&o<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);let n=ee(this._domNode).left;a>n&&(t=!1);let i=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());r.left+(i?i.left:0)>n&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove(`visible`),this._domNode.setAttribute(`aria-hidden`,`true`),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(35).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;let t=this._viewZone;this._viewZoneId!==void 0||!t||this._codeEditor.changeViewZones(n=>{t.heightInPx=this._getHeight(),this._viewZoneId=n.addZone(t),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+t.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(35).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new vx(0));let t=this._viewZone;this._codeEditor.changeViewZones(n=>{if(this._viewZoneId!==void 0){let r=this._getHeight();if(r===t.heightInPx)return;let i=r-t.heightInPx;t.heightInPx=r,n.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+i);return}else{let r=this._getHeight();if(r-=this._codeEditor.getOption(74).top,r<=0)return;t.heightInPx=r,this._viewZoneId=n.addZone(t),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&=(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),void 0))})}_applyTheme(e){let t={inputActiveOptionBorder:e.getColor(Tr),inputActiveOptionBackground:e.getColor(Nr),inputActiveOptionForeground:e.getColor(Vr),inputBackground:e.getColor(vn),inputForeground:e.getColor(Ii),inputBorder:e.getColor(i),inputValidationInfoBackground:e.getColor(_a),inputValidationInfoForeground:e.getColor(_o),inputValidationInfoBorder:e.getColor(ai),inputValidationWarningBackground:e.getColor(Yo),inputValidationWarningForeground:e.getColor(Ua),inputValidationWarningBorder:e.getColor(Si),inputValidationErrorBackground:e.getColor(rs),inputValidationErrorForeground:e.getColor(Vo),inputValidationErrorBorder:e.getColor(so)};this._findInput.style(t),this._replaceInput.style(t),this._toggleSelectionFind.style(t)}_tryUpdateWidgetWidth(){if(!this._isVisible||!Jt(this._domNode))return;let e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add(`hiddenEditor`);return}else this._domNode.classList.contains(`hiddenEditor`)&&this._domNode.classList.remove(`hiddenEditor`);let t=e.width,n=e.minimap.minimapWidth,r=!1,i=!1,a=!1;if(this._resized&&Da(this._domNode)>fx){this._domNode.style.maxWidth=`${t-28-n-15}px`,this._replaceInput.width=Da(this._findInput.domNode);return}if(fx+28+n>=t&&(i=!0),fx+28+n-mx>=t&&(a=!0),fx+28+n-mx>=t+50&&(r=!0),this._domNode.classList.toggle(`collapsed-find-widget`,r),this._domNode.classList.toggle(`narrow-find-widget`,a),this._domNode.classList.toggle(`reduced-find-widget`,i),!a&&!r&&(this._domNode.style.maxWidth=`${t-28-n-15}px`),this._resized){this._findInput.inputBox.layout();let e=this._findInput.inputBox.element.clientWidth;e>0&&(this._replaceInput.width=e)}else this._isReplaceVisible&&(this._replaceInput.width=Da(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){let e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){let e=this._codeEditor.getSelections();e.map(e=>{e.endColumn===1&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1)));let t=this._state.currentMatch;return e.startLineNumber!==e.endLineNumber&&!W.equalsRange(e,t)?e:null}).filter(e=>!!e),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals(_x|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return yx(e,this._findInput.getValue(),this._findInput.domNode.querySelector(`textarea`));if(e.equals(18))return bx(e,this._findInput.getValue(),this._findInput.domNode.querySelector(`textarea`))}_onReplaceInputKeyDown(e){if(e.equals(_x|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{_t&&hr&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(z(`ctrlEnter.keybindingChanged`,`Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.`)),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(gx,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return yx(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector(`textarea`));if(e.equals(18))return bx(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector(`textarea`))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){let t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:``}_buildDomNode(){this._findInput=this._register(new Vb(null,this._contextViewProvider,{width:px,label:Qb,placeholder:$b,appendCaseSensitiveLabel:this._keybindingLabelFor($.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor($.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor($.ToggleRegexCommand),validation:e=>{if(e.length===0||!this._findInput.getRegex())return null;try{return new RegExp(e,`gu`),null}catch(e){return{content:e.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>Ub(this._keybindingService)},this._contextKeyService,!0)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(e=>this._onFindInputKeyDown(e))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(e=>{e.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),e.preventDefault())})),this._register(this._findInput.onRegexKeyDown(e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),e.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(e=>{this._tryUpdateHeight()&&this._showViewZone()})),Je&&this._register(this._findInput.onMouseDown(e=>this._onFindInputMouseDown(e))),this._matchesCount=document.createElement(`div`),this._matchesCount.className=`matchesCount`,this._updateMatchesCount(),this._prevBtn=this._register(new Sx({label:ex+this._keybindingLabelFor($.PreviousMatchFindAction),icon:Xb,onTrigger:()=>{this._codeEditor.getAction($.PreviousMatchFindAction).run().then(void 0,C)}})),this._nextBtn=this._register(new Sx({label:tx+this._keybindingLabelFor($.NextMatchFindAction),icon:Zb,onTrigger:()=>{this._codeEditor.getAction($.NextMatchFindAction).run().then(void 0,C)}}));let e=document.createElement(`div`);e.className=`find-part`,e.appendChild(this._findInput.domNode);let t=document.createElement(`div`);t.className=`find-actions`,e.appendChild(t),t.appendChild(this._matchesCount),t.appendChild(this._prevBtn.domNode),t.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new gb({icon:Gb,title:nx+this._keybindingLabelFor($.ToggleSearchScopeCommand),isChecked:!1})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let e=this._codeEditor.getSelections();e.map(e=>(e.endColumn===1&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e)).filter(e=>!!e),e.length&&this._state.change({searchScope:e},!0)}}else this._state.change({searchScope:null},!0)})),t.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new Sx({label:rx+this._keybindingLabelFor($.CloseFindWidgetCommand),icon:Ls,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:e=>{e.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),e.preventDefault())}})),t.appendChild(this._closeBtn.domNode),this._replaceInput=this._register(new Hb(null,void 0,{label:ix,placeholder:ax,appendPreserveCaseLabel:this._keybindingLabelFor($.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>Ub(this._keybindingService)},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(e=>this._onReplaceInputKeyDown(e))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(e=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(e=>{e.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),e.preventDefault())})),this._replaceBtn=this._register(new Sx({label:ox+this._keybindingLabelFor($.ReplaceOneAction),icon:Jb,onTrigger:()=>{this._controller.replace()},onKeyDown:e=>{e.equals(1026)&&(this._closeBtn.focus(),e.preventDefault())}})),this._replaceAllBtn=this._register(new Sx({label:sx+this._keybindingLabelFor($.ReplaceAllAction),icon:Yb,onTrigger:()=>{this._controller.replaceAll()}}));let n=document.createElement(`div`);n.className=`replace-part`,n.appendChild(this._replaceInput.domNode);let r=document.createElement(`div`);r.className=`replace-actions`,n.appendChild(r),r.appendChild(this._replaceBtn.domNode),r.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new Sx({label:cx,className:`codicon toggle left`,onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=Da(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}})),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement(`div`),this._domNode.className=`editor-widget find-widget`,this._domNode.setAttribute(`aria-hidden`,`true`),this._domNode.style.width=`${fx}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(e),this._domNode.appendChild(n),this._resizeSash=new g(this._domNode,this,{orientation:0,size:2}),this._resized=!1;let i=fx;this._register(this._resizeSash.onDidStart(()=>{i=Da(this._domNode)})),this._register(this._resizeSash.onDidChange(e=>{this._resized=!0;let t=i+e.startX-e.currentX;t<fx||t>(parseFloat(Ce(this._domNode).maxWidth)||0)||(this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=Da(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{let e=Da(this._domNode);if(e<fx)return;let t=fx;if(!this._resized||e===fx){let e=this._codeEditor.getLayoutInfo();t=e.width-28-e.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${t}px`,this._isReplaceVisible&&(this._replaceInput.width=Da(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){let e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}};xx.ID=`editor.contrib.findWidget`;var Sx=class extends ec{constructor(e){super(),this._opts=e;let t=`button`;this._opts.className&&(t=t+` `+this._opts.className),this._opts.icon&&(t=t+` `+Co.asClassName(this._opts.icon)),this._domNode=document.createElement(`div`),this._domNode.title=this._opts.label,this._domNode.tabIndex=0,this._domNode.className=t,this._domNode.setAttribute(`role`,`button`),this._domNode.setAttribute(`aria-label`,this._opts.label),this.onclick(this._domNode,e=>{this._opts.onTrigger(),e.preventDefault()}),this.onkeydown(this._domNode,e=>{if(e.equals(10)||e.equals(3)){this._opts.onTrigger(),e.preventDefault();return}this._opts.onKeyDown&&this._opts.onKeyDown(e)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle(`disabled`,!e),this._domNode.setAttribute(`aria-disabled`,String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute(`aria-expanded`,String(!!e)),e?(this._domNode.classList.remove(...Co.asClassNameArray(Kb)),this._domNode.classList.add(...Co.asClassNameArray(qb))):(this._domNode.classList.remove(...Co.asClassNameArray(qb)),this._domNode.classList.add(...Co.asClassNameArray(Kb)))}};Ya((e,t)=>{let n=(e,n)=>{n&&t.addRule(`.monaco-editor ${e} { background-color: ${n}; }`)};n(`.findMatch`,e.getColor(Zi)),n(`.currentFindMatch`,e.getColor(Xa)),n(`.findScope`,e.getColor(_s)),n(`.find-widget`,e.getColor(lr));let r=e.getColor(qt);r&&t.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${r}; }`);let i=e.getColor(Yr);i&&t.addRule(`.monaco-editor .findMatch { border: 1px ${e.type===`hc`?`dotted`:`solid`} ${i}; box-sizing: border-box; }`);let a=e.getColor(oa);a&&t.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${a}; padding: 1px; box-sizing: border-box; }`);let o=e.getColor(Vs);o&&t.addRule(`.monaco-editor .findScope { border: 1px ${e.type===`hc`?`dashed`:`solid`} ${o}; }`);let s=e.getColor(Va);s&&t.addRule(`.monaco-editor .find-widget { border: 1px solid ${s}; }`);let c=e.getColor(er);c&&t.addRule(`.monaco-editor .find-widget { color: ${c}; }`);let l=e.getColor(He);l&&t.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${l}; }`);let u=e.getColor(_r);if(u)t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${u}; }`);else{let n=e.getColor(Xe);n&&t.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${n}; }`)}let d=e.getColor(Ea);d&&t.addRule(`
		.monaco-editor .find-widget .button:not(.disabled):hover,
		.monaco-editor .find-widget .codicon-find-selection:hover {
			background-color: ${d} !important;
		}
	`);let f=e.getColor(yt);f&&t.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${f}; }`)});var Cx=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},wx=function(e,t){return function(n,r){t(n,r,e)}},Tx=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ex=524288;function Dx(e,t=`single`,n=!1){if(!e.hasModel())return null;let r=e.getSelection();if(t===`single`&&r.startLineNumber===r.endLineNumber||t===`multiple`){if(r.isEmpty()){let t=e.getConfiguredWordAtPosition(r.getStartPosition());if(t&&!1===n)return t.word}else if(e.getModel().getValueLengthInRange(r)<Ex)return e.getModel().getValueInRange(r)}return null}var Ox=class e extends _{constructor(e,t,n,r){super(),this._editor=e,this._findWidgetVisible=ib.bindTo(t),this._contextKeyService=t,this._storageService=n,this._clipboardService=r,this._updateHistoryDelayer=new rr(500),this._state=this._register(new Tb),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(e=>this._onStateChanged(e))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{let e=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean(`editor.matchCase`,1,!1),wholeWord:this._storageService.getBoolean(`editor.wholeWord`,1,!1),isRegex:this._storageService.getBoolean(`editor.isRegex`,1,!1),preserveCase:this._storageService.getBoolean(`editor.preserveCase`,1,!1)},!1),e&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:`none`,seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(35).loop})}))}get editor(){return this._editor}static get(t){return t.getContribution(e.ID)}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&=(this._model.dispose(),null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store(`editor.isRegex`,this._state.actualIsRegex,1,0),e.wholeWord&&this._storageService.store(`editor.wholeWord`,this._state.actualWholeWord,1,0),e.matchCase&&this._storageService.store(`editor.matchCase`,this._state.actualMatchCase,1,0),e.preserveCase&&this._storageService.store(`editor.preserveCase`,this._state.actualPreserveCase,1,0)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean(`editor.matchCase`,1,this._state.matchCase),wholeWord:this._storageService.getBoolean(`editor.wholeWord`,1,this._state.wholeWord),isRegex:this._storageService.getBoolean(`editor.isRegex`,1,this._state.isRegex),preserveCase:this._storageService.getBoolean(`editor.preserveCase`,1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!ab.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e.map(e=>(e.endColumn===1&&e.endLineNumber>e.startLineNumber&&(e=e.setEndPosition(e.endLineNumber-1,this._editor.getModel().getLineMaxColumn(e.endLineNumber-1))),e.isEmpty()?null:e)).filter(e=>!!e),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=Er(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}_start(e){return Tx(this,void 0,void 0,function*(){if(this.disposeModel(),!this._editor.hasModel())return;let t={isRevealed:!0};if(e.seedSearchStringFromSelection===`single`){let n=Dx(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);n&&(this._state.isRegex?t.searchString=Er(n):t.searchString=n)}else if(e.seedSearchStringFromSelection===`multiple`&&!e.updateSearchScope){let n=Dx(this._editor,e.seedSearchStringFromSelection);n&&(t.searchString=n)}if(!t.searchString&&e.seedSearchStringFromGlobalClipboard){let e=yield this.getGlobalBufferTerm();if(!this._editor.hasModel())return;e&&(t.searchString=e)}if(e.forceRevealReplace?t.isReplaceRevealed=!0:this._findWidgetVisible.get()||(t.isReplaceRevealed=!1),e.updateSearchScope){let e=this._editor.getSelections();e.some(e=>!e.isEmpty())&&(t.searchScope=e)}t.loop=e.loop,this._state.change(t,!1),this._model||=new mb(this._editor,this._state)})}start(e){return this._start(e)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){return this._model?(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}getGlobalBufferTerm(){return Tx(this,void 0,void 0,function*(){return this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():``})}setGlobalBufferTerm(e){this._editor.getOption(35).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}};Ox.ID=`editor.contrib.findController`,Ox=Cx([wx(1,D),wx(2,je),wx(3,$r)],Ox);var kx=class extends Ox{constructor(e,t,n,r,i,a,o,s){super(e,n,o,s),this._contextViewService=t,this._keybindingService=r,this._themeService=i,this._notificationService=a,this._widget=null,this._findOptionsWidget=null}_start(e){let t=Object.create(null,{_start:{get:()=>super._start}});return Tx(this,void 0,void 0,function*(){this._widget||this._createFindWidget();let n=this._editor.getSelection(),r=!1;switch(this._editor.getOption(35).autoFindInSelection){case`always`:r=!0;break;case`never`:r=!1;break;case`multiline`:r=!!n&&n.startLineNumber!==n.endLineNumber;break;default:break}e.updateSearchScope=r,yield t._start.call(this,e),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())})}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new xx(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService)),this._findOptionsWidget=this._register(new Cb(this._editor,this._state,this._keybindingService,this._themeService))}};kx=Cx([wx(1,Gs),wx(2,D),wx(3,Oo),wx(4,Vi),wx(5,Ft),wx(6,je),wx(7,$r)],kx),ri(new Dr({id:$.StartFindAction,label:z(`startFindAction`,`Find`),alias:`Find`,precondition:w.or(A.focus,w.has(`editorIsOpen`)),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:N.MenubarEditMenu,group:`3_find`,title:z({key:`miFind`,comment:[`&& denotes a mnemonic`]},`&&Find`),order:1}})).addImplementation(0,(e,t,n)=>{let r=Ox.get(t);return r?r.start({forceRevealReplace:!1,seedSearchStringFromSelection:t.getOption(35).seedSearchStringFromSelection===`never`?`none`:`single`,seedSearchStringFromNonEmptySelection:t.getOption(35).seedSearchStringFromSelection===`selection`,seedSearchStringFromGlobalClipboard:t.getOption(35).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}):!1});var Ax=class extends V{constructor(){super({id:$.StartFindWithSelection,label:z(`startFindWithSelectionAction`,`Find With Selection`),alias:`Find With Selection`,precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}run(e,t){return Tx(this,void 0,void 0,function*(){let e=Ox.get(t);e&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:`multiple`,seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),e.setGlobalBufferTerm(e.getState().searchString))})}},jx=class extends V{run(e,t){return Tx(this,void 0,void 0,function*(){let e=Ox.get(t);e&&!this._run(e)&&(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getState().searchString.length===0&&t.getOption(35).seedSearchStringFromSelection!==`never`?`single`:`none`,seedSearchStringFromNonEmptySelection:t.getOption(35).seedSearchStringFromSelection===`selection`,seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),this._run(e))})}},Mx=class extends jx{constructor(){super({id:$.NextMatchFindAction,label:z(`findNextMatchAction`,`Find Next`),alias:`Find Next`,precondition:void 0,kbOpts:[{kbExpr:A.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:w.and(A.focus,ab),primary:3,weight:100}]})}_run(e){return e.moveToNextMatch()?(e.editor.pushUndoStop(),!0):!1}},Nx=class extends jx{constructor(){super({id:$.PreviousMatchFindAction,label:z(`findPreviousMatchAction`,`Find Previous`),alias:`Find Previous`,precondition:void 0,kbOpts:[{kbExpr:A.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:w.and(A.focus,ab),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}},Px=class extends V{run(e,t){return Tx(this,void 0,void 0,function*(){let e=Ox.get(t);if(!e)return;let n=t.getOption(35).seedSearchStringFromSelection===`selection`,r=null;t.getOption(35).seedSearchStringFromSelection!==`never`&&(r=Dx(t,`single`,n)),r&&e.setSearchString(r),this._run(e)||(yield e.start({forceRevealReplace:!1,seedSearchStringFromSelection:t.getOption(35).seedSearchStringFromSelection===`never`?`none`:`single`,seedSearchStringFromNonEmptySelection:n,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop}),this._run(e))})}},Fx=class extends Px{constructor(){super({id:$.NextSelectionMatchFindAction,label:z(`nextSelectionMatchFindAction`,`Find Next Selection`),alias:`Find Next Selection`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}},Ix=class extends Px{constructor(){super({id:$.PreviousSelectionMatchFindAction,label:z(`previousSelectionMatchFindAction`,`Find Previous Selection`),alias:`Find Previous Selection`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}};ri(new Dr({id:$.StartFindReplaceAction,label:z(`startReplace`,`Replace`),alias:`Replace`,precondition:w.or(A.focus,w.has(`editorIsOpen`)),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:N.MenubarEditMenu,group:`3_find`,title:z({key:`miReplace`,comment:[`&& denotes a mnemonic`]},`&&Replace`),order:2}})).addImplementation(0,(e,t,n)=>{if(!t.hasModel()||t.getOption(80))return!1;let r=Ox.get(t);if(!r)return!1;let i=t.getSelection(),a=r.isFindInputFocused(),o=!i.isEmpty()&&i.startLineNumber===i.endLineNumber&&t.getOption(35).seedSearchStringFromSelection!==`never`&&!a,s=a||o?2:1;return r.start({forceRevealReplace:!0,seedSearchStringFromSelection:o?`single`:`none`,seedSearchStringFromNonEmptySelection:t.getOption(35).seedSearchStringFromSelection===`selection`,seedSearchStringFromGlobalClipboard:t.getOption(35).seedSearchStringFromSelection!==`never`,shouldFocus:s,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(35).loop})}),U(Ox.ID,kx),o(Ax),o(Mx),o(Nx),o(Fx),o(Ix);var Lx=ft.bindToContribution(Ox.get);F(new Lx({id:$.CloseFindWidgetCommand,precondition:ib,handler:e=>e.closeFindWidget(),kbOpts:{weight:105,kbExpr:w.and(A.focus,w.not(`isComposing`)),primary:9,secondary:[1033]}})),F(new Lx({id:$.ToggleCaseSensitiveCommand,precondition:void 0,handler:e=>e.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:A.focus,primary:sb.primary,mac:sb.mac,win:sb.win,linux:sb.linux}})),F(new Lx({id:$.ToggleWholeWordCommand,precondition:void 0,handler:e=>e.toggleWholeWords(),kbOpts:{weight:105,kbExpr:A.focus,primary:cb.primary,mac:cb.mac,win:cb.win,linux:cb.linux}})),F(new Lx({id:$.ToggleRegexCommand,precondition:void 0,handler:e=>e.toggleRegex(),kbOpts:{weight:105,kbExpr:A.focus,primary:lb.primary,mac:lb.mac,win:lb.win,linux:lb.linux}})),F(new Lx({id:$.ToggleSearchScopeCommand,precondition:void 0,handler:e=>e.toggleSearchScope(),kbOpts:{weight:105,kbExpr:A.focus,primary:ub.primary,mac:ub.mac,win:ub.win,linux:ub.linux}})),F(new Lx({id:$.TogglePreserveCaseCommand,precondition:void 0,handler:e=>e.togglePreserveCase(),kbOpts:{weight:105,kbExpr:A.focus,primary:db.primary,mac:db.mac,win:db.win,linux:db.linux}})),F(new Lx({id:$.ReplaceOneAction,precondition:ib,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:A.focus,primary:3094}})),F(new Lx({id:$.ReplaceOneAction,precondition:ib,handler:e=>e.replace(),kbOpts:{weight:105,kbExpr:w.and(A.focus,ob),primary:3}})),F(new Lx({id:$.ReplaceAllAction,precondition:ib,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:A.focus,primary:2563}})),F(new Lx({id:$.ReplaceAllAction,precondition:ib,handler:e=>e.replaceAll(),kbOpts:{weight:105,kbExpr:w.and(A.focus,ob),primary:void 0,mac:{primary:2051}}})),F(new Lx({id:$.SelectAllMatchesAction,precondition:ib,handler:e=>e.selectAllMatches(),kbOpts:{weight:105,kbExpr:A.focus,primary:515}}));const Rx=16777215;var zx=4278190080,Bx=class{constructor(e,t,n){if(e.length!==t.length||e.length>65535)throw Error(`invalid startIndexes or endIndexes size`);this._startIndexes=e,this._endIndexes=t,this._collapseStates=new Uint32Array(Math.ceil(e.length/32)),this._types=n,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],t=(t,n)=>{let r=e[e.length-1];return this.getStartLineNumber(r)<=t&&this.getEndLineNumber(r)>=n};for(let n=0,r=this._startIndexes.length;n<r;n++){let r=this._startIndexes[n],i=this._endIndexes[n];if(r>16777215||i>16777215)throw Error(`startLineNumber or endLineNumber must not exceed `+Rx);for(;e.length>0&&!t(r,i);)e.pop();let a=e.length>0?e[e.length-1]:-1;e.push(n),this._startIndexes[n]=r+((a&255)<<24),this._endIndexes[n]=i+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&Rx}getEndLineNumber(e){return this._endIndexes[e]&Rx}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){let t=e/32|0,n=e%32;return(this._collapseStates[t]&1<<n)!=0}setCollapsed(e,t){let n=e/32|0,r=e%32,i=this._collapseStates[n];t?this._collapseStates[n]=i|1<<r:this._collapseStates[n]=i&~(1<<r)}setCollapsedAllOfType(e,t){let n=!1;if(this._types)for(let r=0;r<this._types.length;r++)this._types[r]===e&&(this.setCollapsed(r,t),n=!0);return n}toRegion(e){return new Vx(this,e)}getParentIndex(e){this.ensureParentIndices();let t=((this._startIndexes[e]&zx)>>>24)+((this._endIndexes[e]&zx)>>>16);return t===65535?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,n=this._startIndexes.length;if(n===0)return-1;for(;t<n;){let r=Math.floor((t+n)/2);e<this.getStartLineNumber(r)?n=r:t=r+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){let e=[];for(let t=0;t<this.length;t++)e[t]=`[${this.isCollapsed(t)?`+`:`-`}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(`, `)}},Vx=class{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}},Hx=class{constructor(e,t){this._updateEventEmitter=new J,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new Bx(new Uint32Array,new Uint32Array),this._editorDecorationIds=[],this._isInitialized=!1}get regions(){return this._regions}get textModel(){return this._textModel}get isInitialized(){return this._isInitialized}toggleCollapseState(e){if(!e.length)return;e=e.sort((e,t)=>e.regionIndex-t.regionIndex);let t={};this._decorationProvider.changeDecorations(n=>{let r=0,i=-1,a=-1,o=e=>{for(;r<e;){let e=this._regions.getEndLineNumber(r),t=this._regions.isCollapsed(r);e<=i&&n.changeDecorationOptions(this._editorDecorationIds[r],this._decorationProvider.getDecorationOption(t,e<=a)),t&&e>a&&(a=e),r++}};for(let n of e){let e=n.regionIndex,r=this._editorDecorationIds[e];if(r&&!t[r]){t[r]=!0,o(e);let n=!this._regions.isCollapsed(e);this._regions.setCollapsed(e,n),i=Math.max(i,this._regions.getEndLineNumber(e))}}o(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}update(e,t=[]){let n=[],r=(e,n)=>{for(let r of t)if(e<r&&r<=n)return!0;return!1},i=-1,a=(t,a)=>{let o=e.getStartLineNumber(t),s=e.getEndLineNumber(t);a||=e.isCollapsed(t),a&&r(o,s)&&(a=!1),e.setCollapsed(t,a);let c=this._textModel.getLineMaxColumn(o),l={startLineNumber:o,startColumn:Math.max(c-1,1),endLineNumber:o,endColumn:c};n.push({range:l,options:this._decorationProvider.getDecorationOption(a,s<=i)}),a&&s>i&&(i=s)},o=0,s=()=>{for(;o<this._regions.length;){let e=this._regions.isCollapsed(o);if(o++,e)return o-1}return-1},c=0,l=s();for(;l!==-1&&c<e.length;){let t=this._textModel.getDecorationRange(this._editorDecorationIds[l]);if(t){let n=t.startLineNumber;if(t.startColumn===Math.max(t.endColumn-1,1)&&this._textModel.getLineMaxColumn(n)===t.endColumn)for(;c<e.length;){let t=e.getStartLineNumber(c);if(n>=t)a(c,n===t),c++;else break}}l=s()}for(;c<e.length;)a(c,!1),c++;this._editorDecorationIds=this._decorationProvider.deltaDecorations(this._editorDecorationIds,n),this._regions=e,this._isInitialized=!0,this._updateEventEmitter.fire({model:this})}getMemento(){let e=[];for(let t=0;t<this._regions.length;t++)if(this._regions.isCollapsed(t)){let n=this._textModel.getDecorationRange(this._editorDecorationIds[t]);if(n){let r=n.startLineNumber,i=n.endLineNumber+this._regions.getEndLineNumber(t)-this._regions.getStartLineNumber(t);e.push({startLineNumber:r,endLineNumber:i})}}if(e.length>0)return e}applyMemento(e){if(!Array.isArray(e))return;let t=[];for(let n of e){let e=this.getRegionAtLine(n.startLineNumber);e&&!e.isCollapsed&&t.push(e)}this.toggleCollapseState(t)}dispose(){this._decorationProvider.deltaDecorations(this._editorDecorationIds,[])}getAllRegionsAtLine(e,t){let n=[];if(this._regions){let r=this._regions.findRange(e),i=1;for(;r>=0;){let e=this._regions.toRegion(r);(!t||t(e,i))&&n.push(e),i++,r=e.parentIndex}}return n}getRegionAtLine(e){if(this._regions){let t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){let n=[],r=e?e.regionIndex+1:0,i=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){let e=[];for(let a=r,o=this._regions.length;a<o;a++){let r=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<i){for(;e.length>0&&!r.containedBy(e[e.length-1]);)e.pop();e.push(r),t(r,e.length)&&n.push(r)}else break}}else for(let e=r,a=this._regions.length;e<a;e++){let r=this._regions.toRegion(e);if(this._regions.getStartLineNumber(e)<i)(!t||t(r))&&n.push(r);else break}return n}};function Ux(e,t,n){let r=[];for(let i of n){let n=e.getRegionAtLine(i);if(n){let i=!n.isCollapsed;if(r.push(n),t>1){let a=e.getRegionsInside(n,(e,n)=>e.isCollapsed!==i&&n<t);r.push(...a)}}}e.toggleCollapseState(r)}function Wx(e,t,n=Number.MAX_VALUE,r){let i=[];if(r&&r.length>0)for(let a of r){let r=e.getRegionAtLine(a);if(r&&(r.isCollapsed!==t&&i.push(r),n>1)){let a=e.getRegionsInside(r,(e,r)=>e.isCollapsed!==t&&r<n);i.push(...a)}}else{let r=e.getRegionsInside(null,(e,r)=>e.isCollapsed!==t&&r<n);i.push(...r)}e.toggleCollapseState(i)}function Gx(e,t,n,r){let i=[];for(let a of r){let r=e.getAllRegionsAtLine(a,(e,r)=>e.isCollapsed!==t&&r<=n);i.push(...r)}e.toggleCollapseState(i)}function Kx(e,t,n){let r=[];for(let i of n){let n=e.getAllRegionsAtLine(i,e=>e.isCollapsed!==t);n.length>0&&r.push(n[0])}e.toggleCollapseState(r)}function qx(e,t,n,r){let i=e.getRegionsInside(null,(e,i)=>i===t&&e.isCollapsed!==n&&!r.some(t=>e.containsLine(t)));e.toggleCollapseState(i)}function Jx(e,t,n){let r=[];for(let t of n)r.push(e.getAllRegionsAtLine(t,void 0)[0]);let i=e.getRegionsInside(null,e=>r.every(t=>!t.containedBy(e)&&!e.containedBy(t))&&e.isCollapsed!==t);e.toggleCollapseState(i)}function Yx(e,t,n){let r=e.textModel,i=e.regions,a=[];for(let e=i.length-1;e>=0;e--)if(n!==i.isCollapsed(e)){let n=i.getStartLineNumber(e);t.test(r.getLineContent(n))&&a.push(i.toRegion(e))}e.toggleCollapseState(a)}function Xx(e,t,n){let r=e.regions,i=[];for(let e=r.length-1;e>=0;e--)n!==r.isCollapsed(e)&&t===r.getType(e)&&i.push(r.toRegion(e));e.toggleCollapseState(i)}function Zx(e,t){let n=null,r=t.getRegionAtLine(e);if(r!==null&&(n=r.startLineNumber,e===n)){let e=r.parentIndex;n=e===-1?null:t.regions.getStartLineNumber(e)}return n}function Qx(e,t){let n=t.getRegionAtLine(e);if(n!==null&&n.startLineNumber===e){if(e!==n.startLineNumber)return n.startLineNumber;{let e=n.parentIndex,r=0;for(e!==-1&&(r=t.regions.getStartLineNumber(n.parentIndex));n!==null;)if(n.regionIndex>0){if(n=t.regions.toRegion(n.regionIndex-1),n.startLineNumber<=r)return null;if(n.parentIndex===e)return n.startLineNumber}else return null}}else if(t.regions.length>0)for(n=t.regions.toRegion(t.regions.length-1);n!==null;){if(n.startLineNumber<e)return n.startLineNumber;n=n.regionIndex>0?t.regions.toRegion(n.regionIndex-1):null}return null}function $x(e,t){let n=t.getRegionAtLine(e);if(n!==null&&n.startLineNumber===e){let e=n.parentIndex,r=0;if(e!==-1)r=t.regions.getEndLineNumber(n.parentIndex);else if(t.regions.length===0)return null;else r=t.regions.getEndLineNumber(t.regions.length-1);for(;n!==null;)if(n.regionIndex<t.regions.length){if(n=t.regions.toRegion(n.regionIndex+1),n.startLineNumber>=r)return null;if(n.parentIndex===e)return n.startLineNumber}else return null}else if(t.regions.length>0)for(n=t.regions.toRegion(0);n!==null;){if(n.startLineNumber>e)return n.startLineNumber;n=n.regionIndex<t.regions.length?t.regions.toRegion(n.regionIndex+1):null}return null}var eS=class{constructor(e){this._updateEventEmitter=new J,this._foldingModel=e,this._foldingModelListener=e.onDidChange(e=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}updateHiddenRanges(){let e=!1,t=[],n=0,r=0,i=Number.MAX_VALUE,a=-1,o=this._foldingModel.regions;for(;n<o.length;n++){if(!o.isCollapsed(n))continue;let s=o.getStartLineNumber(n)+1,c=o.getEndLineNumber(n);i<=s&&c<=a||(!e&&r<this._hiddenRanges.length&&this._hiddenRanges[r].startLineNumber===s&&this._hiddenRanges[r].endLineNumber===c?(t.push(this._hiddenRanges[r]),r++):(e=!0,t.push(new W(s,1,c,1))),i=s,a=c)}(e||r<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyMemento(e){if(!Array.isArray(e)||e.length===0)return!1;let t=[];for(let n of e){if(!n.startLineNumber||!n.endLineNumber)return!1;t.push(new W(n.startLineNumber+1,1,n.endLineNumber,1))}return this.applyHiddenRanges(t),!0}getMemento(){return this._hiddenRanges.map(e=>({startLineNumber:e.startLineNumber-1,endLineNumber:e.endLineNumber}))}applyHiddenRanges(e){this._hiddenRanges=e,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return nS(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1,n=this._foldingModel.textModel,r=null,i=e=>((!r||!tS(e,r))&&(r=nS(this._hiddenRanges,e)),r?r.startLineNumber-1:null);for(let r=0,a=e.length;r<a;r++){let a=e[r],o=i(a.startLineNumber);o&&(a=a.setStartPosition(o,n.getLineMaxColumn(o)),t=!0);let s=i(a.endLineNumber);s&&(a=a.setEndPosition(s,n.getLineMaxColumn(s)),t=!0),e[r]=a}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&=(this._foldingModelListener.dispose(),null)}};function tS(e,t){return e>=t.startLineNumber&&e<=t.endLineNumber}function nS(e,t){let n=$o(e,e=>t<e.startLineNumber)-1;return n>=0&&e[n].endLineNumber>=t?e[n]:null}var rS=5e3,iS=class{constructor(e){this.editorModel=e,this.id=`indent`}dispose(){}compute(e){let t=Ei.getFoldingRules(this.editorModel.getLanguageId()),n=t&&!!t.offSide,r=t&&t.markers;return Promise.resolve(oS(this.editorModel,n,r))}},aS=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,n){if(e>16777215||t>16777215)return;let r=this._length;this._startIndexes[r]=e,this._endIndexes[r]=t,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}toIndentRanges(e){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let n=this._length-1,r=0;n>=0;n--,r++)e[r]=this._startIndexes[n],t[r]=this._endIndexes[n];return new Bx(e,t)}else{let t=0,n=this._indentOccurrences.length;for(let e=0;e<this._indentOccurrences.length;e++){let r=this._indentOccurrences[e];if(r){if(r+t>this._foldingRangesLimit){n=e;break}t+=r}}let r=e.getOptions().tabSize,i=new Uint32Array(this._foldingRangesLimit),a=new Uint32Array(this._foldingRangesLimit);for(let o=this._length-1,s=0;o>=0;o--){let c=this._startIndexes[o],l=e.getLineContent(c),u=ts.computeIndentLevel(l,r);(u<n||u===n&&t++<this._foldingRangesLimit)&&(i[s]=c,a[s]=this._endIndexes[o],s++)}return new Bx(i,a)}}};function oS(e,t,n,r=rS){let i=e.getOptions().tabSize,a=new aS(r),o;n&&(o=RegExp(`(${n.start.source})|(?:${n.end.source})`));let s=[],c=e.getLineCount()+1;s.push({indent:-1,endAbove:c,line:c});for(let n=e.getLineCount();n>0;n--){let r=e.getLineContent(n),c=ts.computeIndentLevel(r,i),l=s[s.length-1];if(c===-1){t&&(l.endAbove=n);continue}let u;if(o&&(u=r.match(o)))if(u[1]){let e=s.length-1;for(;e>0&&s[e].indent!==-2;)e--;if(e>0){s.length=e+1,l=s[e],a.insertFirst(n,l.line,c),l.line=n,l.indent=c,l.endAbove=n;continue}}else{s.push({indent:-2,endAbove:n,line:n});continue}if(l.indent>c){do s.pop(),l=s[s.length-1];while(l.indent>c);let e=l.endAbove-1;e-n>=1&&a.insertFirst(n,e,c)}l.indent===c?l.endAbove=n:s.push({indent:c,endAbove:n,line:n})}return a.toIndentRanges(e)}var sS=5e3,cS={},lS=class{constructor(e,t,n,r=sS){this.editorModel=e,this.providers=t,this.limit=r,this.id=`syntax`;for(let e of t)typeof e.onDidChange==`function`&&(this.disposables||=new K,this.disposables.add(e.onDidChange(n)))}compute(e){return uS(this.providers,this.editorModel,e).then(e=>e?fS(e,this.limit):null)}dispose(){var e;(e=this.disposables)==null||e.dispose()}};function uS(e,t,n){let r=null,i=e.map((e,i)=>Promise.resolve(e.provideFoldingRanges(t,cS,n)).then(e=>{if(!n.isCancellationRequested&&Array.isArray(e)){Array.isArray(r)||(r=[]);let n=t.getLineCount();for(let t of e)t.start>0&&t.end>t.start&&t.end<=n&&r.push({start:t.start,end:t.end,rank:i,kind:t.kind})}},nt));return Promise.all(i).then(e=>r)}var dS=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,n,r){if(e>16777215||t>16777215)return;let i=this._length;this._startIndexes[i]=e,this._endIndexes[i]=t,this._nestingLevels[i]=r,this._types[i]=n,this._length++,r<30&&(this._nestingLevelCounts[r]=(this._nestingLevelCounts[r]||0)+1)}toIndentRanges(){if(this._length<=this._foldingRangesLimit){let e=new Uint32Array(this._length),t=new Uint32Array(this._length);for(let n=0;n<this._length;n++)e[n]=this._startIndexes[n],t[n]=this._endIndexes[n];return new Bx(e,t,this._types)}else{let e=0,t=this._nestingLevelCounts.length;for(let n=0;n<this._nestingLevelCounts.length;n++){let r=this._nestingLevelCounts[n];if(r){if(r+e>this._foldingRangesLimit){t=n;break}e+=r}}let n=new Uint32Array(this._foldingRangesLimit),r=new Uint32Array(this._foldingRangesLimit),i=[];for(let a=0,o=0;a<this._length;a++){let s=this._nestingLevels[a];(s<t||s===t&&e++<this._foldingRangesLimit)&&(n[o]=this._startIndexes[a],r[o]=this._endIndexes[a],i[o]=this._types[a],o++)}return new Bx(n,r,i)}}};function fS(e,t){let n=e.sort((e,t)=>{let n=e.start-t.start;return n===0&&(n=e.rank-t.rank),n}),r=new dS(t),i,a=[];for(let e of n)if(!i)i=e,r.add(e.start,e.end,e.kind&&e.kind.value,a.length);else if(e.start>i.start)if(e.end<=i.end)a.push(i),i=e,r.add(e.start,e.end,e.kind&&e.kind.value,a.length);else{if(e.start>i.end){do i=a.pop();while(i&&e.start>i.end);i&&a.push(i),i=e}r.add(e.start,e.end,e.kind&&e.kind.value,a.length)}return r.toIndentRanges()}var pS=class{constructor(e,t,n,r){this.editorModel=e,this.id=`init`,t.length&&(this.decorationIds=e.deltaDecorations([],t.map(t=>({range:{startLineNumber:t.startLineNumber,startColumn:0,endLineNumber:t.endLineNumber,endColumn:e.getLineLength(t.endLineNumber)},options:{description:`folding-initializing-range-provider`,stickiness:1}}))),this.timeout=setTimeout(n,r))}dispose(){this.decorationIds&&=(this.editorModel.deltaDecorations(this.decorationIds,[]),void 0),typeof this.timeout==`number`&&(clearTimeout(this.timeout),this.timeout=void 0)}compute(e){let t=[];if(this.decorationIds)for(let e of this.decorationIds){let n=this.editorModel.getDecorationRange(e);n&&t.push({start:n.startLineNumber,end:n.endLineNumber,rank:1})}return Promise.resolve(fS(t,Number.MAX_VALUE))}};const mS=gi(`folding-expanded`,M.chevronDown,z(`foldingExpandedIcon`,`Icon for expanded ranges in the editor glyph margin.`)),hS=gi(`folding-collapsed`,M.chevronRight,z(`foldingCollapsedIcon`,`Icon for collapsed ranges in the editor glyph margin.`));var gS=class e{constructor(e){this.editor=e,this.autoHideFoldingControls=!0,this.showFoldingHighlights=!0}getDecorationOption(t,n){return n?e.HIDDEN_RANGE_DECORATION:t?this.showFoldingHighlights?e.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:e.COLLAPSED_VISUAL_DECORATION:this.autoHideFoldingControls?e.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:e.EXPANDED_VISUAL_DECORATION}deltaDecorations(e,t){return this.editor.deltaDecorations(e,t)}changeDecorations(e){return this.editor.changeDecorations(e)}};gS.COLLAPSED_VISUAL_DECORATION=I.register({description:`folding-collapsed-visual-decoration`,stickiness:1,afterContentClassName:`inline-folded`,isWholeLine:!0,firstLineDecorationClassName:Co.asClassName(hS)}),gS.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=I.register({description:`folding-collapsed-highlighted-visual-decoration`,stickiness:1,afterContentClassName:`inline-folded`,className:`folded-background`,isWholeLine:!0,firstLineDecorationClassName:Co.asClassName(hS)}),gS.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=I.register({description:`folding-expanded-auto-hide-visual-decoration`,stickiness:1,isWholeLine:!0,firstLineDecorationClassName:Co.asClassName(mS)}),gS.EXPANDED_VISUAL_DECORATION=I.register({description:`folding-expanded-visual-decoration`,stickiness:1,isWholeLine:!0,firstLineDecorationClassName:`alwaysShowFoldIcons `+Co.asClassName(mS)}),gS.HIDDEN_RANGE_DECORATION=I.register({description:`folding-hidden-range-decoration`,stickiness:1});var _S=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},vS=function(e,t){return function(n,r){t(n,r,e)}},yS=new k(`foldingEnabled`,!1),bS=class e extends _{constructor(e,t){super(),this.contextKeyService=t,this.localToDispose=this._register(new K),this.editor=e;let n=this.editor.getOptions();this._isEnabled=n.get(37),this._useFoldingProviders=n.get(38)!==`indentation`,this._unfoldOnClickAfterEndOfLine=n.get(41),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=n.get(40),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingStateMemento=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new gS(e),this.foldingDecorationProvider.autoHideFoldingControls=n.get(98)===`mouseover`,this.foldingDecorationProvider.showFoldingHighlights=n.get(39),this.foldingEnabled=yS.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(e=>{if(e.hasChanged(37)&&(this._isEnabled=this.editor.getOptions().get(37),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),e.hasChanged(98)||e.hasChanged(39)){let e=this.editor.getOptions();this.foldingDecorationProvider.autoHideFoldingControls=e.get(98)===`mouseover`,this.foldingDecorationProvider.showFoldingHighlights=e.get(39),this.onModelContentChanged()}e.hasChanged(38)&&(this._useFoldingProviders=this.editor.getOptions().get(38)!==`indentation`,this.onFoldingStrategyChanged()),e.hasChanged(41)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(41)),e.hasChanged(40)&&(this._foldingImportsByDefault=this.editor.getOptions().get(40))})),this.onModelChanged()}static get(t){return t.getContribution(e.ID)}saveViewState(){let e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){let t=this.foldingModel.isInitialized?this.foldingModel.getMemento():this.hiddenRangeModel.getMemento(),n=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:n,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){let t=this.editor.getModel();if(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel||!e||e.lineCount!==t.getLineCount()||(this._currentModelHasFoldedImports=!!e.foldedImports,!e.collapsedRegions))return;(e.provider===`syntax`||e.provider===`init`)&&(this.foldingStateMemento=e);let n=e.collapsedRegions;if(this.hiddenRangeModel.applyMemento(n)){let e=this.getFoldingModel();e&&e.then(e=>{if(e){this._restoringViewState=!0;try{e.applyMemento(n)}finally{this._restoringViewState=!1}}}).then(void 0,C)}}onModelChanged(){this.localToDispose.clear();let e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new Hx(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new eS(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(e=>this.onHiddenRangesChanges(e))),this.updateScheduler=new rr(200),this.cursorChangedScheduler=new T(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(tt.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(()=>this.onModelContentChanged())),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(e=>this.onEditorMouseDown(e))),this.localToDispose.add(this.editor.onMouseUp(e=>this.onEditorMouseUp(e))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&=(this.foldingRegionPromise.cancel(),null),this.updateScheduler&&this.updateScheduler.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.foldingStateMemento=null,this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null}}),this.onModelContentChanged())}onFoldingStrategyChanged(){this.rangeProvider&&this.rangeProvider.dispose(),this.rangeProvider=null,this.onModelContentChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;if(this.rangeProvider=new iS(e),this._useFoldingProviders&&this.foldingModel){let t=tt.ordered(this.foldingModel.textModel);if(t.length===0&&this.foldingStateMemento&&this.foldingStateMemento.collapsedRegions)return this.rangeProvider=new pS(e,this.foldingStateMemento.collapsedRegions,()=>{this.foldingStateMemento=null,this.onFoldingStrategyChanged()},3e4);t.length>0&&(this.rangeProvider=new lS(e,t,()=>this.onModelContentChanged()))}return this.foldingStateMemento=null,this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onModelContentChanged(){this.updateScheduler&&(this.foldingRegionPromise&&=(this.foldingRegionPromise.cancel(),null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{let e=this.foldingModel;if(!e)return null;let t=this.getRangeProvider(e.textModel),n=this.foldingRegionPromise=No(e=>t.compute(e));return n.then(t=>{if(t&&n===this.foldingRegionPromise){let n;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){let e=t.setCollapsedAllOfType(Me.Imports.value,!0);e&&(n=b.capture(this.editor),this._currentModelHasFoldedImports=e)}let r=this.editor.getSelections(),i=r?r.map(e=>e.startLineNumber):[];e.update(t,i),n&&n.restore(this.editor)}return e})}).then(void 0,e=>(C(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){let e=this.editor.getSelections();e&&this.hiddenRangeModel.adjustSelections(e)&&this.editor.setSelections(e)}this.editor.setHiddenAreas(e)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){let e=this.getFoldingModel();e&&e.then(e=>{if(e){let t=this.editor.getSelections();if(t&&t.length>0){let n=[];for(let r of t){let t=r.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(t)&&n.push(...e.getAllRegionsAtLine(t,e=>e.isCollapsed&&t>e.startLineNumber))}n.length&&(e.toggleCollapseState(n),this.reveal(t[0].getPosition()))}}}).then(void 0,C)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;let t=e.target.range,n=!1;switch(e.target.type){case 4:let r=e.target.detail,i=e.target.element.offsetLeft;if(r.offsetX-i<5)return;n=!0;break;case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return;case 6:if(this.hiddenRangeModel.hasRanges()){let e=this.editor.getModel();if(e&&t.startColumn===e.getLineMaxColumn(t.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:n}}onEditorMouseUp(e){let t=this.getFoldingModel();if(!t||!this.mouseDownInfo||!e.target)return;let n=this.mouseDownInfo.lineNumber,r=this.mouseDownInfo.iconClicked,i=e.target.range;if(!(!i||i.startLineNumber!==n)){if(r){if(e.target.type!==4)return}else{let e=this.editor.getModel();if(!e||i.startColumn!==e.getLineMaxColumn(n))return}t.then(t=>{if(t){let i=t.getRegionAtLine(n);if(i&&i.startLineNumber===n){let a=i.isCollapsed;if(r||a){let r=e.event.altKey,o=[];if(r){let e=t.getRegionsInside(null,e=>!e.containedBy(i)&&!i.containedBy(e));for(let t of e)t.isCollapsed&&o.push(t);o.length===0&&(o=e)}else{let n=e.event.middleButton||e.event.shiftKey;if(n)for(let e of t.getRegionsInside(i))e.isCollapsed===a&&o.push(e);(a||!n||o.length===0)&&o.push(i)}t.toggleCollapseState(o),this.reveal({lineNumber:n,column:1})}}}}).then(void 0,C)}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}};bS.ID=`editor.contrib.folding`,bS=_S([vS(1,D)],bS);var xS=class extends V{runEditorCommand(e,t,n){let r=bS.get(t);if(!r)return;let i=r.getFoldingModel();if(i)return this.reportTelemetry(e,t),i.then(e=>{if(e){this.invoke(r,e,t,n);let i=t.getSelection();i&&r.reveal(i.getStartPosition())}})}getSelectedLines(e){let t=e.getSelections();return t?t.map(e=>e.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(e=>e+1):this.getSelectedLines(t)}run(e,t){}};function SS(e){if(!De(e)){if(!Es(e))return!1;let t=e;if(!De(t.levels)&&!me(t.levels)||!De(t.direction)&&!Kn(t.direction)||!De(t.selectionLines)&&(!Ln(t.selectionLines)||!t.selectionLines.every(me)))return!1}return!0}var CS=class extends xS{constructor(){super({id:`editor.unfold`,label:z(`unfoldAction.label`,`Unfold`),alias:`Unfold`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:3161,mac:{primary:2649},weight:100},description:{description:`Unfold the content in the editor`,args:[{name:`Unfold editor argument`,description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:SS,schema:{type:`object`,properties:{levels:{type:`number`,default:1},direction:{type:`string`,enum:[`up`,`down`],default:`down`},selectionLines:{type:`array`,items:{type:`number`}}}}}]}})}invoke(e,t,n,r){let i=r&&r.levels||1,a=this.getLineNumbers(r,n);r&&r.direction===`up`?Gx(t,!1,i,a):Wx(t,!1,i,a)}},wS=class extends xS{constructor(){super({id:`editor.unfoldRecursively`,label:z(`unFoldRecursivelyAction.label`,`Unfold Recursively`),alias:`Unfold Recursively`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2137),weight:100}})}invoke(e,t,n,r){Wx(t,!1,Number.MAX_VALUE,this.getSelectedLines(n))}},TS=class extends xS{constructor(){super({id:`editor.fold`,label:z(`foldAction.label`,`Fold`),alias:`Fold`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:3159,mac:{primary:2647},weight:100},description:{description:`Fold the content in the editor`,args:[{name:`Fold editor argument`,description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:SS,schema:{type:`object`,properties:{levels:{type:`number`},direction:{type:`string`,enum:[`up`,`down`]},selectionLines:{type:`array`,items:{type:`number`}}}}}]}})}invoke(e,t,n,r){let i=this.getLineNumbers(r,n),a=r&&r.levels,o=r&&r.direction;typeof a!=`number`&&typeof o!=`string`?Kx(t,!0,i):o===`up`?Gx(t,!0,a||1,i):Wx(t,!0,a||1,i)}},ES=class extends xS{constructor(){super({id:`editor.toggleFold`,label:z(`toggleFoldAction.label`,`Toggle Fold`),alias:`Toggle Fold`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2090),weight:100}})}invoke(e,t,n){Ux(t,1,this.getSelectedLines(n))}},DS=class extends xS{constructor(){super({id:`editor.foldRecursively`,label:z(`foldRecursivelyAction.label`,`Fold Recursively`),alias:`Fold Recursively`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2135),weight:100}})}invoke(e,t,n){let r=this.getSelectedLines(n);Wx(t,!0,Number.MAX_VALUE,r)}},OS=class extends xS{constructor(){super({id:`editor.foldAllBlockComments`,label:z(`foldAllBlockComments.label`,`Fold All Block Comments`),alias:`Fold All Block Comments`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2133),weight:100}})}invoke(e,t,n){if(t.regions.hasTypes())Xx(t,Me.Comment.value,!0);else{let e=n.getModel();if(!e)return;let r=Ei.getComments(e.getLanguageId());r&&r.blockCommentStartToken&&Yx(t,RegExp(`^\\s*`+Er(r.blockCommentStartToken)),!0)}}},kS=class extends xS{constructor(){super({id:`editor.foldAllMarkerRegions`,label:z(`foldAllMarkerRegions.label`,`Fold All Regions`),alias:`Fold All Regions`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2077),weight:100}})}invoke(e,t,n){if(t.regions.hasTypes())Xx(t,Me.Region.value,!0);else{let e=n.getModel();if(!e)return;let r=Ei.getFoldingRules(e.getLanguageId());r&&r.markers&&r.markers.start&&Yx(t,new RegExp(r.markers.start),!0)}}},AS=class extends xS{constructor(){super({id:`editor.unfoldAllMarkerRegions`,label:z(`unfoldAllMarkerRegions.label`,`Unfold All Regions`),alias:`Unfold All Regions`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2078),weight:100}})}invoke(e,t,n){if(t.regions.hasTypes())Xx(t,Me.Region.value,!1);else{let e=n.getModel();if(!e)return;let r=Ei.getFoldingRules(e.getLanguageId());r&&r.markers&&r.markers.start&&Yx(t,new RegExp(r.markers.start),!1)}}},jS=class extends xS{constructor(){super({id:`editor.foldAllExcept`,label:z(`foldAllExcept.label`,`Fold All Regions Except Selected`),alias:`Fold All Regions Except Selected`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2131),weight:100}})}invoke(e,t,n){Jx(t,!0,this.getSelectedLines(n))}},MS=class extends xS{constructor(){super({id:`editor.unfoldAllExcept`,label:z(`unfoldAllExcept.label`,`Unfold All Regions Except Selected`),alias:`Unfold All Regions Except Selected`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2129),weight:100}})}invoke(e,t,n){Jx(t,!1,this.getSelectedLines(n))}},NS=class extends xS{constructor(){super({id:`editor.foldAll`,label:z(`foldAllAction.label`,`Fold All`),alias:`Fold All`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2069),weight:100}})}invoke(e,t,n){Wx(t,!0)}},PS=class extends xS{constructor(){super({id:`editor.unfoldAll`,label:z(`unfoldAllAction.label`,`Unfold All`),alias:`Unfold All`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2088),weight:100}})}invoke(e,t,n){Wx(t,!1)}},FS=class e extends xS{getFoldingLevel(){return parseInt(this.id.substr(e.ID_PREFIX.length))}invoke(e,t,n){qx(t,this.getFoldingLevel(),!0,this.getSelectedLines(n))}};FS.ID_PREFIX=`editor.foldLevel`,FS.ID=e=>FS.ID_PREFIX+e;var IS=class extends xS{constructor(){super({id:`editor.gotoParentFold`,label:z(`gotoParentFold.label`,`Go to Parent Fold`),alias:`Go to Parent Fold`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,weight:100}})}invoke(e,t,n){let r=this.getSelectedLines(n);if(r.length>0){let e=Zx(r[0],t);e!==null&&n.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}},LS=class extends xS{constructor(){super({id:`editor.gotoPreviousFold`,label:z(`gotoPreviousFold.label`,`Go to Previous Folding Range`),alias:`Go to Previous Folding Range`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,weight:100}})}invoke(e,t,n){let r=this.getSelectedLines(n);if(r.length>0){let e=Qx(r[0],t);e!==null&&n.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}},RS=class extends xS{constructor(){super({id:`editor.gotoNextFold`,label:z(`gotoNextFold.label`,`Go to Next Folding Range`),alias:`Go to Next Folding Range`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,weight:100}})}invoke(e,t,n){let r=this.getSelectedLines(n);if(r.length>0){let e=$x(r[0],t);e!==null&&n.setSelection({startLineNumber:e,startColumn:1,endLineNumber:e,endColumn:1})}}};U(bS.ID,bS),o(CS),o(wS),o(TS),o(DS),o(NS),o(PS),o(OS),o(kS),o(AS),o(jS),o(MS),o(ES),o(IS),o(LS),o(RS);for(let e=1;e<=7;e++)io(new FS({id:FS.ID(e),label:z(`foldLevelAction.label`,`Fold Level {0}`,e),alias:`Fold Level ${e}`,precondition:yS,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2048|21+e),weight:100}}));const zS=v(`editor.foldBackground`,{light:Rt(rt,.3),dark:Rt(rt,.3),hc:null},z(`foldBackgroundBackground`,`Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.`),!0),BS=v(`editorGutter.foldingControlForeground`,{dark:ut,light:ut,hc:ut},z(`editorGutter.foldingControlForeground`,`Color of the folding control in the editor gutter.`));Ya((e,t)=>{let n=e.getColor(zS);n&&t.addRule(`.monaco-editor .folded-background { background-color: ${n}; }`);let r=e.getColor(BS);r&&t.addRule(`
		.monaco-editor .cldr${Co.asCSSSelector(mS)},
		.monaco-editor .cldr${Co.asCSSSelector(hS)} {
			color: ${r} !important;
		}
		`)});var VS=class extends V{constructor(){super({id:`editor.action.fontZoomIn`,label:z(`EditorFontZoomIn.label`,`Editor Font Zoom In`),alias:`Editor Font Zoom In`,precondition:void 0})}run(e,t){Ui.setZoomLevel(Ui.getZoomLevel()+1)}},HS=class extends V{constructor(){super({id:`editor.action.fontZoomOut`,label:z(`EditorFontZoomOut.label`,`Editor Font Zoom Out`),alias:`Editor Font Zoom Out`,precondition:void 0})}run(e,t){Ui.setZoomLevel(Ui.getZoomLevel()-1)}},US=class extends V{constructor(){super({id:`editor.action.fontZoomReset`,label:z(`EditorFontZoomReset.label`,`Editor Font Zoom Reset`),alias:`Editor Font Zoom Reset`,precondition:void 0})}run(e,t){Ui.setZoomLevel(0)}};o(VS),o(HS),o(US);var WS=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},GS=function(e,t){return function(n,r){t(n,r,e)}},KS=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},qS=class{constructor(e,t){this._workerService=t,this._callOnDispose=new K,this._callOnModel=new K,this._editor=e,this._callOnDispose.add(e.onDidChangeConfiguration(()=>this._update())),this._callOnDispose.add(e.onDidChangeModel(()=>this._update())),this._callOnDispose.add(e.onDidChangeModelLanguage(()=>this._update())),this._callOnDispose.add(ze.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){if(this._callOnModel.clear(),!this._editor.getOption(48)||!this._editor.hasModel())return;let e=this._editor.getModel(),[t]=ze.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;let n=new vi;for(let e of t.autoFormatTriggerCharacters)n.add(e.charCodeAt(0));this._callOnModel.add(this._editor.onDidType(e=>{let t=e.charCodeAt(e.length-1);n.has(t)&&this._trigger(String.fromCharCode(t))}))}_trigger(e){if(!this._editor.hasModel()||this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;let t=this._editor.getModel(),n=this._editor.getPosition(),r=!1,i=this._editor.onDidChangeModelContent(e=>{if(e.isFlush){r=!0,i.dispose();return}for(let t=0,a=e.changes.length;t<a;t++)if(e.changes[t].range.endLineNumber<=n.lineNumber){r=!0,i.dispose();return}});ps(this._workerService,t,n,e,t.getFormattingOptions()).then(e=>{i.dispose(),!r&&ti(e)&&(Rs.execute(this._editor,e,!0),na(e))},e=>{throw i.dispose(),e})}};qS.ID=`editor.contrib.autoFormat`,qS=WS([GS(1,li)],qS);var JS=class{constructor(e,t){this.editor=e,this._instantiationService=t,this._callOnDispose=new K,this._callOnModel=new K,this._callOnDispose.add(e.onDidChangeConfiguration(()=>this._update())),this._callOnDispose.add(e.onDidChangeModel(()=>this._update())),this._callOnDispose.add(e.onDidChangeModelLanguage(()=>this._update())),this._callOnDispose.add(Nt.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(47)&&this.editor.hasModel()&&Nt.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste(({range:e})=>this._trigger(e)))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(qi,this.editor,e,2,ta.None,j.None).catch(C))}};JS.ID=`editor.contrib.formatOnPaste`,JS=WS([GS(1,H)],JS);var YS=class extends V{constructor(){super({id:`editor.action.formatDocument`,label:z(`formatDocument.label`,`Format Document`),alias:`Format Document`,precondition:w.and(A.notInCompositeEditor,A.writable,A.hasDocumentFormattingProvider),kbOpts:{kbExpr:A.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:`1_modification`,order:1.3}})}run(e,t){return KS(this,void 0,void 0,function*(){if(t.hasModel()){let n=e.get(H);yield e.get(ua).showWhile(n.invokeFunction(Kr,t,1,ta.None,j.None),250)}})}},XS=class extends V{constructor(){super({id:`editor.action.formatSelection`,label:z(`formatSelection.label`,`Format Selection`),alias:`Format Selection`,precondition:w.and(A.writable,A.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2084),weight:100},contextMenuOpts:{when:A.hasNonEmptySelection,group:`1_modification`,order:1.31}})}run(e,t){return KS(this,void 0,void 0,function*(){if(!t.hasModel())return;let n=e.get(H),r=t.getModel(),i=t.getSelections().map(e=>e.isEmpty()?new W(e.startLineNumber,1,e.startLineNumber,r.getLineMaxColumn(e.startLineNumber)):e);yield e.get(ua).showWhile(n.invokeFunction(qi,t,i,1,ta.None,j.None),250)})}};U(qS.ID,qS),U(JS.ID,JS),o(YS),o(XS),vs.registerCommand(`editor.action.format`,e=>KS(void 0,void 0,void 0,function*(){let t=e.get(po).getFocusedCodeEditor();if(!t||!t.hasModel())return;let n=e.get(Hs);t.getSelection().isEmpty()?yield n.executeCommand(`editor.action.formatDocument`):yield n.executeCommand(`editor.action.formatSelection`)}));var ZS=class{remove(){this.parent&&this.parent.children.delete(this.id)}static findId(e,t){let n;typeof e==`string`?n=`${t.id}/${e}`:(n=`${t.id}/${e.name}`,t.children.get(n)!==void 0&&(n=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let r=n;for(let e=0;t.children.get(r)!==void 0;e++)r=`${n}_${e}`;return r}static empty(e){return e.children.size===0}},QS=class extends ZS{constructor(e,t,n){super(),this.id=e,this.parent=t,this.symbol=n,this.children=new Map}},$S=class extends ZS{constructor(e,t,n,r){super(),this.id=e,this.parent=t,this.label=n,this.order=r,this.children=new Map}},eC=class e extends ZS{constructor(e){super(),this.uri=e,this.id=`root`,this.parent=void 0,this._groups=new Map,this.children=new Map,this.id=`root`,this.parent=void 0}static create(t,n){let r=this._keys.for(t,!0),i=e._requests.get(r);if(!i){let n=new hs;i={promiseCnt:0,source:n,promise:e._create(t,n.token),model:void 0},e._requests.set(r,i);let a=Date.now();i.promise.then(()=>{this._requestDurations.update(t,Date.now()-a)})}return i.model?Promise.resolve(i.model):(i.promiseCnt+=1,n.onCancellationRequested(()=>{--i.promiseCnt===0&&(i.source.cancel(),e._requests.delete(r))}),new Promise((t,n)=>{i.promise.then(e=>{i.model=e,t(e)},t=>{e._requests.delete(r),n(t)})}))}static _create(t,n){let r=new hs(n),i=new e(t.uri),a=sn.ordered(t),o=a.map((n,a)=>{let o=ZS.findId(`provider_${a}`,i),s=new $S(o,i,n.displayName??`Unknown Outline Provider`,a);return Promise.resolve(n.provideDocumentSymbols(t,r.token)).then(t=>{for(let n of t||[])e._makeOutlineElement(n,s);return s},e=>(nt(e),s)).then(e=>{ZS.empty(e)?e.remove():i._groups.set(o,e)})}),s=sn.onDidChange(()=>{Ni(sn.ordered(t),a)||r.cancel()});return Promise.all(o).then(()=>r.token.isCancellationRequested&&!n.isCancellationRequested?e._create(t,n):i._compact()).finally(()=>{s.dispose()})}static _makeOutlineElement(t,n){let r=new QS(ZS.findId(t,n),n,t);if(t.children)for(let n of t.children)e._makeOutlineElement(n,r);n.children.set(r.id,r)}_compact(){let e=0;for(let[t,n]of this._groups)n.children.size===0?this._groups.delete(t):e+=1;if(e!==1)this.children=this._groups;else{let e=d.first(this._groups.values());for(let[,t]of e.children)t.parent=this,this.children.set(t.id,t)}return this}getTopLevelSymbols(){let e=[];for(let t of this.children.values())t instanceof QS?e.push(t.symbol):e.push(...d.map(t.children.values(),e=>e.symbol));return e.sort((e,t)=>W.compareRangesUsingStarts(e.range,t.range))}asListOfDocumentSymbols(){let t=this.getTopLevelSymbols(),n=[];return e._flattenDocumentSymbols(n,t,``),n.sort((e,t)=>W.compareRangesUsingStarts(e.range,t.range))}static _flattenDocumentSymbols(t,n,r){for(let i of n)t.push({kind:i.kind,tags:i.tags,name:i.name,detail:i.detail,containerName:i.containerName||r,range:i.range,selectionRange:i.selectionRange,children:void 0}),i.children&&e._flattenDocumentSymbols(t,i.children,i.name)}};eC._requestDurations=new go(sn,350),eC._requests=new oe(9,.75),eC._keys=new class{constructor(){this._counter=1,this._data=new WeakMap}for(e,t){return`${e.id}/${t?e.getVersionId():``}/${this._hash(sn.all(e))}`}_hash(e){let t=``;for(let n of e){let e=this._data.get(n);e===void 0&&(e=this._counter++,this._data.set(n,e)),t+=e}return t}};var tC=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};function nC(e,t,n){return tC(this,void 0,void 0,function*(){let r=yield eC.create(e,n);return t?r.asListOfDocumentSymbols():r.getTopLevelSymbols()})}vs.registerCommand(`_executeDocumentSymbolProvider`,function(e,...t){return tC(this,void 0,void 0,function*(){let[n]=t;Fs(L.isUri(n));let r=e.get(Jo).getModel(n);if(r)return nC(r,!1,j.None);let i=yield e.get(ms).createModelReference(n);try{return yield nC(i.object.textEditorModel,!1,j.None)}finally{i.dispose()}})});function rC(e,t){let n=0;for(let r=0;r<e.length;r++)e.charAt(r)===`	`?n+=t:n++;return n}function iC(e,t,n){e=e<0?0:e;let r=``;if(!n){let n=Math.floor(e/t);e%=t;for(let e=0;e<n;e++)r+=`	`}for(let t=0;t<e;t++)r+=` `;return r}function aC(e,t,n,r){if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return[];let i=Ei.getIndentationRules(e.getLanguageId());if(!i)return[];for(n=Math.min(n,e.getLineCount());t<=n&&i.unIndentedLinePattern;){let n=e.getLineContent(t);if(!i.unIndentedLinePattern.test(n))break;t++}if(t>n-1)return[];let{tabSize:o,indentSize:s,insertSpaces:c}=e.getOptions(),l=(e,t)=>(t||=1,ir.shiftIndent(e,e.length+t,o,s,c)),u=(e,t)=>(t||=1,ir.unshiftIndent(e,e.length+t,o,s,c)),d=[],f,p=e.getLineContent(t),m=p;if(r!=null){f=r;let e=a(p);m=f+p.substring(e.length),i.decreaseIndentPattern&&i.decreaseIndentPattern.test(m)&&(f=u(f),m=f+p.substring(e.length)),p!==m&&d.push(En.replaceMove(new R(t,1,t,e.length+1),ts.normalizeIndentation(f,s,c)))}else f=a(p);let h=f;i.increaseIndentPattern&&i.increaseIndentPattern.test(m)?(h=l(h),f=l(f)):i.indentNextLinePattern&&i.indentNextLinePattern.test(m)&&(h=l(h)),t++;for(let r=t;r<=n;r++){let t=e.getLineContent(r),n=a(t),o=h+t.substring(n.length);i.decreaseIndentPattern&&i.decreaseIndentPattern.test(o)&&(h=u(h),f=u(f)),n!==h&&d.push(En.replaceMove(new R(r,1,r,n.length+1),ts.normalizeIndentation(h,s,c))),!(i.unIndentedLinePattern&&i.unIndentedLinePattern.test(t))&&(i.increaseIndentPattern&&i.increaseIndentPattern.test(o)?(f=l(f),h=f):h=i.indentNextLinePattern&&i.indentNextLinePattern.test(o)?l(h):f)}return d}var oC=class e extends V{constructor(){super({id:e.ID,label:z(`indentationToSpaces`,`Convert Indentation to Spaces`),alias:`Convert Indentation to Spaces`,precondition:A.writable})}run(e,t){let n=t.getModel();if(!n)return;let r=n.getOptions(),i=t.getSelection();if(!i)return;let a=new _C(i,r.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[a]),t.pushUndoStop(),n.updateOptions({insertSpaces:!0})}};oC.ID=`editor.action.indentationToSpaces`;var sC=class e extends V{constructor(){super({id:e.ID,label:z(`indentationToTabs`,`Convert Indentation to Tabs`),alias:`Convert Indentation to Tabs`,precondition:A.writable})}run(e,t){let n=t.getModel();if(!n)return;let r=n.getOptions(),i=t.getSelection();if(!i)return;let a=new vC(i,r.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[a]),t.pushUndoStop(),n.updateOptions({insertSpaces:!1})}};sC.ID=`editor.action.indentationToTabs`;var cC=class extends V{constructor(e,t){super(t),this.insertSpaces=e}run(e,t){let n=e.get(ci),r=e.get(Jo),i=t.getModel();if(!i)return;let a=r.getCreationOptions(i.getLanguageId(),i.uri,i.isForSimpleWidget),o=[1,2,3,4,5,6,7,8].map(e=>({id:e.toString(),label:e.toString(),description:e===a.tabSize?z(`configuredTabSize`,`Configured Tab Size`):void 0})),s=Math.min(i.getOptions().tabSize-1,7);setTimeout(()=>{n.pick(o,{placeHolder:z({key:`selectTabWidth`,comment:[`Tab corresponds to the tab key`]},`Select Tab Size for Current File`),activeItem:o[s]}).then(e=>{e&&i&&!i.isDisposed()&&i.updateOptions({tabSize:parseInt(e.label,10),insertSpaces:this.insertSpaces})})},50)}},lC=class e extends cC{constructor(){super(!1,{id:e.ID,label:z(`indentUsingTabs`,`Indent Using Tabs`),alias:`Indent Using Tabs`,precondition:void 0})}};lC.ID=`editor.action.indentUsingTabs`;var uC=class e extends cC{constructor(){super(!0,{id:e.ID,label:z(`indentUsingSpaces`,`Indent Using Spaces`),alias:`Indent Using Spaces`,precondition:void 0})}};uC.ID=`editor.action.indentUsingSpaces`;var dC=class e extends V{constructor(){super({id:e.ID,label:z(`detectIndentation`,`Detect Indentation from Content`),alias:`Detect Indentation from Content`,precondition:void 0})}run(e,t){let n=e.get(Jo),r=t.getModel();if(!r)return;let i=n.getCreationOptions(r.getLanguageId(),r.uri,r.isForSimpleWidget);r.detectIndentation(i.insertSpaces,i.tabSize)}};dC.ID=`editor.action.detectIndentation`;var fC=class extends V{constructor(){super({id:`editor.action.reindentlines`,label:z(`editor.reindentlines`,`Reindent Lines`),alias:`Reindent Lines`,precondition:A.writable})}run(e,t){let n=t.getModel();if(!n)return;let r=aC(n,1,n.getLineCount());r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}},pC=class extends V{constructor(){super({id:`editor.action.reindentselectedlines`,label:z(`editor.reindentselectedlines`,`Reindent Selected Lines`),alias:`Reindent Selected Lines`,precondition:A.writable})}run(e,t){let n=t.getModel();if(!n)return;let r=t.getSelections();if(r===null)return;let i=[];for(let e of r){let t=e.startLineNumber,r=e.endLineNumber;if(t!==r&&e.endColumn===1&&r--,t===1){if(t===r)continue}else t--;let a=aC(n,t,r);i.push(...a)}i.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,i),t.pushUndoStop())}},mC=class{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(let t of e)t.range&&typeof t.text==`string`&&this._edits.push(t)}getEditOperations(e,t){for(let e of this._edits)t.addEditOperation(W.lift(e.range),e.text);let n=!1;Array.isArray(this._edits)&&this._edits.length===1&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(n=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(n=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),n||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}},hC=class{constructor(e){this.callOnDispose=new K,this.callOnModel=new K,this.editor=e,this.callOnDispose.add(e.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.add(e.onDidChangeModel(()=>this.update())),this.callOnDispose.add(e.onDidChangeModelLanguage(()=>this.update()))}update(){this.callOnModel.clear(),!(this.editor.getOption(9)<4||this.editor.getOption(47))&&this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste(({range:e})=>{this.trigger(e)}))}trigger(e){let t=this.editor.getSelections();if(t===null||t.length>1)return;let n=this.editor.getModel();if(!n||!n.isCheapToTokenize(e.getStartPosition().lineNumber))return;let r=this.editor.getOption(9),{tabSize:i,indentSize:o,insertSpaces:s}=n.getOptions(),c=[],l={shiftIndent:e=>ir.shiftIndent(e,e.length+1,i,o,s),unshiftIndent:e=>ir.unshiftIndent(e,e.length+1,i,o,s)},u=e.startLineNumber;for(;u<=e.endLineNumber;){if(this.shouldIgnoreLine(n,u)){u++;continue}break}if(u>e.endLineNumber)return;let d=n.getLineContent(u);if(!/\S/.test(d.substring(0,e.startColumn-1))){let e=Ei.getGoodIndentForLine(r,n,n.getLanguageId(),u,l);if(e!==null){let t=a(d),r=rC(e,i);if(r!==rC(t,i)){let e=iC(r,i,s);c.push({range:new W(u,1,u,t.length+1),text:e}),d=e+d.substr(t.length)}else{let e=Ei.getIndentMetadata(n,u);if(e===0||e===8)return}}}let f=u;for(;u<e.endLineNumber;){if(!/\S/.test(n.getLineContent(u+1))){u++;continue}break}if(u!==e.endLineNumber){let t=Ei.getGoodIndentForLine(r,{getLineTokens:e=>n.getLineTokens(e),getLanguageId:()=>n.getLanguageId(),getLanguageIdAtPosition:(e,t)=>n.getLanguageIdAtPosition(e,t),getLineContent:e=>e===f?d:n.getLineContent(e)},n.getLanguageId(),u+1,l);if(t!==null){let r=rC(t,i),o=rC(a(n.getLineContent(u+1)),i);if(r!==o){let t=r-o;for(let r=u+1;r<=e.endLineNumber;r++){let e=a(n.getLineContent(r)),o=iC(rC(e,i)+t,i,s);o!==e&&c.push({range:new W(r,1,r,e.length+1),text:o})}}}}if(c.length>0){this.editor.pushUndoStop();let e=new mC(c,this.editor.getSelection());this.editor.executeCommand(`autoIndentOnPaste`,e),this.editor.pushUndoStop()}}shouldIgnoreLine(e,t){e.forceTokenization(t);let n=e.getLineFirstNonWhitespaceColumn(t);if(n===0)return!0;let r=e.getLineTokens(t);if(r.getCount()>0){let e=r.findTokenIndexAtOffset(n);if(e>=0&&r.getStandardTokenType(e)===1)return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}};hC.ID=`editor.contrib.autoIndentOnPaste`;function gC(e,t,n,r){if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return;let i=``;for(let e=0;e<n;e++)i+=` `;let a=new RegExp(i,`gi`);for(let n=1,o=e.getLineCount();n<=o;n++){let o=e.getLineFirstNonWhitespaceColumn(n);if(o===0&&(o=e.getLineMaxColumn(n)),o===1)continue;let s=new W(n,1,n,o),c=e.getValueInRange(s),l=r?c.replace(/\t/gi,i):c.replace(a,`	`);t.addEditOperation(s,l)}}var _C=class{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),gC(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}},vC=class{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),gC(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}};U(hC.ID,hC),o(oC),o(sC),o(lC),o(uC),o(dC),o(fC),o(pC);var yC=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},bC=function(e,t){return function(n,r){t(n,r,e)}},xC=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},SC=1500,CC=class{constructor(){this._data=new ur}push(e,t){let n=this._data.get(e.uri);n===void 0?this._data.set(e.uri,new Set([t])):n.add(t)}pop(e,t){let n=this._data.get(e.uri);n&&(n.delete(t),n.size===0&&this._data.delete(e.uri))}has(e,t){return!!this._data.get(e.uri)?.has(t)}};function wC(e,t,n,r){return xC(this,void 0,void 0,function*(){let i=[],a=ne.ordered(e).reverse().map(a=>t.map(t=>xC(this,void 0,void 0,function*(){try{n.push(e,a);let o=yield a.provideInlayHints(e,t,r);o?.length&&i.push(o.filter(e=>t.containsPosition(e.position)))}catch(e){nt(e)}finally{n.pop(e,a)}})));return yield Promise.all(a.flat()),i.flat().sort((e,t)=>P.compare(e.position,t.position))})}var TC=class e{constructor(){this._entries=new oe(50)}get(t){let n=e._key(t);return this._entries.get(n)}set(t,n){let r=e._key(t);this._entries.set(r,n)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}},EC=class e{constructor(t,n){this._editor=t,this._codeEditorService=n,this._decorationOwnerId=++e._decorationOwnerIdPool,this._disposables=new K,this._sessionDisposables=new K,this._getInlayHintsDelays=new go(ne,25,500),this._cache=new TC,this._decorations=new Map,this._disposables.add(ne.onDidChange(()=>this._update())),this._disposables.add(t.onDidChangeModel(()=>this._update())),this._disposables.add(t.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(t.onDidChangeConfiguration(e=>{e.hasChanged(125)&&this._update()})),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){if(this._sessionDisposables.clear(),this._removeAllDecorations(),!this._editor.getOption(125).enabled)return;let e=this._editor.getModel();if(!e||!ne.has(e))return;let t=this._cache.get(e);t&&this._updateHintsDecorators([e.getFullModelRange()],t);let n=new CC,r=new T(()=>xC(this,void 0,void 0,function*(){let t=Date.now(),i=new hs;this._sessionDisposables.add(ja(()=>i.dispose(!0)));let a=this._getHintsRanges(),o=yield wC(e,a,n,i.token);r.delay=this._getInlayHintsDelays.update(e,Date.now()-t),!i.token.isCancellationRequested&&(this._updateHintsDecorators(a,o),this._cache.set(e,Array.from(this._decorations.values()).map(e=>e.hint)))}),this._getInlayHintsDelays.get(e));this._sessionDisposables.add(r),this._sessionDisposables.add(this._editor.onDidChangeModelContent(()=>r.schedule())),this._disposables.add(this._editor.onDidScrollChange(()=>r.schedule())),r.schedule();let i=new K;this._sessionDisposables.add(i);for(let t of ne.all(e))typeof t.onDidChangeInlayHints==`function`&&i.add(t.onDidChangeInlayHints(()=>{n.has(e,t)||r.schedule()}))}_getHintsRanges(){let e=this._editor.getModel(),t=this._editor.getVisibleRangesPlusViewportAboveBelow(),n=[];for(let r of t.sort(W.compareRangesUsingStarts)){let t=e.validateRange(new W(r.startLineNumber-30,r.startColumn,r.endLineNumber+30,r.endColumn));n.length===0||!W.areIntersectingOrTouching(n[n.length-1],t)?n.push(t):n[n.length-1]=W.plusRange(n[n.length-1],t)}return n}_updateHintsDecorators(e,t){let{fontSize:n,fontFamily:r}=this._getLayoutInfo(),i=this._editor.getModel(),a=[],o=[],s=`--code-editorInlayHintsFontFamily`;this._editor.getContainerDomNode().style.setProperty(s,r);for(let e of t){let{text:t,position:r,whitespaceBefore:c,whitespaceAfter:l}=e,u=c?n/3|0:0,d=l?n/3|0:0,f={contentText:OC(t),fontSize:`${n}px`,margin:`0px ${d}px 0px ${u}px`,fontFamily:`var(${s}), ${Et.fontFamily}`,padding:`1px ${Math.max(1,n/4)|0}px`,borderRadius:`${n/4|0}px`,verticalAlign:`middle`,backgroundColor:aa(en),color:aa(Na)};e.kind===qs.Parameter?(f.backgroundColor=aa(p),f.color=aa(wa)):e.kind===qs.Type&&(f.backgroundColor=aa(It),f.color=aa(Gt));let m={beforeInjectedText:Object.assign(Object.assign({},f),{affectsLetterSpacing:!0})},h=W.fromPositions(r),ee=i.getWordAtPosition(r),g=!1;ee&&(ee.endColumn===r.column?(m.afterInjectedText=m.beforeInjectedText,m.beforeInjectedText=void 0,g=!0,h=DC(ee,r.lineNumber)):ee.startColumn===r.column&&(g=!0,h=DC(ee,r.lineNumber)));let te=`inlayHints-`+Ha(m).toString(16);if(this._codeEditorService.registerDecorationType(`inlay-hints-controller`,te,m,void 0,this._editor),a.push(te),o.push({range:h,options:Object.assign(Object.assign({},this._codeEditorService.resolveDecorationOptions(te,!0)),{showIfCollapsed:!g,stickiness:0})})>SC)break}let c=[];for(let t of e)for(let{id:e}of i.getDecorationsInRange(t,this._decorationOwnerId,!0)){let t=this._decorations.get(e);t&&(c.push(e),this._codeEditorService.removeDecorationType(t.decorationTypeId),this._decorations.delete(e))}let l=i.deltaDecorations(c,o,this._decorationOwnerId);for(let e=0;e<l.length;e++)this._decorations.set(l[e],{hint:t[e],decorationTypeId:a[e]})}_getLayoutInfo(){let e=this._editor.getOption(125),t=this._editor.getOption(45),n=e.fontSize;(!n||n<5||n>t)&&(n=t*.9|0);let r=e.fontFamily||this._editor.getOption(42);return{fontSize:n,fontFamily:r}}_removeAllDecorations(){this._editor.deltaDecorations(Array.from(this._decorations.keys()),[]);for(let e of this._decorations.values())this._codeEditorService.removeDecorationType(e.decorationTypeId);this._decorations.clear()}};EC.ID=`editor.contrib.InlayHints`,EC._decorationOwnerIdPool=0,EC=yC([bC(1,po)],EC);function DC(e,t){return new W(t,e.startColumn,t,e.endColumn)}function OC(e){return e.replace(/[ \t]/g,`\xA0`)}U(EC.ID,EC),vs.registerCommand(`_executeInlayHintProvider`,(e,...t)=>xC(void 0,void 0,void 0,function*(){let[n,r]=t;Fs(L.isUri(n)),Fs(W.isIRange(r));let i=yield e.get(ms).createModelReference(n);try{return yield wC(i.object.textEditorModel,[W.lift(r)],new CC,j.None)}finally{i.dispose()}}));var kC=class{constructor(e,t,n){this._editRange=e,this._originalSelection=t,this._text=n}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){let n=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new R(n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn),n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn)):new R(n.endLineNumber,n.endColumn-this._text.length,n.endLineNumber,n.endColumn)}},AC=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},jC=function(e,t){return function(n,r){t(n,r,e)}},MC=class e{constructor(e,t){this.decorationIds=[],this.editor=e,this.editorWorkerService=t}static get(t){return t.getContribution(e.ID)}dispose(){}run(t,n){this.currentRequest&&this.currentRequest.cancel();let r=this.editor.getSelection(),i=this.editor.getModel();if(!i||!r)return;let a=r;if(a.startLineNumber!==a.endLineNumber)return;let o=new Yn(this.editor,5),s=i.uri;return this.editorWorkerService.canNavigateValueSet(s)?(this.currentRequest=No(e=>this.editorWorkerService.navigateValueSet(s,a,n)),this.currentRequest.then(n=>{if(!n||!n.range||!n.value||!o.validate(this.editor))return;let r=W.lift(n.range),i=n.range,s=n.value.length-(a.endColumn-a.startColumn);i={startLineNumber:i.startLineNumber,startColumn:i.startColumn,endLineNumber:i.endLineNumber,endColumn:i.startColumn+n.value.length},s>1&&(a=new R(a.startLineNumber,a.startColumn,a.endLineNumber,a.endColumn+s-1));let c=new kC(r,a,n.value);this.editor.pushUndoStop(),this.editor.executeCommand(t,c),this.editor.pushUndoStop(),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[{range:i,options:e.DECORATION}]),this.decorationRemover&&this.decorationRemover.cancel(),this.decorationRemover=xn(350),this.decorationRemover.then(()=>this.decorationIds=this.editor.deltaDecorations(this.decorationIds,[])).catch(C)}).catch(C)):Promise.resolve(void 0)}};MC.ID=`editor.contrib.inPlaceReplaceController`,MC.DECORATION=I.register({description:`in-place-replace`,className:`valueSetReplacement`}),MC=AC([jC(1,li)],MC);var NC=class extends V{constructor(){super({id:`editor.action.inPlaceReplace.up`,label:z(`InPlaceReplaceAction.previous.label`,`Replace with Previous Value`),alias:`Replace with Previous Value`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:3154,weight:100}})}run(e,t){let n=MC.get(t);return n?n.run(this.id,!0):Promise.resolve(void 0)}},PC=class extends V{constructor(){super({id:`editor.action.inPlaceReplace.down`,label:z(`InPlaceReplaceAction.next.label`,`Replace with Next Value`),alias:`Replace with Next Value`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:3156,weight:100}})}run(e,t){let n=MC.get(t);return n?n.run(this.id,!1):Promise.resolve(void 0)}};U(MC.ID,MC),o(NC),o(PC),Ya((e,t)=>{let n=e.getColor(zo);n&&t.addRule(`.monaco-editor.vs .valueSetReplacement { outline: solid 2px ${n}; }`)});var FC=class{constructor(e,t){this._selection=e,this._cursors=t,this._selectionId=null}getEditOperations(e,t){let n=IC(e,this._cursors);for(let e=0,r=n.length;e<r;e++){let r=n[e];t.addEditOperation(r.range,r.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}};function IC(e,t){t.sort((e,t)=>e.lineNumber===t.lineNumber?e.column-t.column:e.lineNumber-t.lineNumber);for(let e=t.length-2;e>=0;e--)t[e].lineNumber===t[e+1].lineNumber&&t.splice(e,1);let n=[],r=0,i=0,a=t.length;for(let o=1,s=e.getLineCount();o<=s;o++){let s=e.getLineContent(o),c=s.length+1,l=0;if(i<a&&t[i].lineNumber===o&&(l=t[i].column,i++,l===c)||s.length===0)continue;let u=vo(s),d=0;if(u===-1)d=1;else if(u!==s.length-1)d=u+2;else continue;d=Math.max(l,d),n[r++]=En.delete(new W(o,d,o,c))}return n}var LC=class{constructor(e,t,n){this._selection=e,this._isCopyingDown=t,this._noop=n||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let n=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,n.startLineNumber<n.endLineNumber&&n.endColumn===1&&(this._endLineNumberDelta=1,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));let r=[];for(let t=n.startLineNumber;t<=n.endLineNumber;t++)r.push(e.getLineContent(t));let i=r.join(`
`);i===``&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new W(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber+1,1),n.endLineNumber===e.getLineCount()?``:`
`):this._isCopyingDown?t.addEditOperation(new W(n.startLineNumber,1,n.startLineNumber,1),i+`
`):t.addEditOperation(new W(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),`
`+i),this._selectionId=t.trackSelection(n),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);if(this._startLineNumberDelta!==0||this._endLineNumberDelta!==0){let e=n.startLineNumber,t=n.startColumn,r=n.endLineNumber,i=n.endColumn;this._startLineNumberDelta!==0&&(e+=this._startLineNumberDelta,t=1),this._endLineNumberDelta!==0&&(r+=this._endLineNumberDelta,i=1),n=R.createWithDirection(e,t,r,i,this._selectionDirection)}return n}},RC=class{constructor(e,t,n){this._selection=e,this._isMovingDown=t,this._autoIndent=n,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){let n=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===n){this._selectionId=t.trackSelection(this._selection);return}if(!this._isMovingDown&&this._selection.startLineNumber===1){this._selectionId=t.trackSelection(this._selection);return}this._moveEndPositionDown=!1;let r=this._selection;r.startLineNumber<r.endLineNumber&&r.endColumn===1&&(this._moveEndPositionDown=!0,r=r.setEndPosition(r.endLineNumber-1,e.getLineMaxColumn(r.endLineNumber-1)));let{tabSize:i,indentSize:o,insertSpaces:s}=e.getOptions(),c=this.buildIndentConverter(i,o,s),l={getLineTokens:t=>e.getLineTokens(t),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(t,n)=>e.getLanguageIdAtPosition(t,n),getLineContent:null};if(r.startLineNumber===r.endLineNumber&&e.getLineMaxColumn(r.startLineNumber)===1){let n=r.startLineNumber,i=this._isMovingDown?n+1:n-1;e.getLineMaxColumn(i)===1?t.addEditOperation(new W(1,1,1,1),null):(t.addEditOperation(new W(n,1,n,1),e.getLineContent(i)),t.addEditOperation(new W(i,1,i,e.getLineMaxColumn(i)),null)),r=new R(i,1,i,1)}else{let n,o;if(this._isMovingDown){n=r.endLineNumber+1,o=e.getLineContent(n),t.addEditOperation(new W(n-1,e.getLineMaxColumn(n-1),n,e.getLineMaxColumn(n)),null);let u=o;if(this.shouldAutoIndent(e,r)){let d=this.matchEnterRule(e,c,i,n,r.startLineNumber-1);if(d!==null)u=iC(d+rC(a(e.getLineContent(n)),i),i,s)+this.trimLeft(o);else{l.getLineContent=t=>t===r.startLineNumber?e.getLineContent(n):e.getLineContent(t);let t=Ei.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(n,1),r.startLineNumber,c);if(t!==null){let r=a(e.getLineContent(n)),c=rC(t,i);c!==rC(r,i)&&(u=iC(c,i,s)+this.trimLeft(o))}}t.addEditOperation(new W(r.startLineNumber,1,r.startLineNumber,1),u+`
`);let f=this.matchEnterRuleMovingDown(e,c,i,r.startLineNumber,n,u);if(f!==null)f!==0&&this.getIndentEditsOfMovingBlock(e,t,r,i,s,f);else{l.getLineContent=t=>t===r.startLineNumber?u:t>=r.startLineNumber+1&&t<=r.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t);let o=Ei.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(n,1),r.startLineNumber+1,c);if(o!==null){let n=a(e.getLineContent(r.startLineNumber)),c=rC(o,i),l=rC(n,i);if(c!==l){let n=c-l;this.getIndentEditsOfMovingBlock(e,t,r,i,s,n)}}}}else t.addEditOperation(new W(r.startLineNumber,1,r.startLineNumber,1),u+`
`)}else if(n=r.startLineNumber-1,o=e.getLineContent(n),t.addEditOperation(new W(n,1,n+1,1),null),t.addEditOperation(new W(r.endLineNumber,e.getLineMaxColumn(r.endLineNumber),r.endLineNumber,e.getLineMaxColumn(r.endLineNumber)),`
`+o),this.shouldAutoIndent(e,r)){l.getLineContent=t=>t===n?e.getLineContent(r.startLineNumber):e.getLineContent(t);let o=this.matchEnterRule(e,c,i,r.startLineNumber,r.startLineNumber-2);if(o!==null)o!==0&&this.getIndentEditsOfMovingBlock(e,t,r,i,s,o);else{let o=Ei.getGoodIndentForLine(this._autoIndent,l,e.getLanguageIdAtPosition(r.startLineNumber,1),n,c);if(o!==null){let n=a(e.getLineContent(r.startLineNumber)),c=rC(o,i),l=rC(n,i);if(c!==l){let n=c-l;this.getIndentEditsOfMovingBlock(e,t,r,i,s,n)}}}}}this._selectionId=t.trackSelection(r)}buildIndentConverter(e,t,n){return{shiftIndent:r=>ir.shiftIndent(r,r.length+1,e,t,n),unshiftIndent:r=>ir.unshiftIndent(r,r.length+1,e,t,n)}}parseEnterResult(e,t,n,r,i){if(i){let o=i.indentation;i.indentAction===qr.None||i.indentAction===qr.Indent?o=i.indentation+i.appendText:i.indentAction===qr.IndentOutdent?o=i.indentation:i.indentAction===qr.Outdent&&(o=t.unshiftIndent(i.indentation)+i.appendText);let s=e.getLineContent(r);if(this.trimLeft(s).indexOf(this.trimLeft(o))>=0){let i=a(e.getLineContent(r)),s=a(o),c=Ei.getIndentMetadata(e,r);return c!==null&&c&2&&(s=t.unshiftIndent(s)),rC(s,n)-rC(i,n)}}return null}matchEnterRuleMovingDown(e,t,n,r,i,a){if(vo(a)>=0){let a=e.getLineMaxColumn(i),o=Ei.getEnterAction(this._autoIndent,e,new W(i,a,i,a));return this.parseEnterResult(e,t,n,r,o)}else{let i=r-1;for(;i>=1&&!(vo(e.getLineContent(i))>=0);)i--;if(i<1||r>e.getLineCount())return null;let a=e.getLineMaxColumn(i),o=Ei.getEnterAction(this._autoIndent,e,new W(i,a,i,a));return this.parseEnterResult(e,t,n,r,o)}}matchEnterRule(e,t,n,r,i,a){let o=i;for(;o>=1;){let t;if(t=o===i&&a!==void 0?a:e.getLineContent(o),vo(t)>=0)break;o--}if(o<1||r>e.getLineCount())return null;let s=e.getLineMaxColumn(o),c=Ei.getEnterAction(this._autoIndent,e,new W(o,s,o,s));return this.parseEnterResult(e,t,n,r,c)}trimLeft(e){return e.replace(/^\s+/,``)}shouldAutoIndent(e,t){if(this._autoIndent<4||!e.isCheapToTokenize(t.startLineNumber))return!1;let n=e.getLanguageIdAtPosition(t.startLineNumber,1);return!(n!==e.getLanguageIdAtPosition(t.endLineNumber,1)||Ei.getIndentRulesSupport(n)===null)}getIndentEditsOfMovingBlock(e,t,n,r,i,o){for(let s=n.startLineNumber;s<=n.endLineNumber;s++){let c=a(e.getLineContent(s)),l=iC(rC(c,r)+o,r,i);l!==c&&(t.addEditOperation(new W(s,1,s,c.length+1),l),s===n.endLineNumber&&n.endColumn<=c.length+1&&l===``&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(n=n.setEndPosition(n.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&n.startLineNumber<n.endLineNumber&&(n=n.setEndPosition(n.endLineNumber,2)),n}},zC=class e{constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}static getCollator(){return e._COLLATOR||=new Intl.Collator,e._COLLATOR}getEditOperations(e,t){let n=VC(e,this.selection,this.descending);n&&t.addEditOperation(n.range,n.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,n){if(e===null)return!1;let r=BC(e,t,n);if(!r)return!1;for(let e=0,t=r.before.length;e<t;e++)if(r.before[e]!==r.after[e])return!0;return!1}};zC._COLLATOR=null;function BC(e,t,n){let r=t.startLineNumber,i=t.endLineNumber;if(t.endColumn===1&&i--,r>=i)return null;let a=[];for(let t=r;t<=i;t++)a.push(e.getLineContent(t));let o=a.slice(0);return o.sort(zC.getCollator().compare),n===!0&&(o=o.reverse()),{startLineNumber:r,endLineNumber:i,before:a,after:o}}function VC(e,t,n){let r=BC(e,t,n);return r?En.replace(new W(r.startLineNumber,1,r.endLineNumber,e.getLineMaxColumn(r.endLineNumber)),r.after.join(`
`)):null}var HC=class extends V{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;let n=t.getSelections().map((e,t)=>({selection:e,index:t,ignore:!1}));n.sort((e,t)=>W.compareRangesUsingStarts(e.selection,t.selection));let r=n[0];for(let e=1;e<n.length;e++){let t=n[e];r.selection.endLineNumber===t.selection.startLineNumber&&(r.index<t.index?t.ignore=!0:(r.ignore=!0,r=t))}let i=[];for(let e of n)i.push(new LC(e.selection,this.down,e.ignore));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}},UC=class extends HC{constructor(){super(!1,{id:`editor.action.copyLinesUpAction`,label:z(`lines.copyUp`,`Copy Line Up`),alias:`Copy Line Up`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`2_line`,title:z({key:`miCopyLinesUp`,comment:[`&& denotes a mnemonic`]},`&&Copy Line Up`),order:1}})}},WC=class extends HC{constructor(){super(!0,{id:`editor.action.copyLinesDownAction`,label:z(`lines.copyDown`,`Copy Line Down`),alias:`Copy Line Down`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`2_line`,title:z({key:`miCopyLinesDown`,comment:[`&& denotes a mnemonic`]},`Co&&py Line Down`),order:2}})}},GC=class extends V{constructor(){super({id:`editor.action.duplicateSelection`,label:z(`duplicateSelection`,`Duplicate Selection`),alias:`Duplicate Selection`,precondition:A.writable,menuOpts:{menuId:N.MenubarSelectionMenu,group:`2_line`,title:z({key:`miDuplicateSelection`,comment:[`&& denotes a mnemonic`]},`&&Duplicate Selection`),order:5}})}run(e,t,n){if(!t.hasModel())return;let r=[],i=t.getSelections(),a=t.getModel();for(let e of i)if(e.isEmpty())r.push(new LC(e,!0));else{let t=new R(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn);r.push(new kr(t,a.getValueInRange(e)))}t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}},KC=class extends V{constructor(e,t){super(t),this.down=e}run(e,t){let n=[],r=t.getSelections()||[],i=t.getOption(9);for(let e of r)n.push(new RC(e,this.down,i));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}},qC=class extends KC{constructor(){super(!1,{id:`editor.action.moveLinesUpAction`,label:z(`lines.moveUp`,`Move Line Up`),alias:`Move Line Up`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`2_line`,title:z({key:`miMoveLinesUp`,comment:[`&& denotes a mnemonic`]},`Mo&&ve Line Up`),order:3}})}},JC=class extends KC{constructor(){super(!0,{id:`editor.action.moveLinesDownAction`,label:z(`lines.moveDown`,`Move Line Down`),alias:`Move Line Down`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`2_line`,title:z({key:`miMoveLinesDown`,comment:[`&& denotes a mnemonic`]},`Move &&Line Down`),order:4}})}},YC=class extends V{constructor(e,t){super(t),this.descending=e}run(e,t){let n=t.getSelections()||[];for(let e of n)if(!zC.canRun(t.getModel(),e,this.descending))return;let r=[];for(let e=0,t=n.length;e<t;e++)r[e]=new zC(n[e],this.descending);t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}},XC=class extends YC{constructor(){super(!1,{id:`editor.action.sortLinesAscending`,label:z(`lines.sortAscending`,`Sort Lines Ascending`),alias:`Sort Lines Ascending`,precondition:A.writable})}},ZC=class extends YC{constructor(){super(!0,{id:`editor.action.sortLinesDescending`,label:z(`lines.sortDescending`,`Sort Lines Descending`),alias:`Sort Lines Descending`,precondition:A.writable})}},QC=class extends V{constructor(){super({id:`editor.action.removeDuplicateLines`,label:z(`lines.deleteDuplicates`,`Delete Duplicate Lines`),alias:`Delete Duplicate Lines`,precondition:A.writable})}run(e,t){if(!t.hasModel())return;let n=t.getModel();if(n.getLineCount()===1&&n.getLineMaxColumn(1)===1)return;let r=[],i=[],a=0;for(let e of t.getSelections()){let t=new Set,o=[];for(let r=e.startLineNumber;r<=e.endLineNumber;r++){let e=n.getLineContent(r);t.has(e)||(o.push(e),t.add(e))}let s=new R(e.startLineNumber,1,e.endLineNumber,n.getLineMaxColumn(e.endLineNumber)),c=e.startLineNumber-a,l=new R(c,1,c+o.length-1,o[o.length-1].length);r.push(En.replace(s,o.join(`
`))),i.push(l),a+=e.endLineNumber-e.startLineNumber+1-o.length}t.pushUndoStop(),t.executeEdits(this.id,r,i),t.pushUndoStop()}},$C=class e extends V{constructor(){super({id:e.ID,label:z(`lines.trimTrailingWhitespace`,`Trim Trailing Whitespace`),alias:`Trim Trailing Whitespace`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:Yi(2089,2102),weight:100}})}run(e,t,n){let r=[];n.reason===`auto-save`&&(r=(t.getSelections()||[]).map(e=>new P(e.positionLineNumber,e.positionColumn)));let i=t.getSelection();if(i===null)return;let a=new FC(i,r);t.pushUndoStop(),t.executeCommands(this.id,[a]),t.pushUndoStop()}};$C.ID=`editor.action.trimTrailingWhitespace`;var ew=class extends V{constructor(){super({id:`editor.action.deleteLines`,label:z(`lines.delete`,`Delete Line`),alias:`Delete Line`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;let n=this._getLinesToRemove(t),r=t.getModel();if(r.getLineCount()===1&&r.getLineMaxColumn(1)===1)return;let i=0,a=[],o=[];for(let e=0,t=n.length;e<t;e++){let t=n[e],s=t.startLineNumber,c=t.endLineNumber,l=1,u=r.getLineMaxColumn(c);c<r.getLineCount()?(c+=1,u=1):s>1&&(--s,l=r.getLineMaxColumn(s)),a.push(En.replace(new R(s,l,c,u),``)),o.push(new R(s-i,t.positionColumn,s-i,t.positionColumn)),i+=t.endLineNumber-t.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,a,o),t.pushUndoStop()}_getLinesToRemove(e){let t=e.getSelections().map(e=>{let t=e.endLineNumber;return e.startLineNumber<e.endLineNumber&&e.endColumn===1&&--t,{startLineNumber:e.startLineNumber,selectionStartColumn:e.selectionStartColumn,endLineNumber:t,positionColumn:e.positionColumn}});t.sort((e,t)=>e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber);let n=[],r=t[0];for(let e=1;e<t.length;e++)r.endLineNumber+1>=t[e].startLineNumber?r.endLineNumber=t[e].endLineNumber:(n.push(r),r=t[e]);return n.push(r),n}},tw=class extends V{constructor(){super({id:`editor.action.indentLines`,label:z(`lines.indent`,`Indent Line`),alias:`Indent Line`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:2137,weight:100}})}run(e,t){let n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,et.indent(n.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}},nw=class extends V{constructor(){super({id:`editor.action.outdentLines`,label:z(`lines.outdent`,`Outdent Line`),alias:`Outdent Line`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:2135,weight:100}})}run(e,t){le.Outdent.runEditorCommand(e,t,null)}},rw=class extends V{constructor(){super({id:`editor.action.insertLineBefore`,label:z(`lines.insertBefore`,`Insert Line Above`),alias:`Insert Line Above`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:3075,weight:100}})}run(e,t){let n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,et.lineInsertBefore(n.cursorConfig,t.getModel(),t.getSelections())))}},iw=class extends V{constructor(){super({id:`editor.action.insertLineAfter`,label:z(`lines.insertAfter`,`Insert Line Below`),alias:`Insert Line Below`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:2051,weight:100}})}run(e,t){let n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,et.lineInsertAfter(n.cursorConfig,t.getModel(),t.getSelections())))}},aw=class extends V{run(e,t){if(!t.hasModel())return;let n=t.getSelection(),r=this._getRangesToDelete(t),i=[];for(let e=0,t=r.length-1;e<t;e++){let t=r[e],n=r[e+1];W.intersectRanges(t,n)===null?i.push(t):r[e+1]=W.plusRange(t,n)}i.push(r[r.length-1]);let a=this._getEndCursorState(n,i),o=i.map(e=>En.replace(e,``));t.pushUndoStop(),t.executeEdits(this.id,o,a),t.pushUndoStop()}},ow=class extends aw{constructor(){super({id:`deleteAllLeft`,label:z(`lines.deleteAllLeft`,`Delete All Left`),alias:`Delete All Left`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let n=null,r=[],i=0;return t.forEach(t=>{let a;if(t.endColumn===1&&i>0){let e=t.startLineNumber-i;a=new R(e,t.startColumn,e,t.startColumn)}else a=new R(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn);i+=t.endLineNumber-t.startLineNumber,t.intersectRanges(e)?n=a:r.push(a)}),n&&r.unshift(n),r}_getRangesToDelete(e){let t=e.getSelections();if(t===null)return[];let n=t,r=e.getModel();return r===null?[]:(n.sort(W.compareRangesUsingStarts),n=n.map(e=>{if(e.isEmpty())if(e.startColumn===1){let t=Math.max(1,e.startLineNumber-1);return new W(t,e.startLineNumber===1?1:r.getLineContent(t).length+1,e.startLineNumber,1)}else return new W(e.startLineNumber,1,e.startLineNumber,e.startColumn);else return new W(e.startLineNumber,1,e.endLineNumber,e.endColumn)}),n)}},sw=class extends aw{constructor(){super({id:`deleteAllRight`,label:z(`lines.deleteAllRight`,`Delete All Right`),alias:`Delete All Right`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let n=null,r=[];for(let i=0,a=t.length;i<a;i++){let a=t[i],o=new R(a.startLineNumber-0,a.startColumn,a.startLineNumber-0,a.startColumn);a.intersectRanges(e)?n=o:r.push(o)}return n&&r.unshift(n),r}_getRangesToDelete(e){let t=e.getModel();if(t===null)return[];let n=e.getSelections();if(n===null)return[];let r=n.map(e=>{if(e.isEmpty()){let n=t.getLineMaxColumn(e.startLineNumber);return e.startColumn===n?new W(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new W(e.startLineNumber,e.startColumn,e.startLineNumber,n)}return e});return r.sort(W.compareRangesUsingStarts),r}},cw=class extends V{constructor(){super({id:`editor.action.joinLines`,label:z(`lines.joinLines`,`Join Lines`),alias:`Join Lines`,precondition:A.writable,kbOpts:{kbExpr:A.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){let n=t.getSelections();if(n===null)return;let r=t.getSelection();if(r===null)return;n.sort(W.compareRangesUsingStarts);let i=[],a=n.reduce((e,t)=>e.isEmpty()?e.endLineNumber===t.startLineNumber?(r.equalsSelection(e)&&(r=t),t):t.startLineNumber>e.endLineNumber+1?(i.push(e),t):new R(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(i.push(e),t):new R(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn));i.push(a);let o=t.getModel();if(o===null)return;let s=[],c=[],l=r,u=0;for(let e=0,t=i.length;e<t;e++){let t=i[e],n=t.startLineNumber,a=0,d,f,p=o.getLineContent(t.endLineNumber).length-t.endColumn;if(t.isEmpty()||t.startLineNumber===t.endLineNumber){let e=t.getStartPosition();e.lineNumber<o.getLineCount()?(d=n+1,f=o.getLineMaxColumn(d)):(d=e.lineNumber,f=o.getLineMaxColumn(e.lineNumber))}else d=t.endLineNumber,f=o.getLineMaxColumn(d);let m=o.getLineContent(n);for(let e=n+1;e<=d;e++){let t=o.getLineContent(e),n=o.getLineFirstNonWhitespaceColumn(e);if(n>=1){let e=!0;m===``&&(e=!1),e&&(m.charAt(m.length-1)===` `||m.charAt(m.length-1)===`	`)&&(e=!1,m=m.replace(/[\s\uFEFF\xA0]+$/g,` `));let r=t.substr(n-1);m+=(e?` `:``)+r,a=e?r.length+1:r.length}else a=0}let h=new W(n,1,d,f);if(!h.isEmpty()){let e;t.isEmpty()?(s.push(En.replace(h,m)),e=new R(h.startLineNumber-u,m.length-a+1,n-u,m.length-a+1)):t.startLineNumber===t.endLineNumber?(s.push(En.replace(h,m)),e=new R(t.startLineNumber-u,t.startColumn,t.endLineNumber-u,t.endColumn)):(s.push(En.replace(h,m)),e=new R(t.startLineNumber-u,t.startColumn,t.startLineNumber-u,m.length-p)),W.intersectRanges(h,r)===null?c.push(e):l=e}u+=h.endLineNumber-h.startLineNumber}c.unshift(l),t.pushUndoStop(),t.executeEdits(this.id,s,c),t.pushUndoStop()}},lw=class extends V{constructor(){super({id:`editor.action.transpose`,label:z(`editor.transpose`,`Transpose characters around the cursor`),alias:`Transpose characters around the cursor`,precondition:A.writable})}run(e,t){let n=t.getSelections();if(n===null)return;let r=t.getModel();if(r===null)return;let i=[];for(let e=0,t=n.length;e<t;e++){let t=n[e];if(!t.isEmpty())continue;let a=t.getStartPosition(),o=r.getLineMaxColumn(a.lineNumber);if(a.column>=o){if(a.lineNumber===r.getLineCount())continue;let e=new W(a.lineNumber,Math.max(1,a.column-1),a.lineNumber+1,1),t=r.getValueInRange(e).split(``).reverse().join(``);i.push(new mt(new R(a.lineNumber,Math.max(1,a.column-1),a.lineNumber+1,1),t))}else{let e=new W(a.lineNumber,Math.max(1,a.column-1),a.lineNumber,a.column+1),t=r.getValueInRange(e).split(``).reverse().join(``);i.push(new Lr(e,t,new R(a.lineNumber,a.column+1,a.lineNumber,a.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}},uw=class extends V{run(e,t){let n=t.getSelections();if(n===null)return;let r=t.getModel();if(r===null)return;let i=t.getOption(115),a=[];for(let e of n)if(e.isEmpty()){let n=e.getStartPosition(),o=t.getConfiguredWordAtPosition(n);if(!o)continue;let s=new W(n.lineNumber,o.startColumn,n.lineNumber,o.endColumn),c=r.getValueInRange(s);a.push(En.replace(s,this._modifyText(c,i)))}else{let t=r.getValueInRange(e);a.push(En.replace(e,this._modifyText(t,i)))}t.pushUndoStop(),t.executeEdits(this.id,a),t.pushUndoStop()}},dw=class extends uw{constructor(){super({id:`editor.action.transformToUppercase`,label:z(`editor.transformToUppercase`,`Transform to Uppercase`),alias:`Transform to Uppercase`,precondition:A.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}},fw=class extends uw{constructor(){super({id:`editor.action.transformToLowercase`,label:z(`editor.transformToLowercase`,`Transform to Lowercase`),alias:`Transform to Lowercase`,precondition:A.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}},pw=class{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch{}}return this._actual}isSupported(){return this.get()!==null}},mw=class e extends uw{constructor(){super({id:`editor.action.transformToTitlecase`,label:z(`editor.transformToTitlecase`,`Transform to Title Case`),alias:`Transform to Title Case`,precondition:A.writable})}_modifyText(t,n){let r=e.titleBoundary.get();return r?t.toLocaleLowerCase().replace(r,e=>e.toLocaleUpperCase()):t}};mw.titleBoundary=new pw(`(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}`,`gmu`);var hw=class e extends uw{constructor(){super({id:`editor.action.transformToSnakecase`,label:z(`editor.transformToSnakecase`,`Transform to Snake Case`),alias:`Transform to Snake Case`,precondition:A.writable})}_modifyText(t,n){let r=e.caseBoundary.get(),i=e.singleLetters.get();return!r||!i?t:t.replace(r,`$1_$2`).replace(i,`$1_$2$3`).toLocaleLowerCase()}};hw.caseBoundary=new pw(`(\\p{Ll})(\\p{Lu})`,`gmu`),hw.singleLetters=new pw(`(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})`,`gmu`),o(UC),o(WC),o(GC),o(qC),o(JC),o(XC),o(ZC),o(QC),o($C),o(ew),o(tw),o(nw),o(rw),o(iw),o(ow),o(sw),o(cw),o(lw),o(dw),o(fw),hw.caseBoundary.isSupported()&&hw.singleLetters.isSupported()&&o(hw),mw.titleBoundary.isSupported()&&o(mw);var gw=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_w=function(e,t){return function(n,r){t(n,r,e)}},vw=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};const yw=new k(`LinkedEditingInputVisible`,!1);var bw=`linked-editing-decoration`,xw=class e extends _{constructor(e,t){super(),this._debounceDuration=200,this._localToDispose=this._register(new K),this._editor=e,this._enabled=!1,this._visibleContextKey=yw.bindTo(t),this._currentDecorations=[],this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new K),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel(()=>this.reinitialize(!0))),this._register(this._editor.onDidChangeConfiguration(e=>{(e.hasChanged(61)||e.hasChanged(81))&&this.reinitialize(!1)})),this._register(mr.onDidChange(()=>this.reinitialize(!1))),this._register(this._editor.onDidChangeModelLanguage(()=>this.reinitialize(!0))),this.reinitialize(!0)}static get(t){return t.getContribution(e.ID)}reinitialize(e){let t=this._editor.getModel(),n=t!==null&&(this._editor.getOption(61)||this._editor.getOption(81))&&mr.has(t);if(n===this._enabled&&!e||(this._enabled=n,this.clearRanges(),this._localToDispose.clear(),!n||t===null))return;this._languageWordPattern=Ei.getWordDefinition(t.getLanguageId()),this._localToDispose.add(t.onDidChangeLanguageConfiguration(()=>{this._languageWordPattern=Ei.getWordDefinition(t.getLanguageId())}));let r=new rr(this._debounceDuration),i=()=>{this._rangeUpdateTriggerPromise=r.trigger(()=>this.updateRanges(),this._debounceDuration)},a=new rr(0),o=e=>{this._rangeSyncTriggerPromise=a.trigger(()=>this._syncRanges(e))};this._localToDispose.add(this._editor.onDidChangeCursorPosition(()=>{i()})),this._localToDispose.add(this._editor.onDidChangeModelContent(e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){let n=t.getDecorationRange(this._currentDecorations[0]);if(n&&e.changes.every(e=>n.intersectRanges(e.range))){o(this._currentDecorations);return}}i()})),this._localToDispose.add({dispose:()=>{r.cancel(),a.cancel()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._currentDecorations||e.length===0)return;let t=this._editor.getModel(),n=t.getDecorationRange(e[0]);if(!n||n.startLineNumber!==n.endLineNumber)return this.clearRanges();let r=t.getValueInRange(n);if(this._currentWordPattern){let e=r.match(this._currentWordPattern);if((e?e[0].length:0)!==r.length)return this.clearRanges()}let i=[];for(let n=1,a=e.length;n<a;n++){let a=t.getDecorationRange(e[n]);if(a)if(a.startLineNumber!==a.endLineNumber)i.push({range:a,text:r});else{let e=t.getValueInRange(a),n=r,o=a.startColumn,s=a.endColumn,c=tr(e,n);o+=c,e=e.substr(c),n=n.substr(c);let l=vr(e,n);s-=l,e=e.substr(0,e.length-l),n=n.substr(0,n.length-l),(o!==s||n.length!==0)&&i.push({range:new W(a.startLineNumber,o,a.endLineNumber,s),text:n})}}if(i.length!==0)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;let e=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits(`linkedEditing`,i),this._editor._getViewModel().setPrevEditOperationType(e)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,[]),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(t=!1){return vw(this,void 0,void 0,function*(){if(!this._editor.hasModel()){this.clearRanges();return}let n=this._editor.getPosition();if(!this._enabled&&!t||this._editor.getSelections().length>1){this.clearRanges();return}let r=this._editor.getModel(),i=r.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===i){if(n.equals(this._currentRequestPosition))return;if(this._currentDecorations&&this._currentDecorations.length>0){let e=r.getDecorationRange(this._currentDecorations[0]);if(e&&e.containsPosition(n))return}}this._currentRequestPosition=n,this._currentRequestModelVersion=i;let a=No(t=>vw(this,void 0,void 0,function*(){try{let o=yield Cw(r,n,t);if(a!==this._currentRequest||(this._currentRequest=null,i!==r.getVersionId()))return;let s=[];o?.ranges&&(s=o.ranges),this._currentWordPattern=o?.wordPattern||this._languageWordPattern;let c=!1;for(let e=0,t=s.length;e<t;e++)if(W.containsPosition(s[e],n)){if(c=!0,e!==0){let t=s[e];s.splice(e,1),s.unshift(t)}break}if(!c){this.clearRanges();return}let l=s.map(t=>({range:t,options:e.DECORATION}));this._visibleContextKey.set(!0),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,l)}catch(e){cn(e)||C(e),(this._currentRequest===a||!this._currentRequest)&&this.clearRanges()}}));return this._currentRequest=a,a})}};xw.ID=`editor.contrib.linkedEditing`,xw.DECORATION=I.register({description:`linked-editing`,stickiness:0,className:bw}),xw=gw([_w(1,D)],xw);var Sw=class extends V{constructor(){super({id:`editor.action.linkedEditing`,label:z(`linkedEditing.label`,`Start Linked Editing`),alias:`Start Linked Editing`,precondition:w.and(A.writable,A.hasRenameProvider),kbOpts:{kbExpr:A.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){let n=e.get(po),[r,i]=Array.isArray(t)&&t||[void 0,void 0];return L.isUri(r)&&P.isIPosition(i)?n.openCodeEditor({resource:r},n.getActiveCodeEditor()).then(e=>{e&&(e.setPosition(i),e.invokeWithinContext(t=>(this.reportTelemetry(t,e),this.run(t,e))))},C):super.runCommand(e,t)}run(e,t){let n=xw.get(t);return n?Promise.resolve(n.updateRanges(!0)):Promise.resolve()}};F(new(ft.bindToContribution(xw.get))({id:`cancelLinkedEditingInput`,precondition:yw,handler:e=>e.clearRanges(),kbOpts:{kbExpr:A.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));function Cw(e,t,n){return Ir(mr.ordered(e).map(r=>()=>vw(this,void 0,void 0,function*(){try{return yield r.provideLinkedEditingRanges(e,t,n)}catch(e){nt(e);return}})),e=>!!e&&ti(e?.ranges))}const ww=v(`editor.linkedEditingBackground`,{dark:O.fromHex(`#f00`).transparent(.3),light:O.fromHex(`#f00`).transparent(.3),hc:O.fromHex(`#f00`).transparent(.3)},z(`editorLinkedEditingBackground`,`Background color when the editor auto renames on type.`));Ya((e,t)=>{let n=e.getColor(ww);n&&t.addRule(`.monaco-editor .${bw} { background: ${n}; border-left-color: ${n}; }`)}),Ro(`_executeLinkedEditingProvider`,(e,t)=>Cw(e,t,j.None)),U(xw.ID,xw),o(Sw);var Tw=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ew=class{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}resolve(e){return Tw(this,void 0,void 0,function*(){return this._link.url?this._link.url:typeof this._provider.resolveLink==`function`?Promise.resolve(this._provider.resolveLink(this._link,e)).then(t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(Error(`missing`)))):Promise.reject(Error(`missing`))})}},Dw=class e{constructor(t){this._disposables=new K;let n=[];for(let[r,i]of t){let t=r.links.map(e=>new Ew(e,i));n=e._union(n,t),Qt(r)&&this._disposables.add(r)}this.links=n}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){let n=[],r,i,a,o;for(r=0,a=0,i=e.length,o=t.length;r<i&&a<o;){let i=e[r],o=t[a];if(W.areIntersectingOrTouching(i.range,o.range)){r++;continue}W.compareRangesUsingStarts(i.range,o.range)<0?(n.push(i),r++):(n.push(o),a++)}for(;r<i;r++)n.push(e[r]);for(;a<o;a++)n.push(t[a]);return n}};function Ow(e,t){let n=[],i=Zn.ordered(e).reverse().map((r,i)=>Promise.resolve(r.provideLinks(e,t)).then(e=>{e&&(n[i]=[e,r])},nt));return Promise.all(i).then(()=>{let e=new Dw(r(n));return t.isCancellationRequested?(e.dispose(),new Dw([])):e})}vs.registerCommand(`_executeLinkProvider`,(e,...t)=>Tw(void 0,void 0,void 0,function*(){let[n,r]=t;Fs(n instanceof L),typeof r!=`number`&&(r=0);let i=e.get(Jo).getModel(n);if(!i)return[];let a=yield Ow(i,j.None);if(!a)return[];for(let e=0;e<Math.min(r,a.links.length);e++)yield a.links[e].resolve(j.None);let o=a.links.slice(0);return a.dispose(),o}));var kw=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Aw=function(e,t){return function(n,r){t(n,r,e)}},jw=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};function Mw(e,t){let n=e.url&&/^command:/i.test(e.url.toString()),r=e.tooltip?e.tooltip:n?z(`links.navigate.executeCmd`,`Execute command`):z(`links.navigate.follow`,`Follow link`),i=t?Qn?z(`links.navigate.kb.meta.mac`,`cmd + click`):z(`links.navigate.kb.meta`,`ctrl + click`):Qn?z(`links.navigate.kb.alt.mac`,`option + click`):z(`links.navigate.kb.alt`,`alt + click`);if(e.url){let t=``;if(/^command:/i.test(e.url.toString())){let n=e.url.toString().match(/^command:([^?#]+)/);if(n){let e=n[1];t=` "${z(`tooltip.explanation`,`Execute command {0}`,e)}"`}}return new ue(``,!0).appendMarkdown(`[${r}](${e.url.toString(!0).replace(/ /g,`%20`)}${t}) (${i})`)}else return new ue().appendText(`${r} (${i})`)}var Nw={general:I.register({description:`detected-link`,stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:`detected-link`}),active:I.register({description:`detected-link-active`,stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:`detected-link-active`})},Pw=class e{constructor(e,t){this.link=e,this.decorationId=t}static decoration(t,n){return{range:t.range,options:e._getOptions(t,n,!1)}}static _getOptions(e,t,n){let r=Object.assign({},n?Nw.active:Nw.general);return r.hoverMessage=Mw(e,t),r}activate(t,n){t.changeDecorationOptions(this.decorationId,e._getOptions(this.link,n,!0))}deactivate(t,n){t.changeDecorationOptions(this.decorationId,e._getOptions(this.link,n,!1))}},Fw=class e{constructor(e,t,n){this.listenersToRemove=new K,this.editor=e,this.openerService=t,this.notificationService=n;let r=new zu(e);this.listenersToRemove.add(r),this.listenersToRemove.add(r.onMouseMoveOrRelevantKeyDown(([e,t])=>{this._onEditorMouseMove(e,t)})),this.listenersToRemove.add(r.onExecute(e=>{this.onEditorMouseUp(e)})),this.listenersToRemove.add(r.onCancel(e=>{this.cleanUpActiveLinkDecoration()})),this.enabled=e.getOption(62),this.listenersToRemove.add(e.onDidChangeConfiguration(t=>{let n=e.getOption(62);this.enabled!==n&&(this.enabled=n,this.updateDecorations([]),this.stop(),this.beginCompute())})),this.listenersToRemove.add(e.onDidChangeModelContent(e=>this.onChange())),this.listenersToRemove.add(e.onDidChangeModel(e=>this.onModelChanged())),this.listenersToRemove.add(e.onDidChangeModelLanguage(e=>this.onModelModeChanged())),this.listenersToRemove.add(Zn.onDidChange(e=>this.onModelModeChanged())),this.timeout=new St,this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null,this.beginCompute()}static get(t){return t.getContribution(e.ID)}onModelChanged(){this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.beginCompute()}onModelModeChanged(){this.stop(),this.beginCompute()}onChange(){this.timeout.setIfNotSet(()=>this.beginCompute(),e.RECOMPUTE_TIME)}beginCompute(){return jw(this,void 0,void 0,function*(){if(!this.editor.hasModel()||!this.enabled)return;let e=this.editor.getModel();if(Zn.has(e)){this.activeLinksList&&=(this.activeLinksList.dispose(),null),this.computePromise=No(t=>Ow(e,t));try{this.activeLinksList=yield this.computePromise,this.updateDecorations(this.activeLinksList.links)}catch(e){C(e)}finally{this.computePromise=null}}})}updateDecorations(e){let t=this.editor.getOption(69)===`altKey`,n=[],r=Object.keys(this.currentOccurrences);for(let e=0,t=r.length;e<t;e++){let t=r[e],i=this.currentOccurrences[t];n.push(i.decorationId)}let i=[];if(e)for(let n of e)i.push(Pw.decoration(n,t));let a=this.editor.deltaDecorations(n,i);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let t=0,n=a.length;t<n;t++){let n=new Pw(e[t],a[t]);this.currentOccurrences[n.decorationId]=n}}_onEditorMouseMove(e,t){let n=this.editor.getOption(69)===`altKey`;if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();let t=this.getLinkOccurrence(e.target.position);t&&this.editor.changeDecorations(e=>{t.activate(e,n),this.activeLinkDecorationId=t.decorationId})}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){let e=this.editor.getOption(69)===`altKey`;if(this.activeLinkDecorationId){let t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations(n=>{t.deactivate(n,e)}),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;let t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,n=!1){if(!this.openerService)return;let{link:r}=e;r.resolve(j.None).then(e=>{if(typeof e==`string`&&this.editor.hasModel()){let t=this.editor.getModel().uri;if(t.scheme===$e.file&&e.startsWith(`${$e.file}:`)){let n=L.parse(e);if(n.scheme===$e.file){let r=Pe(n),i=null;r.startsWith(`/./`)?i=`.${r.substr(1)}`:r.startsWith(`//./`)&&(i=`.${r.substr(2)}`),i&&(e=dn(t,i))}}}return this.openerService.open(e,{openToSide:t,fromUserGesture:n,allowContributedOpeners:!0,allowCommands:!0})},e=>{let t=e instanceof Error?e.message:e;t===`invalid`?this.notificationService.warn(z(`invalid.url`,`Failed to open this link because it is not well-formed: {0}`,r.url.toString())):t===`missing`?this.notificationService.warn(z(`missing.url`,`Failed to open this link because its target is missing.`)):C(e)})}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;let t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(let e of t){let t=this.currentOccurrences[e.id];if(t)return t}return null}isEnabled(e,t){return!!(e.target.type===6&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){var e;this.timeout.cancel(),this.activeLinksList&&=((e=this.activeLinksList)==null||e.dispose(),null),this.computePromise&&=(this.computePromise.cancel(),null)}dispose(){this.listenersToRemove.dispose(),this.stop(),this.timeout.dispose()}};Fw.ID=`editor.linkDetector`,Fw.RECOMPUTE_TIME=1e3,Fw=kw([Aw(1,Qi),Aw(2,Ft)],Fw);var Iw=class extends V{constructor(){super({id:`editor.action.openLink`,label:z(`label`,`Open Link`),alias:`Open Link`,precondition:void 0})}run(e,t){let n=Fw.get(t);if(!n||!t.hasModel())return;let r=t.getSelections();for(let e of r){let t=n.getLinkOccurrence(e.getEndPosition());t&&n.openLinkOccurrence(t,!1)}}};U(Fw.ID,Fw),o(Iw),Ya((e,t)=>{let n=e.getColor(ls);n&&t.addRule(`.monaco-editor .detected-link-active { color: ${n} !important; }`)});function Lw(e,t){let n=t.filter(t=>!e.find(e=>e.equals(t)));if(n.length>=1){let e=n.map(e=>`line ${e.viewState.position.lineNumber} column ${e.viewState.position.column}`).join(`, `);fe(n.length===1?z(`cursorAdded`,`Cursor added: {0}`,e):z(`cursorsAdded`,`Cursors added: {0}`,e))}}var Rw=class extends V{constructor(){super({id:`editor.action.insertCursorAbove`,label:z(`mutlicursor.insertAbove`,`Add Cursor Above`),alias:`Add Cursor Above`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`3_multi`,title:z({key:`miInsertCursorAbove`,comment:[`&& denotes a mnemonic`]},`&&Add Cursor Above`),order:2}})}run(e,t,n){if(!t.hasModel())return;let r=!0;n&&n.logicalLine===!1&&(r=!1);let i=t._getViewModel();if(i.cursorConfig.readOnly)return;i.pushStackElement();let a=i.getCursorStates();i.setCursorStates(n.source,3,xr.addCursorUp(i,a,r)),i.revealTopMostCursor(n.source),Lw(a,i.getCursorStates())}},zw=class extends V{constructor(){super({id:`editor.action.insertCursorBelow`,label:z(`mutlicursor.insertBelow`,`Add Cursor Below`),alias:`Add Cursor Below`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`3_multi`,title:z({key:`miInsertCursorBelow`,comment:[`&& denotes a mnemonic`]},`A&&dd Cursor Below`),order:3}})}run(e,t,n){if(!t.hasModel())return;let r=!0;n&&n.logicalLine===!1&&(r=!1);let i=t._getViewModel();if(i.cursorConfig.readOnly)return;i.pushStackElement();let a=i.getCursorStates();i.setCursorStates(n.source,3,xr.addCursorDown(i,a,r)),i.revealBottomMostCursor(n.source),Lw(a,i.getCursorStates())}},Bw=class extends V{constructor(){super({id:`editor.action.insertCursorAtEndOfEachLineSelected`,label:z(`mutlicursor.insertAtEndOfEachLineSelected`,`Add Cursors to Line Ends`),alias:`Add Cursors to Line Ends`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`3_multi`,title:z({key:`miInsertCursorAtEndOfEachLineSelected`,comment:[`&& denotes a mnemonic`]},`Add C&&ursors to Line Ends`),order:4}})}getCursorsForSelection(e,t,n){if(!e.isEmpty()){for(let r=e.startLineNumber;r<e.endLineNumber;r++){let e=t.getLineMaxColumn(r);n.push(new R(r,e,r,e))}e.endColumn>1&&n.push(new R(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;let n=t.getModel(),r=t.getSelections(),i=t._getViewModel(),a=i.getCursorStates(),o=[];r.forEach(e=>this.getCursorsForSelection(e,n,o)),o.length>0&&t.setSelections(o),Lw(a,i.getCursorStates())}},Vw=class extends V{constructor(){super({id:`editor.action.addCursorsToBottom`,label:z(`mutlicursor.addCursorsToBottom`,`Add Cursors To Bottom`),alias:`Add Cursors To Bottom`,precondition:void 0})}run(e,t){if(!t.hasModel())return;let n=t.getSelections(),r=t.getModel().getLineCount(),i=[];for(let e=n[0].startLineNumber;e<=r;e++)i.push(new R(e,n[0].startColumn,e,n[0].endColumn));let a=t._getViewModel(),o=a.getCursorStates();i.length>0&&t.setSelections(i),Lw(o,a.getCursorStates())}},Hw=class extends V{constructor(){super({id:`editor.action.addCursorsToTop`,label:z(`mutlicursor.addCursorsToTop`,`Add Cursors To Top`),alias:`Add Cursors To Top`,precondition:void 0})}run(e,t){if(!t.hasModel())return;let n=t.getSelections(),r=[];for(let e=n[0].startLineNumber;e>=1;e--)r.push(new R(e,n[0].startColumn,e,n[0].endColumn));let i=t._getViewModel(),a=i.getCursorStates();r.length>0&&t.setSelections(r),Lw(a,i.getCursorStates())}},Uw=class{constructor(e,t,n){this.selections=e,this.revealRange=t,this.revealScrollType=n}},Ww=class e{constructor(e,t,n,r,i,a,o){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=n,this.searchText=r,this.wholeWord=i,this.matchCase=a,this.currentMatch=o}static create(t,n){if(!t.hasModel())return null;let r=n.getState();if(!t.hasTextFocus()&&r.isRevealed&&r.searchString.length>0)return new e(t,n,!1,r.searchString,r.wholeWord,r.matchCase,null);let i=!1,a,o,s=t.getSelections();s.length===1&&s[0].isEmpty()?(i=!0,a=!0,o=!0):(a=r.wholeWord,o=r.matchCase);let c=t.getSelection(),l,u=null;if(c.isEmpty()){let e=t.getConfiguredWordAtPosition(c.getStartPosition());if(!e)return null;l=e.word,u=new R(c.startLineNumber,e.startColumn,c.startLineNumber,e.endColumn)}else l=t.getModel().getValueInRange(c).replace(/\r\n/g,`
`);return new e(t,n,i,l,a,o,u)}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;let e=this._getNextMatch();return e?new Uw(this._editor.getSelections().concat(e),e,0):null}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;let e=this._getNextMatch();if(!e)return null;let t=this._editor.getSelections();return new Uw(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){let e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();let e=this._editor.getSelections(),t=e[e.length-1],n=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(115):null,!1);return n?new R(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;let e=this._getPreviousMatch();return e?new Uw(this._editor.getSelections().concat(e),e,0):null}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;let e=this._getPreviousMatch();if(!e)return null;let t=this._editor.getSelections();return new Uw(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){let e=this.currentMatch;return this.currentMatch=null,e}this.findController.highlightFindOptions();let e=this._editor.getSelections(),t=e[e.length-1],n=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(115):null,!1);return n?new R(n.range.startLineNumber,n.range.startColumn,n.range.endLineNumber,n.range.endColumn):null}selectAll(){return this._editor.hasModel()?(this.findController.highlightFindOptions(),this._editor.getModel().findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(115):null,!1,1073741824)):[]}},Gw=class e extends _{constructor(e){super(),this._sessionDispose=this._register(new K),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}static get(t){return t.getContribution(e.ID)}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){let t=Ww.create(this._editor,e);if(!t)return;this._session=t;let n={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(n.wholeWordOverride=1,n.matchCaseOverride=1,n.isRegexOverride=2),e.getState().change(n,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(e=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(e=>{(e.matchCase||e.wholeWord)&&this._endSession()}))}}_endSession(){this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController&&this._session.findController.getState().change({wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0},!1),this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;let n=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return n?new R(t.startLineNumber,n.startColumn,t.startLineNumber,n.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){let t=this._editor.getSelections();if(t.length>1){let n=e.getState().matchCase;if(!tT(this._editor.getModel(),t,n)){let e=this._editor.getModel(),n=[];for(let r=0,i=t.length;r<i;r++)n[r]=this._expandEmptyToWord(e,t[r]);this._editor.setSelections(n);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null,n=e.getState();if(n.isRevealed&&n.searchString.length>0&&n.isRegex)t=this._editor.getModel().findMatches(n.searchString,!0,n.isRegex,n.matchCase,n.wholeWord?this._editor.getOption(115):null,!1,1073741824);else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll()}if(n.searchScope){let e=n.searchScope,r=[];t.forEach(t=>{e.forEach(e=>{t.range.endLineNumber<=e.endLineNumber&&t.range.startLineNumber>=e.startLineNumber&&r.push(t)})}),t=r}if(t.length>0){let e=this._editor.getSelection();for(let n=0,r=t.length;n<r;n++){let r=t[n];if(r.range.intersectRanges(e)){t[n]=t[0],t[0]=r;break}}this._setSelections(t.map(e=>new R(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn)))}}};Gw.ID=`editor.contrib.multiCursorController`;var Kw=class extends V{run(e,t){let n=Gw.get(t);if(!n)return;let r=Ox.get(t);if(!r)return;let i=t._getViewModel();if(i){let e=i.getCursorStates();this._run(n,r),Lw(e,i.getCursorStates())}}},qw=class extends Kw{constructor(){super({id:`editor.action.addSelectionToNextFindMatch`,label:z(`addSelectionToNextFindMatch`,`Add Selection To Next Find Match`),alias:`Add Selection To Next Find Match`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:2082,weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`3_multi`,title:z({key:`miAddSelectionToNextFindMatch`,comment:[`&& denotes a mnemonic`]},`Add &&Next Occurrence`),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}},Jw=class extends Kw{constructor(){super({id:`editor.action.addSelectionToPreviousFindMatch`,label:z(`addSelectionToPreviousFindMatch`,`Add Selection To Previous Find Match`),alias:`Add Selection To Previous Find Match`,precondition:void 0,menuOpts:{menuId:N.MenubarSelectionMenu,group:`3_multi`,title:z({key:`miAddSelectionToPreviousFindMatch`,comment:[`&& denotes a mnemonic`]},`Add P&&revious Occurrence`),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}},Yw=class extends Kw{constructor(){super({id:`editor.action.moveSelectionToNextFindMatch`,label:z(`moveSelectionToNextFindMatch`,`Move Last Selection To Next Find Match`),alias:`Move Last Selection To Next Find Match`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:Yi(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}},Xw=class extends Kw{constructor(){super({id:`editor.action.moveSelectionToPreviousFindMatch`,label:z(`moveSelectionToPreviousFindMatch`,`Move Last Selection To Previous Find Match`),alias:`Move Last Selection To Previous Find Match`,precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}},Zw=class extends Kw{constructor(){super({id:`editor.action.selectHighlights`,label:z(`selectAllOccurrencesOfFindMatch`,`Select All Occurrences of Find Match`),alias:`Select All Occurrences of Find Match`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:3114,weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`3_multi`,title:z({key:`miSelectHighlights`,comment:[`&& denotes a mnemonic`]},`Select All &&Occurrences`),order:7}})}_run(e,t){e.selectAll(t)}},Qw=class extends Kw{constructor(){super({id:`editor.action.changeAll`,label:z(`changeAll.label`,`Change All Occurrences`),alias:`Change All Occurrences`,precondition:w.and(A.writable,A.editorTextFocus),kbOpts:{kbExpr:A.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:`1_modification`,order:1.2}})}_run(e,t){e.selectAll(t)}},$w=class{constructor(e,t,n,r){this.searchText=e,this.matchCase=t,this.wordSeparators=n,this.modelVersionId=r}static softEquals(e,t){return!e&&!t?!0:!e||!t?!1:e.searchText===t.searchText&&e.matchCase===t.matchCase&&e.wordSeparators===t.wordSeparators&&e.modelVersionId===t.modelVersionId}},eT=class e extends _{constructor(e){super(),this.editor=e,this._isEnabled=e.getOption(96),this.decorations=[],this.updateSoon=this._register(new T(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(t=>{this._isEnabled=e.getOption(96)})),this._register(e.onDidChangeCursorSelection(e=>{this._isEnabled&&(e.selection.isEmpty()?e.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(e=>{this._setState(null)})),this._register(e.onDidChangeModelContent(e=>{this._isEnabled&&this.updateSoon.schedule()})),this._register(Ox.get(e).getState().onFindReplaceStateChange(e=>{this._update()}))}_update(){this._setState(e._createState(this._isEnabled,this.editor))}static _createState(e,t){if(!e||!t.hasModel())return null;let n=t.getSelection();if(n.startLineNumber!==n.endLineNumber)return null;let r=Gw.get(t);if(!r)return null;let i=Ox.get(t);if(!i)return null;let a=r.getSession(i);if(!a){let e=t.getSelections();if(e.length>1){let n=i.getState().matchCase;if(!tT(t.getModel(),e,n))return null}a=Ww.create(t,i)}if(!a||a.currentMatch||/^[ \t]+$/.test(a.searchText)||a.searchText.length>200)return null;let o=i.getState(),s=o.matchCase;if(o.isRevealed){let e=o.searchString;s||(e=e.toLowerCase());let t=a.searchText;if(s||(t=t.toLowerCase()),e===t&&a.matchCase===o.matchCase&&a.wholeWord===o.wholeWord&&!o.isRegex)return null}return new $w(a.searchText,a.matchCase,a.wholeWord?t.getOption(115):null,t.getModel().getVersionId())}_setState(t){if($w.softEquals(this.state,t)){this.state=t;return}if(this.state=t,!this.state){this.decorations=this.editor.deltaDecorations(this.decorations,[]);return}if(!this.editor.hasModel())return;let n=this.editor.getModel();if(n.isTooLargeForTokenization())return;let r=xa.has(n)&&this.editor.getOption(71),i=n.findMatches(this.state.searchText,!0,!1,this.state.matchCase,this.state.wordSeparators,!1).map(e=>e.range);i.sort(W.compareRangesUsingStarts);let a=this.editor.getSelections();a.sort(W.compareRangesUsingStarts);let o=[];for(let e=0,t=0,n=i.length,r=a.length;e<n;){let n=i[e];if(t>=r)o.push(n),e++;else{let r=W.compareRangesUsingStarts(n,a[t]);r<0?((a[t].isEmpty()||!W.areIntersecting(n,a[t]))&&o.push(n),e++):(r>0||e++,t++)}}let s=o.map(t=>({range:t,options:r?e._SELECTION_HIGHLIGHT:e._SELECTION_HIGHLIGHT_OVERVIEW}));this.decorations=this.editor.deltaDecorations(this.decorations,s)}dispose(){this._setState(null),super.dispose()}};eT.ID=`editor.contrib.selectionHighlighter`,eT._SELECTION_HIGHLIGHT_OVERVIEW=I.register({description:`selection-highlight-overview`,stickiness:1,className:`selectionHighlight`,minimap:{color:aa(Eo),position:us.Inline},overviewRuler:{color:aa($i),position:ki.Center}}),eT._SELECTION_HIGHLIGHT=I.register({description:`selection-highlight`,stickiness:1,className:`selectionHighlight`});function tT(e,t,n){let r=nT(e,t[0],!n);for(let i=1,a=t.length;i<a;i++){let a=t[i];if(a.isEmpty()||r!==nT(e,a,!n))return!1}return!0}function nT(e,t,n){let r=e.getValueInRange(t);return n?r.toLowerCase():r}U(Gw.ID,Gw),U(eT.ID,eT),o(Rw),o(zw),o(Bw),o(qw),o(Jw),o(Yw),o(Xw),o(Zw),o(Qw),o(Vw),o(Hw);var rT=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};const iT={Visible:new k(`parameterHintsVisible`,!1),MultipleSignatures:new k(`parameterHintsMultipleSignatures`,!1)};function aT(e,t,n,r){return rT(this,void 0,void 0,function*(){let i=jr.ordered(e);for(let a of i)try{let i=yield a.provideSignatureHelp(e,t,r,n);if(i)return i}catch(e){nt(e)}})}vs.registerCommand(`_executeSignatureHelpProvider`,(e,...t)=>rT(void 0,void 0,void 0,function*(){let[n,r,i]=t;Fs(L.isUri(n)),Fs(P.isIPosition(r)),Fs(typeof i==`string`||!i);let a=yield e.get(ms).createModelReference(n);try{let e=yield aT(a.object.textEditorModel,P.lift(r),{triggerKind:Cr.Invoke,isRetrigger:!1,triggerCharacter:i},j.None);return e?(setTimeout(()=>e.dispose(),0),e.value):void 0}finally{a.dispose()}}));var oT=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},sT;(function(e){e.Default={type:0};class t{constructor(e,t){this.request=e,this.previouslyActiveHints=t,this.type=2}}e.Pending=t;class n{constructor(e){this.hints=e,this.type=1}}e.Active=n})(sT||={});var cT=class e extends _{constructor(t,n=e.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new J),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=sT.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new Un),this.triggerChars=new vi,this.retriggerChars=new vi,this.triggerId=0,this.editor=t,this.throttledDelayer=new rr(n),this._register(this.editor.onDidBlurEditorWidget(()=>this.cancel())),this._register(this.editor.onDidChangeConfiguration(()=>this.onEditorConfigurationChange())),this._register(this.editor.onDidChangeModel(e=>this.onModelChanged())),this._register(this.editor.onDidChangeModelLanguage(e=>this.onModelChanged())),this._register(this.editor.onDidChangeCursorSelection(e=>this.onCursorChange(e))),this._register(this.editor.onDidChangeModelContent(e=>this.onModelContentChange())),this._register(jr.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType(e=>this.onDidType(e))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(e){this._state.type===2&&this._state.request.cancel(),this._state=e}cancel(e=!1){this.state=sT.Default,this.throttledDelayer.cancel(),e||this._onChangedHints.fire(void 0)}trigger(e,t){let n=this.editor.getModel();if(!n||!jr.has(n))return;let r=++this.triggerId;this._pendingTriggers.push(e),this.throttledDelayer.trigger(()=>this.doTrigger(r),t).catch(C)}next(){if(this.state.type!==1)return;let e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,n=t%e===e-1,r=this.editor.getOption(75).cycle;if((e<2||n)&&!r){this.cancel();return}this.updateActiveSignature(n&&r?0:t+1)}previous(){if(this.state.type!==1)return;let e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,n=t===0,r=this.editor.getOption(75).cycle;if((e<2||n)&&!r){this.cancel();return}this.updateActiveSignature(n&&r?e-1:t-1)}updateActiveSignature(e){this.state.type===1&&(this.state=new sT.Active(Object.assign(Object.assign({},this.state.hints),{activeSignature:e})),this._onChangedHints.fire(this.state.hints))}doTrigger(e){return oT(this,void 0,void 0,function*(){let t=this.state.type===1||this.state.type===2,n=this.getLastActiveHints();if(this.cancel(!0),this._pendingTriggers.length===0)return!1;let r=this._pendingTriggers.reduce(lT);this._pendingTriggers=[];let i={triggerKind:r.triggerKind,triggerCharacter:r.triggerCharacter,isRetrigger:t,activeSignatureHelp:n};if(!this.editor.hasModel())return!1;let a=this.editor.getModel(),o=this.editor.getPosition();this.state=new sT.Pending(No(e=>aT(a,o,i,e)),n);try{let t=yield this.state.request;return e===this.triggerId?!t||!t.value.signatures||t.value.signatures.length===0?(t?.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1):(this.state=new sT.Active(t.value),this._lastSignatureHelpResult.value=t,this._onChangedHints.fire(this.state.hints),!0):(t?.dispose(),!1)}catch(t){return e===this.triggerId&&(this.state=sT.Default),C(t),!1}})}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return this.state.type===1||this.state.type===2||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars=new vi,this.retriggerChars=new vi;let e=this.editor.getModel();if(e)for(let t of jr.ordered(e)){for(let e of t.signatureHelpTriggerCharacters||[])this.triggerChars.add(e.charCodeAt(0)),this.retriggerChars.add(e.charCodeAt(0));for(let e of t.signatureHelpRetriggerCharacters||[])this.retriggerChars.add(e.charCodeAt(0))}}onDidType(e){if(!this.triggerOnType)return;let t=e.length-1,n=e.charCodeAt(t);(this.triggerChars.has(n)||this.isTriggered&&this.retriggerChars.has(n))&&this.trigger({triggerKind:Cr.TriggerCharacter,triggerCharacter:e.charAt(t)})}onCursorChange(e){e.source===`mouse`?this.cancel():this.isTriggered&&this.trigger({triggerKind:Cr.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:Cr.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(75).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}};cT.DEFAULT_DELAY=120;function lT(e,t){switch(t.triggerKind){case Cr.Invoke:return t;case Cr.ContentChange:return e;case Cr.TriggerCharacter:default:return t}}var uT=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dT=function(e,t){return function(n,r){t(n,r,e)}},fT=G,pT=gi(`parameter-hints-next`,M.chevronDown,z(`parameterHintsNextIcon`,`Icon for show next parameter hint.`)),mT=gi(`parameter-hints-previous`,M.chevronUp,z(`parameterHintsPreviousIcon`,`Icon for show previous parameter hint.`)),hT=class e extends _{constructor(e,t,n,r){super(),this.editor=e,this.renderDisposeables=this._register(new K),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new ym({editor:e},r,n)),this.model=this._register(new cT(e)),this.keyVisible=iT.Visible.bindTo(t),this.keyMultipleSignatures=iT.MultipleSignatures.bindTo(t),this._register(this.model.onChangedHints(e=>{e?(this.show(),this.render(e)):this.hide()}))}createParameterHintDOMNodes(){let e=fT(`.editor-widget.parameter-hints-widget`),t=q(e,fT(`.phwrapper`));t.tabIndex=-1;let n=q(t,fT(`.controls`)),r=q(n,fT(`.button`+Co.asCSSSelector(mT))),i=q(n,fT(`.overloads`)),a=q(n,fT(`.button`+Co.asCSSSelector(pT)));this._register(Qr(r,`click`,e=>{Gi.stop(e),this.previous()})),this._register(Qr(a,`click`,e=>{Gi.stop(e),this.next()}));let o=fT(`.body`),s=new jt(o,{});this._register(s),t.appendChild(s.getDomNode());let c=q(o,fT(`.signature`)),l=q(o,fT(`.docs`));e.style.userSelect=`text`,this.domNodes={element:e,signature:c,overloads:i,docs:l,scrollbar:s},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection(e=>{this.visible&&this.editor.layoutContentWidget(this)}));let u=()=>{if(!this.domNodes)return;let e=this.editor.getOption(43);this.domNodes.element.style.fontSize=`${e.fontSize}px`,this.domNodes.element.style.lineHeight=`${e.lineHeight/e.fontSize}`};u(),this._register(ui.chain(this.editor.onDidChangeConfiguration.bind(this.editor)).filter(e=>e.hasChanged(43)).on(u,null)),this._register(this.editor.onDidLayoutChange(e=>this.updateMaxHeight())),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout(()=>{this.domNodes&&this.domNodes.element.classList.add(`visible`)},100),this.editor.layoutContentWidget(this))}hide(){this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,this.domNodes&&this.domNodes.element.classList.remove(`visible`),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){if(this.renderDisposeables.clear(),!this.domNodes)return;let t=e.signatures.length>1;this.domNodes.element.classList.toggle(`multiple`,t),this.keyMultipleSignatures.set(t),this.domNodes.signature.innerText=``,this.domNodes.docs.innerText=``;let n=e.signatures[e.activeSignature];if(!n)return;let r=q(this.domNodes.signature,fT(`.code`)),i=this.editor.getOption(43);r.style.fontSize=`${i.fontSize}px`,r.style.fontFamily=i.fontFamily;let a=n.parameters.length>0,o=n.activeParameter??e.activeParameter;if(a)this.renderParameters(r,n,o);else{let e=q(r,fT(`span`));e.textContent=n.label}let s=n.parameters[o];if(s?.documentation){let e=fT(`span.documentation`);if(typeof s.documentation==`string`)e.textContent=s.documentation;else{let t=this.renderMarkdownDocs(s.documentation);e.appendChild(t.element)}q(this.domNodes.docs,fT(`p`,{},e))}if(n.documentation!==void 0)if(typeof n.documentation==`string`)q(this.domNodes.docs,fT(`p`,{},n.documentation));else{let e=this.renderMarkdownDocs(n.documentation);q(this.domNodes.docs,e.element)}let c=this.hasDocs(n,s);if(this.domNodes.signature.classList.toggle(`has-docs`,c),this.domNodes.docs.classList.toggle(`empty`,!c),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,`0`)+`/`+e.signatures.length,s){let e=``,t=n.parameters[o];e=Array.isArray(t.label)?n.label.substring(t.label[0],t.label[1]):t.label,t.documentation&&(e+=typeof t.documentation==`string`?`, ${t.documentation}`:`, ${t.documentation.value}`),n.documentation&&(e+=typeof n.documentation==`string`?`, ${n.documentation}`:`, ${n.documentation.value}`),this.announcedLabel!==e&&(Fn(z(`hint`,`{0}, hint`,e)),this.announcedLabel=e)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){let t=this.renderDisposeables.add(this.markdownRenderer.render(e,{asyncRenderCallback:()=>{var e;(e=this.domNodes)==null||e.scrollbar.scanDomNode()}}));return t.element.classList.add(`markdown-docs`),t}hasDocs(e,t){return!!(t&&typeof t.documentation==`string`&&pi(t.documentation).length>0||t&&typeof t.documentation==`object`&&pi(t.documentation).value.length>0||e.documentation&&typeof e.documentation==`string`&&pi(e.documentation).length>0||e.documentation&&typeof e.documentation==`object`&&pi(e.documentation.value).length>0)}renderParameters(e,t,n){let[r,i]=this.getParameterLabelOffsets(t,n),a=document.createElement(`span`);a.textContent=t.label.substring(0,r);let o=document.createElement(`span`);o.textContent=t.label.substring(r,i),o.className=`parameter active`;let s=document.createElement(`span`);s.textContent=t.label.substring(i),q(e,a,o,s)}getParameterLabelOffsets(e,t){let n=e.parameters[t];if(n){if(Array.isArray(n.label))return n.label;if(n.label.length){let t=RegExp(`(\\W|^)${Er(n.label)}(?=\\W|$)`,`g`);t.test(e.label);let r=t.lastIndex-n.label.length;return r>=0?[r,t.lastIndex]:[0,0]}else return[0,0]}else return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}cancel(){this.model.cancel()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return e.ID}trigger(e){this.model.trigger(e,0)}updateMaxHeight(){if(!this.domNodes)return;let e=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=e;let t=this.domNodes.element.getElementsByClassName(`phwrapper`);t.length&&(t[0].style.maxHeight=e)}};hT.ID=`editor.widget.parameterHintsWidget`,hT=uT([dT(1,D),dT(2,Qi),dT(3,zs)],hT);const gT=v(`editorHoverWidget.highlightForeground`,{dark:Ai,light:Ai,hc:Ai},z(`editorHoverWidgetHighlightForeground`,`Foreground color of the active item in the parameter hint.`));Ya((e,t)=>{let n=e.getColor(In);if(n){let r=e.type===Xi.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .parameter-hints-widget { border: ${r}px solid ${n}; }`),t.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${n.transparent(.5)}; }`),t.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${n.transparent(.5)}; }`)}let r=e.getColor(Ps);r&&t.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${r}; }`);let i=e.getColor(h);i&&t.addRule(`.monaco-editor .parameter-hints-widget a { color: ${i}; }`);let a=e.getColor(Fa);a&&t.addRule(`.monaco-editor .parameter-hints-widget a:hover { color: ${a}; }`);let o=e.getColor(pe);o&&t.addRule(`.monaco-editor .parameter-hints-widget { color: ${o}; }`);let s=e.getColor(nn);s&&t.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${s}; }`);let c=e.getColor(gT);c&&t.addRule(`.monaco-editor .parameter-hints-widget .parameter.active { color: ${c}}`)});var _T=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},vT=function(e,t){return function(n,r){t(n,r,e)}},yT=class e extends _{constructor(e,t){super(),this.editor=e,this.widget=this._register(t.createInstance(hT,this.editor))}static get(t){return t.getContribution(e.ID)}cancel(){this.widget.cancel()}previous(){this.widget.previous()}next(){this.widget.next()}trigger(e){this.widget.trigger(e)}};yT.ID=`editor.controller.parameterHints`,yT=_T([vT(1,H)],yT);var bT=class extends V{constructor(){super({id:`editor.action.triggerParameterHints`,label:z(`parameterHints.trigger.label`,`Trigger Parameter Hints`),alias:`Trigger Parameter Hints`,precondition:A.hasSignatureHelpProvider,kbOpts:{kbExpr:A.editorTextFocus,primary:3082,weight:100}})}run(e,t){let n=yT.get(t);n&&n.trigger({triggerKind:Cr.Invoke})}};U(yT.ID,yT),o(bT);var xT=175,ST=ft.bindToContribution(yT.get);F(new ST({id:`closeParameterHints`,precondition:iT.Visible,handler:e=>e.cancel(),kbOpts:{weight:xT,kbExpr:A.focus,primary:9,secondary:[1033]}})),F(new ST({id:`showPrevParameterHint`,precondition:w.and(iT.Visible,iT.MultipleSignatures),handler:e=>e.previous(),kbOpts:{weight:xT,kbExpr:A.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}})),F(new ST({id:`showNextParameterHint`,precondition:w.and(iT.Visible,iT.MultipleSignatures),handler:e=>e.next(),kbOpts:{weight:xT,kbExpr:A.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));var CT=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},wT=function(e,t){return function(n,r){t(n,r,e)}};const TT=new k(`renameInputVisible`,!1,z(`renameInputVisible`,`Whether the rename input widget is visible`));var ET=class{constructor(e,t,n,r,i){this._editor=e,this._acceptKeybindings=t,this._themeService=n,this._keybindingService=r,this._disposables=new K,this.allowEditorOverflow=!0,this._visibleContextKey=TT.bindTo(i),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration(e=>{e.hasChanged(43)&&this._updateFont()})),this._disposables.add(n.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return`__renameInputWidget`}getDomNode(){if(!this._domNode){this._domNode=document.createElement(`div`),this._domNode.className=`monaco-editor rename-box`,this._input=document.createElement(`input`),this._input.className=`rename-input`,this._input.type=`text`,this._input.setAttribute(`aria-label`,z(`renameAriaLabel`,`Rename input. Type new name and press Enter to commit.`)),this._domNode.appendChild(this._input),this._label=document.createElement(`div`),this._label.className=`rename-label`,this._domNode.appendChild(this._label);let e=()=>{let[e,t]=this._acceptKeybindings;this._keybindingService.lookupKeybinding(e),this._label.innerText=z({key:`label`,comment:[`placeholders are keybindings, e.g "F2 to Rename, Shift+F2 to Preview"`]},`{0} to Rename, {1} to Preview`,this._keybindingService.lookupKeybinding(e)?.getLabel(),this._keybindingService.lookupKeybinding(t)?.getLabel())};e(),this._disposables.add(this._keybindingService.onDidUpdateKeybindings(e)),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())}return this._domNode}_updateStyles(e){if(!this._input||!this._domNode)return;let t=e.getColor(qt);this._domNode.style.backgroundColor=String(e.getColor(lr)??``),this._domNode.style.boxShadow=t?` 0 0 8px 2px ${t}`:``,this._domNode.style.color=String(e.getColor(Ii)??``),this._input.style.backgroundColor=String(e.getColor(vn)??``);let n=e.getColor(i);this._input.style.borderWidth=n?`1px`:`0px`,this._input.style.borderStyle=n?`solid`:`none`,this._input.style.borderColor=n?.toString()??`none`}_updateFont(){if(!this._input||!this._label)return;let e=this._editor.getOption(43);this._input.style.fontFamily=e.fontFamily,this._input.style.fontWeight=e.fontWeight,this._input.style.fontSize=`${e.fontSize}px`,this._label.style.fontSize=`${e.fontSize*.8}px`}getPosition(){return this._visible?{position:this._position,preference:[2,1]}:null}afterRender(e){e||this.cancelInput(!0)}acceptInput(e){this._currentAcceptInput&&this._currentAcceptInput(e)}cancelInput(e){this._currentCancelInput&&this._currentCancelInput(e)}getInput(e,t,n,r,i,a){this._domNode.classList.toggle(`preview`,i),this._position=new P(e.startLineNumber,e.startColumn),this._input.value=t,this._input.setAttribute(`selectionStart`,n.toString()),this._input.setAttribute(`selectionEnd`,r.toString()),this._input.size=Math.max((e.endColumn-e.startColumn)*1.1,20);let o=new K;return new Promise(e=>{this._currentCancelInput=t=>(this._currentAcceptInput=void 0,this._currentCancelInput=void 0,e(t),!0),this._currentAcceptInput=n=>{if(this._input.value.trim().length===0||this._input.value===t){this.cancelInput(!0);return}this._currentAcceptInput=void 0,this._currentCancelInput=void 0,e({newName:this._input.value,wantsPreview:i&&n})},a.onCancellationRequested(()=>this.cancelInput(!0)),o.add(this._editor.onDidBlurEditorWidget(()=>this.cancelInput(!1))),this._show()}).finally(()=>{o.dispose(),this._hide()})}_show(){this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout(()=>{this._input.focus(),this._input.setSelectionRange(parseInt(this._input.getAttribute(`selectionStart`)),parseInt(this._input.getAttribute(`selectionEnd`)))},100)}_hide(){this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}};ET=CT([wT(2,Vi),wT(3,Oo),wT(4,D)],ET);var DT=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},OT=function(e,t){return function(n,r){t(n,r,e)}},kT=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},AT=class{constructor(e,t){this.model=e,this.position=t,this._providerRenameIdx=0,this._providers=Ao.ordered(e)}hasProvider(){return this._providers.length>0}resolveRenameLocation(e){return kT(this,void 0,void 0,function*(){let t=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){let n=this._providers[this._providerRenameIdx];if(!n.resolveRenameLocation)break;let r=yield n.resolveRenameLocation(this.model,this.position,e);if(r){if(r.rejectReason){t.push(r.rejectReason);continue}return r}}let n=this.model.getWordAtPosition(this.position);return n?{range:new W(this.position.lineNumber,n.startColumn,this.position.lineNumber,n.endColumn),text:n.word,rejectReason:t.length>0?t.join(`
`):void 0}:{range:W.fromPositions(this.position),text:``,rejectReason:t.length>0?t.join(`
`):void 0}})}provideRenameEdits(e,t){return kT(this,void 0,void 0,function*(){return this._provideRenameEdits(e,this._providerRenameIdx,[],t)})}_provideRenameEdits(e,t,n,r){return kT(this,void 0,void 0,function*(){let i=this._providers[t];if(!i)return{edits:[],rejectReason:n.join(`
`)};let a=yield i.provideRenameEdits(this.model,this.position,e,r);if(a){if(a.rejectReason)return this._provideRenameEdits(e,t+1,n.concat(a.rejectReason),r)}else return this._provideRenameEdits(e,t+1,n.concat(z(`no result`,`No result.`)),r);return a})}};function jT(e,t,n){return kT(this,void 0,void 0,function*(){let r=new AT(e,t),i=yield r.resolveRenameLocation(j.None);return i?.rejectReason?{edits:[],rejectReason:i.rejectReason}:r.provideRenameEdits(n,j.None)})}var MT=class e{constructor(e,t,n,r,i,a,o){this.editor=e,this._instaService=t,this._notificationService=n,this._bulkEditService=r,this._progressService=i,this._logService=a,this._configService=o,this._dispoableStore=new K,this._cts=new hs,this._renameInputField=this._dispoableStore.add(new br(()=>this._dispoableStore.add(this._instaService.createInstance(ET,this.editor,[`acceptRenameInput`,`acceptRenameInputWithPreview`]))))}static get(t){return t.getContribution(e.ID)}dispose(){this._dispoableStore.dispose(),this._cts.dispose(!0)}run(){return kT(this,void 0,void 0,function*(){if(this._cts.dispose(!0),!this.editor.hasModel())return;let e=this.editor.getPosition(),t=new AT(this.editor.getModel(),e);if(!t.hasProvider())return;this._cts=new Ae(this.editor,5);let n;try{let e=t.resolveRenameLocation(this._cts.token);this._progressService.showWhile(e,250),n=yield e}catch(t){Sl.get(this.editor).showMessage(t||z(`resolveRenameLocationFailed`,`An unknown error occurred while resolving rename location`),e);return}if(!n)return;if(n.rejectReason){Sl.get(this.editor).showMessage(n.rejectReason,e);return}if(this._cts.token.isCancellationRequested)return;this._cts.dispose(),this._cts=new Ae(this.editor,5,n.range);let r=this.editor.getSelection(),i=0,a=n.text.length;!W.isEmpty(r)&&!W.spansMultipleLines(r)&&W.containsRange(n.range,r)&&(i=Math.max(0,r.startColumn-n.range.startColumn),a=Math.min(n.range.endColumn,r.endColumn)-n.range.startColumn);let o=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,`editor.rename.enablePreview`),s=yield this._renameInputField.value.getInput(n.range,n.text,i,a,o,this._cts.token);if(typeof s==`boolean`){s&&this.editor.focus();return}this.editor.focus();let c=Or(t.provideRenameEdits(s.newName,this._cts.token),this._cts.token).then(e=>kT(this,void 0,void 0,function*(){if(!(!e||!this.editor.hasModel())){if(e.rejectReason){this._notificationService.info(e.rejectReason);return}this.editor.setSelection(W.fromPositions(this.editor.getSelection().getPosition())),this._bulkEditService.apply(cr.convert(e),{editor:this.editor,showPreview:s.wantsPreview,label:z(`label`,`Renaming '{0}'`,n?.text),quotableLabel:z(`quotableLabel`,`Renaming {0}`,n?.text)}).then(e=>{e.ariaSummary&&Fn(z(`aria`,`Successfully renamed '{0}' to '{1}'. Summary: {2}`,n.text,s.newName,e.ariaSummary))}).catch(e=>{this._notificationService.error(z(`rename.failedApply`,`Rename failed to apply edits`)),this._logService.error(e)})}}),e=>{this._notificationService.error(z(`rename.failed`,`Rename failed to compute edits`)),this._logService.error(e)});return this._progressService.showWhile(c,250),c})}acceptRenameInput(e){this._renameInputField.value.acceptInput(e)}cancelRenameInput(){this._renameInputField.value.cancelInput(!0)}};MT.ID=`editor.contrib.renameController`,MT=DT([OT(1,H),OT(2,Ft),OT(3,ie),OT(4,ua),OT(5,wr),OT(6,Go)],MT);var NT=class extends V{constructor(){super({id:`editor.action.rename`,label:z(`rename.label`,`Rename Symbol`),alias:`Rename Symbol`,precondition:w.and(A.writable,A.hasRenameProvider),kbOpts:{kbExpr:A.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:`1_modification`,order:1.1}})}runCommand(e,t){let n=e.get(po),[r,i]=Array.isArray(t)&&t||[void 0,void 0];return L.isUri(r)&&P.isIPosition(i)?n.openCodeEditor({resource:r},n.getActiveCodeEditor()).then(e=>{e&&(e.setPosition(i),e.invokeWithinContext(t=>(this.reportTelemetry(t,e),this.run(t,e))))},C):super.runCommand(e,t)}run(e,t){let n=MT.get(t);return n?n.run():Promise.resolve()}};U(MT.ID,MT),o(NT);var PT=ft.bindToContribution(MT.get);F(new PT({id:`acceptRenameInput`,precondition:TT,handler:e=>e.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:A.focus,primary:3}})),F(new PT({id:`acceptRenameInputWithPreview`,precondition:w.and(TT,w.has(`config.editor.rename.enablePreview`)),handler:e=>e.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:A.focus,primary:1027}})),F(new PT({id:`cancelRenameInput`,precondition:TT,handler:e=>e.cancelRenameInput(),kbOpts:{weight:199,kbExpr:A.focus,primary:9,secondary:[1033]}})),Ro(`_executeDocumentRenameProvider`,function(e,t,...n){let[r]=n;return Fs(typeof r==`string`),jT(e,t,r)}),Ro(`_executePrepareRename`,function(e,t){return kT(this,void 0,void 0,function*(){let n=yield new AT(e,t).resolveRenameLocation(j.None);if(n?.rejectReason)throw Error(n.rejectReason);return n})}),ra.as(qa.Configuration).registerConfiguration({id:`editor`,properties:{"editor.rename.enablePreview":{scope:5,description:z(`enablePreview`,`Enable/disable the ability to preview changes before renaming`),default:!0,type:`boolean`}}});var FT=class{provideSelectionRanges(e,t){let n=[];for(let r of t){let t=[];n.push(t),this._addInWordRanges(t,e,r),this._addWordRanges(t,e,r),this._addWhitespaceLine(t,e,r),t.push({range:e.getFullModelRange()})}return n}_addInWordRanges(e,t,n){let r=t.getWordAtPosition(n);if(!r)return;let{word:i,startColumn:a}=r,o=n.column-a,s=o,c=o,l=0;for(;s>=0;s--){let e=i.charCodeAt(s);if(s!==o&&(e===95||e===45)||va(e)&&oi(l))break;l=e}for(s+=1;c<i.length;c++){let e=i.charCodeAt(c);if(oi(e)&&va(l)||e===95||e===45)break;l=e}s<c&&e.push({range:new W(n.lineNumber,a+s,n.lineNumber,a+c)})}_addWordRanges(e,t,n){let r=t.getWordAtPosition(n);r&&e.push({range:new W(n.lineNumber,r.startColumn,n.lineNumber,r.endColumn)})}_addWhitespaceLine(e,t,n){t.getLineLength(n.lineNumber)>0&&t.getLineFirstNonWhitespaceColumn(n.lineNumber)===0&&t.getLineLastNonWhitespaceColumn(n.lineNumber)===0&&e.push({range:new W(n.lineNumber,1,n.lineNumber,t.getLineMaxColumn(n.lineNumber))})}},IT=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},LT=class e{constructor(e,t){this.index=e,this.ranges=t}mov(t){let n=this.index+(t?1:-1);if(n<0||n>=this.ranges.length)return this;let r=new e(n,this.ranges);return r.ranges[n].equalsRange(this.ranges[this.index])?r.mov(t):r}},RT=class e{constructor(e){this._editor=e,this._ignoreSelection=!1}static get(t){return t.getContribution(e.ID)}dispose(){var e;(e=this._selectionListener)==null||e.dispose()}run(e){return IT(this,void 0,void 0,function*(){if(!this._editor.hasModel())return;let t=this._editor.getSelections(),n=this._editor.getModel();if(!ct.has(n)||(this._state||(yield HT(n,t.map(e=>e.getPosition()),this._editor.getOption(101),j.None).then(e=>{var n;if(!(!ti(e)||e.length!==t.length)&&!(!this._editor.hasModel()||!Ni(this._editor.getSelections(),t,(e,t)=>e.equalsSelection(t)))){for(let n=0;n<e.length;n++)e[n]=e[n].filter(e=>e.containsPosition(t[n].getStartPosition())&&e.containsPosition(t[n].getEndPosition())),e[n].unshift(t[n]);this._state=e.map(e=>new LT(0,e)),(n=this._selectionListener)==null||n.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition(()=>{var e;this._ignoreSelection||((e=this._selectionListener)==null||e.dispose(),this._state=void 0)})}})),!this._state))return;this._state=this._state.map(t=>t.mov(e));let r=this._state.map(e=>R.fromPositions(e.ranges[e.index].getStartPosition(),e.ranges[e.index].getEndPosition()));this._ignoreSelection=!0;try{this._editor.setSelections(r)}finally{this._ignoreSelection=!1}})}};RT.ID=`editor.contrib.smartSelectController`;var zT=class extends V{constructor(e,t){super(t),this._forward=e}run(e,t){return IT(this,void 0,void 0,function*(){let e=RT.get(t);e&&(yield e.run(this._forward))})}},BT=class extends zT{constructor(){super(!0,{id:`editor.action.smartSelect.expand`,label:z(`smartSelect.expand`,`Expand Selection`),alias:`Expand Selection`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`1_basic`,title:z({key:`miSmartSelectGrow`,comment:[`&& denotes a mnemonic`]},`&&Expand Selection`),order:2}})}};vs.registerCommandAlias(`editor.action.smartSelect.grow`,`editor.action.smartSelect.expand`);var VT=class extends zT{constructor(){super(!1,{id:`editor.action.smartSelect.shrink`,label:z(`smartSelect.shrink`,`Shrink Selection`),alias:`Shrink Selection`,precondition:void 0,kbOpts:{kbExpr:A.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:N.MenubarSelectionMenu,group:`1_basic`,title:z({key:`miSmartSelectShrink`,comment:[`&& denotes a mnemonic`]},`&&Shrink Selection`),order:3}})}};U(RT.ID,RT),o(BT),o(VT),ct.register(`*`,new FT);function HT(e,t,n,r){return IT(this,void 0,void 0,function*(){let i=ct.all(e);i.length===1&&i.unshift(new Ug);let a=[],o=[];for(let n of i)a.push(Promise.resolve(n.provideSelectionRanges(e,t,r)).then(e=>{if(ti(e)&&e.length===t.length)for(let n=0;n<t.length;n++){o[n]||(o[n]=[]);for(let r of e[n])W.isIRange(r.range)&&W.containsPosition(r.range,t[n])&&o[n].push(W.lift(r.range))}},nt));return yield Promise.all(a),o.map(t=>{if(t.length===0)return[];t.sort((e,t)=>P.isBefore(e.getStartPosition(),t.getStartPosition())?1:P.isBefore(t.getStartPosition(),e.getStartPosition())||P.isBefore(e.getEndPosition(),t.getEndPosition())?-1:P.isBefore(t.getEndPosition(),e.getEndPosition())?1:0);let r=[],i;for(let e of t)(!i||W.containsRange(e,i)&&!W.equalsRange(e,i))&&(r.push(e),i=e);if(!n.selectLeadingAndTrailingWhitespace)return r;let a=[r[0]];for(let t=1;t<r.length;t++){let n=r[t-1],i=r[t];if(i.startLineNumber!==n.startLineNumber||i.endLineNumber!==n.endLineNumber){let t=new W(n.startLineNumber,e.getLineFirstNonWhitespaceColumn(n.startLineNumber),n.endLineNumber,e.getLineLastNonWhitespaceColumn(n.endLineNumber));t.containsRange(n)&&!t.equalsRange(n)&&i.containsRange(t)&&!i.equalsRange(t)&&a.push(t);let r=new W(n.startLineNumber,1,n.endLineNumber,e.getLineMaxColumn(n.endLineNumber));r.containsRange(n)&&!r.equalsRange(t)&&i.containsRange(r)&&!i.equalsRange(r)&&a.push(r)}a.push(i)}return a})})}ma(`_executeSelectionRangeProvider`,function(e,...t){let[n]=t;return HT(e,n,{selectLeadingAndTrailingWhitespace:!0},j.None)}),o(class extends V{constructor(){super({id:`editor.action.forceRetokenize`,label:z(`forceRetokenize`,`Developer: Force Retokenize`),alias:`Developer: Force Retokenize`,precondition:void 0})}run(e,t){if(!t.hasModel())return;let n=t.getModel();n.resetTokenization();let r=new Ms(!0);n.forceTokenization(n.getLineCount()),r.stop(),console.log(`tokenization took ${r.elapsed()}`)}});var UT=class e extends V{constructor(){super({id:e.ID,label:z({key:`toggle.tabMovesFocus`,comment:[`Turn on/off use of tab key for moving focus around VS Code`]},`Toggle Tab Key Moves Focus`),alias:`Toggle Tab Key Moves Focus`,precondition:void 0,kbOpts:{kbExpr:null,primary:2091,mac:{primary:1323},weight:100}})}run(e,t){let n=!Ys.getTabFocusMode();Ys.setTabFocusMode(n),Fn(n?z(`toggle.tabMovesFocus.on`,`Pressing Tab will now move focus to the next focusable element`):z(`toggle.tabMovesFocus.off`,`Pressing Tab will now insert the tab character`))}};UT.ID=`editor.action.toggleTabFocusMode`,o(UT);var WT=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},GT=function(e,t){return function(n,r){t(n,r,e)}},KT=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},qT=`ignoreUnusualLineTerminators`;function JT(e,t,n){e.setModelProperty(t.uri,qT,n)}function YT(e,t){return e.getModelProperty(t.uri,qT)}var XT=class extends _{constructor(e,t,n){super(),this._editor=e,this._dialogService=t,this._codeEditorService=n,this._config=this._editor.getOption(112),this._register(this._editor.onDidChangeConfiguration(e=>{e.hasChanged(112)&&(this._config=this._editor.getOption(112),this._checkForUnusualLineTerminators())})),this._register(this._editor.onDidChangeModel(()=>{this._checkForUnusualLineTerminators()})),this._register(this._editor.onDidChangeModelContent(e=>{e.isUndoing||this._checkForUnusualLineTerminators()}))}_checkForUnusualLineTerminators(){return KT(this,void 0,void 0,function*(){if(this._config===`off`||!this._editor.hasModel())return;let e=this._editor.getModel();if(e.mightContainUnusualLineTerminators()&&YT(this._codeEditorService,e)!==!0&&!this._editor.getOption(80)){if(this._config===`auto`){e.removeUnusualLineTerminators(this._editor.getSelections());return}if(!(yield this._dialogService.confirm({title:z(`unusualLineTerminators.title`,`Unusual Line Terminators`),message:z(`unusualLineTerminators.message`,`Detected unusual line terminators`),detail:z(`unusualLineTerminators.detail`,`The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).

It is recommended to remove them from the file. This can be configured via \`editor.unusualLineTerminators\`.`,Pa(e.uri)),primaryButton:z(`unusualLineTerminators.fix`,`Remove Unusual Line Terminators`),secondaryButton:z(`unusualLineTerminators.ignore`,`Ignore`)})).confirmed){JT(this._codeEditorService,e,!0);return}e.removeUnusualLineTerminators(this._editor.getSelections())}})}};XT.ID=`editor.contrib.unusualLineTerminatorsDetector`,XT=WT([GT(1,st),GT(2,po)],XT),U(XT.ID,XT);var ZT=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},QT=function(e,t){return function(n,r){t(n,r,e)}},$T=class extends _{constructor(e,t,n,r){super(),this._modelService=t,this._themeService=n,this._configurationService=r,this._editor=e,this._tokenizeViewport=new T(()=>this._tokenizeViewportNow(),100),this._outstandingRequests=[],this._register(this._editor.onDidScrollChange(()=>{this._tokenizeViewport.schedule()})),this._register(this._editor.onDidChangeModel(()=>{this._cancelAll(),this._tokenizeViewport.schedule()})),this._register(this._editor.onDidChangeModelContent(e=>{this._cancelAll(),this._tokenizeViewport.schedule()})),this._register(Ht.onDidChange(()=>{this._cancelAll(),this._tokenizeViewport.schedule()})),this._register(this._configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(`editor.semanticHighlighting`)&&(this._cancelAll(),this._tokenizeViewport.schedule())})),this._register(this._themeService.onDidColorThemeChange(()=>{this._cancelAll(),this._tokenizeViewport.schedule()}))}_cancelAll(){for(let e of this._outstandingRequests)e.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(e){for(let t=0,n=this._outstandingRequests.length;t<n;t++)if(this._outstandingRequests[t]===e){this._outstandingRequests.splice(t,1);return}}_tokenizeViewportNow(){if(!this._editor.hasModel())return;let e=this._editor.getModel();if(e.hasCompleteSemanticTokens())return;if(!Ga(e,this._themeService,this._configurationService)){e.hasSomeSemanticTokens()&&e.setSemanticTokens(null,!1);return}if(!Mi(e)){e.hasSomeSemanticTokens()&&e.setSemanticTokens(null,!1);return}let t=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(t.map(t=>this._requestRange(e,t)))}_requestRange(e,t){let n=e.getVersionId(),r=No(n=>Promise.resolve(fs(e,t,n)));return r.then(r=>{if(!r||!r.tokens||e.isDisposed()||e.getVersionId()!==n)return;let{provider:i,tokens:a}=r,o=this._modelService.getSemanticTokensProviderStyling(i);e.setPartialSemanticTokens(t,Ki(a,o,e.getLanguageId()))}).then(()=>this._removeOutstandingRequest(r),()=>this._removeOutstandingRequest(r)),r}};$T.ID=`editor.contrib.viewportSemanticTokens`,$T=ZT([QT(1,Jo),QT(2,Vi),QT(3,xo)],$T),U($T.ID,$T);var eE=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},tE=function(e,t){return function(n,r){t(n,r,e)}},nE=v(`editor.wordHighlightBackground`,{dark:`#575757B8`,light:`#57575740`,hc:null},z(`wordHighlight`,`Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations.`),!0),rE=v(`editor.wordHighlightStrongBackground`,{dark:`#004972B8`,light:`#0e639c40`,hc:null},z(`wordHighlightStrong`,`Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations.`),!0),iE=v(`editor.wordHighlightBorder`,{light:null,dark:null,hc:bi},z(`wordHighlightBorder`,`Border color of a symbol during read-access, like reading a variable.`)),aE=v(`editor.wordHighlightStrongBorder`,{light:null,dark:null,hc:bi},z(`wordHighlightStrongBorder`,`Border color of a symbol during write-access, like writing to a variable.`)),oE=v(`editorOverviewRuler.wordHighlightForeground`,{dark:`#A0A0A0CC`,light:`#A0A0A0CC`,hc:`#A0A0A0CC`},z(`overviewRulerWordHighlightForeground`,`Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations.`),!0),sE=v(`editorOverviewRuler.wordHighlightStrongForeground`,{dark:`#C0A0C0CC`,light:`#C0A0C0CC`,hc:`#C0A0C0CC`},z(`overviewRulerWordHighlightStrongForeground`,`Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations.`),!0),cE=new k(`hasWordHighlights`,!1);function lE(e,t,n){return Ir(xa.ordered(e).map(r=>()=>Promise.resolve(r.provideDocumentHighlights(e,t,n)).then(void 0,nt)),ti)}var uE=class{constructor(e,t,n){this._wordRange=this._getCurrentWordRange(e,t),this.result=No(r=>this._compute(e,t,n,r))}_getCurrentWordRange(e,t){let n=e.getWordAtPosition(t.getPosition());return n?new W(t.startLineNumber,n.startColumn,t.startLineNumber,n.endColumn):null}isValid(e,t,n){let r=t.startLineNumber,i=t.startColumn,a=t.endColumn,o=this._getCurrentWordRange(e,t),s=!!(this._wordRange&&this._wordRange.equalsRange(o));for(let t=0,o=n.length;!s&&t<o;t++){let o=e.getDecorationRange(n[t]);o&&o.startLineNumber===r&&o.startColumn<=i&&o.endColumn>=a&&(s=!0)}return s}cancel(){this.result.cancel()}},dE=class extends uE{_compute(e,t,n,r){return lE(e,t.getPosition(),r).then(e=>e||[])}},fE=class extends uE{constructor(e,t,n){super(e,t,n),this._selectionIsEmpty=t.isEmpty()}_compute(e,t,n,r){return xn(250,r).then(()=>{if(!t.isEmpty())return[];let r=e.getWordAtPosition(t.getPosition());return!r||r.word.length>1e3?[]:e.findMatches(r.word,!0,!1,!0,n,!1).map(e=>({range:e.range,kind:u.Text}))})}isValid(e,t,n){let r=t.isEmpty();return this._selectionIsEmpty===r?super.isValid(e,t,n):!1}};function pE(e,t,n){return xa.has(e)?new dE(e,t,n):new fE(e,t,n)}Ro(`_executeDocumentHighlights`,(e,t)=>lE(e,t,j.None));var mE=class e{constructor(e,t){this.toUnhook=new K,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=[],this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.editor=e,this._hasWordHighlights=cE.bindTo(t),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(71),this.model=this.editor.getModel(),this.toUnhook.add(e.onDidChangeCursorPosition(e=>{this._ignorePositionChangeEvent||this.occurrencesHighlight&&this._onPositionChanged(e)})),this.toUnhook.add(e.onDidChangeModelContent(e=>{this._stopAll()})),this.toUnhook.add(e.onDidChangeConfiguration(e=>{let t=this.editor.getOption(71);this.occurrencesHighlight!==t&&(this.occurrencesHighlight=t,this._stopAll())})),this._decorationIds=[],this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1}hasDecorations(){return this._decorationIds.length>0}restore(){this.occurrencesHighlight&&this._run()}_getSortedHighlights(){return r(this._decorationIds.map(e=>this.model.getDecorationRange(e)).sort(W.compareRangesUsingStarts))}moveNext(){let e=this._getSortedHighlights(),t=(e.findIndex(e=>e.containsPosition(this.editor.getPosition()))+1)%e.length,n=e[t];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);let r=this._getWord();r&&Fn(`${this.editor.getModel().getLineContent(n.startLineNumber)}, ${t+1} of ${e.length} for '${r.word}'`)}finally{this._ignorePositionChangeEvent=!1}}moveBack(){let e=this._getSortedHighlights(),t=(e.findIndex(e=>e.containsPosition(this.editor.getPosition()))-1+e.length)%e.length,n=e[t];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);let r=this._getWord();r&&Fn(`${this.editor.getModel().getLineContent(n.startLineNumber)}, ${t+1} of ${e.length} for '${r.word}'`)}finally{this._ignorePositionChangeEvent=!1}}_removeDecorations(){this._decorationIds.length>0&&(this._decorationIds=this.editor.deltaDecorations(this._decorationIds,[]),this._hasWordHighlights.set(!1))}_stopAll(){this._removeDecorations(),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||=(this.workerRequestTokenId++,!0)}_onPositionChanged(e){if(!this.occurrencesHighlight){this._stopAll();return}if(e.reason!==3){this._stopAll();return}this._run()}_getWord(){let e=this.editor.getSelection(),t=e.startLineNumber,n=e.startColumn;return this.model.getWordAtPosition({lineNumber:t,column:n})}_run(){let e=this.editor.getSelection();if(e.startLineNumber!==e.endLineNumber){this._stopAll();return}let t=e.startColumn,n=e.endColumn,r=this._getWord();if(!r||r.startColumn>t||r.endColumn<n){this._stopAll();return}let i=this.workerRequest&&this.workerRequest.isValid(this.model,e,this._decorationIds);if(this.lastCursorPositionChangeTime=new Date().getTime(),i)this.workerRequestCompleted&&this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else{this._stopAll();let e=++this.workerRequestTokenId;this.workerRequestCompleted=!1,this.workerRequest=pE(this.model,this.editor.getSelection(),this.editor.getOption(115)),this.workerRequest.result.then(t=>{e===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=t||[],this._beginRenderDecorations())},C)}}_beginRenderDecorations(){let e=new Date().getTime(),t=this.lastCursorPositionChangeTime+250;e>=t?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout(()=>{this.renderDecorations()},t-e)}renderDecorations(){this.renderDecorationsTimer=-1;let t=[];for(let n of this.workerRequestValue)n.range&&t.push({range:n.range,options:e._getDecorationOptions(n.kind)});this._decorationIds=this.editor.deltaDecorations(this._decorationIds,t),this._hasWordHighlights.set(this.hasDecorations())}static _getDecorationOptions(e){return e===u.Write?this._WRITE_OPTIONS:e===u.Text?this._TEXT_OPTIONS:this._REGULAR_OPTIONS}dispose(){this._stopAll(),this.toUnhook.dispose()}};mE._WRITE_OPTIONS=I.register({description:`word-highlight-strong`,stickiness:1,className:`wordHighlightStrong`,overviewRuler:{color:aa(sE),position:ki.Center},minimap:{color:aa(Eo),position:us.Inline}}),mE._TEXT_OPTIONS=I.register({description:`selection-highlight`,stickiness:1,className:`selectionHighlight`,overviewRuler:{color:aa($i),position:ki.Center},minimap:{color:aa(Eo),position:us.Inline}}),mE._REGULAR_OPTIONS=I.register({description:`word-highlight`,stickiness:1,className:`wordHighlight`,overviewRuler:{color:aa(oE),position:ki.Center},minimap:{color:aa(Eo),position:us.Inline}});var hE=class e extends _{constructor(e,t){super(),this.wordHighlighter=null;let n=()=>{e.hasModel()&&(this.wordHighlighter=new mE(e,t))};this._register(e.onDidChangeModel(e=>{this.wordHighlighter&&=(this.wordHighlighter.dispose(),null),n()})),n()}static get(t){return t.getContribution(e.ID)}saveViewState(){return!!(this.wordHighlighter&&this.wordHighlighter.hasDecorations())}moveNext(){this.wordHighlighter&&this.wordHighlighter.moveNext()}moveBack(){this.wordHighlighter&&this.wordHighlighter.moveBack()}restoreViewState(e){this.wordHighlighter&&e&&this.wordHighlighter.restore()}dispose(){this.wordHighlighter&&=(this.wordHighlighter.dispose(),null),super.dispose()}};hE.ID=`editor.contrib.wordHighlighter`,hE=eE([tE(1,D)],hE);var gE=class extends V{constructor(e,t){super(t),this._isNext=e}run(e,t){let n=hE.get(t);n&&(this._isNext?n.moveNext():n.moveBack())}},_E=class extends gE{constructor(){super(!0,{id:`editor.action.wordHighlight.next`,label:z(`wordHighlight.next.label`,`Go to Next Symbol Highlight`),alias:`Go to Next Symbol Highlight`,precondition:cE,kbOpts:{kbExpr:A.editorTextFocus,primary:65,weight:100}})}},vE=class extends gE{constructor(){super(!1,{id:`editor.action.wordHighlight.prev`,label:z(`wordHighlight.previous.label`,`Go to Previous Symbol Highlight`),alias:`Go to Previous Symbol Highlight`,precondition:cE,kbOpts:{kbExpr:A.editorTextFocus,primary:1089,weight:100}})}},yE=class extends V{constructor(){super({id:`editor.action.wordHighlight.trigger`,label:z(`wordHighlight.trigger.label`,`Trigger Symbol Highlight`),alias:`Trigger Symbol Highlight`,precondition:cE.toNegated(),kbOpts:{kbExpr:A.editorTextFocus,primary:0,weight:100}})}run(e,t,n){let r=hE.get(t);r&&r.restoreViewState(!0)}};U(hE.ID,hE),o(_E),o(vE),o(yE),Ya((e,t)=>{let n=e.getColor(Dt);n&&(t.addRule(`.monaco-editor .focused .selectionHighlight { background-color: ${n}; }`),t.addRule(`.monaco-editor .selectionHighlight { background-color: ${n.transparent(.5)}; }`));let r=e.getColor(nE);r&&t.addRule(`.monaco-editor .wordHighlight { background-color: ${r}; }`);let i=e.getColor(rE);i&&t.addRule(`.monaco-editor .wordHighlightStrong { background-color: ${i}; }`);let a=e.getColor(Dn);a&&t.addRule(`.monaco-editor .selectionHighlight { border: 1px ${e.type===`hc`?`dotted`:`solid`} ${a}; box-sizing: border-box; }`);let o=e.getColor(iE);o&&t.addRule(`.monaco-editor .wordHighlight { border: 1px ${e.type===`hc`?`dashed`:`solid`} ${o}; box-sizing: border-box; }`);let s=e.getColor(aE);s&&t.addRule(`.monaco-editor .wordHighlightStrong { border: 1px ${e.type===`hc`?`dashed`:`solid`} ${s}; box-sizing: border-box; }`)});var bE=class extends ft{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,n){if(!t.hasModel())return;let r=se(t.getOption(115)),i=t.getModel(),a=t.getSelections().map(e=>{let t=new P(e.positionLineNumber,e.positionColumn),n=this._move(r,i,t,this._wordNavigationType);return this._moveTo(e,n,this._inSelectionMode)});if(i.pushStackElement(),t._getViewModel().setCursorStates(`moveWordCommand`,3,a.map(e=>c.fromModelSelection(e))),a.length===1){let e=new P(a[0].positionLineNumber,a[0].positionColumn);t.revealPosition(e,0)}}_moveTo(e,t,n){return n?new R(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new R(t.lineNumber,t.column,t.lineNumber,t.column)}},xE=class extends bE{_move(e,t,n,r){return Ge.moveWordLeft(e,t,n,r)}},SE=class extends bE{_move(e,t,n,r){return Ge.moveWordRight(e,t,n,r)}},CE=class extends xE{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:`cursorWordStartLeft`,precondition:void 0})}},wE=class extends xE{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:`cursorWordEndLeft`,precondition:void 0})}},TE=class extends xE{constructor(){super({inSelectionMode:!1,wordNavigationType:1,id:`cursorWordLeft`,precondition:void 0,kbOpts:{kbExpr:w.and(A.textInputFocus,w.and(Yt,Xn)?.negate()),primary:2063,mac:{primary:527},weight:100}})}},EE=class extends xE{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:`cursorWordStartLeftSelect`,precondition:void 0})}},DE=class extends xE{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:`cursorWordEndLeftSelect`,precondition:void 0})}},OE=class extends xE{constructor(){super({inSelectionMode:!0,wordNavigationType:1,id:`cursorWordLeftSelect`,precondition:void 0,kbOpts:{kbExpr:w.and(A.textInputFocus,w.and(Yt,Xn)?.negate()),primary:3087,mac:{primary:1551},weight:100}})}},kE=class extends xE{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:`cursorWordAccessibilityLeft`,precondition:void 0})}_move(e,t,n,r){return super._move(se(Js.wordSeparators.defaultValue),t,n,r)}},AE=class extends xE{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:`cursorWordAccessibilityLeftSelect`,precondition:void 0})}_move(e,t,n,r){return super._move(se(Js.wordSeparators.defaultValue),t,n,r)}},jE=class extends SE{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:`cursorWordStartRight`,precondition:void 0})}},ME=class extends SE{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:`cursorWordEndRight`,precondition:void 0,kbOpts:{kbExpr:w.and(A.textInputFocus,w.and(Yt,Xn)?.negate()),primary:2065,mac:{primary:529},weight:100}})}},NE=class extends SE{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:`cursorWordRight`,precondition:void 0})}},PE=class extends SE{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:`cursorWordStartRightSelect`,precondition:void 0})}},FE=class extends SE{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:`cursorWordEndRightSelect`,precondition:void 0,kbOpts:{kbExpr:w.and(A.textInputFocus,w.and(Yt,Xn)?.negate()),primary:3089,mac:{primary:1553},weight:100}})}},IE=class extends SE{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:`cursorWordRightSelect`,precondition:void 0})}},LE=class extends SE{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:`cursorWordAccessibilityRight`,precondition:void 0})}_move(e,t,n,r){return super._move(se(Js.wordSeparators.defaultValue),t,n,r)}},RE=class extends SE{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:`cursorWordAccessibilityRightSelect`,precondition:void 0})}_move(e,t,n,r){return super._move(se(Js.wordSeparators.defaultValue),t,n,r)}},zE=class extends ft{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,n){if(!t.hasModel())return;let r=se(t.getOption(115)),i=t.getModel(),a=t.getSelections(),o=t.getOption(5),s=t.getOption(8),c=Ei.getAutoClosingPairs(i.getLanguageId()),l=t._getViewModel(),u=a.map(e=>new mt(this._delete({wordSeparators:r,model:i,selection:e,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:t.getOption(6),autoClosingBrackets:o,autoClosingQuotes:s,autoClosingPairs:c,autoClosedCharacters:l.getCursorAutoClosedCharacters()},this._wordNavigationType),``));t.pushUndoStop(),t.executeCommands(this.id,u),t.pushUndoStop()}},BE=class extends zE{_delete(e,t){return Ge.deleteWordLeft(e,t)||new W(1,1,1,1)}},VE=class extends zE{_delete(e,t){let n=Ge.deleteWordRight(e,t);if(n)return n;let r=e.model.getLineCount(),i=e.model.getLineMaxColumn(r);return new W(r,i,r,i)}},HE=class extends BE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:`deleteWordStartLeft`,precondition:A.writable})}},UE=class extends BE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:`deleteWordEndLeft`,precondition:A.writable})}},WE=class extends BE{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:`deleteWordLeft`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}},GE=class extends VE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:`deleteWordStartRight`,precondition:A.writable})}},KE=class extends VE{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:`deleteWordEndRight`,precondition:A.writable})}},qE=class extends VE{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:`deleteWordRight`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}},JE=class extends V{constructor(){super({id:`deleteInsideWord`,precondition:A.writable,label:z(`deleteInsideWord`,`Delete Word`),alias:`Delete Word`})}run(e,t,n){if(!t.hasModel())return;let r=se(t.getOption(115)),i=t.getModel(),a=t.getSelections().map(e=>new mt(Ge.deleteInsideWord(r,i,e),``));t.pushUndoStop(),t.executeCommands(this.id,a),t.pushUndoStop()}};F(new CE),F(new wE),F(new TE),F(new EE),F(new DE),F(new OE),F(new jE),F(new ME),F(new NE),F(new PE),F(new FE),F(new IE),F(new kE),F(new AE),F(new LE),F(new RE),F(new HE),F(new UE),F(new WE),F(new GE),F(new KE),F(new qE),o(JE);var YE=class extends zE{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:`deleteWordPartLeft`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(e,t){return Ct.deleteWordPartLeft(e)||new W(1,1,1,1)}},XE=class extends zE{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:`deleteWordPartRight`,precondition:A.writable,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(e,t){let n=Ct.deleteWordPartRight(e);if(n)return n;let r=e.model.getLineCount(),i=e.model.getLineMaxColumn(r);return new W(r,i,r,i)}},ZE=class extends bE{_move(e,t,n,r){return Ct.moveWordPartLeft(e,t,n)}},QE=class extends ZE{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:`cursorWordPartLeft`,precondition:void 0,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:783},weight:100}})}};vs.registerCommandAlias(`cursorWordPartStartLeft`,`cursorWordPartLeft`);var $E=class extends ZE{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:`cursorWordPartLeftSelect`,precondition:void 0,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}};vs.registerCommandAlias(`cursorWordPartStartLeftSelect`,`cursorWordPartLeftSelect`);var eD=class extends bE{_move(e,t,n,r){return Ct.moveWordPartRight(e,t,n)}},tD=class extends eD{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:`cursorWordPartRight`,precondition:void 0,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:785},weight:100}})}},nD=class extends eD{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:`cursorWordPartRightSelect`,precondition:void 0,kbOpts:{kbExpr:A.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}};F(new YE),F(new XE),F(new QE),F(new $E),F(new tD),F(new nD);var rD=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},iD=function(e,t){return function(n,r){t(n,r,e)}},aD=new k(`accessibilityHelpWidgetVisible`,!1),oD=class e extends _{constructor(e,t){super(),this._editor=e,this._widget=this._register(t.createInstance(cD,this._editor))}static get(t){return t.getContribution(e.ID)}show(){this._widget.show()}hide(){this._widget.hide()}};oD.ID=`editor.contrib.accessibilityHelpController`,oD=rD([iD(1,H)],oD);function sD(e,t){return!e||e.length===0?ws.noSelection:e.length===1?t?yn(ws.singleSelectionRange,e[0].positionLineNumber,e[0].positionColumn,t):yn(ws.singleSelection,e[0].positionLineNumber,e[0].positionColumn):t?yn(ws.multiSelectionRange,e.length,t):e.length>0?yn(ws.multiSelection,e.length):``}var cD=class e extends ec{constructor(e,t,n,r){super(),this._contextKeyService=t,this._keybindingService=n,this._openerService=r,this._editor=e,this._isVisibleKey=aD.bindTo(this._contextKeyService),this._domNode=We(document.createElement(`div`)),this._domNode.setClassName(`accessibilityHelpWidget`),this._domNode.setDisplay(`none`),this._domNode.setAttribute(`role`,`dialog`),this._domNode.setAttribute(`aria-hidden`,`true`),this._contentDomNode=We(document.createElement(`div`)),this._contentDomNode.setAttribute(`role`,`document`),this._domNode.appendChild(this._contentDomNode),this._isVisible=!1,this._register(this._editor.onDidLayoutChange(()=>{this._isVisible&&this._layout()})),this._register(hi(this._contentDomNode.domNode,`keydown`,e=>{if(this._isVisible&&(e.equals(2083)&&(Fn(ws.emergencyConfOn),this._editor.updateOptions({accessibilitySupport:`on`}),he(this._contentDomNode.domNode),this._buildContent(),this._contentDomNode.domNode.focus(),e.preventDefault(),e.stopPropagation()),e.equals(2086))){Fn(ws.openingDocs);let t=this._editor.getRawOptions().accessibilityHelpUrl;t===void 0&&(t=`https://go.microsoft.com/fwlink/?linkid=852450`),this._openerService.open(L.parse(t)),e.preventDefault(),e.stopPropagation()}})),this.onblur(this._contentDomNode.domNode,()=>{this.hide()}),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return e.ID}getDomNode(){return this._domNode.domNode}getPosition(){return{preference:null}}show(){this._isVisible||(this._isVisible=!0,this._isVisibleKey.set(!0),this._layout(),this._domNode.setDisplay(`block`),this._domNode.setAttribute(`aria-hidden`,`false`),this._contentDomNode.domNode.tabIndex=0,this._buildContent(),this._contentDomNode.domNode.focus())}_descriptionForCommand(e,t,n){let r=this._keybindingService.lookupKeybinding(e);return r?yn(t,r.getAriaLabel()):yn(n,e)}_buildContent(){let e=this._editor.getOptions(),t=this._editor.getSelections(),n=0;if(t){let e=this._editor.getModel();e&&t.forEach(t=>{n+=e.getValueLengthInRange(t)})}let r=sD(t,n);e.get(53)?e.get(80)?r+=ws.readonlyDiffEditor:r+=ws.editableDiffEditor:e.get(80)?r+=ws.readonlyEditor:r+=ws.editableEditor;let i=Qn?ws.changeConfigToOnMac:ws.changeConfigToOnWinLinux;switch(e.get(2)){case 0:r+=`

 - `+i;break;case 2:r+=`

 - `+ws.auto_on;break;case 1:r+=`

 - `+ws.auto_off,r+=` `+i;break}e.get(128)?r+=`

 - `+this._descriptionForCommand(UT.ID,ws.tabFocusModeOnMsg,ws.tabFocusModeOnMsgNoKb):r+=`

 - `+this._descriptionForCommand(UT.ID,ws.tabFocusModeOffMsg,ws.tabFocusModeOffMsgNoKb);let a=Qn?ws.openDocMac:ws.openDocWinLinux;r+=`

 - `+a,r+=`

`+ws.outroMsg,this._contentDomNode.domNode.appendChild(l(r)),this._contentDomNode.domNode.setAttribute(`aria-label`,r)}hide(){this._isVisible&&(this._isVisible=!1,this._isVisibleKey.reset(),this._domNode.setDisplay(`none`),this._domNode.setAttribute(`aria-hidden`,`true`),this._contentDomNode.domNode.tabIndex=-1,he(this._contentDomNode.domNode),this._editor.focus())}_layout(){let t=this._editor.getLayoutInfo(),n=Math.max(5,Math.min(e.WIDTH,t.width-40)),r=Math.max(5,Math.min(e.HEIGHT,t.height-40));this._domNode.setWidth(n),this._domNode.setHeight(r);let i=Math.round((t.height-r)/2);this._domNode.setTop(i);let a=Math.round((t.width-n)/2);this._domNode.setLeft(a)}};cD.ID=`editor.contrib.accessibilityHelpWidget`,cD.WIDTH=500,cD.HEIGHT=300,cD=rD([iD(1,D),iD(2,Oo),iD(3,Qi)],cD);var lD=class extends V{constructor(){super({id:`editor.action.showAccessibilityHelp`,label:ws.showAccessibilityHelpAction,alias:`Show Accessibility Help`,precondition:void 0,kbOpts:{primary:571,weight:100,linux:{primary:1595,secondary:[571]}}})}run(e,t){let n=oD.get(t);n&&n.show()}};U(oD.ID,oD),o(lD),F(new(ft.bindToContribution(oD.get))({id:`closeAccessibilityHelp`,precondition:aD,handler:e=>e.hide(),kbOpts:{weight:200,kbExpr:A.focus,primary:9,secondary:[1033]}})),Ya((e,t)=>{let n=e.getColor(lr);n&&t.addRule(`.monaco-editor .accessibilityHelpWidget { background-color: ${n}; }`);let r=e.getColor(er);r&&t.addRule(`.monaco-editor .accessibilityHelpWidget { color: ${r}; }`);let i=e.getColor(qt);i&&t.addRule(`.monaco-editor .accessibilityHelpWidget { box-shadow: 0 2px 8px ${i}; }`);let a=e.getColor(Va);a&&t.addRule(`.monaco-editor .accessibilityHelpWidget { border: 2px solid ${a}; }`)});var uD=class extends _{constructor(e){super(),this.editor=e,this.widget=null,sr&&(this._register(e.onDidChangeConfiguration(()=>this.update())),this.update())}update(){let e=!this.editor.getOption(80);!this.widget&&e?this.widget=new dD(this.editor):this.widget&&!e&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&=(this.widget.dispose(),null)}};uD.ID=`editor.contrib.iPadShowKeyboard`;var dD=class e extends _{constructor(e){super(),this.editor=e,this._domNode=document.createElement(`textarea`),this._domNode.className=`iPadShowKeyboard`,this._register(Qr(this._domNode,`touchstart`,e=>{this.editor.focus()})),this._register(Qr(this._domNode,`focus`,e=>{this.editor.focus()})),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return e.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}};dD.ID=`editor.contrib.ShowKeyboardWidget`,U(uD.ID,uD);var fD=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},pD=function(e,t){return function(n,r){t(n,r,e)}},mD=class e extends _{constructor(e,t,r){super(),this._editor=e,this._modeService=r,this._widget=null,this._register(this._editor.onDidChangeModel(e=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(e=>this.stop())),this._register(n.onDidChange(e=>this.stop())),this._register(this._editor.onKeyUp(e=>e.keyCode===9&&this.stop()))}static get(t){return t.getContribution(e.ID)}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new vD(this._editor,this._modeService))}stop(){this._widget&&=(this._widget.dispose(),null)}};mD.ID=`editor.contrib.inspectTokens`,mD=fD([pD(1,eo),pD(2,zs)],mD);var hD=class extends V{constructor(){super({id:`editor.action.inspectTokens`,label:Te.inspectTokensAction,alias:`Developer: Inspect Tokens`,precondition:void 0})}run(e,t){let n=mD.get(t);n&&n.launch()}};function gD(e){let t=``;for(let n=0,r=e.length;n<r;n++){let r=e.charCodeAt(n);switch(r){case 9:t+=``;break;case 32:t+=``;break;default:t+=String.fromCharCode(r)}}return t}function _D(e,t){let r=n.get(t);if(r)return r;let i=e.encodeLanguageId(t);return{getInitialState:()=>js,tokenize:(e,n,r,i)=>Nn(t,e,r,i),tokenize2:(e,t,n,r)=>de(i,e,n,r)}}var vD=class e extends _{constructor(e,t){super(),this.allowEditorOverflow=!0,this._editor=e,this._modeService=t,this._model=this._editor.getModel(),this._domNode=document.createElement(`div`),this._domNode.className=`tokens-inspect-widget`,this._tokenizationSupport=_D(this._modeService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(e=>this._compute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return e._ID}_compute(e){let t=this._getTokensAtLine(e.lineNumber),n=0;for(let r=t.tokens1.length-1;r>=0;r--){let i=t.tokens1[r];if(e.column-1>=i.offset){n=r;break}}let r=0;for(let n=t.tokens2.length>>>1;n>=0;n--)if(e.column-1>=t.tokens2[n<<1]){r=n;break}let i=this._model.getLineContent(e.lineNumber),a=``;if(n<t.tokens1.length){let e=t.tokens1[n].offset,r=n+1<t.tokens1.length?t.tokens1[n+1].offset:i.length;a=i.substring(e,r)}At(this._domNode,G(`h2.tm-token`,void 0,gD(a),G(`span.tm-token-length`,void 0,`${a.length} ${a.length===1?`char`:`chars`}`))),q(this._domNode,G(`hr.tokens-inspect-separator`,{style:`clear:both`}));let o=(r<<1)+1<t.tokens2.length?this._decodeMetadata(t.tokens2[(r<<1)+1]):null;q(this._domNode,G(`table.tm-metadata-table`,void 0,G(`tbody`,void 0,G(`tr`,void 0,G(`td.tm-metadata-key`,void 0,`language`),G(`td.tm-metadata-value`,void 0,`${o?o.languageId:`-?-`}`)),G(`tr`,void 0,G(`td.tm-metadata-key`,void 0,`token type`),G(`td.tm-metadata-value`,void 0,`${o?this._tokenTypeToString(o.tokenType):`-?-`}`)),G(`tr`,void 0,G(`td.tm-metadata-key`,void 0,`font style`),G(`td.tm-metadata-value`,void 0,`${o?this._fontStyleToString(o.fontStyle):`-?-`}`)),G(`tr`,void 0,G(`td.tm-metadata-key`,void 0,`foreground`),G(`td.tm-metadata-value`,void 0,`${o?O.Format.CSS.formatHex(o.foreground):`-?-`}`)),G(`tr`,void 0,G(`td.tm-metadata-key`,void 0,`background`),G(`td.tm-metadata-value`,void 0,`${o?O.Format.CSS.formatHex(o.background):`-?-`}`))))),q(this._domNode,G(`hr.tokens-inspect-separator`)),n<t.tokens1.length&&q(this._domNode,G(`span.tm-token-type`,void 0,t.tokens1[n].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(e){let t=n.getColorMap(),r=gn.getLanguageId(e),i=gn.getTokenType(e),a=gn.getFontStyle(e),o=gn.getForeground(e),s=gn.getBackground(e);return{languageId:this._modeService.languageIdCodec.decodeLanguageId(r),tokenType:i,fontStyle:a,foreground:t[o],background:t[s]}}_tokenTypeToString(e){switch(e){case 0:return`Other`;case 1:return`Comment`;case 2:return`String`;case 4:return`RegEx`;default:return`??`}}_fontStyleToString(e){let t=``;return e&1&&(t+=`italic `),e&2&&(t+=`bold `),e&4&&(t+=`underline `),t.length===0&&(t=`---`),t}_getTokensAtLine(e){let t=this._getStateBeforeLine(e),n=this._tokenizationSupport.tokenize(this._model.getLineContent(e),!0,t,0),r=this._tokenizationSupport.tokenize2(this._model.getLineContent(e),!0,t,0);return{startState:t,tokens1:n.tokens,tokens2:r.tokens,endState:n.endState}}_getStateBeforeLine(e){let t=this._tokenizationSupport.getInitialState();for(let n=1;n<e;n++)t=this._tokenizationSupport.tokenize(this._model.getLineContent(n),!0,t,0).endState;return t}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}};vD._ID=`editor.contrib.inspectTokensWidget`,U(mD.ID,mD),o(hD),Ya((e,t)=>{let n=e.getColor(In);if(n){let r=e.type===Xi.HIGH_CONTRAST?2:1;t.addRule(`.monaco-editor .tokens-inspect-widget { border: ${r}px solid ${n}; }`),t.addRule(`.monaco-editor .tokens-inspect-widget .tokens-inspect-separator { background-color: ${n}; }`)}let r=e.getColor(Ps);r&&t.addRule(`.monaco-editor .tokens-inspect-widget { background-color: ${r}; }`);let i=e.getColor(pe);i&&t.addRule(`.monaco-editor .tokens-inspect-widget { color: ${i}; }`)});var yD=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},bD=function(e,t){return function(n,r){t(n,r,e)}},xD=class e{constructor(e){this.quickInputService=e,this.registry=ra.as(As.Quickaccess)}provide(t){let n=new K;n.add(t.onDidAccept(()=>{let[e]=t.selectedItems;e&&this.quickInputService.quickAccess.show(e.prefix,{preserveValue:!0})})),n.add(t.onDidChangeValue(t=>{let n=this.registry.getQuickAccessProvider(t.substr(e.PREFIX.length));n&&n.prefix&&n.prefix!==e.PREFIX&&this.quickInputService.quickAccess.show(n.prefix,{preserveValue:!0})}));let{editorProviders:r,globalProviders:i}=this.getQuickAccessProviders();return t.items=r.length===0||i.length===0?[...r.length===0?i:r]:[{label:z(`globalCommands`,`global commands`),type:`separator`},...i,{label:z(`editorCommands`,`editor commands`),type:`separator`},...r],n}getQuickAccessProviders(){let t=[],n=[];for(let r of this.registry.getQuickAccessProviders().sort((e,t)=>e.prefix.localeCompare(t.prefix)))if(r.prefix!==e.PREFIX)for(let e of r.helpEntries){let i=e.prefix||r.prefix,a=i||``;(e.needsEditor?n:t).push({prefix:i,label:a,ariaLabel:z(`helpPickAriaLabel`,`{0}, {1}`,a,e.description),description:e.description})}return{editorProviders:n,globalProviders:t}}};xD.PREFIX=`?`,xD=yD([bD(0,ci)],xD),ra.as(As.Quickaccess).registerQuickAccessProvider({ctor:xD,prefix:``,helpEntries:[{description:$t.helpQuickAccessActionLabel,needsEditor:!0}]});var SD=class{constructor(e){this.options=e,this.rangeHighlightDecorationId=void 0}provide(e,t){let n=new K;e.canAcceptInBackground=!!this.options?.canAcceptInBackground,e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;let r=n.add(new Un);return r.value=this.doProvide(e,t),n.add(this.onDidActiveTextEditorControlChange(()=>{r.value=void 0,r.value=this.doProvide(e,t)})),n}doProvide(e,t){let n=new K,r=this.activeTextEditorControl;if(r&&this.canProvideWithTextEditor(r)){let i={editor:r},a=Ye(r);if(a){let e=xe(r.saveViewState());n.add(a.onDidChangeCursorPosition(()=>{e=xe(r.saveViewState())})),i.restoreViewState=()=>{e&&r===this.activeTextEditorControl&&r.restoreViewState(e)},n.add(Sa(t.onCancellationRequested)(()=>i.restoreViewState?.call(i)))}n.add(ja(()=>this.clearDecorations(r))),n.add(this.provideWithTextEditor(i,e,t))}else n.add(this.provideWithoutTextEditor(e,t));return n}canProvideWithTextEditor(e){return!0}gotoLocation({editor:e},t){e.setSelection(t.range),e.revealRangeInCenter(t.range,0),t.preserveFocus||e.focus()}getModel(e){return gr(e)?e.getModel()?.modified:e.getModel()}addDecorations(e,t){e.changeDecorations(e=>{let n=[];this.rangeHighlightDecorationId&&=(n.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),n.push(this.rangeHighlightDecorationId.rangeHighlightId),void 0);let r=[{range:t,options:{description:`quick-access-range-highlight`,className:`rangeHighlight`,isWholeLine:!0}},{range:t,options:{description:`quick-access-range-highlight-overview`,overviewRuler:{color:aa(qo),position:ki.Full}}}],[i,a]=e.deltaDecorations(n,r);this.rangeHighlightDecorationId={rangeHighlightId:i,overviewRulerDecorationId:a}})}clearDecorations(e){let t=this.rangeHighlightDecorationId;t&&(e.changeDecorations(e=>{e.deltaDecorations([t.overviewRulerDecorationId,t.rangeHighlightId],[])}),this.rangeHighlightDecorationId=void 0)}},CD=class e extends SD{constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(e){let t=z(`cannotRunGotoLine`,`Open a text editor first to go to a line.`);return e.items=[{label:t}],e.ariaLabel=t,_.None}provideWithTextEditor(t,n,r){let i=t.editor,a=new K;a.add(n.onDidAccept(e=>{let[r]=n.selectedItems;if(r){if(!this.isValidLineNumber(i,r.lineNumber))return;this.gotoLocation(t,{range:this.toRange(r.lineNumber,r.column),keyMods:n.keyMods,preserveFocus:e.inBackground}),e.inBackground||n.hide()}}));let o=()=>{let t=this.parsePosition(i,n.value.trim().substr(e.PREFIX.length)),r=this.getPickLabel(i,t.lineNumber,t.column);if(n.items=[{lineNumber:t.lineNumber,column:t.column,label:r}],n.ariaLabel=r,!this.isValidLineNumber(i,t.lineNumber)){this.clearDecorations(i);return}let a=this.toRange(t.lineNumber,t.column);i.revealRangeInCenter(a,0),this.addDecorations(i,a)};o(),a.add(n.onDidChangeValue(()=>o()));let s=Ye(i);return s&&s.getOptions().get(59).renderType===2&&(s.updateOptions({lineNumbers:`on`}),a.add(ja(()=>s.updateOptions({lineNumbers:`relative`})))),a}toRange(e=1,t=1){return{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}}parsePosition(e,t){let n=t.split(/,|:|#/).map(e=>parseInt(e,10)).filter(e=>!isNaN(e)),r=this.lineCount(e)+1;return{lineNumber:n[0]>0?n[0]:r+n[0],column:n[1]}}getPickLabel(e,t,n){if(this.isValidLineNumber(e,t))return this.isValidColumn(e,t,n)?z(`gotoLineColumnLabel`,`Go to line {0} and character {1}.`,t,n):z(`gotoLineLabel`,`Go to line {0}.`,t);let r=e.getPosition()||{lineNumber:1,column:1},i=this.lineCount(e);return i>1?z(`gotoLineLabelEmptyWithLimit`,`Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.`,r.lineNumber,r.column,i):z(`gotoLineLabelEmpty`,`Current Line: {0}, Character: {1}. Type a line number to navigate to.`,r.lineNumber,r.column)}isValidLineNumber(e,t){return!t||typeof t!=`number`?!1:t>0&&t<=this.lineCount(e)}isValidColumn(e,t,n){if(!n||typeof n!=`number`)return!1;let r=this.getModel(e);if(!r)return!1;let i={lineNumber:t,column:n};return r.validatePosition(i).equals(i)}lineCount(e){return this.getModel(e)?.getLineCount()??0}};CD.PREFIX=`:`;var wD=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},TD=function(e,t){return function(n,r){t(n,r,e)}},ED=class extends CD{constructor(e){super(),this.editorService=e,this.onDidActiveTextEditorControlChange=ui.None}get activeTextEditorControl(){return xe(this.editorService.getFocusedCodeEditor())}};ED=wD([TD(0,po)],ED),ra.as(As.Quickaccess).registerQuickAccessProvider({ctor:ED,prefix:ED.PREFIX,helpEntries:[{description:Wn.gotoLineActionLabel,needsEditor:!0}]}),o(class extends V{constructor(){super({id:`editor.action.gotoLine`,label:Wn.gotoLineActionLabel,alias:`Go to Line/Column...`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:2085,mac:{primary:293},weight:100}})}run(e){e.get(ci).quickAccess.show(ED.PREFIX)}});var DD=[void 0,[]];function OD(e,t,n=0,r=0){let i=t;return i.values&&i.values.length>1?kD(e,i.values,n,r):AD(e,t,n,r)}function kD(e,t,n,r){let i=0,a=[];for(let o of t){let[t,s]=AD(e,o,n,r);if(typeof t!=`number`)return DD;i+=t,a.push(...s)}return[i,jD(a)]}function AD(e,t,n,r){let i=lo(t.original,t.originalLowercase,n,e,e.toLowerCase(),r,!0);return i?[i[0],as(i)]:DD}function jD(e){let t=e.sort((e,t)=>e.start-t.start),n=[],r;for(let e of t)!r||!MD(r,e)?(r=e,n.push(e)):(r.start=Math.min(r.start,e.start),r.end=Math.max(r.end,e.end));return n}function MD(e,t){return!(e.end<t.start||t.end<e.start)}function ND(e){return e.startsWith(`"`)&&e.endsWith(`"`)}var PD=` `;function FD(e){typeof e!=`string`&&(e=``);let t=e.toLowerCase(),{pathNormalized:n,normalized:r,normalizedLowercase:i}=ID(e),a=n.indexOf(ia)>=0,o=ND(e),s,c=e.split(PD);if(c.length>1)for(let e of c){let t=ND(e),{pathNormalized:n,normalized:r,normalizedLowercase:i}=ID(e);r&&(s||=[],s.push({original:e,originalLowercase:e.toLowerCase(),pathNormalized:n,normalized:r,normalizedLowercase:i,expectContiguousMatch:t}))}return{original:e,originalLowercase:t,pathNormalized:n,normalized:r,normalizedLowercase:i,values:s,containsPathSeparator:a,expectContiguousMatch:o}}function ID(e){let t;t=_t?e.replace(/\//g,ia):e.replace(/\\/g,ia);let n=Ci(t).replace(/\s|"/g,``);return{pathNormalized:t,normalized:n,normalizedLowercase:n.toLowerCase()}}function LD(e){return FD(Array.isArray(e)?e.map(e=>e.original).join(PD):e.original)}var RD=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},zD=class e extends SD{constructor(e=Object.create(null)){super(e),this.options=e,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(e){return this.provideLabelPick(e,z(`cannotRunGotoSymbolWithoutEditor`,`To go to a symbol, first open a text editor with symbol information.`)),_.None}provideWithTextEditor(e,t,n){let r=e.editor,i=this.getModel(r);return i?sn.has(i)?this.doProvideWithEditorSymbols(e,i,t,n):this.doProvideWithoutEditorSymbols(e,i,t,n):_.None}doProvideWithoutEditorSymbols(e,t,n,r){let i=new K;return this.provideLabelPick(n,z(`cannotRunGotoSymbolWithoutSymbolProvider`,`The active text editor does not provide symbol information.`)),RD(this,void 0,void 0,function*(){!(yield this.waitForLanguageSymbolRegistry(t,i))||r.isCancellationRequested||i.add(this.doProvideWithEditorSymbols(e,t,n,r))}),i}provideLabelPick(e,t){e.items=[{label:t,index:0,kind:14}],e.ariaLabel=t}waitForLanguageSymbolRegistry(e,t){return RD(this,void 0,void 0,function*(){if(sn.has(e))return!0;let n,r=new Promise(e=>n=e),i=t.add(sn.onDidChange(()=>{sn.has(e)&&(i.dispose(),n(!0))}));return t.add(ja(()=>n(!1))),r})}doProvideWithEditorSymbols(t,n,r,i){let a=t.editor,o=new K;o.add(r.onDidAccept(e=>{let[n]=r.selectedItems;n&&n.range&&(this.gotoLocation(t,{range:n.range.selection,keyMods:r.keyMods,preserveFocus:e.inBackground}),e.inBackground||r.hide())})),o.add(r.onDidTriggerItemButton(({item:e})=>{e&&e.range&&(this.gotoLocation(t,{range:e.range.selection,keyMods:r.keyMods,forceSideBySide:!0}),r.hide())}));let s=this.getDocumentSymbols(n,i),c,l=()=>RD(this,void 0,void 0,function*(){c?.dispose(!0),r.busy=!1,c=new hs(i),r.busy=!0;try{let t=FD(r.value.substr(e.PREFIX.length).trim()),n=yield this.doGetSymbolPicks(s,t,void 0,c.token);if(i.isCancellationRequested)return;n.length>0?r.items=n:t.original.length>0?this.provideLabelPick(r,z(`noMatchingSymbolResults`,`No matching editor symbols`)):this.provideLabelPick(r,z(`noSymbolResults`,`No editor symbols`))}finally{i.isCancellationRequested||(r.busy=!1)}});o.add(r.onDidChangeValue(()=>l())),l();let u=!0;return o.add(r.onDidChangeActive(()=>{let[e]=r.activeItems;if(e&&e.range){if(u){u=!1;return}a.revealRangeInCenter(e.range.selection,0),this.addDecorations(a,e.range.decoration)}})),o}doGetSymbolPicks(t,n,r,i){return RD(this,void 0,void 0,function*(){let a=yield t;if(i.isCancellationRequested)return[];let o=n.original.indexOf(e.SCOPE_PREFIX)===0,s=o?1:0,c,l;n.values&&n.values.length>1?(c=LD(n.values[0]),l=LD(n.values.slice(1))):c=n;let u=[];for(let e=0;e<a.length;e++){let t=a[e],i=Wa(t.name),o=`$(symbol-${zr.toString(t.kind)||`property`}) ${i}`,d=o.length-i.length,f=t.containerName;r?.extraContainerLabel&&(f=f?`${r.extraContainerLabel}  ${f}`:r.extraContainerLabel);let p,m,h,ee;if(n.original.length>s){let e=!1;if(c!==n&&([p,m]=OD(o,Object.assign(Object.assign({},n),{values:void 0}),s,d),typeof p==`number`&&(e=!0)),typeof p!=`number`&&([p,m]=OD(o,c,s,d),typeof p!=`number`))continue;if(!e&&l){if(f&&l.original.length>0&&([h,ee]=OD(f,l)),typeof h!=`number`)continue;typeof p==`number`&&(p+=h)}}let g=t.tags&&t.tags.indexOf(1)>=0;u.push({index:e,kind:t.kind,score:p,label:o,ariaLabel:i,description:f,highlights:g?void 0:{label:m,description:ee},range:{selection:W.collapseToStart(t.selectionRange),decoration:t.range},strikethrough:g,buttons:(()=>{let e=this.options?.openSideBySideDirection?this.options?.openSideBySideDirection():void 0;if(e)return[{iconClass:e===`right`?M.splitHorizontal.classNames:M.splitVertical.classNames,tooltip:e===`right`?z(`openToSide`,`Open to the Side`):z(`openToBottom`,`Open to the Bottom`)}]})()})}let d=u.sort((e,t)=>o?this.compareByKindAndScore(e,t):this.compareByScore(e,t)),f=[];if(o){let e,t,n=0;function r(){t&&typeof e==`number`&&n>0&&(t.label=yn(VD[e]||BD,n))}for(let i of d)e===i.kind?n++:(r(),e=i.kind,n=1,t={type:`separator`},f.push(t)),f.push(i);r()}else d.length>0&&(f=[{label:z(`symbols`,`symbols ({0})`,u.length),type:`separator`},...d]);return f})}compareByScore(e,t){if(typeof e.score!=`number`&&typeof t.score==`number`)return 1;if(typeof e.score==`number`&&typeof t.score!=`number`)return-1;if(typeof e.score==`number`&&typeof t.score==`number`){if(e.score>t.score)return-1;if(e.score<t.score)return 1}return e.index<t.index?-1:e.index>t.index?1:0}compareByKindAndScore(e,t){let n=VD[e.kind]||BD,r=VD[t.kind]||BD,i=n.localeCompare(r);return i===0?this.compareByScore(e,t):i}getDocumentSymbols(e,t){return RD(this,void 0,void 0,function*(){let n=yield eC.create(e,t);return t.isCancellationRequested?[]:n.asListOfDocumentSymbols()})}};zD.PREFIX=`@`,zD.SCOPE_PREFIX=`:`,zD.PREFIX_BY_CATEGORY=`${zD.PREFIX}${zD.SCOPE_PREFIX}`;var BD=z(`property`,`properties ({0})`),VD={5:z(`method`,`methods ({0})`),11:z(`function`,`functions ({0})`),8:z(`_constructor`,`constructors ({0})`),12:z(`variable`,`variables ({0})`),4:z(`class`,`classes ({0})`),22:z(`struct`,`structs ({0})`),23:z(`event`,`events ({0})`),24:z(`operator`,`operators ({0})`),10:z(`interface`,`interfaces ({0})`),2:z(`namespace`,`namespaces ({0})`),3:z(`package`,`packages ({0})`),25:z(`typeParameter`,`type parameters ({0})`),1:z(`modules`,`modules ({0})`),6:z(`property`,`properties ({0})`),9:z(`enum`,`enumerations ({0})`),21:z(`enumMember`,`enumeration members ({0})`),14:z(`string`,`strings ({0})`),0:z(`file`,`files ({0})`),17:z(`array`,`arrays ({0})`),15:z(`number`,`numbers ({0})`),16:z(`boolean`,`booleans ({0})`),18:z(`object`,`objects ({0})`),19:z(`key`,`keys ({0})`),7:z(`field`,`fields ({0})`),13:z(`constant`,`constants ({0})`)},HD=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},UD=function(e,t){return function(n,r){t(n,r,e)}},WD=class extends zD{constructor(e){super(),this.editorService=e,this.onDidActiveTextEditorControlChange=ui.None}get activeTextEditorControl(){return xe(this.editorService.getFocusedCodeEditor())}};WD=HD([UD(0,po)],WD),ra.as(As.Quickaccess).registerQuickAccessProvider({ctor:WD,prefix:zD.PREFIX,helpEntries:[{description:Ma.quickOutlineActionLabel,prefix:zD.PREFIX,needsEditor:!0},{description:Ma.quickOutlineByCategoryActionLabel,prefix:zD.PREFIX_BY_CATEGORY,needsEditor:!0}]}),o(class extends V{constructor(){super({id:`editor.action.quickOutline`,label:Ma.quickOutlineActionLabel,alias:`Go to Symbol...`,precondition:A.hasDocumentSymbolProvider,kbOpts:{kbExpr:A.focus,primary:3117,weight:100},contextMenuOpts:{group:`navigation`,order:3}})}run(e){e.get(ci).quickAccess.show(zD.PREFIX)}});function GD(e,t){return t&&(e.stack||e.stacktrace)?z(`stackTrace.format`,`{0}: {1}`,qD(e),KD(e.stack)||KD(e.stacktrace)):qD(e)}function KD(e){return Array.isArray(e)?e.join(`
`):e}function qD(e){return typeof e.code==`string`&&typeof e.errno==`number`&&typeof e.syscall==`string`?z(`nodeExceptionMessage`,`A system error occurred ({0})`,e.message):e.message||z(`error.defaultMessage`,`An unknown error occurred. Please consult the log for more details.`)}function JD(e=null,t=!1){if(!e)return z(`error.defaultMessage`,`An unknown error occurred. Please consult the log for more details.`);if(Array.isArray(e)){let n=r(e),i=JD(n[0],t);return n.length>1?z(`error.moreErrors`,`{0} ({1} errors in total)`,i,n.length):i}if(Kn(e))return e;if(e.detail){let n=e.detail;if(n.error)return GD(n.error,t);if(n.exception)return GD(n.exception,t)}return e.stack?GD(e,t):e.message?e.message:z(`error.defaultMessage`,`An unknown error occurred. Please consult the log for more details.`)}var YD=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},XD;(function(e){e[e.NO_ACTION=0]=`NO_ACTION`,e[e.CLOSE_PICKER=1]=`CLOSE_PICKER`,e[e.REFRESH_PICKER=2]=`REFRESH_PICKER`,e[e.REMOVE_ITEM=3]=`REMOVE_ITEM`})(XD||={});function ZD(e){let t=e;return Array.isArray(t.items)}function QD(e){let t=e;return!!t.picks&&t.additionalPicks instanceof Promise}var $D=class e extends _{constructor(e,t){super(),this.prefix=e,this.options=t}provide(t,n){let r=new K;t.canAcceptInBackground=!!this.options?.canAcceptInBackground,t.matchOnLabel=t.matchOnDescription=t.matchOnDetail=t.sortByLabel=!1;let i,a=r.add(new Un),o=()=>YD(this,void 0,void 0,function*(){let r=a.value=new K;i?.dispose(!0),t.busy=!1,i=new hs(n);let o=i.token,s=t.value.substr(this.prefix.length).trim(),c=this._getPicks(s,r,o),l=(e,n)=>{let r,i;if(ZD(e)?(r=e.items,i=e.active):r=e,r.length===0){if(n)return!1;s.length>0&&this.options?.noResultsPick&&(r=[this.options.noResultsPick])}return t.items=r,i&&(t.activeItems=[i]),!0};if(c!==null)if(QD(c)){let n=!1,r=!1;yield Promise.all([(()=>YD(this,void 0,void 0,function*(){yield xn(e.FAST_PICKS_RACE_DELAY),!o.isCancellationRequested&&(r||(n=l(c.picks,!0)))}))(),(()=>YD(this,void 0,void 0,function*(){t.busy=!0;try{let e=yield c.additionalPicks;if(o.isCancellationRequested)return;let r,i;ZD(c.picks)?(r=c.picks.items,i=c.picks.active):r=c.picks;let a,s;if(ZD(e)?(a=e.items,s=e.active):a=e,a.length>0||!n){let e;if(!i&&!s){let n=t.activeItems[0];n&&r.indexOf(n)!==-1&&(e=n)}l({items:[...r,...a],active:i||s||e})}}finally{o.isCancellationRequested||(t.busy=!1),r=!0}}))()])}else if(!(c instanceof Promise))l(c);else{t.busy=!0;try{let e=yield c;if(o.isCancellationRequested)return;l(e)}finally{o.isCancellationRequested||(t.busy=!1)}}});return r.add(t.onDidChangeValue(()=>o())),o(),r.add(t.onDidAccept(e=>{let[n]=t.selectedItems;typeof n?.accept==`function`&&(e.inBackground||t.hide(),n.accept(t.keyMods,e))})),r.add(t.onDidTriggerItemButton(({button:e,item:r})=>YD(this,void 0,void 0,function*(){if(typeof r.trigger==`function`){let i=r.buttons?.indexOf(e)??-1;if(i>=0){let e=r.trigger(i,t.keyMods),a=typeof e==`number`?e:yield e;if(n.isCancellationRequested)return;switch(a){case XD.NO_ACTION:break;case XD.CLOSE_PICKER:t.hide();break;case XD.REFRESH_PICKER:o();break;case XD.REMOVE_ITEM:let e=t.items.indexOf(r);if(e!==-1){let n=t.items.slice(),r=n.splice(e,1),i=t.activeItems.filter(e=>e!==r[0]),a=t.keepScrollPosition;t.keepScrollPosition=!0,t.items=n,i&&(t.activeItems=i),t.keepScrollPosition=a}break}}}}))),r}};$D.FAST_PICKS_RACE_DELAY=200;var eO=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},tO=function(e,t){return function(n,r){t(n,r,e)}},nO=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},rO=class e extends $D{constructor(t,n,r,i,a,o){super(e.PREFIX,t),this.instantiationService=n,this.keybindingService=r,this.commandService=i,this.telemetryService=a,this.dialogService=o,this.commandsHistory=this._register(this.instantiationService.createInstance(iO)),this.options=t}_getPicks(t,n,r){return nO(this,void 0,void 0,function*(){let i=yield this.getCommandPicks(n,r);if(r.isCancellationRequested)return[];let a=[];for(let n of i){let r=xe(e.WORD_FILTER(t,n.label)),i=n.commandAlias?xe(e.WORD_FILTER(t,n.commandAlias)):void 0;r||i?(n.highlights={label:r,detail:this.options.showAlias?i:void 0},a.push(n)):t===n.commandId&&a.push(n)}let o=new Map;for(let e of a){let t=o.get(e.label);t?(e.description=e.commandId,t.description=t.commandId):o.set(e.label,e)}a.sort((e,t)=>{let n=this.commandsHistory.peek(e.commandId),r=this.commandsHistory.peek(t.commandId);return n&&r?n>r?-1:1:n?-1:r?1:e.label.localeCompare(t.label)});let s=[],c=!1;for(let e=0;e<a.length;e++){let t=a[e],n=this.keybindingService.lookupKeybinding(t.commandId),r=n?z(`commandPickAriaLabelWithKeybinding`,`{0}, {1}`,t.label,n.getAriaLabel()):t.label;e===0&&this.commandsHistory.peek(t.commandId)&&(s.push({type:`separator`,label:z(`recentlyUsed`,`recently used`)}),c=!0),e!==0&&c&&!this.commandsHistory.peek(t.commandId)&&(s.push({type:`separator`,label:z(`morecCommands`,`other commands`)}),c=!1),s.push(Object.assign(Object.assign({},t),{ariaLabel:r,detail:this.options.showAlias&&t.commandAlias!==t.label?t.commandAlias:void 0,keybinding:n,accept:()=>nO(this,void 0,void 0,function*(){this.commandsHistory.push(t.commandId),this.telemetryService.publicLog2(`workbenchActionExecuted`,{id:t.commandId,from:`quick open`});try{yield this.commandService.executeCommand(t.commandId)}catch(e){cn(e)||this.dialogService.show(Ve.Error,z(`canNotRun`,`Command '{0}' resulted in an error ({1})`,t.label,JD(e)))}})}))}return s})}};rO.PREFIX=`>`,rO.WORD_FILTER=Zo(si,yo,ya),rO=eO([tO(1,H),tO(2,Oo),tO(3,Hs),tO(4,mo),tO(5,st)],rO);var iO=class e extends _{constructor(e,t){super(),this.storageService=e,this.configurationService=t,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(()=>this.updateConfiguration()))}updateConfiguration(){this.configuredCommandsHistoryLength=e.getConfiguredCommandHistoryLength(this.configurationService),e.cache&&e.cache.limit!==this.configuredCommandsHistoryLength&&(e.cache.limit=this.configuredCommandsHistoryLength,e.saveState(this.storageService))}load(){let t=this.storageService.get(e.PREF_KEY_CACHE,0),n;if(t)try{n=JSON.parse(t)}catch{}let r=e.cache=new oe(this.configuredCommandsHistoryLength,1);if(n){let e;e=n.usesLRU?n.entries:n.entries.sort((e,t)=>e.value-t.value),e.forEach(e=>r.set(e.key,e.value))}e.counter=this.storageService.getNumber(e.PREF_KEY_COUNTER,0,e.counter)}push(t){e.cache&&(e.cache.set(t,e.counter++),e.saveState(this.storageService))}peek(t){return e.cache?.peek(t)}static saveState(t){if(!e.cache)return;let n={usesLRU:!0,entries:[]};e.cache.forEach((e,t)=>n.entries.push({key:t,value:e})),t.store(e.PREF_KEY_CACHE,JSON.stringify(n),0,0),t.store(e.PREF_KEY_COUNTER,e.counter,0,0)}static getConfiguredCommandHistoryLength(t){let n=t.getValue().workbench?.commandPalette?.history;return typeof n==`number`?n:e.DEFAULT_COMMANDS_HISTORY_LENGTH}};iO.DEFAULT_COMMANDS_HISTORY_LENGTH=50,iO.PREF_KEY_CACHE=`commandPalette.mru.cache`,iO.PREF_KEY_COUNTER=`commandPalette.mru.counter`,iO.counter=1,iO=eO([tO(0,je),tO(1,xo)],iO);var aO=class extends rO{constructor(e,t,n,r,i,a){super(e,t,n,r,i,a)}getCodeEditorCommandPicks(){let e=this.activeTextEditorControl;if(!e)return[];let t=[];for(let n of e.getSupportedActions())t.push({commandId:n.id,commandAlias:n.alias,label:hn(n.label)||n.id});return t}},oO=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},sO=function(e,t){return function(n,r){t(n,r,e)}},cO=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},lO=class extends aO{constructor(e,t,n,r,i,a){super({showAlias:!1},e,n,r,i,a),this.codeEditorService=t}get activeTextEditorControl(){return xe(this.codeEditorService.getFocusedCodeEditor())}getCommandPicks(){return cO(this,void 0,void 0,function*(){return this.getCodeEditorCommandPicks()})}};lO=oO([sO(0,H),sO(1,po),sO(2,Oo),sO(3,Hs),sO(4,mo),sO(5,st)],lO),ra.as(As.Quickaccess).registerQuickAccessProvider({ctor:lO,prefix:lO.PREFIX,helpEntries:[{description:ye.quickCommandHelp,needsEditor:!0}]}),o(class extends V{constructor(){super({id:`editor.action.quickCommand`,label:ye.quickCommandActionLabel,alias:`Command Palette`,precondition:void 0,kbOpts:{kbExpr:A.focus,primary:59,weight:100},contextMenuOpts:{group:`z_commands`,order:1}})}run(e){e.get(ci).quickAccess.show(lO.PREFIX)}});var uO=function(e,t,n,r){var i=arguments.length,a=i<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},dO=function(e,t){return function(n,r){t(n,r,e)}},fO=class extends sf{constructor(e,t,n,r,i,a,o){super(!0,e,t,n,r,i,a,o)}};fO=uO([dO(1,D),dO(2,po),dO(3,Ft),dO(4,H),dO(5,je),dO(6,xo)],fO),U(sf.ID,fO),o(class extends V{constructor(){super({id:`editor.action.toggleHighContrast`,label:f.toggleHighContrast,alias:`Toggle High Contrast Theme`,precondition:void 0}),this._originalThemeName=null}run(e,t){let n=e.get(eo);this._originalThemeName?(n.setTheme(this._originalThemeName),this._originalThemeName=null):(this._originalThemeName=n.getColorTheme().themeName,n.setTheme(`hc-black`))}});export{Qo as CancellationTokenSource,to as Emitter,Fo as KeyCode,da as KeyMod,ei as MarkerSeverity,uo as MarkerTag,Wo as Position,_i as Range,Ra as Selection,os as SelectionDirection,Ti as Token,zi as Uri,bo as editor,Ka as languages};